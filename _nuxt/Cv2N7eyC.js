import{U as Bx,_ as Ox}from"./Dd-faj7m.js";import{c as Wx,d as _x,X as Vx,Q as Nx,V as Hx,l as dm,Z as jx,u as np,z as Ux,ae as Gx,ak as Zx}from"./D-drnA8r.js";import{V as Xx}from"./D2UNT5-5.js";import"./BqPeQ3OS.js";import"./DofQ3S8r.js";import"./DKJK53Zu.js";import"./TGtU8jwX.js";import"./DKQXYXU0.js";import"./DZ_MvYd2.js";import"./-39vNLdD.js";import"./BTSmHasN.js";import"./Cez0OCOh.js";import"./DqdUkXJR.js";import"./DU9aVLxN.js";import"./DmbCR1Vh.js";import"./ChByEAEK.js";import"./CGDHALbh.js";/*!
 * Pintura v8.79.0 - Test version
 * (c) 2018-2024 PQINA Inc. - All Rights Reserved
 * License: https://pqina.nl/pintura/license/
 * 
 * This version of Pintura is for testing purposes only.
 * Visit https://pqina.nl/pintura/ to obtain a commercial license.
 */const Yx=[{value:65504,name:"jfif"},{value:65498,name:"sos"},{value:65505,subvalue:17784,name:"exif"},{value:65505,subvalue:26740,name:"xmp"},{value:65506,subvalue:19792,name:"mpf"}];var Uf=t=>{if(t.getUint16(0)!==65496)return;const e=t.byteLength;let i,n=2,r;for(;n<e&&t.getUint8(n)===255;){i=t.getUint16(n);const o=Yx.find(a=>a.value===i&&(!a.subvalue||a.subvalue===t.getUint16(n+2+2)));if(o){const{name:a}=o;r||(r={}),r[a]||(r[a]={offset:n,size:t.getUint16(n+2)})}if(i===65498)break;n+=2+t.getUint16(n+2)}return r},gh=(t,e,i)=>{if(!t)return;const n=new DataView(t),r=Uf(n);if(!r||!r.exif)return;const o=((a,s)=>{if(a.getUint16(s)!==65505)return;const l=a.getUint16(s+2);if(s+=4,a.getUint32(s)!==1165519206)return;s+=6;const c=a.getUint16(s);if(c!==18761&&c!==19789)return;const d=c===18761;if(s+=2,a.getUint16(s,d)!==42)return;s+=a.getUint32(s+2,d);const u=p=>{const h=[];let g=s;const m=Math.min(a.byteLength,s+l-16);for(;g<m;g+=12){const f=g;a.getUint16(f,d)===p&&h.push(f)}return h};return{read:p=>{const h=u(p);if(h.length)return a.getUint16(h[0]+8,d)},write:(p,h)=>{const g=u(p);return!!g.length&&(g.forEach(m=>a.setUint16(m+8,h,d)),!0)}}})(n,r.exif.offset);return o?i===void 0?o.read(e):o.write(e,i):void 0},fh=t=>window.__pqina_webapi__?window.__pqina_webapi__[t]:window[t],me=(...t)=>{};const qx={ArrayBuffer:"readAsArrayBuffer"};var Gf=async(t,e=[0,t.size],i)=>await((n,r=me,o={})=>new Promise((a,s)=>{const{dataFormat:l=qx.ArrayBuffer}=o,c=new(fh("FileReader"));c.onload=()=>a(c.result),c.onerror=()=>s(c.error),c.onprogress=r,c[l](n)}))(t.slice(...e),i),Kx=async(t,e)=>{const i=await Gf(t,[0,262144],e);return gh(i,274)||1};let rp=null;var Pr=()=>(rp===null&&(rp=typeof window<"u"&&window.document!==void 0),rp);let Fd=null;var wu=()=>new Promise(t=>{if(Fd===null){const e="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";let i=Pr()?new Image:{};return i.onload=()=>{Fd=i.naturalWidth===1,i=void 0,t(Fd)},void(i.src=e)}return t(Fd)}),Nc=t=>t.getContext("2d").getImageData(0,0,t.width,t.height),xn=(t,e,i=[])=>{const n=document.createElement(t),r=Object.getOwnPropertyDescriptors(n.__proto__);for(const o in e)o==="style"?n.style.cssText=e[o]:r[o]&&r[o].set||/textContent|innerHTML/.test(o)||typeof e[o]=="function"?n[o]=e[o]:n.setAttribute(o,e[o]);return i.forEach(o=>n.appendChild(o)),n};const Jx={1:()=>[1,0,0,1,0,0],2:t=>[-1,0,0,1,t,0],3:(t,e)=>[-1,0,0,-1,t,e],4:(t,e)=>[1,0,0,-1,0,e],5:()=>[0,1,1,0,0,0],6:(t,e)=>[0,1,-1,0,e,0],7:(t,e)=>[0,-1,-1,0,e,t],8:t=>[0,-1,1,0,0,t]};var qn=t=>{t.width=1,t.height=1;const e=t.getContext("2d");e&&e.clearRect(0,0,1,1)},Fl=t=>"data"in t,yh=t=>Pr()?RegExp(t).test(window.navigator.userAgent):void 0;let op=null;var Su=()=>(op===null&&(op=yh(/Android/)),op),Zf=(t,e)=>{const i=xn("canvas",{width:t.width,height:t.height});return i.getContext("2d",e).drawImage(t,0,0),i},Nl=async(t,e=1)=>{const i=await wu(),[n,r]=i||e<5?[t.width,t.height]:[t.height,t.width],o=xn("canvas",{width:n,height:r}),a=o.getContext("2d",{willReadFrequently:!0});if(Fl(t)&&!i&&e>1){const s=xn("canvas",{width:t.width,height:t.height});s.getContext("2d",{willReadFrequently:!0}).putImageData(t,0,0),t=s}if(!i&&e>1&&a.transform.apply(a,((s,l,c=-1)=>(c===-1&&(c=1),Jx[c](s,l)))(t.width,t.height,e)),Fl(t)){if(a.putImageData(t,0,0),Su())return Zf(o)}else a.drawImage(t,0,0);return t instanceof HTMLCanvasElement&&qn(t),o},Xf=async(t,e=1)=>e===1||await wu()?t:Nc(await Nl(t,e)),sl=t=>typeof t=="object";const um=t=>t instanceof HTMLElement?t:sl(t)?Yf(t):t,Yf=t=>{let e;return Array.isArray(t)?(e=[],t.forEach((i,n)=>{e[n]=um(i)})):(e={},Object.keys(t).forEach(i=>{const n=t[i];e[i]=um(n)})),e};var _e=t=>typeof t=="string",on=t=>typeof t=="function",Qx=(t,e)=>new Promise((i,n)=>{const r=()=>i(((o,{width:a,height:s,canvasMemoryLimit:l,contextOptions:c})=>{let d=a||o.naturalWidth,u=s||o.naturalHeight;d||u||(d=300,u=150);const p=d*u;if(l&&p>l){const g=Math.sqrt(l)/Math.sqrt(p);d=Math.floor(d*g),u=Math.floor(u*g)}const h=xn("canvas");return h.width=d,h.height=u,h.getContext("2d",c).drawImage(o,0,0,d,u),h})(t,e));t.complete&&t.width?r():(t.onload=r,t.onerror=()=>n(new Error("Failed to load image")))}),qf=()=>"createImageBitmap"in window,Kf=t=>/svg/.test(t.type),ea=()=>Math.random().toString(36).substring(2,9);const ap=new Map;var Hc=(t,e,i)=>new Promise((n,r)=>{const o=t.toString();let a=ap.get(o);if(!a){const l=(p=>`function () {self.onmessage = function (message) {(${p.toString()}).apply(null, message.data.content.concat([function (err, response) {
    response = response || {};
    const transfer = 'data' in response ? [response.data.buffer] : 'width' in response ? [response] : [];
    return self.postMessage({ id: message.data.id, content: response, error: err }, transfer);
}]))}}`)(t),c=URL.createObjectURL((p=>new Blob(["(",typeof p=="function"?p.toString():p,")()"],{type:"application/javascript"}))(l)),d=new Map,u=new Worker(c);a={url:c,worker:u,messages:d,terminationTimeout:void 0,terminate:()=>{clearTimeout(a.terminationTimeout),a.worker.terminate(),URL.revokeObjectURL(c),ap.delete(o)}},u.onmessage=function(p){const{id:h,content:g,error:m}=p.data;if(clearTimeout(a.terminationTimeout),a.terminationTimeout=setTimeout(()=>{d.size>0||a.terminate()},500),!d.has(h))return;const f=d.get(h);d.delete(h),m!=null?f.reject(m):f.resolve(g)},ap.set(o,a)}const s=ea();a.messages.set(s,{resolve:n,reject:r}),a.worker.postMessage({id:s,content:e},i)});let sp=null;var ya=()=>(sp===null&&(sp=yh(/Firefox/)),sp);const pm=async(t,e)=>{const i=await(async(r,o)=>{const a=xn("img",{src:URL.createObjectURL(r)}),s=await Qx(a,o);return URL.revokeObjectURL(a.src),s})(t,{canvasMemoryLimit:e,contextOptions:{willReadFrequently:!0}}),n=Nc(i);return qn(i),n};var Jf=async(t,e)=>{if(Su()&&!ya())return await pm(t,e);let i;if(qf()&&!Kf(t)&&"OffscreenCanvas"in window)try{i=await Hc((n,r,o)=>{createImageBitmap(n).then(a=>{let s=a.width,l=a.height;const c=s*l;if(r&&c>r){const h=Math.sqrt(r)/Math.sqrt(c);s=Math.floor(s*h),l=Math.floor(l*h)}const d=new OffscreenCanvas(s,l),u=d.getContext("2d",{willReadFrequently:!0});u.drawImage(a,0,0,s,l);const p=u.getImageData(0,0,d.width,d.height);o(null,p)}).catch(a=>{o(a)})},[t,e])}catch{}return i&&i.width?i:await pm(t,e)},xh=(t,e,i)=>new Promise((n,r)=>{try{t.toBlob(o=>{if(!o)return r(new Error("Failed to create blob"));n(o)},e,i)}catch(o){r(o)}}),tb=async(t,e,i)=>{const n=await Nl(t),r=await xh(n,e,i);return qn(n),r};const eb={matroska:"mkv"};var Qf=t=>{const e=(t.match(/\/([a-z0-9]+)/)||[])[1];if(/^x/.test(e)){const[,i=""]=t.split("/x-");return eb[i]}return e},ty=t=>t.substr(0,t.lastIndexOf("."))||t;const ib=/avif|bmp|gif|jpg|jpeg|jpe|jif|jfif|png|svg|tiff|webp/;var bh=t=>{return t&&(e=(i=t,i.split(".").pop()).toLowerCase(),ib.test(e)?"image/"+(/jfif|jif|jpe|jpg/.test(e)?"jpeg":e==="svg"?"svg+xml":e):"");var e,i},Ac=(t,e,i)=>{const n=new Date().getTime(),r=t.type.length&&!/null|text/.test(t.type),o=r?t.type:i,a=((s,l)=>{const c=bh(s);if(c===l)return s;const d=Qf(l)||c;return`${ty(s)}.${d}`})(e,o);try{return new(fh("File"))([t],a,{lastModified:n,type:r?t.type:o})}catch{const l=r?t.slice():t.slice(0,t.size,o);return l.lastModified=n,l.name=a,l}},qo=(t,e)=>t/e,Ki=t=>t;const lp=Math.PI,Wo=Math.PI/2,Ko=Wo/2;var Ra=t=>{const e=Math.abs(t)%Math.PI;return e>Ko&&e<Math.PI-Ko};const jp={Top:"t",Right:"r",Bottom:"b",Left:"l",TopLeft:"tl",TopRight:"tr",BottomRight:"br",BottomLeft:"bl"},{Top:Ms,Right:Ps,Bottom:Rs,Left:Is,TopLeft:na,TopRight:ra,BottomRight:oa,BottomLeft:aa}=jp;var Lc={[Ms]:[.5,0],[Ps]:[1,.5],[Rs]:[.5,1],[Is]:[0,.5],[na]:[0,0],[ra]:[1,0],[oa]:[1,1],[aa]:[0,1]},si=(t,e=12)=>parseFloat(t.toFixed(e));const lu=(t,e,i)=>i+(t-i)*e,hm=t=>({x:t.x+.5*t.width,y:t.y+.5*t.height,rx:.5*t.width,ry:.5*t.height}),rn=()=>ot(0,0),ot=(t,e)=>({x:t,y:e}),mm=t=>ot(t.pageX,t.pageY),Be=t=>ot(t.x,t.y),El=t=>(t.x=-t.x,t.y=-t.y,t),Dr=(t,e,i=rn())=>{const n=Math.cos(e),r=Math.sin(e),o=t.x-i.x,a=t.y-i.y;return t.x=i.x+n*o-r*a,t.y=i.y+r*o+n*a,t},ws=t=>Math.sqrt(t.x*t.x+t.y*t.y),ro=t=>{const e=Math.sqrt(t.x*t.x+t.y*t.y);return e===0?rn():(t.x/=e,t.y/=e,t)},Dd=(t,e)=>Math.atan2(e.y-t.y,e.x-t.x),bs=(t,e)=>t.x===e.x&&t.y===e.y,bo=(t,e)=>(t.x=e(t.x),t.y=e(t.y),t),Dn=(t,e)=>(t.x+=e.x,t.y+=e.y,t),Bn=(t,e)=>(t.x-=e.x,t.y-=e.y,t),$m=(t,e)=>(t.x/=e,t.y/=e,t),Mr=(t,e)=>(t.x*=e,t.y*=e,t),Qd=(t,e)=>t.x*e.x+t.y*e.y,tu=(t,e)=>t.x*e.y-t.y*e.x,yo=(t,e=rn())=>{const i=t.x-e.x,n=t.y-e.y;return i*i+n*n},ho=(t,e=rn())=>Math.sqrt(yo(t,e)),nb=(t,e,i)=>(t.x=lu(t.x,e,i.x),t.y=lu(t.y,e,i.y),t),Do=t=>{let e=0,i=0;return t.forEach(n=>{e+=n.x,i+=n.y}),ot(e/t.length,i/t.length)},Al=(t,e,i,n,r)=>(t.forEach(o=>{o.x=e?n-(o.x-n):o.x,o.y=i?r-(o.y-r):o.y}),t),rl=(t,e,i,n)=>{const r=Math.sin(e),o=Math.cos(e);return t.forEach(a=>{a.x-=i,a.y-=n;const s=a.x*o-a.y*r,l=a.x*r+a.y*o;a.x=i+s,a.y=n+l}),t},Hl=(t,e)=>({width:t,height:e}),no=t=>Hl(t.width,t.height),Aa=t=>Hl(t.width,t.height),ol=t=>Hl(t.width,t.height),ey=t=>Hl(t[0],t[1]),Pc=t=>{return/img/i.test(t.nodeName)?Hl((e=t).naturalWidth,e.naturalHeight):Aa(t);var e},Un=(t,e)=>Hl(t,e),zc=(t,e,i=Ki)=>i(t.width)===i(e.width)&&i(t.height)===i(e.height),Bd=(t,e)=>(t.width*=e,t.height*=e,t),Dl=t=>ot(.5*t.width,.5*t.height),iy=(t,e)=>{const i=Math.abs(e),n=Math.abs(Math.cos(i)),r=Math.abs(Math.sin(i)),o=n*t.width+r*t.height,a=r*t.width+n*t.height;return t.width=o,t.height=a,t},cu=(t,e)=>t.width>=e.width&&t.height>=e.height,is=(t,e)=>(t.width=e(t.width),t.height=e(t.height),t),Es=(t,e)=>({start:t,end:e}),ny=t=>Es(Be(t.start),Be(t.end)),vh=(t,e)=>{if(e===0)return t;const i=ot(t.start.x-t.end.x,t.start.y-t.end.y),n=ro(i),r=Mr(n,e);return t.start.x+=r.x,t.start.y+=r.y,t.end.x-=r.x,t.end.y-=r.y,t},rb=[ot(-1,-1),ot(-1,1),ot(1,1),ot(1,-1)],sa=(t,e,i,n)=>({x:t,y:e,width:i,height:n}),Si=t=>sa(t.x,t.y,t.width,t.height),Ss=()=>sa(0,0,0,0),Or=t=>sa(0,0,t.width,t.height),ob=t=>sa(t[3],t[0],t[1]-t[3],t[2]-t[0]),ys=t=>sa(t.x||0,t.y||0,t.width||0,t.height||0),er=t=>{let e=t[0].x,i=t[0].x,n=t[0].y,r=t[0].y;return t.forEach(o=>{e=Math.min(e,o.x),i=Math.max(i,o.x),n=Math.min(n,o.y),r=Math.max(r,o.y)}),sa(e,n,i-e,r-n)},cp=t=>Pn(t.x-t.rx,t.y-t.ry,2*t.rx,2*t.ry),gm=(t,e)=>sa(t.x-.5*e.width,t.y-.5*e.height,e.width,e.height),Pn=(t,e,i,n)=>sa(t,e,i,n),ki=t=>ot(t.x+.5*t.width,t.y+.5*t.height),Jo=(t,e)=>(t.x+=e.x,t.y+=e.y,t),Tr=(t,e,i)=>(i=i||ki(t),t.x=e*(t.x-i.x)+i.x,t.y=e*(t.y-i.y)+i.y,t.width=e*t.width,t.height=e*t.height,t),fm=(t,e,i,n)=>{const r=(n.x-t.x)/t.width,o=(n.y-t.y)/t.height;let a=Math.max(e.width,t.width),s=Math.max(e.height,t.height);return a=Math.min(i.width,a),s=Math.min(i.height,s),t.x=n.x-r*a,t.y=n.y-o*s,t.width=a,t.height=s,t},ym=(t,e)=>{const[i,n]=Lc[e],r=i*t.width,o=n*t.height;return ot(t.x+r,t.y+o)},ks=(t,e)=>(t.x*=e,t.y*=e,t.width*=e,t.height*=e,t),Qo=(t,e,i=Ki)=>i(t.x)===i(e.x)&&i(t.y)===i(e.y)&&i(t.width)===i(e.width)&&i(t.height)===i(e.height),ir=t=>qo(t.width,t.height),ry=(t,e,i,n,r)=>(t.x=e,t.y=i,t.width=n,t.height=r,t),ku=(t,e)=>(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t),mr=(t,e,i)=>(i||(i=ki(t)),Oo(t).map(n=>Dr(n,e,i))),eu=(t,e)=>sa(.5*t.width-.5*e.width,.5*t.height-.5*e.height,e.width,e.height),du=(t,e)=>!(e.x<t.x)&&!(e.y<t.y)&&!(e.x>t.x+t.width)&&!(e.y>t.y+t.height),rs=(t,e,i=rn())=>{if(t.width===0||t.height===0)return Ss();const n=ir(t);e||(e=n);let r=t.width,o=t.height;return e>n?r=o*e:o=r/e,sa(i.x+.5*(t.width-r),i.y+.5*(t.height-o),r,o)},Yr=(t,e=ir(t),i=rn())=>{if(t.width===0||t.height===0)return Ss();let n=t.width,r=n/e;return r>t.height&&(r=t.height,n=r*e),sa(i.x+.5*(t.width-n),i.y+.5*(t.height-r),n,r)},al=t=>[Math.min(t.y,t.y+t.height),Math.max(t.x,t.x+t.width),Math.max(t.y,t.y+t.height),Math.min(t.x,t.x+t.width)],Oo=t=>[ot(t.x,t.y),ot(t.x+t.width,t.y),ot(t.x+t.width,t.y+t.height),ot(t.x,t.y+t.height)],Bo=(t,e)=>{if(t)return t.x=e(t.x),t.y=e(t.y),t.width=e(t.width),t.height=e(t.height),t},oy=(t,e,i=ki(t))=>Oo(t).map((n,r)=>{const o=rb[r];return ot(lu(n.x,1+o.x*e.x,i.x),lu(n.y,1+o.y*e.y,i.y))}),Fc=t=>(t.x=0,t.y=0,t),xm=t=>{const e=t[0],i=t[t.length-1];t=bs(e,i)?t:[...t,e];const n=e.x,r=e.y;let o,a,s,l=0,c=0,d=0,u=0;const p=t.length;for(;c<p;c++)o=t[c],a=t[c+1>p-1?0:c+1],s=(o.y-r)*(a.x-n)-(a.y-r)*(o.x-n),l+=s,d+=(o.x+a.x-2*n)*s,u+=(o.y+a.y-2*r)*s;return s=3*l,ot(n+d/s,r+u/s)},wh=(t,e)=>ay(t.start,t.end,e.start,e.end),ay=(t,e,i,n)=>{const r=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y);if(r===0)return;const o=((n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x))/r,a=((e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x))/r;return o<0||o>1||a<0||a>1?void 0:ot(t.x+o*(e.x-t.x),t.y+o*(e.y-t.y))},sy=(t,e,{ignoreIdenticalLines:i=!1,breakOnIntersection:n=!1}={})=>{const r=e.length,o=[];for(let a=0;a<r-1;a++){if(i&&(bs(t.start,e[a])||bs(t.start,e[a+1])||bs(t.end,e[a])||bs(t.end,e[a+1])))continue;const s=ay(t.start,t.end,e[a],e[a+1]);if(s){if(n)return[s];o.push(s)}}return o.length?o:void 0},Up=(t,e)=>{let i=0,n=0,r=!1;const o=e.length;for(i=0,n=o-1;i<o;n=i++)e[i].y>t.y!=e[n].y>t.y&&t.x<(e[n].x-e[i].x)*(t.y-e[i].y)/(e[n].y-e[i].y)+e[i].x&&(r=!r);return r},ly=t=>{const e=[];for(let i=0;i<t.length;i++){let n=i+1;n===t.length&&(n=0),e.push(Es(Be(t[i]),Be(t[n])))}return e},cy=(t,e=0)=>ly(t).map(i=>vh(i,e)),uu=(t,e,i,n=0,r=!1,o=!1,a=12)=>{const s=[];for(let l=0;l<a;l++)s.push(ot(t.x+e*Math.cos(l*(2*Math.PI)/a),t.y+i*Math.sin(l*(2*Math.PI)/a)));return(r||o)&&Al(s,r,o,t.x,t.y),n&&rl(s,n,t.x,t.y),s},pu=(t,e,i,n)=>{const r=ot(t.x-i.x,t.y-i.y),o=ot(n.x-i.x,n.y-i.y),a=Qd(o,o);let s=Qd(r,o)/a;s=s<0?0:s,s=s>1?1:s;const l=ot(o.x*s+i.x-t.x,o.y*s+i.y-t.y);return Qd(l,l)<=e*e},dy=(t,e,i)=>{const n=i.length;for(let r=0;r<n-1;r++)if(pu(t,e,i[r],i[r+1]))return!0;return!1},Gp=(t,e,i)=>!!Up(t,i)||!!dy(t,e,i)||pu(t,e,i[0],i[i.length-1]),dp=(t,e,i,n,r)=>Gp(t,e,mr(i,n,r||ki(i)));var ab=(t,e)=>{const i=Or(t),n=ki(i),r=mr(i,e,n);return Fc(er(r))},Bl=(t,e)=>t instanceof HTMLElement&&(!e||new RegExp(`^${e}$`,"i").test(t.nodeName)),jc=t=>t instanceof File,bm=async(t,e,i)=>{const n=await xh(t,e,i);return Ac(n,"canvas")},Sh=t=>t.split("/").pop().split(/\?|\#/).shift();const sb=Pr()&&Node.prototype.replaceChildren?(t,e)=>t.replaceChildren(e):(t,e)=>{for(;t.lastChild;)t.removeChild(t.lastChild);e!==void 0&&t.append(e)},Od=Pr()&&xn("div",{class:"PinturaMeasure",style:"position:absolute;left:0;top:0;width:99999px;height:0;pointer-events:none;contain:strict;margin:0;padding:0;"});let vm;var kh=t=>(sb(Od,t),Od.parentNode||document.body.append(Od),clearTimeout(vm),vm=setTimeout(()=>{Od.remove()},500),t);let up=null;var Ea=()=>(up===null&&(up=Pr()&&/^((?!chrome|android).)*(safari|iphone|ipad)/i.test(navigator.userAgent)),up),uy=t=>new Promise((e,i)=>{let n=!1;!t.parentNode&&Ea()&&(n=!0,t.style.cssText="position:absolute;visibility:hidden;pointer-events:none;left:0;top:0;width:0;height:0;",kh(t));const r=()=>{const a=t.naturalWidth,s=t.naturalHeight;a&&s&&(n&&t.remove(),clearInterval(o),e({width:a,height:s}))};t.onerror=a=>{clearInterval(o),i(a)};const o=setInterval(r,1);r()}),py=t=>new Promise((e,i)=>{const n=()=>{e({width:t.videoWidth,height:t.videoHeight})};if(t.readyState>=1)return n();t.onloadedmetadata=n,t.onerror=()=>i(t.error)}),Cu=t=>/^image/.test(t.type),Ch=t=>new Promise(e=>{const i=_e(t)?t:URL.createObjectURL(t),n=()=>{const o=new Image;o.src=i,e(o)};if(t instanceof Blob&&Cu(t))return n();const r=document.createElement("video");r.preload="metadata",r.onloadedmetadata=()=>e(r),r.onerror=n,r.src=i}),hu=t=>t.nodeName==="VIDEO",hy=async t=>{let e,i;e=t.src?t:await Ch(t);try{i=hu(e)?await py(e):await uy(e)}finally{jc(t)&&URL.revokeObjectURL(e.src)}return i},lb=async t=>{const e=await hy(t),i=await(o=>new Promise((a,s)=>{if(o.complete)return a(o);o.onload=()=>a(o),o.onerror=()=>s(new Error("Failed to load image"))}))(t),n=xn("canvas",e);n.getContext("2d",{willReadFrequently:!0}).drawImage(i,0,0);const r=await xh(n);return Ac(r,Sh(i.src))},Pl=(t=0,e=!0)=>new(fh("ProgressEvent"))("progress",{loaded:100*t,total:100,lengthComputable:e}),wm=(t,e,i=n=>n)=>t.getAllResponseHeaders().indexOf(e)>=0?i(t.getResponseHeader(e)):void 0,cb=t=>{if(!t)return null;const e=t.split(/filename=|filename\*=.+''/).splice(1).map(i=>i.trim().replace(/^["']|[;"']{0,2}$/g,"")).filter(i=>i.length);return e.length?decodeURI(e[e.length-1]):null};const db="URL_REQUEST";class Rc extends Error{constructor(e,i,n){super(e),this.name="EditorError",this.code=i,this.metadata=n}}var my=(t,e)=>{const{headers:i={},credentials:n}=e||{};Object.entries(i).forEach(([r,o])=>t.setRequestHeader(r,o)),n&&(t.withCredentials=n!=="omit")},ub=(t,e,i)=>/^data:/.test(t)?(async(n,r="data-uri",o=me)=>{o(Pl(0));const a=await fetch(n);o(Pl(.33));const s=await a.blob();let l;Cu(s)||(l="image/"+(n.includes(",/9j/")?"jpeg":"png")),o(Pl(.66));const c=Ac(s,r,l);return o(Pl(1)),c})(t,void 0,e):((n,r,o)=>new Promise((a,s)=>{const l=()=>s(new Rc("Error fetching image",db,c)),c=new XMLHttpRequest;c.onprogress=r,c.onerror=l,c.onload=()=>{if(!c.response||c.status>=300||c.status<200)return l();const u=wm(c,"Content-Type"),p=wm(c,"Content-Disposition",cb)||Sh(n);a(Ac(c.response,p,u||bh(p)))};const{willRequest:d}=o;Promise.resolve(d&&d(n,{resourceType:"image"})).then(u=>{if(u===!1)return s("Image load rejected");c.open("GET",n),my(c,u),c.responseType="blob",c.send()}).catch(console.error)}))(t,e,i),Th=t=>t instanceof Blob&&!(t instanceof File),$y=t=>"close"in t,pb=async(t,e,i)=>{if(jc(t)||Th(t))return t;if(_e(t))return await ub(t,e,i);if(Bl(t,"canvas"))return await bm(t);if(Bl(t,"img"))return await lb(t);if(Fl(t)||$y(t))return await bm(await Nl(t));throw new Rc("Invalid image source","invalid-image-source")};let pp=null;var Tu=()=>(pp===null&&(pp=Pr()&&/^mac/i.test(navigator.platform)),pp);let hp=null;var ia=()=>(hp===null&&(hp=Pr()&&(yh(/iPhone|iPad|iPod/)||Tu()&&navigator.maxTouchPoints>=1)),hp),hb=async(t,e=1)=>await wu()||ia()||e<5?t:Un(t.height,t.width),gy=t=>/jpeg/.test(t.type),mb=t=>{return typeof(e=t)!="object"||e.constructor!=Object?t:JSON.stringify(t);var e},Mh=(t,e=0,i)=>(e===0||(t.translate(i.x,i.y),t.rotate(e),t.translate(-i.x,-i.y)),t),fy=(t,e,i)=>(t.scale(e,i),t),$b=async(t,e={})=>{const{flipX:i,flipY:n,rotation:r,crop:o}=e,a=Aa(t),s=i||n,l=!!r,c=o&&(o.x||o.y||o.width||o.height),d=c&&Qo(o,Or(a)),u=c&&!d;if(!s&&!l&&!u)return t;let p,h=xn("canvas",{width:t.width,height:t.height});if(h.getContext("2d",{willReadFrequently:!0}).putImageData(t,0,0),s){const g=xn("canvas",{width:h.width,height:h.height}).getContext("2d",{willReadFrequently:!0});fy(g,i?-1:1,n?-1:1),g.drawImage(h,i?-h.width:0,n?-h.height:0),g.restore(),qn(h),h=g.canvas}if(l){const g=is(ol(er(mr(ys(h),r))),Math.floor),m=xn("canvas",{width:o.width,height:o.height}).getContext("2d",{willReadFrequently:!0});((f,b,w)=>{f.translate(b,w)})(m,-o.x,-o.y),Mh(m,r,Dl(g)),m.drawImage(h,.5*(g.width-h.width),.5*(g.height-h.height)),m.restore(),qn(h),h=m.canvas}else if(u)return p=h.getContext("2d",{willReadFrequently:!0}).getImageData(o.x,o.y,o.width,o.height),qn(h),p;return p=h.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,h.width,h.height),qn(h),p},gb=(t,e)=>{const{imageData:i,width:n,height:r}=t,o=i.width,a=i.height,s=Math.round(n),l=Math.round(r),c=i.data,d=new Uint8ClampedArray(s*l*4),u=o/s,p=a/l,h=Math.ceil(.5*u),g=Math.ceil(.5*p);for(let m=0;m<l;m++)for(let f=0;f<s;f++){const b=4*(f+m*s);let w=0,S=0,C=0,I=0,M=0,D=0,T=0;const F=(m+.5)*p;for(let W=Math.floor(m*p);W<(m+1)*p;W++){const O=Math.abs(F-(W+.5))/g,y=(f+.5)*u,V=O*O;for(let tt=Math.floor(f*u);tt<(f+1)*u;tt++){let k=Math.abs(y-(tt+.5))/h;const N=Math.sqrt(V+k*k);if(N<-1||N>1||(w=2*N*N*N-3*N*N+1,w<=0))continue;k=4*(tt+W*o);const it=c[k+3];T+=w*it,C+=w,it<255&&(w=w*it/250),I+=w*c[k],M+=w*c[k+1],D+=w*c[k+2],S+=w}}d[b]=I/S,d[b+1]=M/S,d[b+2]=D/S,d[b+3]=T/C}e(null,{data:d,width:s,height:l})},Ph=t=>{if(t instanceof ImageData)return t;let e;try{e=new ImageData(t.width,t.height)}catch{e=xn("canvas").getContext("2d").createImageData(t.width,t.height)}return e.data.set(t.data),e},fb=async(t,e={},i)=>{const{width:n,height:r,fit:o,upscale:a}=e;if(!n&&!r)return t;let s=n,l=r;if(n?r||(l=n):s=r,o!=="force"){const c=s/t.width,d=l/t.height;let u=1;if(o==="cover"?u=Math.max(c,d):o==="contain"&&(u=Math.min(c,d)),u>1&&a===!1)return t;s=Math.round(t.width*u),l=Math.round(t.height*u)}return s=Math.max(s,1),l=Math.max(l,1),t.width===s&&t.height===l?t:i?i(t,s,l):(t=await Hc(gb,[{imageData:t,width:s,height:l}],[t.data.buffer]),Ph(t))},yb=(t,e)=>{const{imageData:i,matrix:n}=t;if(!n)return e(null,i);const r=new Uint8ClampedArray(i.width*i.height*4),o=i.data,a=o.length,s=n[0],l=n[1],c=n[2],d=n[3],u=n[4],p=n[5],h=n[6],g=n[7],m=n[8],f=n[9],b=n[10],w=n[11],S=n[12],C=n[13],I=n[14],M=n[15],D=n[16],T=n[17],F=n[18],W=n[19];let O=0,y=0,V=0,tt=0,k=0,N=0,it=0,ut=0,at=0,gt=0,G=0,$t=0;for(;O<a;O+=4)y=o[O]/255,V=o[O+1]/255,tt=o[O+2]/255,k=o[O+3]/255,N=y*s+V*l+tt*c+k*d+u,it=y*p+V*h+tt*g+k*m+f,ut=y*b+V*w+tt*S+k*C+I,at=y*M+V*D+tt*T+k*F+W,gt=Math.max(0,N*at)+(1-at),G=Math.max(0,it*at)+(1-at),$t=Math.max(0,ut*at)+(1-at),r[O]=255*Math.max(0,Math.min(1,gt)),r[O+1]=255*Math.max(0,Math.min(1,G)),r[O+2]=255*Math.max(0,Math.min(1,$t)),r[O+3]=255*k;e(null,{data:r,width:i.width,height:i.height})},yy=(t,e)=>{const{imageData:i,matrix:n}=t;if(!n)return e(null,i);let r=n.reduce((T,F)=>T+F);r=r<=0?1:r;const o=i.width,a=i.height,s=i.data;let l=0,c=0,d=0;const u=Math.round(Math.sqrt(n.length)),p=Math.floor(u/2);let h=0,g=0,m=0,f=0,b=0,w=0,S=0,C=0,I=0,M=0;const D=new Uint8ClampedArray(o*a*4);for(d=0;d<a;d++)for(c=0;c<o;c++){for(h=0,g=0,m=0,f=0,w=0;w<u;w++)for(b=0;b<u;b++)S=d+w-p,C=c+b-p,S<0&&(S=a-1),S>=a&&(S=0),C<0&&(C=o-1),C>=o&&(C=0),I=4*(S*o+C),M=n[w*u+b],h+=s[I]*M,g+=s[I+1]*M,m+=s[I+2]*M,f+=s[I+3]*M;D[l]=h/r,D[l+1]=g/r,D[l+2]=m/r,D[l+3]=f/r,l+=4}e(null,{data:D,width:o,height:a})},xb=(t,e)=>{let{imageData:i,strength:n}=t;if(!n)return e(null,i);const r=new Uint8ClampedArray(i.width*i.height*4),o=i.width,a=i.height,s=i.data,l=(V,tt)=>(c=V-M,d=tt-D,Math.sqrt(c*c+d*d));let c,d,u,p,h,g,m,f,b,w,S,C=0,I=0,M=.5*o,D=.5*a,T=l(0,0);for(n>0?(u=0,p=0,h=0):(n=Math.abs(n),u=1,p=1,h=1),I=0;I<a;I++)for(C=0;C<o;C++)F=4*(C+I*o),W=s,O=r,y=l(C,I)*n/T,g=W[F]/255,m=W[F+1]/255,f=W[F+2]/255,b=W[F+3]/255,w=1-y,S=w*b+y,O[F]=(w*b*g+y*u)/S*255,O[F+1]=(w*b*m+y*p)/S*255,O[F+2]=(w*b*f+y*h)/S*255,O[F+3]=255*S;var F,W,O,y;e(null,{data:r,width:i.width,height:i.height})},bb=(t,e)=>{const{imageData:i,level:n,monochrome:r=!1}=t;if(!n)return e(null,i);const o=new Uint8ClampedArray(i.width*i.height*4),a=i.data,s=a.length;let l,c,d,u=0;const p=()=>255*(2*Math.random()-1)*n,h=r?()=>{const g=p();return[g,g,g]}:()=>[p(),p(),p()];for(;u<s;u+=4)[l,c,d]=h(),o[u]=a[u]+l,o[u+1]=a[u+1]+c,o[u+2]=a[u+2]+d,o[u+3]=a[u+3];e(null,{data:o,width:i.width,height:i.height})},vb=(t,e)=>{const{imageData:i,level:n}=t;if(!n)return e(null,i);const r=new Uint8ClampedArray(i.width*i.height*4),o=i.data,a=o.length;let s,l,c,d=0;for(;d<a;d+=4)s=o[d]/255,l=o[d+1]/255,c=o[d+2]/255,r[d]=255*Math.pow(s,n),r[d+1]=255*Math.pow(l,n),r[d+2]=255*Math.pow(c,n),r[d+3]=o[d+3];e(null,{data:r,width:i.width,height:i.height})},wb=async(t,e={})=>{const{colorMatrix:i,convolutionMatrix:n,gamma:r,noise:o,vignette:a}=e,s=[];if(n&&s.push([yy,{matrix:n.clarity}]),r>0&&s.push([vb,{level:1/r}]),i&&!(d=>{const u=d.length;let p;const h=u>=20?6:u>=16?5:3;for(let g=0;g<u;g++)if(p=d[g],p===1&&g%h!=0||p!==0&&p!==1)return!1;return!0})(i)&&s.push([yb,{matrix:i}]),(o>0||o<0)&&s.push([bb,{level:o}]),(a>0||a<0)&&s.push([xb,{strength:a}]),!s.length)return t;const l=(d,u)=>`(err, imageData) => {
            (${d[u][0].toString()})(Object.assign({ imageData: imageData }, filterInstructions[${u}]), 
                ${d[u+1]?l(d,u+1):"done"})
        }`,c=`function (options, done) {
        const filterInstructions = options.filterInstructions;
        const imageData = options.imageData;
        (${l(s,0)})(null, imageData)
    }`;return t=await Hc(c,[{imageData:t,filterInstructions:s.map(d=>d[1])}],[t.data.buffer]),Ph(t)},hi=t=>typeof t=="number",mu=t=>_e(t)&&t.match(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g)!==null,Ae=(t,e)=>t.hasOwnProperty(e),Rn=t=>Array.isArray(t);let Sm=64,mp=102,km=112,Cm=!1;var xy=(t,e)=>(!Cm&&Pr()&&(/^win/i.test(navigator.platform)&&(mp=103),(ia()||Tu())&&(Sm=63.5,mp=110,km=123),Cm=!0),`<svg${e?` aria-label="${e}"`:""} width="128" height="128" viewBox="0 0 128 128" preserveAspectRatio="xMinYMin meet" xmlns="http://www.w3.org/2000/svg"><text x="${Sm}" y="${mp}" alignment-baseline="text-top" dominant-baseline="text-top" text-anchor="middle" font-size="${km}px">${t}</text></svg>`),Ol=t=>t instanceof Blob,Fr=(t,e)=>t/e*100+"%",$r=t=>`rgba(${Math.round(255*t[0])}, ${Math.round(255*t[1])}, ${Math.round(255*t[2])}, ${hi(t[3])?t[3]:1})`,iu=t=>Object.values(t).join("_");const by=async(t,e=0)=>{const i=xn("canvas",{width:80,height:80}).getContext("2d");return await((n=0)=>new Promise(r=>{setTimeout(r,n)}))(e),i.drawImage(t,0,0,80,80),!((n=>!new Uint32Array(n.getImageData(0,0,n.canvas.width,n.canvas.height).data.buffer).some(r=>r!==0))(i)&&e<=256)||await by(t,e+16)},Tm=new Map;var Sb=t=>new Promise((e,i)=>{const n=new FileReader;n.onerror=()=>i(n.error),n.onload=()=>e(n.result),n.readAsDataURL(t)}),ns=()=>{let t=[];return{sub:(e,i)=>(t.push({event:e,callback:i}),()=>t=t.filter(n=>n.event!==e||n.callback!==i)),pub:(e,i)=>{t.filter(n=>n.event===e).forEach(n=>n.callback(i))}}};const Ia=32,Rh=({color:t=[0,0,0],fontSize:e=16,fontFamily:i="sans-serif",fontVariant:n="normal",fontWeight:r="normal",fontStyle:o="normal",textAlign:a="left",letterSpacing:s="normal",lineHeight:l=20},c=1)=>`font-size:${e*c}px;font-style:${o};font-weight:${r};font-family:${i};font-variant:${n};line-height:${l*c}px;text-align:${a};letter-spacing:${hi(s)?s+"px":"normal"};color:${$r(t)};`,Ih=(t,e,i=1)=>{const{width:n,height:r,disableNewline:o}=e,a=!n,s=o===!1?((d="")=>d.split(`
`).length)(t):void 0,l=a?"normal":"break-word",c=a&&!s?"nowrap":"pre-line";return`max-width:none;min-width:auto;width:${a?"auto":n*i+"px"};height:${r?r*i+"px":"auto"};margin-top:0;margin-bottom:0;padding-top:${(({fontSize:d=16,lineHeight:u=20}={})=>.5*Math.max(0,d-u))(e)*i}px;word-break:${l};word-wrap:normal;white-space:${c};`},Mm=new Map,vy=t=>{const e=[];for(const i of Array.from(t.childNodes))i.nodeType===Node.TEXT_NODE?e.push(kb(i)):e.push(...vy(i));return e},wy="pointer-events:none;visibility:hidden;position:absolute;left:0;top:0;",kb=t=>{const e=t.nodeValue;if(!e)return[];const i=e.length,n=document.createRange();n.selectNodeContents(t);const r=[];for(let a=0;a<i;a++){n.setStart(t,0),n.setEnd(t,a+1);const s=n.getClientRects().length-1,l=e.charAt(a);r[s]?r[s]+=l:r.push(l)}const o=n.getClientRects();return r.map((a,s)=>({rect:o[s],text:a}))},Pm=new Map,Fo=(t="",e)=>{const{width:i=0,height:n=0}=e;if(i&&n)return Un(i,n);let{fontSize:r=16,fontFamily:o,lineHeight:a=20,fontWeight:s,fontStyle:l,fontVariant:c,letterSpacing:d}=e;const u=iu({text:t,fontFamily:o,fontWeight:s,fontStyle:l,fontVariant:c,fontSize:r,letterSpacing:d,lineHeight:a,width:i});let p=Pm.get(u);if(p)return p;let h=1;r>1e3&&ya()&&(h=r/1e3,r=1e3,a/=h);const g=kh(xn("pre",{contenteditable:"true",spellcheck:"false",style:`${wy}${Rh({...e,fontSize:r,lineHeight:a})};${Ih(t,e)}"`,innerHTML:t})).getBoundingClientRect();return p=Aa(g),p=is(p,m=>m*h),i&&(p.width=i),Pm.set(u,p),p},Rm=new Map,Cb=(t,e)=>new Promise((i,n)=>{let r=Rm.get(t);r===void 0&&(r=((o,a)=>{const{sub:s,pub:l}=ns();let c,d;return Promise.resolve(a&&a(o,{resourceType:"stylesheet"})).then(u=>{if(u===!1)return d="requestPrevented",l("error",d);const{headers:p,credentials:h}=u||{};fetch(o,{headers:p,credentials:h}).then(g=>g.text()).then(g=>{c=g,l("load",c)}).catch(g=>{d=g,l("error",d)})}),{sub:(u,p)=>u==="load"&&c?p(c):u==="error"&&d?p(d):void s(u,p)}})(t,e),Rm.set(t,r)),r.sub("load",i),r.sub("error",n)}),Im=async(t,e,i)=>{let n;try{n=await Cb(t,e)}catch{return[]}const r={innerHTML:n,id:ea()};i&&(r.nonce=i);const o=xn("style",r);document.head.append(o);const a=Array.from(document.styleSheets).find(s=>s.ownerNode.id===o.id);return o.remove(),Array.from(a.cssRules)},kl=new Map,Tb=async(t,e,i)=>{if(kl.has(t.href))return kl.get(t.href);let n;try{n=Array.from(t.cssRules);for(const r of(o=>o.filter(a=>a instanceof CSSImportRule))(n)){const o=r.href;if(kl.has(o)){const s=kl.get(o);n=[...n,...s];continue}const a=await Im(o,e,i);kl.set(o,a),n=[...n,...a]}}catch{const o=t.href;n=await Im(o,e,i),kl.set(o,n)}return(r=>r.filter(o=>o instanceof CSSFontFaceRule))(n)},Sy=(t,e)=>t.style.getPropertyValue(e),Mb=(t,e)=>t.style?Sy(t,"font-family").replace(/^"|"$/g,"")==e:!1,Pb=async(t,e,i)=>{const n=((r,o)=>{const a=[];for(const s of r)Mb(s,o)&&a.push(s);return a})(await(async(r,o)=>{const a=Array.from(document.styleSheets).map(c=>Tb(c,r,o)),s=await Promise.all(a),l=[];return s.forEach(c=>l.push(...c)),l})(e,i),t);return n.length?n.map(r=>{const o=r.parentStyleSheet.href&&new URL(r.parentStyleSheet.href),a=o?o.origin+(c=>c.pathname.split("/").slice(0,-1).join("/"))(o)+"/":"",s=r.style.getPropertyValue("src").match(/url\("?(.*?)"?\)/)[1],l=Array.from(r.style).filter(c=>c!="src").reduce((c,d)=>c+=d+":"+Sy(r,d)+";","");return[/^http/.test(s)?s:a+s,l]}):[]},Em=new Map,Am=new Map;var ky=async(t="",e)=>{if(!t.length)return;let{color:i,imageWidth:n=300,imageHeight:r=150,paddingTop:o=0,paddingRight:a=Ia,paddingBottom:s=0,paddingLeft:l=Ia,fontFamily:c,fontSize:d,pixelRatio:u=1,willRequest:p,outline:h,blur:g,styleNonce:m}=e,f=1,b="";d>1e3&&ya()&&(f=d/1e3,b=`transform-origin:0 0;transform:scale(${f})`);const w=u/f,S=(n+l+a)*u,C=(r+s+o)*u,I=await(async(y,V,tt)=>{if(Em.get(y))return;let k=Am.get(y);if(!k){const it=await Pb(y,V,tt);if(!it.length)return void Em.set(y,!0);const ut=[];for(const[at,gt]of it){const G=await fetch(at).then(lt=>lt.blob()),$t=!(N=G.type)||/woff2/.test(N)?"woff2":/woff/.test(N)?"woff":/ttf|truetype/.test(N)?"truetype":/otf|opentype/.test(N)?"opentype":/svg/.test(N)?"svg":"woff2",vt=await Sb(G);ut.push(`@font-face { src:url(${vt}) format('${$t}');${gt};font-display:block; }`)}k=ut.join(""),Am.set(y,k)}var N;return k})(c,p,m);let M="";I&&(M=`<style${m?` nonce="${m}"`:""}>${I}</style>`);const D=t.replace(/%/g,"%25").replace(/#/g,"%23").replace(/&nbsp;/g,"Â ").replace(/&(?!#\d{4};|[a-z]+;)/gi,"&amp;").replace(/<br>|\n/g,"<br/>"),T=`top:${o*w}px;right:${a*w}px;bottom:${s*w}px;left:${l*w}px`;let F=i,W="",O="";if(h||g){const y=$r(i);h&&(F=[0,0,0,0],W=`-webkit-text-stroke: ${2*h*w}px ${y}`),g&&(Ea()?O=`filter:blur(${g*w*.4}px)`:(F=[0,0,0,0],O=`text-shadow: 0 0 ${g*w}px ${y}`))}return((y,{safariCacheKey:V="*"}={})=>new Promise((tt,k)=>{const N=new Image;N.onerror=()=>k(new Error("Failed to load SVG")),N.onload=()=>{if(!Ea()||!y.includes("@font-face")||Tm.has(V))return tt(N);by(N).then(()=>{Tm.set(V,!0),tt(N)})},N.src="data:image/svg+xml,"+y}))(`<svg xmlns="http://www.w3.org/2000/svg" width="${S}" height="${C}" viewBox="0 0 ${S} ${C}"><foreignObject x="0" y="0" width="${S}" height="${C}"><div xmlns="http://www.w3.org/1999/xhtml">${M}<pre contenteditable="true" spellcheck="false" style="position:absolute;${T};${Rh({...e,color:F,fontSize:d},w)};${Ih(t,e,w)};${b};${W};${O}">${D}</pre></div></foreignObject></svg>`,{safariCacheKey:c})};const jn=t=>{const e={...t};return Yf(e)},Lm=(t,e={})=>{const i=ir(t);let n,r;const o=e.width||e.rx,a=e.height||e.ry;if(o&&a)return no(e);if(o||a){n=parseFloat(o||Number.MAX_SAFE_INTEGER),r=parseFloat(a||Number.MAX_SAFE_INTEGER);const s=Math.min(n,r);_e(o)||_e(a)?(n=s+"%",r=s*i+"%"):(n=s,r=s)}else n="10%",r=10*i+"%";return{[(e.width?"width":e.rx?"rx":void 0)||"width"]:n,[(e.width?"height":e.rx?"ry":void 0)||"height"]:r}},zm=(t,e={})=>{return{width:void 0,height:void 0,...e,aspectRatio:1,backgroundImage:(i=xy(t),"data:image/svg+xml,"+i.replace("<","%3C").replace(">","%3E"))};var i},Fm=(t,e={})=>({backgroundColor:[0,0,0,0],...Yn(e)?{}:{width:void 0,height:void 0,aspectRatio:void 0},...e,backgroundImage:_e(t)?t:Ol(t)?URL.createObjectURL(t):t}),Dm=(t,e)=>{let i;if(_e(t)||Ol(t)){const n={...Lm(e),backgroundSize:"contain"};i=mu(t)?zm(t,n):Fm(t,n)}else if(t.src){const n=Lm(e,t.shape||t),r={...t.shape,...n};if(t.width&&t.height&&!Ae(r,"aspectRatio")){const o=Jp(n,"width",e),a=Jp(n,"height",e);r.aspectRatio=qo(o,a)}r.backgroundSize||t.shape||t.width&&t.height||(r.backgroundSize="contain"),i=mu(t.src)?zm(t.src,r):Fm(t.src,r)}else t.shape&&(i=jn(t.shape));return Ae(i,"backgroundImage")&&(Ae(i,"backgroundColor")||(i.backgroundColor=[0,0,0,0]),Ae(i,"disableStyle")||(i.disableStyle=["cornerRadius","backgroundColor","strokeColor","strokeWidth"])),e?Zn(i,e):i},Qa=t=>ot(t.x1,t.y1),ts=t=>ot(t.x2,t.y2),Xn=t=>Ae(t,"text"),$u=t=>Xn(t)&&!(Mu(t)||Ae(t,"width")),nu=t=>Xn(t)&&(Mu(t)||Ae(t,"width")),xo=t=>!Xn(t)&&Rb(t),Yn=t=>Ae(t,"rx"),tr=t=>Ae(t,"x1"),_n=t=>Ae(t,"points"),Ja=t=>Xn(t)&&t.isEditing,Wd=t=>!Ae(t,"opacity")||t.opacity>0,xs=t=>t.isSelected,$p=t=>t.isEditing,fo=t=>t._isDraft,el=t=>Ae(t,"width")&&Ae(t,"height"),Cy=t=>{const e=Ae(t,"right"),i=Ae(t,"bottom");return e||i},Mu=t=>(Ae(t,"x")||Ae(t,"left"))&&Ae(t,"right")||(Ae(t,"y")||Ae(t,"top"))&&Ae(t,"bottom"),Rb=t=>el(t)||Mu(t),Zp=t=>(t._isDraft=!0,t),Bm=t=>(t._isDraft=!1,t),Xp=(t,e)=>t.disableStyle!==!0&&(!Rn(t.disableStyle)||!e||!t.disableStyle.includes(e)),ha=t=>t.disableSelect!==!0,Om=t=>t.disableRemove!==!0,Ib=t=>!t.disableFlip&&!fo(t)&&!Cy(t)&&(e=>Ae(e,"backgroundImage")||Ae(e,"text"))(t),Cl=(t,e)=>!!Xn(t)&&t.disableInput!==!0&&(on(t.disableInput)?t.disableInput(e??t.text):e||!0),qs=(t,e)=>t.disableTextLayout!==!0&&(!Rn(t.disableTextLayout)||!e||!t.disableTextLayout.includes(e)),gp=t=>Ty(t)&&t.points.length>3,Ty=t=>!!_n(t)&&t.disableAddPoints!==void 0&&t.disableAddPoints!==!0,Yp=t=>t.disableManipulate!==!0&&!fo(t)&&!Cy(t),wc=t=>Yp(t)&&t.disableMove!==!0,qp=t=>(delete t.left,delete t.right,delete t.top,delete t.bottom,t),Wm=t=>(delete t.rotation,t),_m=t=>(t.strokeWidth=t.strokeWidth||1,t.strokeColor=t.strokeColor||[0,0,0],t),Vm=t=>(t.backgroundColor=t.backgroundColor?t.backgroundColor:t.strokeWidth||t.backgroundImage?void 0:[0,0,0],t),Nm=t=>{let e=t.text;e=e.replace(/&(#[0-9]+|[a-z]+);/gi,(i,n)=>`___${n}___`),e=e.replace(/&/,"&amp;"),t.text=e.replace(/___(#[0-9]+|[a-z]+)___/gi,(i,n)=>`&${n};`)},Eb=t=>{if(t.fontSize=t.fontSize||"4%",t.fontFamily=t.fontFamily||"sans-serif",t.fontWeight=t.fontWeight||"normal",t.fontStyle=t.fontStyle||"normal",t.fontVariant=t.fontVariant||"normal",t.lineHeight=t.lineHeight||"120%",t.color=t.color||[0,0,0],t.format=t.format==="html"?"html":"text",t.textShadow){const[e,i,n,r]=t.textShadow;t.textShadowX=e,t.textShadowY=i,t.textShadowBlur=n,t.textShadowColor=r,delete t.textShadow}if(t.textOutline){const[e,i]=t.textOutline;t.textOutlineWidth=e,t.textOutlineColor=i,delete t.textOutline}return t.format==="html"?Nm(t):(e=>{Nm(e);let i=e.text;i=i.replace(/</g,"&gt;"),i=i.replace(/>/g,"&lt;"),e.text=i})(t),$u(t)?Ab(t):Lb(t)},Ab=t=>(t.disableNewline!==!1&&(delete t.textAlign,t.text=t.text.replace(/\n/g," ")),qp(t)),Lb=t=>(t.textAlign=t.textAlign||"left",t),My=t=>((e=>{_e(e.id)||(e.id=ea()),Ae(e,"rotation")||(e.rotation=0),Ae(e,"opacity")||(e.opacity=1),Ae(e,"disableErase")||(e.disableErase=!0)})(t),Xn(t)?Eb(t):xo(t)?(e=>{e.cornerRadius=e.cornerRadius||0,e.strokeWidth=e.strokeWidth||0,e.strokeColor=e.strokeColor||[0,0,0],Vm(e)})(t):_n(t)?(e=>{_m(e),Wm(e),Ae(e,"pathClose")||(e.disableResize=!0,Ae(e,"disableMove")||(e.disableMove=!0)),qp(e)})(t):tr(t)?(e=>{_m(e),e.lineStart=e.lineStart||void 0,e.lineEnd=e.lineEnd||void 0,Wm(e),qp(e)})(t):Yn(t)&&(e=>{e.strokeWidth=e.strokeWidth||0,e.strokeColor=e.strokeColor||[0,0,0],Vm(e)})(t),t),zb=t=>Xn(t)?"text":xo(t)?"rectangle":_n(t)?"path":tr(t)?"line":Yn(t)?"ellipse":void 0,gu=(t,e)=>parseFloat(t)/100*e,Fb=new RegExp(/^x|left|right|^width|rx|fontSize|eraseRadius|feather|cornerRadius|strokeWidth|strokeDash/,"i"),Db=new RegExp(/^y|top|bottom|^height|ry/,"i"),Eh=(t,e,{width:i,height:n})=>{if(Array.isArray(e))return e.map(o=>(sl(o)&&Py(o,{width:i,height:n}),_e(o)&&(o=Eh(t,o,{width:i,height:n})),o));if(typeof e!="string"||!e.endsWith("%"))return e;const r=parseFloat(e)/100;return Fb.test(t)?si(i*r,6):Db.test(t)?si(n*r,6):e},Bb=Eh,Ob=["lineHeight","textOutlineWidth","textShadowX","textShadowY","textShadowBlur"],Py=(t,e)=>{Object.entries(t).map(([i,n])=>{t[i]=Eh(i,n,e)}),t.text&&Ob.filter(i=>_e(t[i])).forEach(i=>{var n,r;t[i]=(n=t[i],r=t.fontSize,Math.round(r*(parseFloat(n)/100)))})},Zn=(t,e)=>(Py(t,e),Ey(t,e),t),Kp=(t,e)=>{let i;return/^x|width|rx|fontSize|strokeWidth|cornerRadius/.test(t)?i=e.width:/^y|height|ry/.test(t)&&(i=e.height),i},Jp=(t,e,i)=>Array.isArray(t[e])?t[e].map(n=>Object.entries(n).reduce((r,[o,a])=>(r[o]=_e(a)?gu(a,Kp(o,i)):a,r),{})):_e(t[e])?gu(t[e],Kp(e,i)):t[e],Ll=(t,e,i)=>e.reduce((n,r)=>{const o=Jp(t,r,i);return n[r]=o,n},{}),ga=(t,e,i)=>(Object.keys(e).forEach(n=>((r,o,a,s)=>{if(!_e(r[o]))return r[o]=a,r;const l=Kp(o,s);return r[o]=l===void 0?a:Fr(a,l),r})(t,n,e[n],i)),t),Ry=(t,e)=>{const i=t.filter(n=>n.x<0||n.y<0||n.x1<0||n.y1<0).reduce((n,r)=>{const[o,a,s,l]=(c=>{const d=Ss(),u=c.strokeWidth||0;if(xo(c))d.x=c.x-.5*u,d.y=c.y-.5*u,d.width=c.width+u,d.height=c.height+u;else if(tr(c)){const{x1:p,y1:h,x2:g,y2:m}=c,f=Math.abs(Math.min(p,g)),b=Math.abs(Math.max(p,g)),w=Math.abs(Math.min(h,m)),S=Math.abs(Math.min(h,m));d.x=f+.5*u,d.y=b+.5*u,d.width=b-f+u,d.height=S-w+u}else Yn(c)&&(d.x=c.x-c.rx+.5*u,d.y=c.y-c.ry+.5*u,d.width=2*c.rx+u,d.height=2*c.ry+u);return d&&Ae(c,"rotation")&&mr(d,c.rotation),al(d)})(r);return n.top=Math.min(o,n.top),n.left=Math.min(l,n.left),n.bottom=Math.max(s,n.bottom),n.right=Math.max(a,n.right),n},{top:0,right:0,bottom:0,left:0});return i.right>0&&(i.right-=e.width),i.bottom>0&&(i.bottom-=e.height),i},Iy=(t,e,i)=>{const n=jn(t);Zn(n,e);const r=i(n);return Array.isArray(r)?r:[r]},Ey=(t,e)=>{if(Ae(t,"left")&&(t.x=t.left),Ae(t,"right")&&!_e(t.right)){const i=e.width-t.right;Ae(t,"left")?(t.x=t.left,t.width=Math.max(0,i-t.left)):Ae(t,"width")&&(t.x=i-t.width)}if(Ae(t,"top")&&(t.y=t.top),Ae(t,"bottom")&&!_e(t.bottom)){const i=e.height-t.bottom;Ae(t,"top")?(t.y=t.top,t.height=Math.max(0,i-t.top)):Ae(t,"height")&&(t.y=i-t.height)}return t},Ay=(t,e)=>(_n(t)&&t.points.filter(i=>hi(i.x)).forEach(i=>{i.x*=e,i.y*=e}),tr(t)&&hi(t.x1)&&(t.x1*=e,t.y1*=e,t.x2*=e,t.y2*=e),hi(t.x)&&hi(t.y)&&(t.x*=e,t.y*=e),hi(t.width)&&hi(t.height)&&(t.width*=e,t.height*=e),hi(t.rx)&&hi(t.ry)&&(t.rx*=e,t.ry*=e),(i=>hi(i.strokeWidth)&&i.strokeWidth>0)(t)&&(t.strokeWidth*=e),Xn(t)&&(t._scale=e,hi(t.fontSize)&&(t.fontSize*=e),hi(t.lineHeight)&&(t.lineHeight*=e),hi(t.width)&&!hi(t.height)&&(t.width*=e)),Ae(t,"cornerRadius")&&hi(t.cornerRadius)&&(t.cornerRadius*=e),t),Ly=t=>{if(xo(t))return ot(t.x+.5*t.width,t.y+.5*t.height);if(Yn(t))return ot(t.x,t.y);if(t.text){if(nu(t)){const i=t.height||Fo(t.text,t).height;return ot(t.x+.5*t.width,t.y+.5*i)}const e=Fo(t.text,t);return ot(t.x+.5*e.width,t.y+.5*e.height)}return _n(t)?Do(t.points):tr(t)?Do([Qa(t),ts(t)]):void 0};var Uc=t=>/canvas/i.test(t.nodeName),Wb=(t,e)=>new Promise((i,n)=>{let r=t,o=!1;const a=()=>{o||(o=!0,on(e)&&Promise.resolve().then(()=>e(Un(r.naturalWidth,r.naturalHeight))))};if(r.src||(r=new Image,_e(t)&&new URL(t,location.href).origin!==location.origin&&(r.crossOrigin="anonymous"),r.src=_e(t)?t:URL.createObjectURL(t)),r.complete)return a(),i(r);on(e)&&uy(r).then(a).catch(n),r.onload=()=>{a(),i(r)},r.onerror=()=>n(new Error("Failed to load image"))});const Hm=new Map([]),Ah=(t,e={})=>new Promise((i,n)=>{const{onMetadata:r=me,onLoad:o=i,onError:a=n,onComplete:s=me}=e;let l=Hm.get(t);if(l||(l={loading:!1,complete:!1,error:!1,image:void 0,size:void 0,bus:ns()},Hm.set(t,l)),l.bus.sub("meta",r),l.bus.sub("load",o),l.bus.sub("error",a),l.bus.sub("complete",s),Uc(t)){const c=t,d=c.cloneNode();l.complete=!0,l.image=d,l.size=Pc(c)}if(l.complete)return l.bus.pub("meta",{size:l.size}),l.error?l.bus.pub("error",l.error):l.bus.pub("load",l.image),l.bus.pub("complete"),void(l.bus=ns());l.loading||(l.loading=!0,Wb(t,c=>{l.size=c,l.bus.pub("meta",{size:c})}).then(c=>{l.image=c,l.bus.pub("load",c)}).catch(c=>{l.error=c,l.bus.pub("error",c)}).finally(()=>{l.complete=!0,l.loading=!1,l.bus.pub("complete"),l.bus=ns()}))}),_b=(t,e,i,n)=>t.drawImage(e,i.x,i.x,i.width,i.height,n.x,n.y,n.width,n.height);var zy=async(t,e,i,n,r=_b,o)=>{t.save(),t.clip(),await r(t,e,i,n,o),t.restore()};const fu=(t,e,i,n,r)=>{const o=Si(t);if(n){const s=Bo(er(n),si);return s.x*=i.width,s.width*=i.width,s.y*=i.height,s.height*=i.height,{srcRect:s,destRect:o}}const a=Pn(0,0,i.width,i.height);if(e==="contain"){const s=Yr(t,ir(a));o.width=s.width,o.height=s.height,r?(o.x+=r.x,o.y+=r.y):(o.x+=s.x,o.y+=s.y)}else if(e==="cover"){const s=rs(o,a.width/a.height);o.width=s.width,o.height=s.height,r?(o.x+=r.x,o.y+=r.y):(o.x+=s.x,o.y+=s.y)}else e?(o.width=e.width,o.height=e.height,r&&(o.x+=r.x,o.y+=r.y)):r&&(o.width=i.width,o.height=i.height,o.x+=r.x,o.y+=r.y);return{srcRect:a,destRect:o}},fp=(t,e)=>(e.cornerRadius>0?((i,n,r,o,a,s)=>{o<2*s&&(s=o/2),a<2*s&&(s=a/2),i.beginPath(),i.moveTo(n+s,r),i.arcTo(n+o,r,n+o,r+a,s),i.arcTo(n+o,r+a,n,r+a,s),i.arcTo(n,r+a,n,r,s),i.arcTo(n,r,n+o,r,s),i.closePath()})(t,e.x,e.y,e.width,e.height,e.cornerRadius):t.rect(e.x,e.y,e.width,e.height),t),jm=(t,e)=>(e.backgroundColor&&t.fill(),t),Um=(t,e)=>(e.strokeWidth&&t.stroke(),t);var Lh=async(t,e,i={})=>{const{drawImage:n}=i;if(t.lineWidth=e.strokeWidth?e.strokeWidth:1,t.strokeStyle=e.strokeColor?$r(e.strokeColor):"none",t.fillStyle=e.backgroundColor?$r(e.backgroundColor):"none",t.globalAlpha=e.opacity,e.backgroundImage){let r;if(r=Uc(e.backgroundImage)?e.backgroundImage:await Ah(e.backgroundImage),fp(t,e),jm(t,e),e.backgroundRepeat==="repeat"){const o=e.backgroundPosition||{x:0,y:0},{srcRect:a,destRect:s}=fu(e,e.backgroundSize||Pc(r),Pc(r),e.backgroundCorners,{x:0,y:0}),l=document.createElement("canvas");l.width=s.width,l.height=s.height;const c=l.getContext("2d",{willReadFrequently:!1,desynchronized:!0});await n(c,r,a,{...s,x:0,y:0});const d=t.createPattern(l,"repeat");t.fillStyle=d,t.save(),t.beginPath(),t.rect(e.x+o.x,e.y+o.y,e.width-o.x,e.height-o.y),t.clip(),t.translate(s.x+o.x,s.y+o.y),t.fill(),qn(l),t.restore()}else{const{srcRect:o,destRect:a}=fu(e,e.backgroundSize,Pc(r),e.backgroundCorners,e.backgroundPosition);await zy(t,r,o,a,n,{feather:e.feather})}return t.beginPath(),fp(t,e),Um(t,e),[]}return fp(t,e),jm(t,e),Um(t,e),[]},zh=async(t,e,i={})=>new Promise(async(n,r)=>{const{drawImage:o}=i;if(t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?$r(e.strokeColor):"none",t.fillStyle=e.backgroundColor?$r(e.backgroundColor):"none",t.globalAlpha=e.opacity,t.ellipse(e.x,e.y,e.rx,e.ry,0,0,2*Math.PI),e.backgroundColor&&t.fill(),e.backgroundImage){let a;try{a=await Ah(e.backgroundImage)}catch(d){r(d)}const s=Pn(e.x-e.rx,e.y-e.ry,2*e.rx,2*e.ry),{srcRect:l,destRect:c}=fu(s,e.backgroundSize,Pc(a),e.backgroundCorners,e.backgroundPosition);await zy(t,a,l,c,o),e.strokeWidth&&t.stroke(),n([])}else e.strokeWidth&&t.stroke(),n([])}),Vb=async(t,e,i)=>{const n=e.width&&e.height?Aa(e):Fo(e.text,e),r={x:e.x,y:e.y,width:n.width,height:n.height};if(Lh(t,{...e,...r,options:i}),!e.text.length)return[];const{textOutlineWidth:o=0,textShadowX:a=0,textShadowY:s=0,textShadowBlur:l=0,textShadowColor:c,outline:d,blur:u,...p}=e,h=!!e.height;if(h&&(t.rect(r.x-o+Math.min(a,0),r.y-o+Math.min(s,0),r.width+o+o+Math.abs(a)+l,r.height+o+Math.abs(s)+l),t.save(),t.clip()),a||s||l){t.save(),t.translate(a,s);const g={...r};h||(g.height+=Ia+l),await yp(t,g,e,{...i,paddingLeft:Ia+l,paddingRight:Ia+l,paddingTop:l,paddingBottom:l+h?-1*s:e.fontSize,shapeExtendedProps:{color:c,blur:l}}),t.restore()}if(o){const g={...r};h||(g.height+=Ia+o),await yp(t,g,e,{...i,paddingLeft:Ia+o,paddingRight:Ia+o,paddingTop:o,paddingBottom:o+h?0:e.fontSize,shapeExtendedProps:{color:e.textOutlineColor,outline:o}})}return h&&t.restore(),await yp(t,r,p,{...i,paddingLeft:Ia,paddingRight:Ia,paddingTop:0,paddingBottom:h?0:e.fontSize}),[]};const yp=async(t,e,i,n)=>{const{willRequest:r,shapeExtendedProps:o,paddingLeft:a,paddingRight:s,paddingTop:l,paddingBottom:c,styleNonce:d}=n,u=await ky(i.text,{...i,...o,...e,paddingLeft:a,paddingRight:s,paddingTop:l,paddingBottom:c,imageWidth:e.width,imageHeight:e.height,willRequest:r,styleNonce:d});t.drawImage(u,i.x-a,i.y-l,u.width,u.height)};var Nb=async(t,e)=>new Promise(async i=>{t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?$r(e.strokeColor):"none",t.globalAlpha=e.opacity;let n=Qa(e),r=ts(e);t.moveTo(n.x,n.y),t.lineTo(r.x,r.y),e.strokeWidth&&t.stroke(),i([])}),Qp=async(t,e)=>new Promise((i,n)=>{if(e.bitmap&&e.points.length===1)return void zh(t,{x:e.points[0].x,y:e.points[0].y,rx:.5*e.strokeWidth,ry:.5*e.strokeWidth,backgroundColor:e.strokeColor}).then(()=>i([]));t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?$r(e.strokeColor):"none",t.fillStyle=e.backgroundColor?$r(e.backgroundColor):"none",t.globalAlpha=e.opacity;const{points:r}=e;t.lineCap=e.strokeCap,t.lineJoin=e.strokeJoin,t.setLineDash(e.strokeDash||[]),e.pathClose&&t.beginPath(),t.moveTo(r[0].x,r[0].y);const o=r.length;for(let a=1;a<o;a++)t.lineTo(r[a].x,r[a].y);e.pathClose&&t.closePath(),e.strokeWidth&&t.stroke(),e.backgroundColor&&t.fill(),i([])}),Fy=(t,e,i,n)=>((e||i)&&(t.translate(n.x,n.y),t.scale(e?-1:1,i?-1:1),t.translate(-n.x,-n.y)),t);const Hb=async(t,e,i)=>{t.globalCompositeOperation=e.drawMode==="subtract"?"destination-out":"source-over";const n=Ly(e);let r;if(Mh(t,e.rotation,n),Fy(t,e.flipX,e.flipY,n),xo(e)?r=Lh:Yn(e)?r=zh:tr(e)?r=Nb:_n(e)?r=Qp:Xn(e)&&(r=Vb),r){const o=await r(t,e,i);return o.length?[e,...await Dy(t,o,i)]:[]}return[]};var Dy=async(t,e,i)=>{let n=[];for(const r of e)t.save(),t.beginPath(),n=[...n,...await Hb(t,r,i)],t.restore();return n},Fh=async(t,e={})=>{const{shapes:i=[],contextBounds:n=t,transform:r=me,drawImage:o,willRequest:a,styleNonce:s,canvasMemoryLimit:l,computeShape:c=Ki,preprocessShape:d=Ki}=e;if(!i.length)return t;const u=xn("canvas");u.width=n.width,u.height=n.height;const p=u.getContext("2d",{willReadFrequently:!0});p.putImageData(t,n.x||0,n.y||0);const h=i.map(jn).map(c).map(d).flat();r(p),await Dy(p,h,{drawImage:o,canvasMemoryLimit:l,willRequest:a,styleNonce:s});const g=p.getImageData(0,0,u.width,u.height);return qn(u),g},jb=async(t,e={})=>{const{backgroundColor:i,backgroundImage:n}=e,r=!(!i||i&&i[3]===0);if(!n&&!r)return t;const o=xn("canvas");o.width=t.width,o.height=t.height;const a=o.getContext("2d",{willReadFrequently:!0});if(a.putImageData(t,0,0),a.globalCompositeOperation="destination-over",r&&(a.fillStyle=$r(i),a.fillRect(0,0,o.width,o.height)),n){let l;l=Uc(n)?n:await Ah(n);const{srcRect:c,destRect:d}=fu({x:0,y:0,width:t.width,height:t.height},"cover",{width:l.width,height:l.height});a.drawImage(l,c.x,c.y,c.width,c.height,d.x,d.y,d.width,d.height)}const s=a.getImageData(0,0,o.width,o.height);return qn(o),s},Dh=t=>t.length?t.reduce((e,i)=>((n,r)=>{const o=new Array(20);return o[0]=n[0]*r[0]+n[1]*r[5]+n[2]*r[10]+n[3]*r[15],o[1]=n[0]*r[1]+n[1]*r[6]+n[2]*r[11]+n[3]*r[16],o[2]=n[0]*r[2]+n[1]*r[7]+n[2]*r[12]+n[3]*r[17],o[3]=n[0]*r[3]+n[1]*r[8]+n[2]*r[13]+n[3]*r[18],o[4]=n[0]*r[4]+n[1]*r[9]+n[2]*r[14]+n[3]*r[19]+n[4],o[5]=n[5]*r[0]+n[6]*r[5]+n[7]*r[10]+n[8]*r[15],o[6]=n[5]*r[1]+n[6]*r[6]+n[7]*r[11]+n[8]*r[16],o[7]=n[5]*r[2]+n[6]*r[7]+n[7]*r[12]+n[8]*r[17],o[8]=n[5]*r[3]+n[6]*r[8]+n[7]*r[13]+n[8]*r[18],o[9]=n[5]*r[4]+n[6]*r[9]+n[7]*r[14]+n[8]*r[19]+n[9],o[10]=n[10]*r[0]+n[11]*r[5]+n[12]*r[10]+n[13]*r[15],o[11]=n[10]*r[1]+n[11]*r[6]+n[12]*r[11]+n[13]*r[16],o[12]=n[10]*r[2]+n[11]*r[7]+n[12]*r[12]+n[13]*r[17],o[13]=n[10]*r[3]+n[11]*r[8]+n[12]*r[13]+n[13]*r[18],o[14]=n[10]*r[4]+n[11]*r[9]+n[12]*r[14]+n[13]*r[19]+n[14],o[15]=n[15]*r[0]+n[16]*r[5]+n[17]*r[10]+n[18]*r[15],o[16]=n[15]*r[1]+n[16]*r[6]+n[17]*r[11]+n[18]*r[16],o[17]=n[15]*r[2]+n[16]*r[7]+n[17]*r[12]+n[18]*r[17],o[18]=n[15]*r[3]+n[16]*r[8]+n[17]*r[13]+n[18]*r[18],o[19]=n[15]*r[4]+n[16]*r[9]+n[17]*r[14]+n[18]*r[19]+n[19],o})([...e],i),t.shift()):[],By=(t,e)=>{const i=t.width*t.height,n=e.reduce((o,a)=>(a.width>o.width&&a.height>o.height&&(o.width=a.width,o.height=a.height),o),{width:0,height:0}),r=n.width*n.height;return((o,a=2)=>Math.round(o*a)/a)(Math.max(.5,.5+(1-r/i)/2),5)};function ni(){}const Oy=t=>t;function Cn(t,e){for(const i in e)t[i]=e[i];return t}function Wy(t){return t()}function Gm(){return Object.create(null)}function Ui(t){t.forEach(Wy)}function Zi(t){return typeof t=="function"}function oi(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Br(t,...e){if(t==null)return ni;const i=t.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function fa(t){let e;return Br(t,i=>e=i)(),e}function A(t,e,i){t.$$.on_destroy.push(Br(e,i))}function rr(t,e,i,n){if(t){const r=_y(t,e,i,n);return t[0](r)}}function _y(t,e,i,n){return t[1]&&n?Cn(i.ctx.slice(),t[1](n(e))):i.ctx}function or(t,e,i,n){if(t[2]&&n){const r=t[2](n(i));if(e.dirty===void 0)return r;if(typeof r=="object"){const o=[],a=Math.max(e.dirty.length,r.length);for(let s=0;s<a;s+=1)o[s]=e.dirty[s]|r[s];return o}return e.dirty|r}return e.dirty}function ar(t,e,i,n,r,o){if(r){const a=_y(e,i,n,o);t.p(a,r)}}function sr(t){if(t.ctx.length>32){const e=[],i=t.ctx.length/32;for(let n=0;n<i;n++)e[n]=-1;return e}return-1}function Dc(t){const e={};for(const i in t)i[0]!=="$"&&(e[i]=t[i]);return e}function Zm(t,e){const i={};e=new Set(e);for(const n in t)e.has(n)||n[0]==="$"||(i[n]=t[n]);return i}function wt(t,e,i){return t.set(i),e}function Xi(t){return t&&Zi(t.destroy)?t.destroy:ni}const Vy=typeof window<"u";let Ny=Vy?()=>window.performance.now():()=>Date.now(),Bh=Vy?t=>requestAnimationFrame(t):ni;const zl=new Set;function Hy(t){zl.forEach(e=>{e.c(t)||(zl.delete(e),e.f())}),zl.size!==0&&Bh(Hy)}function Oh(t){let e;return zl.size===0&&Bh(Hy),{promise:new Promise(i=>{zl.add(e={c:t,f:i})}),abort(){zl.delete(e)}}}function Ct(t,e){t.appendChild(e)}function jy(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Ub(t){const e=ht("style");return function(i,n){Ct(i.head||i,n),n.sheet}(jy(t),e),e.sheet}function et(t,e,i){t.insertBefore(e,i||null)}function Q(t){t.parentNode.removeChild(t)}function ht(t){return document.createElement(t)}function gr(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function mn(t){return document.createTextNode(t)}function pe(){return mn(" ")}function Tn(){return mn("")}function Mt(t,e,i,n){return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i,n)}function Gb(t){return function(e){return e.preventDefault(),t.call(this,e)}}function Zb(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function v(t,e,i){i==null?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function Xm(t,e){const i=Object.getOwnPropertyDescriptors(t.__proto__);for(const n in e)e[n]==null?t.removeAttribute(n):n==="style"?t.style.cssText=e[n]:n==="__value"?t.value=t[n]=e[n]:i[n]&&i[n].set?t[n]=e[n]:v(t,n,e[n])}function Ym(t,e){Object.keys(e).forEach(i=>{(function(n,r,o){r in n?n[r]=typeof n[r]=="boolean"&&o===""||o:v(n,r,o)})(t,i,e[i])})}function In(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function qm(t,e){t.value=e??""}function Uy(t,e,{bubbles:i=!1,cancelable:n=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,i,n,e),r}class Pu{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,i,n=null){this.e||(this.is_svg?this.e=gr(i.nodeName):this.e=ht(i.nodeName),this.t=i,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let i=0;i<this.n.length;i+=1)et(this.t,this.n[i],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(Q)}}function yu(t,e){return new t(e)}const xu=new Map;let Bc,ru=0;function Km(t,e,i,n,r,o,a,s=0){const l=16.666/n;let c=`{
`;for(let f=0;f<=1;f+=l){const b=e+(i-e)*o(f);c+=100*f+`%{${a(b,1-b)}}
`}const d=c+`100% {${a(i,1-i)}}
}`,u=`__svelte_${function(f){let b=5381,w=f.length;for(;w--;)b=(b<<5)-b^f.charCodeAt(w);return b>>>0}(d)}_${s}`,p=jy(t),{stylesheet:h,rules:g}=xu.get(p)||function(f,b){const w={stylesheet:Ub(b),rules:{}};return xu.set(f,w),w}(p,t);g[u]||(g[u]=!0,h.insertRule(`@keyframes ${u} ${d}`,h.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?m+", ":""}${u} ${n}ms linear ${r}ms 1 both`,ru+=1,u}function Xb(t,e){const i=(t.style.animation||"").split(", "),n=i.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),r=i.length-n.length;r&&(t.style.animation=n.join(", "),ru-=r,ru||Bh(()=>{ru||(xu.forEach(o=>{const{ownerNode:a}=o.stylesheet;a&&Q(a)}),xu.clear())}))}function Ic(t){Bc=t}function ll(){if(!Bc)throw new Error("Function called outside component initialization");return Bc}function As(t){ll().$$.on_mount.push(t)}function Yb(t){ll().$$.after_update.push(t)}function _o(t){ll().$$.on_destroy.push(t)}function ba(){const t=ll();return(e,i,{cancelable:n=!1}={})=>{const r=t.$$.callbacks[e];if(r){const o=Uy(e,i,{cancelable:n});return r.slice().forEach(a=>{a.call(t,o)}),!o.defaultPrevented}return!0}}function po(t,e){return ll().$$.context.set(t,e),e}function sn(t){return ll().$$.context.get(t)}function Wr(t,e){const i=t.$$.callbacks[e.type];i&&i.slice().forEach(n=>n.call(this,e))}const Sc=[],zi=[],ou=[],th=[],Gy=Promise.resolve();let eh=!1;function Zy(){eh||(eh=!0,Gy.then(E))}function Xy(){return Zy(),Gy}function Wl(t){ou.push(t)}function vo(t){th.push(t)}const xp=new Set;let mc,_d=0;function E(){const t=Bc;do{for(;_d<Sc.length;){const e=Sc[_d];_d++,Ic(e),qb(e.$$)}for(Ic(null),Sc.length=0,_d=0;zi.length;)zi.pop()();for(let e=0;e<ou.length;e+=1){const i=ou[e];xp.has(i)||(xp.add(i),i())}ou.length=0}while(Sc.length);for(;th.length;)th.pop()();eh=!1,xp.clear(),Ic(t)}function qb(t){if(t.fragment!==null){t.update(),Ui(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Wl)}}function bp(t,e,i){t.dispatchEvent(Uy(`${e?"intro":"outro"}${i}`))}const au=new Set;let es;function Ie(){es={r:0,c:[],p:es}}function Ee(){es.r||Ui(es.c),es=es.p}function P(t,e){t&&t.i&&(au.delete(t),t.i(e))}function z(t,e,i,n){if(t&&t.o){if(au.has(t))return;au.add(t),es.c.push(()=>{au.delete(t),n&&(i&&t.d(1),n())}),t.o(e)}else n&&n()}const Kb={duration:0};function Jm(t,e,i,n){let r=e(t,i),o=n?0:1,a=null,s=null,l=null;function c(){l&&Xb(t,l)}function d(p,h){const g=p.b-o;return h*=Math.abs(g),{a:o,b:p.b,d:g,duration:h,start:p.start,end:p.start+h,group:p.group}}function u(p){const{delay:h=0,duration:g=300,easing:m=Oy,tick:f=ni,css:b}=r||Kb,w={start:Ny()+h,b:p};p||(w.group=es,es.r+=1),a||s?s=w:(b&&(c(),l=Km(t,o,p,g,h,m,b)),p&&f(0,1),a=d(w,g),Wl(()=>bp(t,p,"start")),Oh(S=>{if(s&&S>s.start&&(a=d(s,g),s=null,bp(t,a.b,"start"),b&&(c(),l=Km(t,o,a.b,a.duration,0,m,r.css))),a){if(S>=a.end)f(o=a.b,1-o),bp(t,a.b,"end"),s||(a.b?c():--a.group.r||Ui(a.group.c)),a=null;else if(S>=a.start){const C=S-a.start;o=a.a+a.d*m(C/a.duration),f(o,1-o)}}return!(!a&&!s)}))}return{run(p){Zi(r)?(mc||(mc=Promise.resolve(),mc.then(()=>{mc=null})),mc).then(()=>{r=r(),u(p)}):u(p)},end(){c(),a=s=null}}}const Yy=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function qy(t,e){t.d(1),e.delete(t.key)}function Ls(t,e){z(t,1,1,()=>{e.delete(t.key)})}function La(t,e,i,n,r,o,a,s,l,c,d,u){let p=t.length,h=o.length,g=p;const m={};for(;g--;)m[t[g].key]=g;const f=[],b=new Map,w=new Map;for(g=h;g--;){const M=u(r,o,g),D=i(M);let T=a.get(D);T?T.p(M,e):(T=c(D,M),T.c()),b.set(D,f[g]=T),D in m&&w.set(D,Math.abs(g-m[D]))}const S=new Set,C=new Set;function I(M){P(M,1),M.m(s,d),a.set(M.key,M),d=M.first,h--}for(;p&&h;){const M=f[h-1],D=t[p-1],T=M.key,F=D.key;M===D?(d=M.first,p--,h--):b.has(F)?!a.has(T)||S.has(T)?I(M):C.has(F)?p--:w.get(T)>w.get(F)?(C.add(T),I(M)):(S.add(F),p--):(l(D,a),p--)}for(;p--;){const M=t[p];b.has(M.key)||l(M,a)}for(;h;)I(f[h-1]);return f}function fr(t,e){const i={},n={},r={$$scope:1};let o=t.length;for(;o--;){const a=t[o],s=e[o];if(s){for(const l in a)l in s||(n[l]=1);for(const l in s)r[l]||(i[l]=s[l],r[l]=1);t[o]=s}else for(const l in a)r[l]=1}for(const a in n)a in i||(i[a]=void 0);return i}function Rr(t){return typeof t=="object"&&t!==null?t:{}}function mo(t,e,i){const n=t.$$.props[e];n!==void 0&&(t.$$.bound[n]=i,i(t.$$.ctx[n]))}function Et(t){t&&t.c()}function Rt(t,e,i,n){const{fragment:r,after_update:o}=t.$$;r&&r.m(e,i),n||Wl(()=>{const a=t.$$.on_mount.map(Wy).filter(Zi);t.$$.on_destroy?t.$$.on_destroy.push(...a):Ui(a),t.$$.on_mount=[]}),o.forEach(Wl)}function It(t,e){const i=t.$$;i.fragment!==null&&(Ui(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function li(t,e,i,n,r,o,a,s=[-1]){const l=Bc;Ic(t);const c=t.$$={fragment:null,ctx:[],props:o,update:ni,not_equal:r,bound:Gm(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Gm(),dirty:s,skip_bound:!1,root:e.target||l.$$.root};a&&a(c.root);let d=!1;if(c.ctx=i?i(t,e.props||{},(u,p,...h)=>{const g=h.length?h[0]:p;return c.ctx&&r(c.ctx[u],c.ctx[u]=g)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](g),d&&function(m,f){m.$$.dirty[0]===-1&&(Sc.push(m),Zy(),m.$$.dirty.fill(0)),m.$$.dirty[f/31|0]|=1<<f%31}(t,u)),p}):[],c.update(),d=!0,Ui(c.before_update),c.fragment=!!n&&n(c.ctx),e.target){if(e.hydrate){const u=function(p){return Array.from(p.childNodes)}(e.target);c.fragment&&c.fragment.l(u),u.forEach(Q)}else c.fragment&&c.fragment.c();e.intro&&P(t.$$.fragment),Rt(t,e.target,e.anchor,e.customElement),E()}Ic(l)}class ci{$destroy(){It(this,1),this.$destroy=ni}$on(e,i){if(!Zi(i))return ni;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(i),()=>{const r=n.indexOf(i);r!==-1&&n.splice(r,1)}}$set(e){var i;this.$$set&&(i=e,Object.keys(i).length!==0)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Tl=[];function Rl(t,e){return{subscribe:ue(t,e).subscribe}}function ue(t,e=ni){let i;const n=new Set;function r(o){if(oi(t,o)&&(t=o,i)){const a=!Tl.length;for(const s of n)s[1](),Tl.push(s,t);if(a){for(let s=0;s<Tl.length;s+=2)Tl[s][0](Tl[s+1]);Tl.length=0}}}return{set:r,update:function(o){r(o(t))},subscribe:function(o,a=ni){const s=[o,a];return n.add(s),n.size===1&&(i=e(r)||ni),o(t),()=>{n.delete(s),n.size===0&&(i(),i=null)}}}}function Ei(t,e,i){const n=!Array.isArray(t),r=n?[t]:t,o=e.length<2;return Rl(i,a=>{let s=!1;const l=[];let c=0,d=ni;const u=()=>{if(c)return;d();const h=e(n?l[0]:l,a);o?a(h):d=Zi(h)?h:ni},p=r.map((h,g)=>Br(h,m=>{l[g]=m,c&=~(1<<g),s&&u()},()=>{c|=1<<g}));return s=!0,u(),function(){Ui(p),d()}})}var Ky=t=>t.reduce((e,i)=>Object.assign(e,i),{});const Ml=t=>({updateValue:t}),zo=t=>({defaultValue:t}),Jy=t=>({store:t}),Vd=t=>({store:(e,i)=>Ei(...t(i))}),Nd=t=>({store:(e,i)=>{const[n,r,o=()=>!1]=t(i);let a,s=!0;return Ei(n,(l,c)=>{r(l,d=>{!s&&o(a,d)||(a=d,s=!1,c(d))})})}}),$c=t=>({store:(e,i)=>{const[n,r={},o]=t(i);let a=[];const s={},l=h=>n(h,s),c=h=>{(a.length||h.length)&&(a=h,d())},d=()=>{const h=a.map(l);o&&h.sort(o),a=[...h],p(h)};Object.entries(r).map(([h,g])=>g.subscribe(m=>{s[h]=m,m&&d()}));const{subscribe:u,set:p}=ue(e||[]);return{set:c,update:h=>c(h(a)),subscribe:u}}});var Qm=t=>{const e={},i={};return t.forEach(([n,...r])=>{const o=Ky(r),a=e[n]=((l,c,d)=>{const{store:u=C=>ue(C),defaultValue:p=me,updateValue:h}=d,g=u(p(),c,l),{subscribe:m,update:f=me}=g;let b;const w=C=>{let I=!0;b&&b(),b=m(M=>{if(I)return I=!1;C(M),b(),b=void 0})},S=h?h(l):Ki;return g.set=C=>f(I=>S(C,I,w)),g.defaultValue=p,g})(i,e,o),s={get:()=>fa(a),set:a.set};Object.defineProperty(i,n,s)}),{stores:e,accessors:i}},Jb=[["src",Jy(()=>{let t;const{subscribe:e,set:i}=ue(),n=r=>{t!==r&&(t=r,i(t))};return{set:n,subscribe:e,update:r=>n(r(t))}})],["imageReader"],["imageWriter"],["imageScrambler"],["imageRedactionRendering",zo(()=>"pixelated")],["images",zo(()=>[])],["shapePreprocessor"],["willRequestResource"],["willRequest"],["csp"]],Qy=t=>t.charAt(0).toUpperCase()+t.slice(1),bu=(t,e)=>{Object.keys(e).forEach(i=>{const n=on(e[i])?{value:e[i],writable:!1}:e[i];Object.defineProperty(t,i,n)})};const t$=(t,e)=>{let i,n,r,o,a,s,l,c,d,u;const p=e.length;for(i=0;i<p;i++)if(n=e[i],r=e[i+1>p-1?0:i+1],o=n.x-t.x,a=n.y-t.y,s=r.x-t.x,l=r.y-t.y,c=o-s,d=a-l,u=c*a-d*o,u<-1e-5)return!1;return!0};var e$=(t,e)=>{const i=ly(e),n=rn();Oo(t).forEach(o=>{Dn(o,n),t$(o,e)||i.forEach(a=>{const s=Math.atan2(a.start.y-a.end.y,a.start.x-a.end.x),l=1e4*Math.sin(Math.PI-s),c=1e4*Math.cos(Math.PI-s),d=ot(o.x+l,o.y+c),u=vh(ny(a),1e4),p=wh(Es(o,d),u);p&&Dn(n,Bn(Be(p),o))})});const r=Si(t);return Dn(r,n),!!Oo(r).every(o=>t$(o,e))&&(ku(t,r),!0)},t2=(t,e)=>{const i=Oo(t),n=cy(e,5),r=ki(t),o=[];i.forEach(l=>{const c=((u,p)=>{const h=ot(u.start.x-u.end.x,u.start.y-u.end.y),g=ro(h),m=Mr(g,p);return u.end.x+=m.x,u.end.y+=m.y,u})(Es(Be(r),Be(l)),1e6);let d=!1;n.map(ny).forEach(u=>{const p=wh(c,u);p&&!d&&(o.push(p),d=!0)})});const a=ho(o[0],o[2])<ho(o[1],o[3])?[o[0],o[2]]:[o[1],o[3]],s=er(a);return s.width<t.width&&(ku(t,s),!0)},e2=(t,e,i={x:0,y:0})=>{const n=Or(t),r=ki(n),o=oy(n,i,r).map(s=>Dr(s,e,r)),a=er(o);return o.map(s=>Bn(s,a))},Il=(t,e=0,i=ir(t))=>{let n,r;if(e!==0){const o=Math.atan2(1,i),a=Math.sign(e)*e,s=a%Math.PI,l=a%Wo;let c;c=s>Ko&&s<Wo+Ko?l>Ko?a:Wo-l:l>Ko?Wo-l:a;const d=Math.min(Math.abs(t.height/Math.sin(o+c)),Math.abs(t.width/Math.cos(o-c)));n=Math.cos(o)*d,r=n/i}else n=t.width,r=n/i,r>t.height&&(r=t.height,n=r*i);return Un(n,r)},Qb=(t,e,i,n,r,o,a,s)=>{const l=no(a),c=no(s),d=si(Math.max(e.width/c.width,e.height/c.height)),u=si(Math.min(e.width/l.width,e.height/l.height)),p=Si(e);if(u<1||d>1){const h=ki(t),g=ki(e),m=u<1?u:d,f=(g.x+h.x)/2,b=(g.y+h.y)/2,w=p.width/m,S=p.height/m;ry(p,f-.5*w,b-.5*S,w,S)}return o?(((h,g,m=0,f=rn(),b)=>{if(hi(m)&&m!==0||f.x||f.y){const w=ir(h),S=e2(g,m,f),C=Il(g,m,w);if(!(h.width<C.width&&h.height<C.height)){const I=.5*h.width-.5*C.width,M=.5*h.height-.5*C.height;h.width>C.width&&(h.width=C.width,h.x+=I),h.height>C.height&&(h.height=C.height,h.y+=M)}e$(h,S),t2(h,S)&&e$(h,S)}else{const w=ir(h);h.width=Math.min(h.width,g.width),h.height=Math.min(h.height,g.height),h.x=Math.max(h.x,0),h.x+h.width>g.width&&(h.x-=h.x+h.width-g.width),h.y=Math.max(h.y,0),h.y+h.height>g.height&&(h.y-=h.y+h.height-g.height);const S=ki(h),C=Yr(h,w);C.width=Math.max(b.width,C.width),C.height=Math.max(b.height,C.height),C.x=S.x-.5*C.width,C.y=S.y-.5*C.height,ku(h,C)}})(p,i,n,r,l),{crop:p}):{crop:p}},Wh=(t,e,i)=>{const n=Or(t),r=ki(n),o=mr(n,i,r),a=ki(Fc(er(o))),s=ki(e),l=Dr(s,-i,a),c=Bn(l,a),d=bo(Dn(r,c),si);return Pn(d.x-.5*e.width,d.y-.5*e.height,e.width,e.height)},tn=(t,e,i)=>Math.max(e,Math.min(t,i));const vp=["cropLimitToImage","cropMinSize","cropMaxSize","cropAspectRatio","flipX","flipY","rotation","crop","colorMatrix","convolutionMatrix","gamma","vignette","manipulation","redaction","annotation","decoration","selection","frame","backgroundColor","backgroundImage","targetSize","metadata","trim","volume","minDuration","maxDuration","currentTime"],ih=t=>Rn(t)?t.map(ih):Th(t)||jc(t)?t:sl(t)?{...t}:t,gc=t=>t.map(e=>Object.entries(e).reduce((i,[n,r])=>(n.startsWith("_")||(i[n]=r),i),{})),tv=(t,e)=>t===e;var os=(t,e,i=tv)=>{if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1;return!0};const i$=(t,e,i)=>{const n=bo(ki(t),d=>si(d,8)),r=Or(e),o=ki(r),a=mr(r,i,o),s=bo(Dl(er(a)),d=>si(d,8)),l=Math.abs(s.x-n.x),c=Math.abs(s.y-n.y);return l<1&&c<1},ev=(t,e,i,n,r)=>{if(!r)return[-1/0,1/0];const o=Math.max(i.width/n.width,i.height/n.height),a=Un(n.width*o,n.height*o),s=(l=a,Math.sqrt(l.width*l.width+l.height*l.height));var l;if(s<Math.min(t.width,t.height))return[-1/0,1/0];const c=e?t.height:t.width,d=e?t.width:t.height,u=Math.acos(a.height/s),p=u-Math.acos(d/s),h=Math.asin(c/s)-u;if(Number.isNaN(p)&&Number.isNaN(h))return[-1/0,1/0];const g=Number.isNaN(p)?h:Number.isNaN(h)?p:Math.min(p,h);return[-g,g]},kc=(t,e)=>{const{context:i,props:n}=e;return t._isFormatted||((t=My(t))._isFormatted=!0,Object.assign(t,n)),t._isDraft||!Mu(t)||t._context&&Qo(i,t._context)||(Ey(t,i),t._context={...i}),t},iv=(t,e)=>(t._isFormatted||(t.disableMove=!0,t.disableSelect=!0,t.disableResize=!0,t.disableRotate=!0),kc(t,e));var _h=[["file"],["size"],["loadState"],["processState"],["aspectRatio",Vd(({size:t})=>[t,e=>e?ir(e):void 0])],["perspectiveX",zo(()=>0)],["perspectiveY",zo(()=>0)],["perspective",Vd(({perspectiveX:t,perspectiveY:e})=>[[t,e],([i,n])=>({x:i,y:n})])],["rotation",zo(()=>0),Ml(t=>(e,i,n)=>{if(e===i)return e;const{loadState:r,size:o,rotationRange:a,cropMinSize:s,cropMaxSize:l,crop:c,perspective:d,cropLimitToImage:u,cropOrigin:p}=t;if(!c||!r||!r.beforeComplete)return e;const h=u&&((f,b,w)=>{const S=Il(b,w,ir(f));return zc(is(S,Math.round),is(no(f),Math.round))})(c,o,i),g=u&&i$(c,o,i),m=((f,b,w,S,C,I,M,D,T,F)=>{const W=no(T),O=no(F);M&&(O.width=Math.min(F.width,C.width),O.height=Math.min(F.height,C.height));let y=!1;const V=(N,it)=>{const ut=Wh(C,S,N),at=Or(C),gt=ki(at),G=oy(at,I,gt),$t=Bn(Be(gt),xm(G)),vt=Dr(ki(ut),it,gt),lt=Bn(Be(gt),vt);G.forEach(mt=>Dr(mt,it,gt));const kt=er(G),J=xm(G),q=Dn(Bn(Bn(J,lt),kt),$t),Z=Pn(q.x-.5*ut.width,q.y-.5*ut.height,ut.width,ut.height);if(D&&Tr(Z,D.width/Z.width),M){const mt=e2(C,it,I);t2(Z,mt)}const xt=si(Math.min(Z.width/W.width,Z.height/W.height),8),nt=si(Math.max(Z.width/O.width,Z.height/O.height),8);return(xt<1||nt>1)&&si(Math.abs(it-N))===si(Math.PI/2)&&!y?(y=!0,V(f,f+Math.sign(it-N)*Math.PI)):{rotation:it,crop:Bo(Z,mt=>si(mt,8))}},tt=Math.sign(b)*Math.round(Math.abs(b)/Wo)*Wo,k=tn(b,tt+w[0],tt+w[1]);return V(f,k)})(i,e,a,c,o,d,u,p,s,l);if(h&&g){const f=Il(o,e,ir(m.crop));m.crop.x+=.5*m.crop.width,m.crop.y+=.5*m.crop.height,m.crop.x-=.5*f.width,m.crop.y-=.5*f.height,m.crop.width=f.width,m.crop.height=f.height}return n(()=>{t.crop=Bo(m.crop,f=>si(f,8))}),m.rotation})],["flipX",zo(()=>!1)],["flipY",zo(()=>!1)],["flip",Vd(({flipX:t,flipY:e})=>[[t,e],([i,n])=>({x:i,y:n})])],["isRotatedSideways",Nd(({rotation:t})=>[[t],([e],i)=>i(Ra(e)),(e,i)=>e!==i])],["crop",Ml(t=>(e,i=e)=>{const{loadState:n,size:r,cropMinSize:o,cropMaxSize:a,cropLimitToImage:s,cropAspectRatio:l,rotation:c,perspective:d}=t;if(!e&&!i||!n||!n.beforeComplete)return e;e||(e=Or(Il(r,c,l||ir(r))));const u=Qb(i,e,r,c,d,s,o,a),p=Bo(u.crop,h=>si(h,8));return Qo(i,p)?i:p})],["cropAspectRatio",Ml(t=>(e,i)=>{const{loadState:n,crop:r,size:o,rotation:a,cropLimitToImage:s}=t,l=(d=>{if(d){if(/:/.test(d)){const[u,p]=d.split(":");return u/p}return parseFloat(d)}})(e);if(!l)return;if(!r||!n||!n.beforeComplete)return l;const c=i?Math.abs(e-i):1;if(i$(r,o,a)&&s&&c>=.1){const d=((u,p)=>{const h=u.width,g=u.height;return Ra(p)&&(u.width=g,u.height=h),u})(no(o),a);t.crop=Bo(Yr(Or(d),e),si)}else{const d={width:r.height*l,height:r.height},u=.5*(r.width-d.width),p=.5*(r.height-d.height);t.crop=Bo(Pn(r.x+u,r.y+p,d.width,d.height),si)}return l})],["cropOrigin"],["cropMinSize",zo(()=>({width:1,height:1}))],["cropMaxSize",zo(()=>({width:32768,height:32768}))],["cropLimitToImage",zo(()=>!0),Ml(t=>(e,i,n)=>{const{crop:r}=t;return r&&!i&&e&&n(()=>t.crop=Si(t.crop)),e})],["cropSize",Nd(({crop:t})=>[[t],([e],i)=>{e&&i(Un(e.width,e.height))},(e,i)=>zc(e,i)])],["cropRectAspectRatio",Vd(({cropSize:t})=>[[t],([e],i)=>{e&&i(si(ir(e),5))}])],["cropRange",Nd(({size:t,rotation:e,cropRectAspectRatio:i,cropMinSize:n,cropMaxSize:r,cropLimitToImage:o})=>[[t,e,i,n,r,o],([a,s,l,c,d,u],p)=>{a&&p(((h,g,m,f,b,w)=>{const S=no(f),C=no(b);return w?[S,is(Il(h,g,m),Math.round)]:[S,C]})(a,s,l,c,d,u))},(a,s)=>os(a,s)])],["rotationRange",Nd(({size:t,isRotatedSideways:e,cropMinSize:i,cropSize:n,cropLimitToImage:r})=>[[t,e,i,n,r],([o,a,s,l,c],d)=>{!o||!l||d(ev(o,a,s,l,c))},(o,a)=>os(o,a)])],["backgroundColor",Ml(()=>t=>((e=[0,0,0,0],i=1)=>e.length===4?e:[...e,i])(t))],["backgroundImage"],["targetSize"],["colorMatrix"],["convolutionMatrix"],["gamma"],["noise"],["vignette"],["duration"],["currentTime"],["minDuration",zo(()=>1/24)],["maxDuration",zo(()=>1/0)],["volume",zo(()=>1)],["trim"],["redaction",$c(({size:t})=>[kc,{context:t}])],["manipulation",$c(({size:t})=>[kc,{context:t}])],["annotation",$c(({size:t})=>[kc,{context:t}])],["decoration",$c(({crop:t})=>[kc,{context:t}])],["selection",$c(({size:t})=>[iv,{context:t}])],["frame",Ml(()=>t=>{if(!t)return;const e={frameStyle:void 0,x:0,y:0,width:"100%",height:"100%",disableStyle:["backgroundColor","strokeColor","strokeWidth"]};return _e(t)?e.frameStyle=t:Object.assign(e,t),e})],["metadata"],["state",Jy((t,e,i)=>{const n=vp.map(l=>e[l]);let r=!1;const o=ue({}),{subscribe:a}=Ei([...n,o],(l,c)=>{if(r)return;const d=vp.reduce((u,p,h)=>(u[p]=ih(l[h]),u),{});d.crop&&Bo(d.crop,Math.round),d.manipulation=d.manipulation&&gc(d.manipulation),d.redaction=d.redaction&&gc(d.redaction),d.annotation=d.annotation&&gc(d.annotation),d.decoration=d.decoration&&gc(d.decoration),d.selection=d.selection&&gc(d.selection),c(d)}),s=l=>{l&&(r=!0,i.cropOrigin=void 0,vp.filter(c=>Ae(l,c)).forEach(c=>{const d=l[c];i[c]=d===null?void 0:ih(d)}),r=!1,o.set({}))};return{set:s,update:l=>s(l(null)),subscribe:a}})]],n$=async(t,e,i={},n)=>{const{ontaskstart:r,ontaskprogress:o,ontaskend:a,token:s}=n;let l=!1;const c={cancel:me};s.cancel=()=>{l=!0,c.cancel()};for(const[d,u]of e.entries()){if(l)return;const[p,h]=u;r(d,h);try{t=await p(t,{...i,taskCancelToken:c},g=>o(d,h,g))}catch(g){throw l=!0,g}a(d,h)}return t};const i2=["loadstart","loadabort","loaderror","loadprogress","load","processstart","processabort","processerror","processprogress","process"],nv=["flip","cropOrigin","isRotatedSideways","perspective","perspectiveX","perspectiveY","cropRange"],rv=_h.map(([t])=>t).filter(t=>!nv.includes(t)),wp=t=>"image"+Qy(t),r$=t=>Ae(t,"crop");var n2=()=>{const{stores:t,accessors:e}=Qm(Jb),{sub:i,pub:n}=ns(),r=()=>e.images?e.images[0]:{};let o={};const a={};rv.forEach(m=>{Object.defineProperty(e,wp(m),{get:()=>{const f=r();if(f)return f.accessors[m]},set:f=>{o[wp(m)]=f,a[wp(m)]=f;const b=r();b&&(b.accessors[m]=f)}})});const s=()=>e.images&&e.images[0],l=t.src.subscribe(m=>{if(!m)return e.images=[];e.imageReader&&(e.images.length&&(o={}),d(m))}),c=t.imageReader.subscribe(m=>{m&&(e.images.length||e.src&&d(e.src))}),d=m=>{Promise.resolve().then(()=>p(m,o)).catch(()=>{})};let u;const p=(m,f={})=>new Promise((b,w)=>{let S=s();const C=!(f.cropLimitToImage===!1||f.imageCropLimitToImage===!1||a.imageCropLmitedToImage===!1),I=f.cropMinSize||f.imageCropMinSize||a.imageCropMinSize,M=C?I:S&&S.accessors.cropMinSize,D=f.minDuration||f.imageMinDuration;S&&g(),S=(({minSize:W={width:1,height:1},minDuration:O=0}={})=>{const{stores:y,accessors:V}=Qm(_h),{pub:tt,sub:k}=ns(),N=(it,ut)=>{const at=()=>V[it]||{},gt=vt=>{V[it]={...at(),...vt,timeStamp:Date.now()}},G=()=>at().error,$t=vt=>{G()||(gt({error:vt}),tt(ut+"error",{...at()}))};return{start(){tt(ut+"start")},onabort(){gt({abort:!0}),tt(ut+"abort",{...at()})},ontaskstart(vt,lt){G()||(gt({index:vt,task:lt,taskProgress:void 0,taskLengthComputable:void 0}),tt(ut+"taskstart",{...at()}))},ontaskprogress(vt,lt,kt){G()||(gt({index:vt,task:lt,taskProgress:kt.loaded/kt.total,taskLengthComputable:kt.lengthComputable}),tt(ut+"taskprogress",{...at()}),tt(ut+"progress",{...at()}))},ontaskend(vt,lt){G()||(gt({index:vt,task:lt}),tt(ut+"taskend",{...at()}))},ontaskerror(vt){$t(vt)},error(vt){$t(vt)},beforeComplete(vt){G()||(gt({beforeComplete:!0}),tt("before"+ut,vt))},complete(vt){G()||(gt({complete:!0}),tt(ut,vt))}}};return bu(V,{read:(it,{reader:ut},at={})=>{if(!ut)return;Object.assign(V,{file:void 0,size:void 0,loadState:void 0});let gt={cancel:me},G=!1;const $t=N("loadState","load"),vt={token:gt,...$t},lt={src:it,size:void 0,dest:void 0,duration:void 0};return Promise.resolve().then(async()=>{try{if($t.start(),G)return $t.onabort();const kt=await n$(lt,ut,at,vt);if(G)return $t.onabort();const{size:J,duration:q,dest:Z}=kt||{};if(!J||!J.width||!J.height)throw new Rc("Image size missing","IMAGE_SIZE_MISSING",kt);if(q>0&&q<O)throw new Rc("Video too short","VIDEO_TOO_SHORT",{...kt,minDuration:O});if(J.width<W.width||J.height<W.height)throw new Rc("Image too small","IMAGE_TOO_SMALL",{...kt,minWidth:W.width,minHeight:W.height});Object.assign(V,{file:Z,size:J,duration:q}),$t.beforeComplete(kt),$t.complete(kt)}catch(kt){$t.error(kt)}finally{gt=void 0}}),()=>{G=!0,gt&&gt.cancel(),$t.onabort()}},write:(it,ut)=>{if(!V.loadState.complete)return;V.processState=void 0;const at=N("processState","process"),gt={src:V.file,imageState:V.state,dest:void 0};if(on(it)&&(it=it(V.file,V.state)),!it)return at.start(),void at.complete(gt);let G={cancel:me},$t=!1;const vt=ut,lt={token:G,...at};return Promise.resolve().then(async()=>{try{if(at.start(),$t)return at.onabort();const kt=await n$(gt,it,vt,lt);if($t)return at.onabort();at.complete(kt)}catch(kt){at.error(kt)}finally{G=void 0}}),()=>{$t=!0,G&&G.cancel()}},on:k}),{accessors:V,stores:y}})({minSize:M,minDuration:D}),i2.map(W=>{return S.accessors.on(W,(O=W,y=>n(O,y)));var O});const T=()=>{o={},F.forEach(W=>W())},F=[];F.push(S.accessors.on("loaderror",W=>{T(),w(W)})),F.push(S.accessors.on("loadabort",()=>{T(),w({name:"AbortError"})})),F.push(S.accessors.on("load",W=>{u=void 0,T(),b(W)})),F.push(S.accessors.on("beforeload",()=>((W,O)=>{if(r$(O))return void(e.imageState=O);if(!O.imageCrop){const tt=W.accessors.size,k=O.imageRotation||0,N=iy(no(tt),k),it=Or(N);it.width=si(Math.abs(it.width),6),it.height=si(Math.abs(it.height),6);const ut=O.imageCropAspectRatio||(O.imageCropLimitToImage?ir(tt):ir(it));let at;O.imageCropLimitToImage?at=Yr(it,ut):(at=rs(it,ut),at.x=(tt.width-at.width)/2,at.y=(tt.height-at.height)/2),O.imageCrop=at}if(W.accessors.duration&&!O.imageTrim&&O.imageMaxDuration){const{duration:tt}=W.accessors;O.imageTrim=[[0,Math.min(O.imageMaxDuration/tt,1)]]}const y=["imageCropLimitToImage","imageCrop","imageCropAspectRatio","imageRotation"];y.filter(tt=>Ae(O,tt)).forEach(tt=>{e[tt]=O[tt],delete O[tt]});const V=Object.keys(O).filter(tt=>!y.includes(tt)).reduce((tt,k)=>(tt[k]=O[k],tt),{});Object.assign(e,V)})(S,f))),e.images=[S],f.imageReader&&(e.imageReader=f.imageReader),f.imageWriter&&(e.imageWriter=f.imageWriter),u=S.accessors.read(m,{reader:e.imageReader},{willRequest:e.willRequest})});let h;const g=()=>{const m=s();m&&(u&&u(),m.accessors.loadState=void 0,e.images=[])};return Object.defineProperty(e,"stores",{get:()=>t}),bu(e,{on:i,loadImage:p,abortLoadImage:()=>{u&&u(),e.images=[]},editImage:(m,f)=>new Promise((b,w)=>{p(m,f).then(()=>{const{images:S}=e,C=S[0],I=()=>{M(),D()},M=C.accessors.on("processerror",T=>{I(),w(T)}),D=C.accessors.on("process",T=>{I(),b(T)})}).catch(w)}),removeImage:g,processImage:(m,f)=>new Promise((b,w)=>{try{const S=[],C=()=>{h=void 0,S.forEach(I=>I())};(async()=>{if((M=>_e(M)||Ol(M)||Bl(M))(m))try{await p(m,f)}catch(M){w(M)}else m&&(r$(m)?e.imageState=m:Object.assign(e,m));const I=s();if(!I)return w("no image");S.push(I.accessors.on("processerror",M=>{C(),w(M)})),S.push(I.accessors.on("processabort",()=>{C(),w({name:"AbortError"})})),S.push(I.accessors.on("process",M=>{C(),b(M)})),h=I.accessors.write(e.imageWriter,{redactionRenderStyle:e.imageRedactionRendering,shapePreprocessor:e.shapePreprocessor||Ki,imageScrambler:e.imageScrambler,willRequest:e.willRequest,csp:e.csp||{},willRequestResource:e.willRequestResource})})()}catch(S){w(S)}}),abortProcessImage:()=>{const m=s();m&&(h&&h(),m.accessors.processState=void 0)},destroy:()=>{l&&l(),c&&c()}}),e};const ov=(t,e)=>{const{processImage:i}=n2();return i(t,e)};var r2=()=>Ea()?ia()?/15_|16_/.test(navigator.userAgent)?14745600:16777216:/15_/.test(navigator.userAgent)?16777216:1/0:1/0,o2=(t,e)=>Object.keys(t).filter(i=>!e.includes(i)).reduce((i,n)=>(i[n]=t[n],i),{}),a2=t=>new Promise(e=>{if(t.duration===1/0)return t.ontimeupdate=()=>{t.ontimeupdate=void 0,e(t)},void(t.currentTime=Number.MAX_SAFE_INTEGER);e(t)});const av=t=>new Promise(e=>{const i=new FileReader;i.onload=()=>e(i.result),i.readAsArrayBuffer(t)}),Sp=(t,e=0,i=t.byteLength)=>{const n=[],r=e+i;for(;e<r;){const o=t.getUint32(e);if(o<0)break;const a=t.getUint32(e+4);if(n.push({type:a,size:o,offset:e,bodyOffset:e+8,bodySize:o-8}),o<8)break;e+=o}return n},sv=(t,{limit:e=1024}={})=>{let i=0;if(i+=4,t.getUint32(i)!==1718909296)return 0;i+=4;const n=t.getUint32(i);return n===1836069938?((r,o,a)=>{let s=!1,l=-1;for(let h=o;h<a;h++)if(s||r.getUint32(h)!==1953653099||(s=!0,h+=4),s&&r.getUint8(h)==64){l=h;break}if(l<0)return 0;const c=r.getUint32(l-28),d=r.getUint32(l-20),u=r.getUint32(l-32),p=r.getUint32(l-16);return c===65536&&d===4294901760?90:u===4294901760&&p===4294901760?180:c===4294901760&&d===65536?270:0})(t,i,e):n===1903435808?(r=>{const o=Sp(r).find(c=>c.type===1836019574);if(!o)return 0;const a=Sp(r,o.bodyOffset,o.bodySize);a.filter(c=>c.type===1953653099).forEach(c=>{a.push(...Sp(r,c.bodyOffset,c.bodySize))});const s=[1836476516,1953196132],l=a.filter(c=>s.includes(c.type));for(const{type:c,bodyOffset:d}of l){const u=r.getUint8(d);let p=d+4;p+=c===1836476516?32:36,p+=u===1?12:0;const h=r.getInt32(p),g=r.getInt32(p+4);if(h===0&&g>0)return 90;if(h<0&&g===0)return 180;if(h===0&&g<0)return 270}return 0})(t):0};var s2=t=>new Promise((e,i)=>{(ya()?(async n=>{const r=await av(n),o=new DataView(r);return sv(o)})(t):Promise.resolve(0)).then(n=>{const r=document.createElement("video");r.onerror=()=>i(r.error),r.playsInline=!0,r.preload="auto",r.onseeked=()=>{r.onseeked=void 0,e(r)},r.onloadeddata=()=>{r.onloadeddata=void 0,r.dataset.rotation=n?""+n:"0",a2(r).then(e),r.currentTime=0},r.src=URL.createObjectURL(t),(o=>{ia()&&(o.load(),o.play().catch(()=>{}),o.pause())})(r)})}),l2=(t,e)=>new Promise(i=>{if(t.currentTime===e)return i(t);let n=t.onseeked;t.onseeked=()=>{t.onseeked=n,i(t)},t.currentTime=tn(e,0,t.duration)}),c2=(t,e=0)=>new Promise((i,n)=>{s2(t).then(r=>{l2(r,e).then(o=>{const a=xn("canvas");py(o).then(({width:s,height:l})=>{a.width=s,a.height=l;const c=a.getContext("2d",{willReadFrequently:!0}),d=()=>{c.drawImage(o,0,0,a.width,a.height);const u=c.getImageData(0,0,a.width,a.height);qn(a),URL.revokeObjectURL(o.src),i(u)};Ea()?setTimeout(d,16):d()})})})}),cl=t=>/video/.test(t.type);const Vh=({imageDataResizer:t,canvasMemoryLimit:e}={})=>async(i,n,r,o,a)=>{r.width=Math.max(r.width,1),r.height=Math.max(r.height,1),o.width=Math.max(o.width,1),o.height=Math.max(o.height,1);const{dest:s}=await ov(n,{imageReader:$2(),imageWriter:g2({format:"canvas",targetSize:{...o,upscale:!0},imageDataResizer:t,canvasMemoryLimit:e}),imageCrop:r}),{feather:l=0}=a||{};if(l>0){const c=xn("canvas");c.width=s.width,c.height=s.height;const d=c.getContext("2d",{willReadFrequently:!0}),u=1/l;let p=0;for(p=0;p<l;p++){const g=p*u;d.strokeStyle=`rgba(0,0,0,${g*g})`,d.strokeRect(p+.5,p+.5,s.width-2*p-1,s.height-2*p-1)}d.fillStyle="#000",d.fillRect(p,p,s.width+.5-2*p,s.height+.5-2*p);const h=s.getContext("2d");h.globalCompositeOperation="destination-in",h.drawImage(c,0,0),qn(c)}i.drawImage(s,o.x,o.y,o.width,o.height),qn(s)},wn=(t,e=(...n)=>n,i)=>async(n,r,o)=>{o(Pl(0,!1));let a=!1;const s=await t(...e(n,r,l=>{a=!0,o(l)}));return i&&i(n,s),a||o(Pl(1,!1)),n},lv=({willRequest:t,srcProp:e="src",destProp:i="dest"}={})=>[wn(pb,(n,r,o)=>[n[e],o,{...r,willRequest:t}],(n,r)=>n[i]=r),"any-to-file"],cv=({srcProp:t="dest",destProp:e="dest"}={})=>[wn(async i=>{if(/octet-stream/.test(i.type)){console.warn(`Pintura: File has unknown mime type "${i.type}", make sure your server sets the correct Content-Type header.`);let n="image";const r=await Ch(i);/video/i.test(r.nodeName)&&(n="video");const o={type:n+"/unknown"};return jc(i)?new File([i],i.name,{...o,lastModified:i.lastModified}):new Blob([i],o)}return i},i=>[i[t]],(i,n)=>i[e]=n),"any-to-file"],d2=({srcProp:t="src",destProp:e="size"}={})=>[wn(hy,i=>[i[t]],(i,n)=>i[e]=n),"read-image-size"],dv=async t=>{const e=await Ch(t);if(hu(e))return await(i=>new Promise((n,r)=>{const o=()=>{a2(i).then(()=>{n(i.duration)})};if(i.readyState>=1)return o();i.onloadedmetadata=o,i.onerror=()=>r(i.error)}))(e)},uv=({srcProp:t="src",destProp:e="duration"}={})=>[wn(dv,i=>[i[t]],(i,n)=>i[e]=n),"read-media-duration"],u2=({srcSize:t="size",srcOrientation:e="orientation",destSize:i="size"}={})=>[wn(hb,n=>[n[t],n[e]],(n,r)=>n[i]=r),"image-size-match-orientation"],p2=({srcProp:t="src",destProp:e="head"}={})=>[wn((i,n)=>gy(i)?Gf(i,n):void 0,i=>[i[t],[0,262144],onprogress],(i,n)=>i[e]=n),"read-image-head"],h2=({srcProp:t="head",destProp:e="orientation"}={})=>[wn(gh,i=>[i[t],274],(i,n=1)=>i[e]=n),"read-exif-orientation-tag"],pv=({srcProp:t="head"}={})=>[wn(gh,e=>[e[t],274,1]),"clear-exif-orientation-tag"],hv=({srcImageSize:t="size",srcCanvasSize:e="imageData",srcImageState:i="imageState",destImageSize:n="size",destScalar:r="scalar"}={})=>[wn((o,a)=>[Math.min(a.width/o.width,a.height/o.height),Aa(a)],o=>[o[t],o[e],o[i]],(o,[a,s])=>{o[r]=a,o[n]=s}),"calculate-canvas-scalar"],mv=({srcProp:t="src",destProp:e="imageData",canvasMemoryLimit:i,srcImageState:n="imageState"}={})=>[wn((r,o,a)=>cl(r)?c2(r,a.currentTime):Jf(r,o),r=>[r[t],i,r[n]],(r,o)=>r[e]=o),"blob-to-image-data"],$v=({srcImageData:t="imageData",srcOrientation:e="orientation"}={})=>[wn(Xf,i=>[i[t],i[e]],(i,n)=>i.imageData=n),"image-data-match-orientation"],gv=({srcImageData:t="imageData",srcImageState:e="imageState"}={})=>[wn(jb,i=>[i[t],{backgroundColor:i[e].backgroundColor,backgroundImage:i[e].backgroundImage}],(i,n)=>i.imageData=n),"image-data-fill"],fv=({srcImageData:t="imageData",srcImageState:e="imageState",destScalar:i="scalar"}={})=>[wn($b,n=>{const r=n[i];let{crop:o}=n[e];return o&&r!==1&&(o=Tr(Si(o),r,rn())),[n[t],{crop:o,rotation:n[e].rotation,flipX:n[e].flipX,flipY:n[e].flipY}]},(n,r)=>n.imageData=r),"image-data-crop"],yv=({targetSize:t={width:void 0,height:void 0,fit:void 0,upscale:void 0},imageDataResizer:e,srcProp:i="imageData",srcImageState:n="imageState",destImageScaledSize:r="imageScaledSize"})=>[wn(fb,o=>{const a=Math.min(t.width||Number.MAX_SAFE_INTEGER,o[n].targetSize&&o[n].targetSize.width||Number.MAX_SAFE_INTEGER),s=Math.min(t.height||Number.MAX_SAFE_INTEGER,o[n].targetSize&&o[n].targetSize.height||Number.MAX_SAFE_INTEGER);return[o[i],{width:a,height:s,fit:t.fit||"contain",upscale:(l=o[n],!!(l.targetSize&&l.targetSize.width||l.targetSize&&l.targetSize.height)||t.upscale||!1)},e];var l},(o,a)=>{zc(o.imageData,a)||(o[r]=Aa(a)),o.imageData=a}),"image-data-resize"],xv=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData"}={})=>[wn(wb,n=>{const{colorMatrix:r}=n[e],o=r&&Object.keys(r).map(a=>r[a]).filter(Boolean);return[n[t],{colorMatrix:o&&Dh(o),convolutionMatrix:n[e].convolutionMatrix,gamma:n[e].gamma,noise:n[e].noise,vignette:n[e].vignette}]},(n,r)=>n[i]=r),"image-data-filter"],bv=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData",destScalar:n="scalar"}={})=>[wn(async(r,o,a,s,l,c)=>{if(!o||!s.length)return r;let d;try{const m={dataSizeScalar:By(r,s)};a&&a[3]>0&&(m.backgroundColor=[...a]),d=await o(r,m)}catch{}const u=xn("canvas");u.width=r.width,u.height=r.height;const p=u.getContext("2d",{willReadFrequently:!0});if(p.putImageData(r,0,0),c==="auto"){const m=Math.sqrt(r.width*r.height);p.filter=`blur(${Math.round(m/100)}px)`}const h=new Path2D;s.forEach(m=>{const f=Pn(m.x,m.y,m.width,m.height);ks(f,l);const b=mr(Si(f),m.rotation),w=new Path2D;b.forEach((S,C)=>{if(C===0)return w.moveTo(S.x,S.y);w.lineTo(S.x,S.y)}),h.addPath(w)}),p.clip(h,"nonzero"),p.imageSmoothingEnabled=!1,p.drawImage(d,0,0,u.width,u.height),qn(d);const g=p.getImageData(0,0,u.width,u.height);return qn(u),g},(r,{imageScrambler:o,redactionRenderStyle:a})=>[r[t],o,r[e].backgroundColor,r[e].redaction,r[n],a],(r,o)=>r[i]=o),"image-data-redact"],kp=({srcImageData:t="imageData",srcSize:e="size",srcImageState:i="imageState",srcShapes:n="annotation",destImageData:r="imageData",destImageScaledSize:o="imageScaledSize",destScalar:a="scalar",imageDataResizer:s,canvasMemoryLimit:l,shapeFilter:c=Ki,shapeClip:d=!0,destImageContext:u="imageContext"}={})=>[wn(Fh,(p,{shapePreprocessor:h,willRequestResource:g,csp:m,willRequest:f})=>{const b=p[i][n].filter(c);if(!b.length)return[p[t]];const w=p[a],{crop:S}=p[i],C=p[e];let I=w;const M=p[o];M&&(I=Math.min(M.width/S.width,M.height/S.height));const D={width:C.width/w,height:C.height/w};return[p[t],{shapes:b,computeShape:T=>(T=Zn(T,D),T=o2(T,["left","right","top","bottom"]),T=Ay(T,I)),transform:T=>{const F=p[e],{rotation:W=0,flipX:O,flipY:y,cropLimitToImage:V}=p[i],tt=p[a],{crop:k=Or(F)}=p[i],N=p[o],it=N?Math.min(N.width/k.width,N.height/k.height):1,ut={width:F.width/tt*it,height:F.height/tt*it},at=ab(ut,W),gt=at.width,G=at.height,$t=.5*ut.width-.5*gt,vt=.5*ut.height-.5*G,lt=Dl(ut);T.translate(-$t,-vt),T.translate(-k.x*it,-k.y*it),T.translate(lt.x,lt.y),T.rotate(W),T.translate(-lt.x,-lt.y);const kt=p[u]||{x:0,y:0};T.translate(kt.x,kt.y),T.scale(O?-1:1,y?-1:1),T.translate(O?-ut.width*tt:0,y?-ut.height*tt:0),V&&d&&(T.rect(0,0,ut.width,ut.height),T.clip())},drawImage:Vh({imageDataResizer:s,canvasMemoryLimit:l}),preprocessShape:T=>h(T,{isPreview:!1,...p[i]}),canvasMemoryLimit:l,willRequest:f||g,styleNonce:m.styleNonce}]},(p,h)=>p[r]=h),"image-data-annotate"],o$=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData",destImageScaledSize:n="imageScaledSize",imageDataResizer:r,canvasMemoryLimit:o,destScalar:a="scalar",shapeFilter:s=Ki,destImageContext:l="imageContext"}={})=>[wn(Fh,(c,{shapePreprocessor:d,willRequestResource:u,willRequest:p,csp:h})=>{let g=c[e].decoration.filter(s);if(typeof window<"u"&&(w=>{if(w&&w._u5rlc3k)return;const[S]=[[85,110,108,105,99,101,110,115,101,100,32,80,105,110,116,117,114,97,32,105,110,115,116,97,110,99,101,32]].map(D=>D.map(T=>String.fromCharCode(T)).join("")),{width:C,height:I}=c[e].crop,M=I/15;g=[...g,{x:.5*-M,y:.5*-M,width:1.5*C,height:1.25*I,text:Array(50).fill(S).join(""),fontWeight:900,lineHeight:M,fontSize:M,color:[1,1,1,.05]}]})(window),!g.length)return[c[t]];let m=c[a];const{crop:f}=c[e],b=c[n];return b&&(m=Math.min(b.width/f.width,b.height/f.height)),[c[t],{shapes:g,drawImage:Vh({imageDataResizer:r,canvasMemoryLimit:o}),computeShape:w=>(w=Zn(w,f),w=o2(w,["left","right","top","bottom"]),w=Ay(w,m)),preprocessShape:w=>d(w,{isPreview:!1,...c[e]}),canvasMemoryLimit:o,willRequest:p||u,styleNonce:h.styleNonce,transform:w=>{const S=c[l]||{x:0,y:0};w.translate(S.x,S.y)}}]},(c,d)=>c[i]=d),"image-data-decorate"],vv=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData",destImageScaledSize:n="imageScaledSize",imageDataResizer:r,canvasMemoryLimit:o,destScalar:a="scalar",destImageContext:s="imageContext"}={})=>[wn((l,c)=>new Promise(d=>{if(!c)return d([l]);Fh(l,c).then(u=>{d([u,c.contextBounds])})}),(l,{shapePreprocessor:c,willRequestResource:d,willRequest:u,csp:p})=>{const h=l[e].frame;if(!h)return[l[t]];const g=l[a];let{crop:m}=l[e];m&&g!==1&&(m=Tr(Si(m),g,rn()));const f={...m},b=Ry(Iy(h,f,c),f);f.x=Math.abs(b.left),f.y=Math.abs(b.top),f.width+=Math.abs(b.left)+Math.abs(b.right),f.height+=Math.abs(b.top)+Math.abs(b.bottom);const w=l[n],S=w?Math.min(w.width/m.width,w.height/m.height):1;return ks(f,S),f.x=Math.floor(f.x),f.y=Math.floor(f.y),f.width=Math.floor(f.width),f.height=Math.floor(f.height),[l[t],{shapes:[h],contextBounds:f,computeShape:C=>Zn(C,l[t]),transform:C=>{C.translate(f.x,f.y)},drawImage:Vh({imageDataResizer:r,canvasMemoryLimit:o}),preprocessShape:C=>c(C,{isPreview:!1,...l[e]}),canvasMemoryLimit:o,willRequest:u||d,styleNonce:p.styleNonce}]},(l,[c,d])=>{l[s]=d,l[i]=c}),"image-data-frame"],wv=({mimeType:t,quality:e,srcImageData:i="imageData",srcFile:n="src",destBlob:r="blob"}={})=>[wn(tb,o=>[o[i],t||bh(o[n].name)||o[n].type,e],(o,a)=>o[r]=a),"image-data-to-blob"],Sv=({srcImageData:t="imageData",srcOrientation:e="orientation",destCanvas:i="dest"}={})=>[wn(Nl,n=>[n[t],n[e]],(n,r)=>n[i]=r),"image-data-to-canvas"],kv=async(t,e)=>{if(!gy(t)||!e)return t;const i=new DataView(e),n=Uf(i);if(!n||!n.exif)return t;const r=["exif","mpf","xmp"].reduce((o,a)=>n[a]?Math.max(o,n[a].offset+n[a].size):o,0);return((o,a,s=[0,o.size])=>a?new Blob([a,o.slice(...s)],{type:o.type}):o)(t,e.slice(0,r+2),[20])},Cv=(t="blob",e="head",i="blob")=>[wn(kv,n=>[n[t],n[e]],(n,r)=>n[i]=r),"blob-write-image-head"],Tv=({renameFile:t,srcBlob:e="blob",srcFile:i="src",destFile:n="dest",defaultFilename:r}={})=>[wn(Ac,o=>[o[e],t?t(o[i]):o[i].name||`${r}.${Qf(o[e].type)}`],(o,a)=>o[n]=a),"blob-to-file"],a$=({url:t="./",dataset:e=o=>[["dest",o.dest,o.dest.name],["imageState",o.imageState]],destStore:i="store",credentials:n,headers:r={}})=>[wn(async(o,a)=>await((s,l,c)=>new Promise((d,u)=>{const{token:p={},beforeSend:h=me,onprogress:g=me}=c;p.cancel=()=>m.abort();const m=new XMLHttpRequest;m.upload.onprogress=g,m.onload=()=>m.status>=200&&m.status<300?d(m):u(m),m.onerror=()=>u(m),m.ontimeout=()=>u(m),m.open("POST",encodeURI(s)),h(m),m.send(l instanceof FormData?l:l.reduce((f,b)=>(f.append(...b.map(mb)),f),new FormData))}))(t,o,{onprogress:a,beforeSend:s=>my(s,{headers:r,credentials:n})}),(o,a,s)=>[e(o),s],(o,a)=>o[i]=a),"store"],m2=t=>[wn(e=>(t&&t.length&&Object.keys(e).forEach(i=>{t.includes(i)||delete e[i]}),e)),"prop-filter"],$2=(t={})=>{const{orientImage:e=!0,outputProps:i=["src","dest","size","duration"],preprocessImageFile:n,request:r={}}=t;return[lv({willRequest:()=>r}),cv(),n&&[wn(n,(o,a,s)=>[o.dest,a,s],(o,a)=>o.dest=a),"preprocess-image-file"],d2({srcProp:"dest"}),uv({srcProp:"dest"}),e&&p2({srcProp:"dest"}),e&&h2(),e&&u2(),m2(i)].filter(Boolean)},Mv=t=>t&&(_e(t)?a$({url:t}):on(t)?[t,"store"]:a$(t)),g2=(t={})=>(e,i,n={})=>{let{canvasMemoryLimit:r=r2(),orientImage:o=!0,copyImageHead:a=!0,mimeType:s,quality:l,renameFile:c,targetSize:d,imageDataResizer:u,store:p,format:h="file",outputProps:g=["src","dest","imageState","store"],preprocessImageSource:m,preprocessImageState:f,postprocessImageData:b,postprocessImageBlob:w,testSrcSupport:S=!1}={...t,...n};if(!S||Cu(e))return h==="blob"&&(h="file"),[m&&[wn(m,(C,I,M)=>[C.src,I,M,C.imageState],(C,I)=>C.src=I),"preprocess-image-source"],(o||a)&&p2(),o&&h2(),d2(),f&&[wn(f,(C,I,M,D)=>[C.imageState,I,M,{size:C.size,orientation:C.orientation}],(C,I)=>C.imageState=I),"preprocess-image-state"],mv({canvasMemoryLimit:r}),o&&u2(),o&&$v(),hv(),bv(),fv(),yv({imageDataResizer:u,targetSize:d}),kp({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"manipulation"}),xv(),gv(),kp({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"annotation",shapeFilter:C=>!C.aboveFrame}),o$({imageDataResizer:u,canvasMemoryLimit:r,shapeFilter:C=>!C.aboveFrame}),vv({imageDataResizer:u,canvasMemoryLimit:r}),kp({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"annotation",shapeFilter:C=>C.aboveFrame,shapeClip:!1}),o$({imageDataResizer:u,canvasMemoryLimit:r,shapeFilter:C=>C.aboveFrame}),b&&[wn(b,(C,I,M)=>[C.imageData,I,M],(C,I)=>C.imageData=I),"postprocess-image-data"],h==="file"?wv({mimeType:s,quality:l}):h==="canvas"?Sv():[C=>(C.dest=C.imageData,C)],h==="file"&&o&&pv(),h==="file"&&a&&Cv(),w&&[wn(w,({blob:C,imageData:I,src:M},D,T)=>[{blob:C,imageData:I,src:M},D,T],(C,I)=>C.blob=I),"postprocess-image-file"],h==="file"&&Tv({defaultFilename:"image",renameFile:c}),h==="file"?Mv(p):on(p)&&[p,"store"],m2(g)].filter(Boolean)};var Pv=(t,e,i,n,r,o,a,s,l,c,d)=>{if(!(t&&e&&i&&n&&s))return;s*=o;const u=Fc(Si(e)),p=ki(u),h=ki(t),g=Or(i),m=ki(g),f=Wh(i,n,l),b=ki(f),w=Bn(Be(m),b),S=Bn(Be(h),p);w.x+=S.x,w.y+=S.y;const C=El(Be(w));C.x+=S.x,C.y+=S.y;const I=ki(Jo(Jo(Si(r),a),t)),M=Bn(I,h);return Dn(w,M),{origin:C,translation:w,rotation:{x:d?Math.PI:0,y:c?Math.PI:0,z:l},scale:s}};let fc=null;var Nh=()=>{if(fc===null)if("WebGL2RenderingContext"in window){let t;try{t=xn("canvas"),fc=!!t.getContext("webgl2")}catch{fc=!1}t&&qn(t),t=void 0}else fc=!1;return fc},s$=t=>(t&t-1)==0,Hh=(t,e={},i="",n="")=>Object.keys(e).filter(r=>!sl(e[r])).reduce((r,o)=>r.replace(new RegExp(i+o+n),e[o]),t);const Rv={head:`#version 300 es

in vec4 aPosition;uniform mat4 uMatrix;`,text:`
in vec2 aTexCoord;out vec2 vTexCoord;`,matrix:`
gl_Position=uMatrix*vec4(aPosition.x,aPosition.y,0,1);`},Iv={head:`#version 300 es
precision highp float;

out vec4 fragColor;`,mask:`
uniform float uMaskFeather[8];uniform float uMaskBounds[4];uniform float uMaskOpacity;float mask(float x,float y,float bounds[4],float opacity){return 1.0-(1.0-(smoothstep(bounds[3],bounds[3]+1.0,x)*(1.0-smoothstep(bounds[1]-1.0,bounds[1],x))*(1.0-step(bounds[0],y))*step(bounds[2],y)))*(1.0-opacity);}`,init:`
float a=1.0;vec4 fillColor=uColor;vec4 textureColor=texture(uTexture,vTexCoord);textureColor*=(1.0-step(uRepeat.y,vTexCoord.y))*step(0.0,vTexCoord.y)*(1.0-step(uRepeat.x,vTexCoord.x))*step(0.0,vTexCoord.x);`,colorize:`
if(uTextureColor.a!=0.0&&textureColor.a>0.0){vec3 colorFlattened=textureColor.rgb/textureColor.a;if(colorFlattened.r>=.9999&&colorFlattened.g==0.0&&colorFlattened.b>=.9999){textureColor.rgb=uTextureColor.rgb*textureColor.a;}textureColor*=uTextureColor.a;}`,maskapply:`
float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);`,maskfeatherapply:`
float leftFeatherOpacity=step(uMaskFeather[1],gl_FragCoord.x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],gl_FragCoord.x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],gl_FragCoord.x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],gl_FragCoord.x));a*=leftFeatherOpacity*rightFeatherOpacity;`,rectaa:`
vec2 scaledPoint=vec2(vRectCoord.x*uSize.x,vRectCoord.y*uSize.y);a*=smoothstep(0.0,uEdgeFeather,uSize.x-scaledPoint.x);a*=smoothstep(0.0,uEdgeFeather,uSize.y-scaledPoint.y);a*=smoothstep(0.0,uEdgeFeather,scaledPoint.x);a*=smoothstep(0.0,uEdgeFeather,scaledPoint.y);`,cornerradius:`
vec2 s=(uSize-2.0)*.5;vec2 r=(vRectCoord*uSize)-1.0;vec2 p=r-s;float cornerRadius=uCornerRadius[0];bool left=r.x<s.x;bool top=r.y<s.y;if(!left&&top){cornerRadius=uCornerRadius[1];}if(!left&&!top){cornerRadius=uCornerRadius[3];}if(left&&!top){cornerRadius=uCornerRadius[2];}a*=1.0-clamp(length(max(abs(p)-(s-cornerRadius),0.0))-cornerRadius,0.0,1.0);`,fragcolor:`
if(m<=0.0)discard;fillColor.a*=a;fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);textureColor*=uTextureOpacity;textureColor.a*=a;textureColor.rgb*=m*a;textureColor.rgb+=(1.0-m)*(uCanvasColor.rgb*textureColor.a);fragColor=textureColor+(fillColor*(1.0-textureColor.a));`},l$=(t,e,i)=>{const n=t.createShader(i),r=((o,a,s)=>(a=Hh(a,s===o.VERTEX_SHADER?Rv:Iv,"##").trim(),Nh()?a:(a=(a=a.replace(/#version.+/gm,"").trim()).replace(/^\/\/\#/gm,"#"),s===o.VERTEX_SHADER&&(a=a.replace(/in /gm,"attribute ").replace(/out /g,"varying ")),s===o.FRAGMENT_SHADER&&(a=a.replace(/in /gm,"varying ").replace(/out.*?;/gm,"").replace(/texture\(/g,"texture2D(").replace(/fragColor/g,"gl_FragColor")),""+a)))(t,e,i);return t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)||console.error(t.getShaderInfoLog(n)),n},yc=(t,e,i,n,r)=>{const o=l$(t,e,t.VERTEX_SHADER),a=l$(t,i,t.FRAGMENT_SHADER),s=t.createProgram();t.attachShader(s,o),t.attachShader(s,a),t.linkProgram(s);const l={};return n.forEach(c=>{l[c]=t.getAttribLocation(s,c)}),r.forEach(c=>{l[c]=t.getUniformLocation(s,c)}),{program:s,locations:l,destroy(){t.detachShader(s,o),t.detachShader(s,a),t.deleteShader(o),t.deleteShader(a),t.deleteProgram(s)}}},c$=t=>t.nodeName!=="VIDEO"&&(!!Nh()||s$(t.width)&&s$(t.height)),Ev=(t,e,i,n)=>(t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i),((r,o,a)=>{r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,c$(o)?r.LINEAR_MIPMAP_LINEAR:r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,a.filterParam),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,a.wrapParam),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,a.wrapParam),c$(o)&&r.generateMipmap(r.TEXTURE_2D)})(t,i,n),t.bindTexture(t.TEXTURE_2D,null),e),Ks=(t,e=1)=>t?[t[0],t[1],t[2],hi(t[3])?e*t[3]:e]:[0,0,0,0],Cp=()=>{const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},Tp=(t,e,i,n,r,o,a)=>{const s=1/(e-i),l=1/(n-r),c=1/(o-a);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+i)*s,t[13]=(r+n)*l,t[14]=(a+o)*c,t[15]=1},Js=(t,e,i,n)=>{t[12]=t[0]*e+t[4]*i+t[8]*n+t[12],t[13]=t[1]*e+t[5]*i+t[9]*n+t[13],t[14]=t[2]*e+t[6]*i+t[10]*n+t[14],t[15]=t[3]*e+t[7]*i+t[11]*n+t[15]},d$=(t,e)=>{t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=e,t[5]*=e,t[6]*=e,t[7]*=e,t[8]*=e,t[9]*=e,t[10]*=e,t[11]*=e},u$=(t,e)=>{const i=Math.sin(e),n=Math.cos(e),r=t[4],o=t[5],a=t[6],s=t[7],l=t[8],c=t[9],d=t[10],u=t[11];t[4]=r*n+l*i,t[5]=o*n+c*i,t[6]=a*n+d*i,t[7]=s*n+u*i,t[8]=l*n-r*i,t[9]=c*n-o*i,t[10]=d*n-a*i,t[11]=u*n-s*i},p$=(t,e)=>{const i=Math.sin(e),n=Math.cos(e),r=t[0],o=t[1],a=t[2],s=t[3],l=t[8],c=t[9],d=t[10],u=t[11];t[0]=r*n-l*i,t[1]=o*n-c*i,t[2]=a*n-d*i,t[3]=s*n-u*i,t[8]=r*i+l*n,t[9]=o*i+c*n,t[10]=a*i+d*n,t[11]=s*i+u*n},h$=(t,e)=>{const i=Math.sin(e),n=Math.cos(e),r=t[0],o=t[1],a=t[2],s=t[3],l=t[4],c=t[5],d=t[6],u=t[7];t[0]=r*n+l*i,t[1]=o*n+c*i,t[2]=a*n+d*i,t[3]=s*n+u*i,t[4]=l*n-r*i,t[5]=c*n-o*i,t[6]=d*n-a*i,t[7]=u*n-s*i};var Av=t=>t*Math.PI/180,Ru=(t,e)=>Nh()?t.getContext("webgl2",e):t.getContext("webgl",e)||t.getContext("experimental-webgl",e);const Mp=(t,e)=>{const i=t.length;return e>=i?t[e%i]:e<0?t[e%i+i]:t[e]},Lv=(t,e,i,n)=>{const r=ot(i.x-e.x,i.y-e.y),o=ot(n.x-i.x,n.y-i.y),a=ot(e.x-n.x,e.y-n.y),s=ot(t.x-e.x,t.y-e.y),l=ot(t.x-i.x,t.y-i.y),c=ot(t.x-n.x,t.y-n.y),d=tu(r,s),u=tu(o,l),p=tu(a,c);return d<=0&&u<=0&&p<=0},zv=t=>{if(t.length<3)return[];if((b=>{const w=b.length;for(let S=0;S<w;S++){const C=Es(b[S],Mp(b,S+1));if(sy(C,b,{ignoreIdenticalLines:!0,breakOnIntersection:!0}))return!0}return!1})(t))return[];(b=>{let w,S,C,I,M,D=0;const T=b.length;for(w=0;w<T;w++)S=b[w],C=b[(w+1)%T],I=C.x-S.x,M=(C.y+S.y)/2,D+=I*M;return D})(t)<0&&t.reverse();const e=t.length,i=[...Array(e).keys()],n=[];let r,o,a,s,l,c,d,u,p,h,g,m,f=1024;for(;i.length>3;){if(f<=0)return[];for(f--,r=0;r<i.length;r++)if(a=i[r],s=Mp(i,r-1),l=Mp(i,r+1),c=t[a],d=t[s],u=t[l],p=ot(d.x-c.x,d.y-c.y),h=ot(u.x-c.x,u.y-c.y),!(tu(p,h)<0)){for(g=!0,o=0;o<e;o++)if(o!==a&&o!==s&&o!==l&&(m=t[o],Lv(m,d,c,u))){g=!1;break}if(g){n.push([d,c,u]),i.splice(r,1);break}}}return n.push([t[i[0]],t[i[1]],t[i[2]]]),n},m$=(t,e,i,n,r)=>{const o=ro(ot(n.x-i.x,n.y-i.y)),a=ro(ot(r.x-n.x,r.y-n.y)),s=ro(ot(o.x+a.x,o.y+a.y)),l=ot(-s.y,s.x),c=ot(-o.y,o.x),d=Math.min(1/Qd(l,c),5);t[e]=n.x,t[e+1]=n.y,t[e+2]=l.x*d,t[e+3]=l.y*d,t[e+4]=-1,t[e+5]=n.x,t[e+6]=n.y,t[e+7]=l.x*d,t[e+8]=l.y*d,t[e+9]=1},$$=t=>{const e=new Float32Array(8);return e[0]=t[3].x,e[1]=t[3].y,e[2]=t[0].x,e[3]=t[0].y,e[4]=t[2].x,e[5]=t[2].y,e[6]=t[1].x,e[7]=t[1].y,e},g$=(t,e=0,i,n)=>{const r=Oo(t),o=t.x+.5*t.width,a=t.y+.5*t.height;return(i||n)&&Al(r,i,n,o,a),e!==0&&rl(r,e,o,a),r},Hd=(t,e,i,n,r)=>{const o=Math.min(20,Math.max(4,Math.round(n/2)));let a=0,s=0,l=0,c=0,d=0;for(;d<o;d++)a=d/o,s=r*Wo+a*Wo,l=n*Math.cos(s),c=n*Math.sin(s),t.push(ot(e+l,i+c))};let jd=null;var jh=()=>{if(jd!==null)return jd;let t=xn("canvas");const e=Ru(t);return jd=e?e.getParameter(e.MAX_TEXTURE_SIZE):void 0,qn(t),t=void 0,jd},Uh=()=>Pr()&&!!window.chrome;const Cc=new Float32Array([0,1,0,0,1,1,1,0]),Fv=new Float32Array([1,0,0,0,1,1,0,1]),Dv=Pr()&&ya(),f$=[0,0,0,0,1,0,0,0,0],Bv=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],Pp=[0,0,0,0],Ov=[0,0,0,0],y$=(t,e,i,n,r)=>{if(!i||!n)return Cc;let o=n.x/i.width,a=n.y/i.height,s=t/i.width/r,l=e/i.height/r;return s-=o,l-=a,new Float32Array([-o,l,-o,-a,s,l,s,-a])};var Wv=(t,e={})=>{const{alpha:i=!1}=e,n={width:0,height:0},r={width:0,height:0},o=jh()||1024;let a,s,l;const c=Cp(),d=Cp();let u,p,h,g,m,f,b,w,S,C=0,I=0,M=0,D=1;const T=new Map([]),F=()=>{y.stencilOp(y.KEEP,y.KEEP,y.KEEP),y.stencilFunc(y.ALWAYS,1,255),y.stencilMask(255)},W=Av(30),O=Math.tan(W/2),y=Ru(t,{alpha:i,antialias:!1,premultipliedAlpha:!0,stencil:!0});if(!y)return;y.getExtension("OES_standard_derivatives"),y.disable(y.DEPTH_TEST),y.enable(y.STENCIL_TEST),y.enable(y.BLEND),y.blendFunc(y.ONE,y.ONE_MINUS_SRC_ALPHA),y.pixelStorei(y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!(!i&&ya())),F();const V=y.createTexture();y.bindTexture(y.TEXTURE_2D,V),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,1,1,0,y.RGBA,y.UNSIGNED_BYTE,new Uint8Array(Pp)),T.set(0,V);const tt=y.createTexture();T.set(2,tt);const k=y.createFramebuffer(),N=y.createTexture();T.set(1,N);const it=y.createFramebuffer(),ut=yc(y,`
##head
##text
void main(){vTexCoord=aTexCoord;gl_Position=uMatrix*aPosition;}`,`
##head
in vec2 vTexCoord;uniform sampler2D uTexture;uniform sampler2D uTextureOverlay;uniform sampler2D uTextureBlend;uniform vec2 uTextureSize;uniform float uOpacity;uniform int uAntialias;uniform vec4 uOverlayColor;uniform mat4 uColorMatrix;uniform vec4 uColorOffset;uniform float uClarityKernel[9];uniform float uClarityKernelWeight;uniform float uColorGamma;uniform float uColorVignette;uniform float uMaskClip;uniform float uMaskOpacity;uniform float uMaskBounds[4];uniform float uMaskCornerRadius[4];uniform float uMaskFeather[8];vec4 applyGamma(vec4 c,float g){c.r=pow(c.r,g);c.g=pow(c.g,g);c.b=pow(c.b,g);return c;}vec4 applyColorMatrix(vec4 c,mat4 m,vec4 o){return(c*m)+(o*c.a);}vec4 applyConvolutionMatrix(vec4 c,float k0,float k1,float k2,float k3,float k4,float k5,float k6,float k7,float k8,float w){vec2 pixel=vec2(1)/uTextureSize;vec4 colorSum=texture(uTexture,vTexCoord-pixel)*k0+texture(uTexture,vTexCoord+pixel*vec2(0.0,-1.0))*k1+texture(uTexture,vTexCoord+pixel*vec2(1.0,-1.0))*k2+texture(uTexture,vTexCoord+pixel*vec2(-1.0,0.0))*k3+texture(uTexture,vTexCoord)*k4+texture(uTexture,vTexCoord+pixel*vec2(1.0,0.0))*k5+texture(uTexture,vTexCoord+pixel*vec2(-1.0,1.0))*k6+texture(uTexture,vTexCoord+pixel*vec2(0.0,1.0))*k7+texture(uTexture,vTexCoord+pixel)*k8;vec4 color=vec4(clamp((colorSum/w),0.0,1.0).rgb,c.a);return color;}vec4 applyVignette(vec4 c,vec2 pos,vec2 center,float v){float d=distance(pos,center)/length(center);float f=1.0-(d*abs(v));if(v>0.0){c.rgb*=f;}else if(v<0.0){c.rgb+=(1.0-f)*(1.0-c.rgb);}return c;}vec4 blendPremultipliedAlpha(vec4 back,vec4 front){return front+(back*(1.0-front.a));}void main(){float x=gl_FragCoord.x;float y=gl_FragCoord.y;float a=1.0;float maskTop=uMaskBounds[0];float maskRight=uMaskBounds[1];float maskBottom=uMaskBounds[2];float maskLeft=uMaskBounds[3];float leftFeatherOpacity=step(uMaskFeather[1],x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],x));a*=leftFeatherOpacity*rightFeatherOpacity;float overlayColorAlpha=(smoothstep(maskLeft,maskLeft+1.0,x)*(1.0-smoothstep(maskRight-1.0,maskRight,x))*(1.0-step(maskTop,y))*step(maskBottom,y));if(uOverlayColor.a==0.0){a*=overlayColorAlpha;}vec2 offset=vec2(maskLeft,maskBottom);vec2 size=vec2(maskRight-maskLeft,maskTop-maskBottom)*.5;vec2 center=offset.xy+size.xy;int pixelX=int(step(center.x,x));int pixelY=int(step(y,center.y));float cornerRadius=0.0;if(pixelX==0&&pixelY==0)cornerRadius=uMaskCornerRadius[0];if(pixelX==1&&pixelY==0)cornerRadius=uMaskCornerRadius[1];if(pixelX==0&&pixelY==1)cornerRadius=uMaskCornerRadius[2];if(pixelX==1&&pixelY==1)cornerRadius=uMaskCornerRadius[3];float cornerOffset=sign(cornerRadius)*length(max(abs(gl_FragCoord.xy-size-offset)-size+cornerRadius,0.0))-cornerRadius;float cornerOpacity=1.0-smoothstep(0.0,1.0,cornerOffset);a*=cornerOpacity;if(uAntialias==1){vec2 scaledPoint=vec2(vTexCoord.x*uTextureSize.x,vTexCoord.y*uTextureSize.y);a*=smoothstep(0.0,1.0,uTextureSize.x-scaledPoint.x);a*=smoothstep(0.0,1.0,uTextureSize.y-scaledPoint.y);a*=smoothstep(0.0,1.0,scaledPoint.x);a*=smoothstep(0.0,1.0,scaledPoint.y);}vec4 color=texture(uTexture,vTexCoord);if(uClarityKernelWeight!=-1.0){color=applyConvolutionMatrix(color,uClarityKernel[0],uClarityKernel[1],uClarityKernel[2],uClarityKernel[3],uClarityKernel[4],uClarityKernel[5],uClarityKernel[6],uClarityKernel[7],uClarityKernel[8],uClarityKernelWeight);}color=blendPremultipliedAlpha(color,texture(uTextureBlend,vTexCoord));color=applyGamma(color,uColorGamma);color=applyColorMatrix(color,uColorMatrix,uColorOffset);color*=a;if(uColorVignette!=0.0){vec2 pos=gl_FragCoord.xy-offset;color=applyVignette(color,pos,center-offset,uColorVignette);}color=blendPremultipliedAlpha(color,texture(uTextureOverlay,vTexCoord));if(overlayColorAlpha<=0.0){color*=1.0-uOverlayColor.a;}color*=uOpacity;fragColor=color;}`,["aPosition","aTexCoord"],["uMatrix","uTexture","uTextureBlend","uTextureOverlay","uTextureSize","uColorGamma","uColorVignette","uColorOffset","uColorMatrix","uClarityKernel","uClarityKernelWeight","uOpacity","uMaskOpacity","uMaskBounds","uMaskCornerRadius","uMaskFeather","uOverlayColor","uAntialias"]),at=y.createBuffer(),gt=y.createBuffer();y.bindBuffer(y.ARRAY_BUFFER,gt),y.bufferData(y.ARRAY_BUFFER,Cc,y.STATIC_DRAW);const G=y.createBuffer();y.bindBuffer(y.ARRAY_BUFFER,G),y.bufferData(y.ARRAY_BUFFER,Fv,y.STATIC_DRAW);const $t=yc(y,`#version 300 es

in vec4 aPosition;in vec2 aNormal;in float aMiter;out vec2 vNormal;out float vMiter;out float vWidth;uniform float uWidth;uniform float uSharpness;uniform mat4 uMatrix;void main(){vMiter=aMiter;vNormal=aNormal;vWidth=(uWidth*.5)+uSharpness;gl_Position=uMatrix*vec4(aPosition.x+(aNormal.x*vWidth*aMiter),aPosition.y+(aNormal.y*vWidth*aMiter),0,1);}`,`
##head
##mask
in vec2 vNormal;in float vMiter;in float vWidth;uniform float uWidth;uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);if(m<=0.0)discard;fillColor.a*=clamp(smoothstep(vWidth-.5,vWidth-1.0,abs(vMiter)*vWidth),0.0,1.0);fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}`,["aPosition","aNormal","aMiter"],["uColor","uCanvasColor","uMatrix","uWidth","uSharpness","uMaskBounds","uMaskOpacity"]),vt=y.createBuffer();Uh()&&(y.bindBuffer(y.ARRAY_BUFFER,vt),y.bufferData(y.ARRAY_BUFFER,1,y.DYNAMIC_DRAW));const lt=(dt,Jt,se,ee=!1)=>{const{program:be,locations:ve}=$t;y.useProgram(be),y.enableVertexAttribArray(ve.aPosition),y.enableVertexAttribArray(ve.aNormal),y.enableVertexAttribArray(ve.aMiter);const _=((Ot,ze)=>{let Re,Oe,di,bt=0;const le=Ot.length,Xe=new Float32Array(10*(ze?le+1:le)),Ve=Ot[0],At=Ot[le-1];for(bt=0;bt<le;bt++)Re=Ot[bt-1],Oe=Ot[bt],di=Ot[bt+1],Re||(Re=ze?At:ot(Oe.x+(Oe.x-di.x),Oe.y+(Oe.y-di.y))),di||(di=ze?Ve:ot(Oe.x+(Oe.x-Re.x),Oe.y+(Oe.y-Re.y))),m$(Xe,10*bt,Re,Oe,di);return ze&&m$(Xe,10*le,At,Ve,Ot[1]),Xe})(dt,ee),ke=5*Float32Array.BYTES_PER_ELEMENT,fi=2*Float32Array.BYTES_PER_ELEMENT,ye=4*Float32Array.BYTES_PER_ELEMENT;y.uniform1f(ve.uWidth,Jt),y.uniform1f(ve.uSharpness,l),y.uniform4fv(ve.uColor,se),y.uniformMatrix4fv(ve.uMatrix,!1,u),y.uniform4f(ve.uCanvasColor,C,I,M,D),y.uniform1fv(ve.uMaskBounds,b),y.uniform1f(ve.uMaskOpacity,f),y.bindBuffer(y.ARRAY_BUFFER,vt),y.bufferData(y.ARRAY_BUFFER,_,y.STATIC_DRAW),y.vertexAttribPointer(ve.aPosition,2,y.FLOAT,!1,ke,0),y.vertexAttribPointer(ve.aNormal,2,y.FLOAT,!1,ke,fi),y.vertexAttribPointer(ve.aMiter,1,y.FLOAT,!1,ke,ye),y.drawArrays(y.TRIANGLE_STRIP,0,_.length/5),y.disableVertexAttribArray(ve.aPosition),y.disableVertexAttribArray(ve.aNormal),y.disableVertexAttribArray(ve.aMiter)},kt=yc(y,`
##head
void main(){
##matrix
}`,`
##head
##mask
uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;
##maskapply
fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}`,["aPosition"],["uColor","uCanvasColor","uMatrix","uMaskBounds","uMaskOpacity"]),J=y.createBuffer(),q=yc(y,`
##head
##text
in vec2 aRectCoord;out vec2 vRectCoord;void main(){vTexCoord=aTexCoord;vRectCoord=aRectCoord;
##matrix
}`,`
##head
##mask
in vec2 vTexCoord;in vec2 vRectCoord;uniform sampler2D uTexture;uniform vec4 uTextureColor;uniform float uTextureOpacity;uniform vec2 uRepeat;uniform vec4 uColor;uniform float uCornerRadius[4];uniform vec2 uSize;uniform vec2 uPosition;uniform vec4 uCanvasColor;uniform int uInverted;uniform float uEdgeFeather;void main(){
##init
##colorize
##rectaa
##cornerradius
##maskfeatherapply
if(uInverted==1)a=1.0-a;
##maskapply
##fragcolor
}`,["aPosition","aTexCoord","aRectCoord"],["uTexture","uColor","uMatrix","uCanvasColor","uTextureColor","uTextureOpacity","uRepeat","uPosition","uSize","uMaskBounds","uMaskOpacity","uMaskFeather","uCornerRadius","uInverted","uEdgeFeather"]),Z=y.createBuffer(),xt=y.createBuffer(),nt=y.createBuffer(),mt=yc(y,`
##head
##text
out vec2 vTexCoordDouble;void main(){vTexCoordDouble=vec2(aTexCoord.x*2.0-1.0,aTexCoord.y*2.0-1.0);vTexCoord=aTexCoord;
##matrix
}`,`
##head
##mask
in vec2 vTexCoord;in vec2 vTexCoordDouble;uniform sampler2D uTexture;uniform float uTextureOpacity;uniform vec2 uRepeat;uniform vec2 uRadius;uniform vec4 uColor;uniform int uInverted;uniform vec4 uCanvasColor;void main(){
##init
float ar=uRadius.x/uRadius.y;vec2 rAA=vec2(uRadius.x-1.0,uRadius.y-(1.0/ar));vec2 scaledPointSq=vec2((vTexCoordDouble.x*uRadius.x)*(vTexCoordDouble.x*uRadius.x),(vTexCoordDouble.y*uRadius.y)*(vTexCoordDouble.y*uRadius.y));float p=(scaledPointSq.x/(uRadius.x*uRadius.x))+(scaledPointSq.y/(uRadius.y*uRadius.y));float pAA=(scaledPointSq.x/(rAA.x*rAA.x))+(scaledPointSq.y/(rAA.y*rAA.y));a=smoothstep(1.0,p/pAA,p);if(uInverted==1)a=1.0-a;
##maskapply
##fragcolor
}`,["aPosition","aTexCoord"],["uTexture","uTextureOpacity","uRepeat","uColor","uCanvasColor","uMatrix","uRadius","uInverted","uMaskBounds","uMaskOpacity"]),zt=y.createBuffer(),oe=y.createBuffer(),Dt=new Map,te={2:{width:0,height:0},1:{width:0,height:0}},Kt=(dt,Jt,se,ee=1)=>{const be=Math.min(Math.min(4096,o)/se.width,Math.min(4096,o)/se.height,ee),ve=Math.floor(be*se.width),_=Math.floor(be*se.height);zc(se,te[dt])?y.bindFramebuffer(y.FRAMEBUFFER,Jt):(y.bindTexture(y.TEXTURE_2D,T.get(dt)),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,ve,_,0,y.RGBA,y.UNSIGNED_BYTE,null),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.bindFramebuffer(y.FRAMEBUFFER,Jt),y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,T.get(dt),0),te[dt]=se);const ke=se.width*s,fi=se.height*s;var ye,Ot;Tp(d,0,ke,fi,0,-1,1),Js(d,0,fi,0),Ot=1,(ye=d)[0]*=Ot,ye[1]*=Ot,ye[2]*=Ot,ye[3]*=Ot,((ze,Re)=>{ze[4]*=Re,ze[5]*=Re,ze[6]*=Re,ze[7]*=Re})(d,-1),u=d,y.viewport(0,0,ve,_),y.colorMask(!0,!0,!0,!0),y.clearColor(0,0,0,0),y.clear(y.COLOR_BUFFER_BIT),S=[1,0,1,0,1,Math.max(n.width,se.width),1,Math.max(n.width,se.width)]},U=(dt,Jt)=>{const{forceRelease:se=!1}=Jt||{},{src:ee}=Dt.get(dt);ee instanceof HTMLCanvasElement&&(se||ee.dataset.retain||qn(ee)),Dt.delete(dt),y.deleteTexture(dt)},Tt=dt=>Dt.get(dt).isRotatedVideo;return{drawPath:(dt,Jt=0,se=!1,ee=!1,be,ve,_,ke,fi)=>{if(dt.length<2)return;const ye=dt.map(Oe=>({x:Oe.x*s,y:Oe.y*s})),Ot=be*s;if(Ot>0&&lt(ye,Ot,Ks(ve,fi),_),ye.length<3||!ke||ke[3]===0||!_)return;const ze=zv(ye),Re=new Float32Array(6*ze.length);ze.forEach(([Oe,di,bt],le)=>{const Xe=6*le;Re[Xe+0]=Oe.x,Re[Xe+1]=Oe.y,Re[Xe+2]=di.x,Re[Xe+3]=di.y,Re[Xe+4]=bt.x,Re[Xe+5]=bt.y}),((Oe,di)=>{const{program:bt,locations:le}=kt;y.useProgram(bt),y.enableVertexAttribArray(le.aPosition),y.uniform4fv(le.uColor,di),y.uniformMatrix4fv(le.uMatrix,!1,u),y.uniform1fv(le.uMaskBounds,b),y.uniform1f(le.uMaskOpacity,f),y.uniform4f(le.uCanvasColor,C,I,M,D),y.bindBuffer(y.ARRAY_BUFFER,J),y.bufferData(y.ARRAY_BUFFER,Oe,y.STATIC_DRAW),y.vertexAttribPointer(le.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLES,0,Oe.length/2),y.disableVertexAttribArray(le.aPosition)})(Re,Ks(ke,fi))},drawRect:(dt,Jt=0,se=!1,ee=!1,be,ve,_,ke,fi,ye=!1,Ot,ze,Re,Oe,di,bt=1/s,le,Xe)=>{const Ve=ks(Si(dt),s),At=be.map(Ge=>((Ye,$i)=>Math.floor(tn(Ye,0,Math.min(.5*($i.width-1),.5*($i.height-1)))))(Ge||0,dt)).map(Ge=>Ge*s);if(ve||_){const Ge=Si(Ve);Ge.x-=.5,Ge.y-=.5,Ge.width+=1,Ge.height+=1;const Ye=g$(Ge,Jt,se,ee),$i=$$(Ye);let bi;le&&(bi=Ks(le),bi[3]===0&&(bi[3]=.001));const Mi=ke&&ye?[Ge.width/ke.width,Ge.height/ke.height]:[1,1];((Ci,X,Gt,H,Zt,ae=V,jt,$e=1,Xt=Pp,Le=Cc,qe=S,Ne=1,pt)=>{const{program:Ht,locations:ie}=q;y.useProgram(Ht),y.enableVertexAttribArray(ie.aPosition),y.enableVertexAttribArray(ie.aTexCoord),y.enableVertexAttribArray(ie.aRectCoord),y.uniform4fv(ie.uColor,Zt),y.uniform2fv(ie.uSize,[X,Gt]),y.uniform2fv(ie.uPosition,[Ci[2],Ci[3]]),y.uniform2fv(ie.uRepeat,jt),y.uniform1i(ie.uInverted,pt?1:0),y.uniform1fv(ie.uCornerRadius,H),y.uniform4f(ie.uCanvasColor,C,I,M,D),y.uniform1fv(ie.uMaskFeather,qe.map((Fe,Wt)=>Wt%2==0?Fe:Fe*s)),y.uniform1fv(ie.uMaskBounds,b),y.uniform1f(ie.uMaskOpacity,f),y.uniform1f(ie.uEdgeFeather,Math.max(0,Ne)),y.uniformMatrix4fv(ie.uMatrix,!1,u),y.uniform1i(ie.uTexture,4),y.uniform4fv(ie.uTextureColor,Xt),y.uniform1f(ie.uTextureOpacity,$e),y.activeTexture(y.TEXTURE0+4),y.bindTexture(y.TEXTURE_2D,ae),y.bindBuffer(y.ARRAY_BUFFER,xt),y.bufferData(y.ARRAY_BUFFER,Le,y.STATIC_DRAW),y.vertexAttribPointer(ie.aTexCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,nt),y.bufferData(y.ARRAY_BUFFER,Cc,y.STATIC_DRAW),y.vertexAttribPointer(ie.aRectCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,Z),y.bufferData(y.ARRAY_BUFFER,Ci,y.STATIC_DRAW),y.vertexAttribPointer(ie.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLE_STRIP,0,Ci.length/2),y.disableVertexAttribArray(ie.aPosition),y.disableVertexAttribArray(ie.aTexCoord),y.disableVertexAttribArray(ie.aRectCoord)})($i,Ge.width,Ge.height,At,Ks(ve,Oe),_,Mi,Oe,bi,Ot?new Float32Array(Ot):y$(Ge.width,Ge.height,ke,fi,s),di,bt*s,Xe)}ze&&(ze=Math.min(ze,Ve.width,Ve.height),lt(((Ge,Ye,$i,bi,Mi,Ci,X,Gt)=>{const H=[];if(Ci.every(Zt=>Zt===0))H.push(ot(Ge,Ye),ot(Ge+$i,Ye),ot(Ge+$i,Ye+bi),ot(Ge,Ye+bi));else{const[Zt,ae,jt,$e]=Ci,Xt=Ge,Le=Ge+$i,qe=Ye,Ne=Ye+bi;H.push(ot(Xt+Zt,qe)),Hd(H,Le-ae,qe+ae,ae,-1),H.push(ot(Le,qe+ae)),Hd(H,Le-$e,Ne-$e,$e,0),H.push(ot(Le-$e,Ne)),Hd(H,Xt+jt,Ne-jt,jt,1),H.push(ot(Xt,Ne-jt)),Hd(H,Xt+Zt,qe+Zt,Zt,2)}return(X||Gt)&&Al(H,X,Gt,Ge+.5*$i,Ye+.5*bi),Mi&&rl(H,Mi,Ge+.5*$i,Ye+.5*bi),H})(Ve.x,Ve.y,Ve.width,Ve.height,Jt,At,se,ee),ze*s,Ks(Re,Oe),!0))},drawEllipse:(dt,Jt,se,ee,be,ve,_,ke,fi,ye,Ot,ze,Re,Oe,di)=>{const bt=ks(Pn(dt.x-Jt,dt.y-se,2*Jt,2*se),s);if(_||ke){const le=Si(bt);le.x-=.5,le.y-=.5,le.width+=1,le.height+=1;const Xe=g$(le,ee,be,ve);((Ve,At,Ge,Ye,$i=V,bi=Cc,Mi=1,Ci=!1)=>{const{program:X,locations:Gt}=mt;y.useProgram(X),y.enableVertexAttribArray(Gt.aPosition),y.enableVertexAttribArray(Gt.aTexCoord),y.uniformMatrix4fv(Gt.uMatrix,!1,u),y.uniform2fv(Gt.uRadius,[.5*At,.5*Ge]),y.uniform1i(Gt.uInverted,Ci?1:0),y.uniform4fv(Gt.uColor,Ye),y.uniform4f(Gt.uCanvasColor,C,I,M,D),y.uniform2fv(Gt.uRepeat,[1,1]),y.uniform1fv(Gt.uMaskBounds,b),y.uniform1f(Gt.uMaskOpacity,f),y.uniform1i(Gt.uTexture,4),y.uniform1f(Gt.uTextureOpacity,Mi),y.activeTexture(y.TEXTURE0+4),y.bindTexture(y.TEXTURE_2D,$i),y.bindBuffer(y.ARRAY_BUFFER,oe),y.bufferData(y.ARRAY_BUFFER,bi,y.STATIC_DRAW),y.vertexAttribPointer(Gt.aTexCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,zt),y.bufferData(y.ARRAY_BUFFER,Ve,y.STATIC_DRAW),y.vertexAttribPointer(Gt.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLE_STRIP,0,Ve.length/2),y.disableVertexAttribArray(Gt.aPosition),y.disableVertexAttribArray(Gt.aTexCoord)})($$(Xe),le.width,le.height,Ks(_,Oe),ke,Ot?new Float32Array(Ot):y$(le.width,le.height,fi,ye,s),Oe,di)}ze&&lt(((le,Xe,Ve,At,Ge,Ye,$i)=>{const bi=.5*Math.abs(Ve),Mi=.5*Math.abs(At),Ci=Math.abs(Ve)+Math.abs(At),X=Math.max(20,Math.round(Ci/6));return uu(ot(le+bi,Xe+Mi),bi,Mi,Ge,Ye,$i,X)})(bt.x,bt.y,bt.width,bt.height,ee,be,ve),ze*s,Ks(Re,Oe),!0)},drawImage:(dt,Jt,se,ee,be,ve,_,ke,fi,ye,Ot=Bv,ze=1,Re,Oe=1,di=0,bt=w,le=Ov,Xe=Pp,Ve=!1,At=!1,Ge=!0)=>{const Ye=Jt.width*s,$i=Jt.height*s,bi=-.5*Ye,Mi=.5*$i,Ci=.5*Ye,X=-.5*$i,Gt=new Float32Array([bi,X,0,bi,Mi,0,Ci,X,0,Ci,Mi,0]);y.bindBuffer(y.ARRAY_BUFFER,at),y.bufferData(y.ARRAY_BUFFER,Gt,y.STATIC_DRAW);const H=Jt.height/2/O*(n.height/Jt.height)*-1;be*=s,ve*=s,se*=s,ee*=s;const{program:Zt,locations:ae}=ut,jt=Cp();((Ht,ie,Fe,Wt,K)=>{const Yt=1/Math.tan(ie/2),Ut=1/(Wt-K);Ht[0]=Yt/Fe,Ht[1]=0,Ht[2]=0,Ht[3]=0,Ht[4]=0,Ht[5]=Yt,Ht[6]=0,Ht[7]=0,Ht[8]=0,Ht[9]=0,Ht[10]=(K+Wt)*Ut,Ht[11]=-1,Ht[12]=0,Ht[13]=0,Ht[14]=2*K*Wt*Ut,Ht[15]=0})(jt,W,a,1,2*-H),Js(jt,be,-ve,H),Js(jt,se,-ee,0),h$(jt,-fi),d$(jt,ye),Js(jt,-se,ee,0),p$(jt,ke),u$(jt,_),y.useProgram(Zt),y.enableVertexAttribArray(ae.aPosition),y.enableVertexAttribArray(ae.aTexCoord),y.uniform1i(ae.uTexture,3),y.uniform2f(ae.uTextureSize,Jt.width,Jt.height),y.activeTexture(y.TEXTURE0+3),y.bindTexture(y.TEXTURE_2D,dt);const $e=At?1:0,Xt=T.get($e);y.uniform1i(ae.uTextureBlend,$e),y.activeTexture(y.TEXTURE0+$e),y.bindTexture(y.TEXTURE_2D,Xt);const Le=Ve?2:0,qe=T.get(Le);y.uniform1i(ae.uTextureOverlay,Le),y.activeTexture(y.TEXTURE0+Le),y.bindTexture(y.TEXTURE_2D,qe),y.bindBuffer(y.ARRAY_BUFFER,at),y.vertexAttribPointer(ae.aPosition,3,y.FLOAT,!1,0,0);const Ne=Dv&&Tt(dt);let pt;y.bindBuffer(y.ARRAY_BUFFER,Ne?G:gt),y.vertexAttribPointer(ae.aTexCoord,2,y.FLOAT,!1,0,0),y.uniformMatrix4fv(ae.uMatrix,!1,jt),y.uniform4fv(ae.uOverlayColor,Xe),!Re||os(Re,f$)?(Re=f$,pt=-1):(pt=Re.reduce((Ht,ie)=>Ht+ie,0),pt=pt<=0?1:pt),y.uniform1fv(ae.uClarityKernel,Re),y.uniform1f(ae.uClarityKernelWeight,pt),y.uniform1f(ae.uColorGamma,1/Oe),y.uniform1f(ae.uColorVignette,di),y.uniform1i(ae.uAntialias,Ge?1:0),y.uniform4f(ae.uColorOffset,Ot[4],Ot[9],Ot[14],Ot[19]),y.uniformMatrix4fv(ae.uColorMatrix,!1,[Ot[0],Ot[1],Ot[2],Ot[3],Ot[5],Ot[6],Ot[7],Ot[8],Ot[10],Ot[11],Ot[12],Ot[13],Ot[15],Ot[16],Ot[17],Ot[18]]),y.uniform1f(ae.uOpacity,ze),y.uniform1f(ae.uMaskOpacity,f),y.uniform1fv(ae.uMaskBounds,b),y.uniform1fv(ae.uMaskCornerRadius,le.map(Ht=>Ht*s)),y.uniform1fv(ae.uMaskFeather,bt.map((Ht,ie)=>ie%2==0?Ht:Ht*s)),y.drawArrays(y.TRIANGLE_STRIP,0,4),y.disableVertexAttribArray(ae.aPosition),y.disableVertexAttribArray(ae.aTexCoord)},textureFilterNearest:y.NEAREST,textureFilterLinear:y.LINEAR,textureClamp:y.CLAMP_TO_EDGE,textureRepeat:y.REPEAT,textureCreate:()=>y.createTexture(),textureUpdate:(dt,Jt,se)=>(Dt.set(dt,{src:Jt,options:se,isRotatedVideo:Jt.nodeName==="VIDEO"&&(Jt.dataset&&Jt.dataset.rotation==90||Jt.dataset.rotation==270)}),Ev(y,dt,Jt,se)),textureGetSize:dt=>{const{src:Jt,options:se}=Dt.get(dt),ee=Aa(Jt);return se.scalar?is(ee,be=>be/se.scalar):ee},textureDelete:U,enablePreviewStencil:()=>{y.stencilOp(y.KEEP,y.KEEP,y.REPLACE),y.stencilFunc(y.ALWAYS,1,255),y.stencilMask(255)},applyPreviewStencil:()=>{y.stencilFunc(y.EQUAL,1,255),y.stencilMask(0)},disablePreviewStencil:F,setCanvasColor(dt){C=dt[0],I=dt[1],M=dt[2],D=i?dt[3]:1,y.clear(y.COLOR_BUFFER_BIT)},resetCanvasMatrix:()=>{Tp(c,0,n.width,n.height,0,-1,1)},updateCanvasMatrix(dt,Jt,se,ee,be){const ve=dt.width,_=dt.height,ke=n.width*(.5/s),fi=n.height*(.5/s),ye={x:ke+(se.x+Jt.x),y:fi+(se.y+Jt.y)},Ot={x:ye.x-Jt.x,y:ye.y-Jt.y},ze=.5*ve,Re=.5*_;Dr(Ot,be.z,ye),nb(Ot,ee,ye),Js(c,(Ot.x-ze)*s,(Ot.y-Re)*s,0),Js(c,ze*s,Re*s,0),h$(c,be.z);const Oe=be.x>Math.PI/2;u$(c,Oe?Math.PI:0);const di=be.y>Math.PI/2;p$(c,di?Math.PI:0),d$(c,ee),Js(c,-ze*s,-Re*s,0)},drawToCanvas(){y.bindFramebuffer(y.FRAMEBUFFER,null),u=c,y.viewport(0,0,y.drawingBufferWidth,y.drawingBufferHeight),y.colorMask(!0,!0,!0,!0),y.clearColor(C,I,M,D),y.clear(y.COLOR_BUFFER_BIT),S=[1,0,1,0,1,n.width,1,n.width]},drawToImageBlendBuffer(dt,Jt){Kt(1,it,dt,Jt)},drawToImageOverlayBuffer(dt,Jt){Kt(2,k,dt,Jt)},enableMask(dt,Jt){const se=dt.x*s,ee=dt.y*s,be=dt.width*s,ve=dt.height*s;m=se,h=m+be,p=n.height-ee,g=n.height-(ee+ve),f=1-Jt,b=[p,h,g,m]},disableMask(){m=0,h=n.width,p=n.height,g=0,f=1,b=[p,h,g,m]},resize:(dt,Jt,se)=>{s=Math.max(1,se),l=s===1?.75:1,r.width=dt,r.height=Jt,n.width=dt*s,n.height=Jt*s,a=qo(n.width,n.height),t.width=n.width,t.height=n.height,Tp(c,0,n.width,n.height,0,-1,1),w=[1,0,1,0,1,r.width,1,r.width]},release(){Array.from(Dt.keys()).forEach(dt=>U(dt,{forceRelease:!0})),Dt.clear(),T.forEach(dt=>{y.deleteTexture(dt)}),T.clear(),ut.destroy(),$t.destroy(),kt.destroy(),q.destroy(),mt.destroy(),t.width=1,t.height=1,t=void 0}}},_v=(t,e)=>{const{imageData:i,amount:n=1}=t,r=Math.round(2*Math.max(1,n)),o=Math.round(.5*r),a=i.width,s=i.height,l=new Uint8ClampedArray(a*s*4),c=i.data;let d,u,p,h,g,m=0,f=0,b=0;const w=a*s*4-4;for(p=0;p<s;p++)for(d=crypto.getRandomValues(new Uint8ClampedArray(s)),u=0;u<a;u++)h=d[p]/255,f=0,b=0,h<.5&&(f=4*(-o+Math.round(Math.random()*r))),h>.5&&(b=(-o+Math.round(Math.random()*r))*(4*a)),g=Math.min(Math.max(0,m+f+b),w),l[m]=c[g],l[m+1]=c[g+1],l[m+2]=c[g+2],l[m+3]=c[g+3],m+=4;e(null,{data:l,width:i.width,height:i.height})};const Vv=[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625];function Nv(t){return Math.sqrt(1- --t*t)}function x$(t){return Object.prototype.toString.call(t)==="[object Date]"}function nh(t,e){if(t===e||t!=t)return()=>t;const i=typeof t;if(i!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const n=e.map((r,o)=>nh(t[o],r));return r=>n.map(o=>o(r))}if(i==="object"){if(!t||!e)throw new Error("Object cannot be null");if(x$(t)&&x$(e)){t=t.getTime();const o=(e=e.getTime())-t;return a=>new Date(t+a*o)}const n=Object.keys(e),r={};return n.forEach(o=>{r[o]=nh(t[o],e[o])}),o=>{const a={};return n.forEach(s=>{a[s]=r[s](o)}),a}}if(i==="number"){const n=e-t;return r=>t+r*n}throw new Error(`Cannot interpolate ${i} values`)}function Gh(t,e={}){const i=ue(t);let n,r=t;function o(a,s){if(t==null)return i.set(t=a),Promise.resolve();r=a;let l=n,c=!1,{delay:d=0,duration:u=400,easing:p=Oy,interpolate:h=nh}=Cn(Cn({},e),s);if(u===0)return l&&(l.abort(),l=null),i.set(t=r),Promise.resolve();const g=Ny()+d;let m;return n=Oh(f=>{if(f<g)return!0;c||(m=h(t,a),typeof u=="function"&&(u=u(t,a)),c=!0),l&&(l.abort(),l=null);const b=f-g;return b>u?(i.set(t=a),!1):(i.set(t=m(p(b/u))),!0)}),n.promise}return{set:o,update:(a,s)=>o(a(r,t),s),subscribe:i.subscribe}}function rh(t,e,i,n){if(typeof i=="number"){const r=n-i,o=(i-e)/(t.dt||1/60),a=(o+(t.opts.stiffness*r-t.opts.damping*o)*t.inv_mass)*t.dt;return Math.abs(a)<t.opts.precision&&Math.abs(r)<t.opts.precision?n:(t.settled=!1,i+a)}if(Rn(i))return i.map((r,o)=>rh(t,e[o],i[o],n[o]));if(typeof i=="object"){const r={};for(const o in i)r[o]=rh(t,e[o],i[o],n[o]);return r}throw new Error(`Cannot spring ${typeof i} values`)}function pi(t,e={}){const i=ue(t),{stiffness:n=.15,damping:r=.8,precision:o=.01}=e;let a,s,l,c=t,d=t,u=1,p=0,h=!1;function g(f,b={}){d=f;const w=l={};if(t==null||b.hard||m.stiffness>=1&&m.damping>=1)return h=!0,a=null,c=f,i.set(t=d),Promise.resolve();if(b.soft&&(p=1/(60*(b.soft===!0?.5:+b.soft)),u=0),!s){a=null,h=!1;const S={inv_mass:void 0,opts:m,settled:!0,dt:void 0};s=Oh(C=>{if(a===null&&(a=C),h)return h=!1,s=null,!1;u=Math.min(u+p,1),S.inv_mass=u,S.opts=m,S.settled=!0,S.dt=60*(C-a)/1e3;const I=rh(S,c,t,d);return a=C,c=t,i.set(t=I),S.settled&&(s=null),!S.settled})}return new Promise(S=>{s.promise.then(()=>{w===l&&S()})})}const m={set:g,update:(f,b)=>g(f(d,t),b),subscribe:i.subscribe,stiffness:n,damping:r,precision:o};return m}var Hv=Rl(!1,t=>{const e=window.matchMedia("(prefers-reduced-motion:reduce)"),i=()=>t(e.matches);return i(),e.addListener(i),()=>e.removeListener(i)}),b$=()=>"ResizeObserver"in window;const Rp=Ss(),f2=(t,e,i,n,r)=>{t.rect||(t.rect=Ss());const o=t.rect;ry(Rp,e,i,n,r),Qo(o,Rp)||(ku(o,Rp),t.dispatchEvent(new CustomEvent("measure",{detail:o})))},Ud=Math.round,jv=t=>{const e=t.getBoundingClientRect();$a&&f2(t,Ud(e.x),Ud(e.y),Ud(e.width),Ud(e.height))},Ip=t=>{$a&&f2(t,t.offsetLeft,t.offsetTop,t.offsetWidth,t.offsetHeight)},Ec=[];let Qs,ma,$a;function oh(){Ec.length?(Ec.forEach(t=>t.measure(t)),$a=requestAnimationFrame(oh)):$a=void 0}let Gd=new Map([]),xc=0,Ep=0;var yr=(t,e={})=>{const{observePosition:i=!1,observeViewRect:n=!1,once:r=!1,disabled:o=!1,isMeasureRoot:a=!1}=e;if(b$()&&a&&(ma||(ma=new ResizeObserver(s=>{s.forEach(c=>{Gd.set(c.target,c.contentRect)});const l=Array.from(Gd.values()).some(({width:c,height:d})=>c>0&&d>0);l?l&&$a===!1&&oh():($a&&cancelAnimationFrame($a),$a=!1)})),ma.observe(t),xc++),!o)return!b$()||i||n?(t.measure=n?jv:Ip,Ec.push(t),$a===void 0&&($a=requestAnimationFrame(oh)),t.measure(t),{destroy(){a&&ma&&(Gd.delete(t),ma.unobserve(t),xc--,xc===0&&(ma.disconnect(),ma=void 0));const s=Ec.indexOf(t);Ec.splice(s,1),delete t.measure}}):(Qs||(Qs=new ResizeObserver(s=>{s.forEach(l=>{$a&&Ip(l.target)})})),Qs.observe(t),Ip(t),r?Qs.unobserve(t):Ep++,{destroy(){a&&ma&&(Gd.delete(t),ma.unobserve(t),xc--,xc===0&&(ma.disconnect(),ma=void 0)),r||(Qs.unobserve(t),Ep--,Ep===0&&(Qs.disconnect(),Qs=void 0))}})},Uv=t=>{let e=!1;const i={pointerdown:()=>{e=!1},keydown:()=>{e=!0},keyup:()=>{e=!1},focus:n=>{e&&(n.target.dataset.focusVisible="")},blur:n=>{delete n.target.dataset.focusVisible}};return Object.keys(i).forEach(n=>t.addEventListener(n,i[n],!0)),{destroy(){Object.keys(i).forEach(n=>t.removeEventListener(n,i[n],!0))}}};const Gv=async t=>new Promise(e=>{if(t.kind==="file")return e(t.getAsFile());t.getAsString(e)});var y2=(t,e={})=>{const i=r=>{r.preventDefault()},n=async r=>{r.preventDefault(),r.stopPropagation();try{const o=await(a=>new Promise((s,l)=>{const{items:c}=a.dataTransfer;if(!c)return s([]);Promise.all(Array.from(c).map(Gv)).then(d=>{s(d.filter(u=>Ol(u)&&Cu(u)||/^http/.test(u)))}).catch(l)}))(r);t.dispatchEvent(new CustomEvent("dropfiles",{detail:{event:r,resources:o},...e}))}catch{}};return t.addEventListener("drop",n),t.addEventListener("dragover",i),{destroy(){t.removeEventListener("drop",n),t.removeEventListener("dragover",i)}}};let Zd=null;var Zh=()=>{if(Zd===null)if(Pr()){const t=xn("canvas");Zd=!Ru(t,{failIfMajorPerformanceCaveat:!0}),qn(t)}else Zd=!1;return Zd},Ap=t=>t instanceof WebGLTexture,v$=([t,e,i,n])=>[n.x,n.y,t.x,t.y,i.x,i.y,e.x,e.y];function Zv(t){let e,i,n,r;return{c(){e=ht("div"),i=ht("canvas"),v(e,"class","PinturaCanvas")},m(o,a){et(o,e,a),Ct(e,i),t[37](i),n||(r=[Mt(i,"measure",t[38]),Xi(yr.call(null,i))],n=!0)},p:ni,i:ni,o:ni,d(o){o&&Q(e),t[37](null),n=!1,Ui(r)}}}function Xv(t,e,i){let n,r,o,a,s,l,c;const d=[0,0,0,0],u=rn(),p=Pr()&&(X=>{const Gt=.5*X,H=xn("canvas",{"data-retain":!0,width:X,height:X}),Zt=H.getContext("2d");return Zt.fillStyle="#f0f",Zt.fillRect(0,0,Gt,Gt),Zt.fillRect(Gt,Gt,Gt,Gt),H})(128),h=ba();let g,{isAnimated:m}=e,{isTransparent:f}=e,{maskRect:b}=e,{maskOpacity:w=1}=e,{maskFrameOpacity:S=.95}=e,{maskMarkupOpacity:C=1}=e,{clipAnnotationsToImage:I=!0}=e,{pixelRatio:M=1}=e,{textPixelRatio:D=M}=e,{backgroundColor:T}=e,{willRender:F=Ki}=e,{didRender:W=Ki}=e,{willRequest:O}=e,{csp:y}=e,{loadImageData:V=Ki}=e,{enableGrid:tt=!1}=e,{gridColors:k}=e,{gridSize:N}=e,{gridOpacity:it=0}=e,{images:ut=[]}=e,{interfaceImages:at=[]}=e,{selectionColor:gt}=e,G=null,$t=null,vt=null;const lt=(X,Gt)=>X.set(Gt,{hard:!m}),kt={precision:1e-4*.01};let J=0;const q=Gh(void 0,{duration:0});A(t,q,X=>i(36,c=X));const Z=pi(1,kt);A(t,Z,X=>i(35,s=X));const xt=pi(1,kt);A(t,xt,X=>i(51,o=X));const nt=ue();A(t,nt,X=>i(53,l=X));const mt=ue();A(t,mt,X=>i(52,a=X));const zt={},oe=(X,Gt)=>{let H=zt[X.id];const Zt=Math.min(1,2048/Gt.width);let ae=H?H.element:xn("canvas",{width:Gt.width*Zt,height:Gt.height*Zt,"data-retain":!0});if(!H||((jt,$e)=>{if(jt.total!==$e.length)return!0;const Xt=jt.last,Le=$e[$e.length-1];return Xt.drawMode!==Le.drawMode||!(!xo(Xt)||xo(Le)&&Qo(Xt,Le))||!(!Yn(Xt)||Yn(Le)&&Xt.x===Le.x&&Xt.y===Le.y&&Xt.rx===Le.rx&&Xt.ry===Le.ry)||!(!_n(Xt)||_n(Le)&&Le.points.length===Xt.points.length)})(H,X.actions)){ae=ae.cloneNode(),(($e,Xt,Le)=>{const{selectionColor:qe=[1,1,1],scalar:Ne=1}=Le||{};let pt=!1;for(const Ht of Xt){const ie=Ht.drawMode==="subtract";if(ie&&!pt)continue;$e.globalCompositeOperation=ie?"destination-out":"source-over",$e.save(),$e.beginPath();const Fe=Ly(Ht);fy($e,Ne,Ne),Mh($e,Ht.rotation,Fe),Fy($e,Ht.flipX,Ht.flipY,Fe),Ht.width?Lh($e,{...Ht,backgroundColor:qe}):Ht.points?Qp($e,Object.assign({},Ht,Ht.pathClose?{backgroundColor:qe,strokeColor:[0,0,0,0]}:{strokeColor:qe,strokeJoin:"round",strokeCap:"round"})):Ht.rx&&zh($e,{...Ht,backgroundColor:qe,strokeColor:[0,0,0,0],strokeJoin:"round",strokeCap:"round"}),$e.restore(),pt=!0}})(ae.getContext("2d"),X.actions,{selectionColor:[1,0,1],scalar:Zt});const jt=X.actions.length;zt[X.id]={total:jt,last:{...X.actions[jt-1]},element:ae}}return{x:0,y:0,...Gt,fillColor:X.color||[1,1,1],backgroundImage:ae}};let Dt;const te=()=>{cancelAnimationFrame(Dt),Dt=requestAnimationFrame(()=>{di=!0,Mi=0,r()})},Kt=new Map([]),U=new Map([]),Tt=(X,Gt)=>({filterParam:X==="pixelated"?G.textureFilterNearest:G.textureFilterLinear,wrapParam:Gt==="repeat"?G.textureRepeat:G.textureClamp}),dt=(X,Gt,H)=>{if(!Kt.has(X)){Kt.set(X,X);const jt=Tt(Gt,H);if(!_e(Zt=X)&&($y(Zt)||Fl(Zt)||Uc(Zt)||hu(Zt))){const $e=G.textureCreate();G.textureUpdate($e,X,jt),Kt.set(X,$e)}else V(X).then($e=>{if(!G||!$e)return;const Xt=G.textureCreate();G.textureUpdate(Xt,$e,jt),Kt.set(X,Xt),te()}).catch($e=>{Kt.set(X,$e)})}var Zt,ae;if(hu(X)&&((ae=X).currentTime>0&&!ae.paused&&!ae.ended&&ae.readyState>2||X.dataset.redraw==="true")){const jt=Kt.get(X),$e=Tt(Gt,H);return G.textureUpdate(jt,X,$e),X.dataset.redraw=!1,jt}return Kt.get(X)},Jt=(X,Gt={})=>{const H=Gt.id||X.id;if(X.width&&X.width<1||X.height&&X.height<1||!X.text.length)return void U.delete(H);let{text:Zt,textAlign:ae,fontFamily:jt,fontSize:$e=16,fontWeight:Xt,fontVariant:Le,fontStyle:qe,letterSpacing:Ne,lineHeight:pt=$e,width:Ht,height:ie}=X,{outline:Fe=0,blur:Wt=0,paddingTop:K=0,paddingRight:Yt=0,paddingBottom:Ut=0,paddingLeft:ne=0}=Gt;Ht=hi(Ht)?Math.floor(Ht):Ht,ie=hi(ie)?Math.floor(ie):ie;const{textSize:De,signature:re}=((Ce="",xe)=>{let{width:Ke=0,height:Pe="auto",fontSize:je,fontFamily:Me,lineHeight:fe,fontWeight:Ti,fontStyle:Yi,fontVariant:En,letterSpacing:bn}=xe;const Vn=iu({text:Ce,fontFamily:Me,fontWeight:Ti,fontStyle:Yi,fontVariant:En,fontSize:je,lineHeight:fe,letterSpacing:bn,width:Ke,height:Pe});let An=Mm.get(Vn);if(An)return An;let qr=1;je>1e3&&ya()&&(qr=je/1e3,je=1e3,fe*=qr);const ao=kh(xn("pre",{contenteditable:"true",spellcheck:"false",style:`${wy}${Rh({fontFamily:Me,fontWeight:Ti,fontStyle:Yi,fontVariant:En,fontSize:je,letterSpacing:bn,lineHeight:fe})};${Ih(Ce,xe)}"`,innerHTML:Ce})),Ln=ao.getBoundingClientRect();return An={signature:vy(ao).flat().map(xr=>xr.text).join("_;_"),textSize:is(Aa(Ln),xr=>Math.ceil(xr*qr))},Mm.set(Vn,An),ao.remove(),An})(Zt,{...X,width:Ht,height:void 0}),Bi=iu({text:Zt,textAlign:ae,fontFamily:jt,fontSize:$e,fontWeight:Xt,fontVariant:Le,fontStyle:qe,lineHeight:pt,letterSpacing:Ne,outline:Fe,blur:Wt,signature:re});if(!Kt.has(Bi)){Kt.set(Bi,Zt);const Ce=Math.ceil(De.width),xe=Math.ceil(De.height);if(Ce===0||xe===0)return;const Ke=jh(),Pe=Math.min(1,(Ke-(ne+Yt)*D)/(Ce*D),(Ke-(K+Ut)*D)/(xe*D));ky(Zt,{fontSize:$e,fontFamily:jt,fontWeight:Xt,fontVariant:Le,fontStyle:qe,letterSpacing:Ne,textAlign:ae,lineHeight:pt,width:Ht,height:ie,imageWidth:Ce,imageHeight:xe,paddingLeft:ne,paddingTop:K,paddingRight:Yt,paddingBottom:Ut,pixelRatio:D*Pe,willRequest:O,outline:Fe,blur:Wt,styleNonce:y.styleNonce,color:[1,0,1]}).then(je=>{if(!G)return;const Me=G.textureCreate();G.textureUpdate(Me,je,{filterParam:G.textureFilterLinear,wrapParam:G.textureClamp,scalar:Pe}),Kt.set(Bi,Me),U.set(H,Me),te()}).catch(console.error)}const ti=Kt.get(Bi);return Ap(ti)?ti:U.get(H)},se=new Map,ee=X=>{let Gt;return X.backgroundImage?Gt=dt(X.backgroundImage,X.backgroundImageRendering,X.backgroundRepeat==="repeat"?"repeat":void 0):X.bitmap&&X.points&&(Gt=(H=>{const{id:Zt,points:ae,strokeWidth:jt,strokeCap:$e,strokeJoin:Xt,strokeColor:Le}=H;let qe=Kt.get(Zt),Ne=se.get(Zt);const pt=iu({points:ae.map(De=>`${De.x},${De.y}`).join(","),strokeWidth:jt,strokeCap:$e,strokeJoin:Xt,strokeColor:Le});if(Ne){const{hash:De}=Ne;if(Kt.has(Zt)){if(pt===De)return Kt.get(Zt)}else Ne=void 0}if(!Ne){const De=xn("canvas",{width:1,height:1});Ne={canvas:De,hash:void 0},se.set(H.id,Ne),qe=G.textureCreate(),G.textureUpdate(qe,De,{filterParam:G.textureFilterLinear,wrapParam:G.textureClamp}),Kt.set(Zt,qe)}const{canvas:Ht}=Ne,ie=Math.ceil(H.strokeWidth),Fe=er(ae),Wt=Math.floor(Fe.x)-.5*ie,K=Math.floor(Fe.y)-.5*ie,Yt=Math.ceil(Fe.width+ie),Ut=Math.ceil(Fe.height+ie);Ht.width=Math.max(Yt,1),Ht.height=Math.max(Ut,1);const ne=Ht.getContext("2d");return ne.clearRect(0,0,Ht.width,Ht.height),Yt>=1&&Ut>=1&&(ne.translate(-Wt,-K),Qp(ne,H),ne.resetTransform()),G.textureUpdate(qe,Ht,{filterParam:G.textureFilterLinear,wrapParam:G.textureClamp}),se.set(Zt,{canvas:Ht,hash:pt}),Kt.get(Zt)})(X)),Gt},be=({texture:X,size:Gt,origin:H,translation:Zt,rotation:ae,scale:jt,colorMatrix:$e,opacity:Xt,convolutionMatrix:Le,gamma:qe,vignette:Ne,maskFeather:pt,maskCornerRadius:Ht,overlayColor:ie,enableOverlay:Fe,enableManipulation:Wt,enableAntialiasing:K})=>{let Yt=0,Ut=0;if(M===1){const ne=Math.abs(1-jt)<Number.EPSILON;Yt=ne&&$t%2!=0?.5:0,Ut=ne&&vt%2!=0?.5:0}return G.drawImage(X,Gt,H.x,H.y,Zt.x+Yt,Zt.y+Ut,ae.x,ae.y,ae.z,jt,$e,tn(Xt,0,1),Le,qe,Ne,pt,Ht,ie,Fe,Wt,K),X},ve=(X,Gt,H)=>{const Zt=ki(Gt),ae=ki(X),jt=Zt.x-ae.x,$e=Zt.y-ae.y,Xt=Dr(Zt,H,ae);return{x:Xt.x-ae.x-jt,y:Xt.y-ae.y-$e}},_=(X=[],Gt)=>{X.forEach(H=>{let Zt=ee(H);const ae=H.status!=="complete"&&(H.status==="loading"||H.backgroundImage&&Zt===H.backgroundImage);ae&&te();const jt=H.status==="error"||H.backgroundImage&&Zt instanceof Error;let $e=Ap(Zt)?Zt:void 0;const Xt=H._scale||1,Le=H._translate||u,qe=H.strokeWidth&&H.strokeWidth*Xt,Ne=H.cornerRadius?((Wt,K)=>[Wt,Wt,Wt,Wt].map(Yt=>Yt*K))(H.cornerRadius,Xt):d,pt=!!H.width,Ht=_e(H.text),ie=Rn(H.points),Fe=Yn(H);if(ie){const Wt=H.points.map(K=>ot(K.x*Xt+Le.x,K.y*Xt+Le.y));if(H.bitmap){Zt&&Gt.push(Zt);const K=er(Wt),Yt=Math.ceil(H.strokeWidth*Xt);G.drawRect({x:Math.floor(K.x)-.5*Yt,y:Math.floor(K.y)-.5*Yt,width:Math.ceil(K.width+Yt),height:Math.ceil(K.height+Yt)},H.rotation,H.flipX,H.flipY,[0,0,0,0],void 0,$e,void 0,void 0,void 0,void 0,void 0,void 0,H.opacity,void 0,void 0,!1,!1)}else G.drawPath(Wt,H.rotation,H.flipX,H.flipY,qe,H.strokeColor,H.pathClose,H.backgroundColor,H.opacity)}else if(Fe){let Wt=H.x,K=H.y;Wt*=Xt,K*=Xt,Wt+=Le.x,K+=Le.y;const Yt=ot(Wt,K);G.drawEllipse(Yt,H.rx*Xt,H.ry*Xt,H.rotation,H.flipX,H.flipY,H.backgroundColor,$e,void 0,void 0,H.backgroundCorners&&v$(H.backgroundCorners),qe,H.strokeColor,H.opacity,H.inverted),Zt&&Gt.push(Zt),(ae||jt)&&(H.backgroundColor||H.strokeColor&&H.strokeWidth||G.drawEllipse(Yt,H.rx*Xt,H.ry*Xt,H.rotation,H.flipX,H.flipY,jt?[1,0,0,.25*H.opacity]:[0,0,0,.25*H.opacity]),jt&&Re(Yt),ae&&ze(Yt))}else if(Ht){const Wt=H.fontSize>1e3&&ya()?H.fontSize/1e3:1,K=Math.max(16,Math.ceil(H.fontSize/Wt*.25)),Yt=Math.abs(H.rotation)>0,Ut=Fo(H.text,H),ne={x:H.x*Xt+Le.x,y:H.y*Xt+Le.y,width:Ut.width*Xt,height:Ut.height*Xt};(H.backgroundColor||H.strokeColor)&&G.drawRect(ne,H.rotation,H.flipX,H.flipY,Ne,H.backgroundColor,void 0,void 0,void 0,!1,void 0,qe,H.strokeColor,H.opacity,void 0,void 0,void 0,H.inverted);const{textShadowX:De,textShadowY:re,textShadowBlur:Bi}=H;if(De||re||Bi){const Ce=Math.ceil(.5*Bi),xe=Math.max(K,Ce),Ke=Jt(H,{id:H.id+"shadow",blur:Bi,paddingTop:xe,paddingRight:xe,paddingBottom:xe,paddingLeft:xe});if(Ke&&!H._prerender){Gt.push(Ke);const Pe=G.textureGetSize(Ke),je={x:0,y:0},Me={width:Pe.width/D*Xt,height:Pe.height/D*Xt},fe=K*Xt/Wt,Ti={x:H.x*Xt+Le.x-fe,y:H.y*Xt+Le.y-fe,width:Me.width,height:H.height?Ut.height+fe-re:Me.height};if(Yt){const Yi=ve(ne,Ti,H.rotation);Ti.x+=Yi.x,Ti.y+=Yi.y;const En=Dr(ot(De,re),H.rotation);Ti.x+=En.x,Ti.y+=En.y}else Ti.x+=De,Ti.y+=re;G.drawRect(Ti,H.rotation,H.flipX,H.flipY,[0,0,0,0],void 0,Ke,Me,je,!1,void 0,void 0,void 0,H.opacity,void 0,0,H.textShadowColor)}}if(H.textOutlineWidth){const Ce=Math.ceil(.5*H.textOutlineWidth),xe=K+Ce,Ke=Jt(H,{id:H.id+"outline",outline:H.textOutlineWidth,paddingTop:xe,paddingRight:xe,paddingBottom:xe,paddingLeft:xe});if(Ke&&!H._prerender){Gt.push(Ke);const Pe=G.textureGetSize(Ke),je={x:0,y:0},Me={width:Pe.width/D*Xt,height:Pe.height/D*Xt},fe=(K+Ce)*Xt/Wt,Ti={x:H.x*Xt+Le.x-fe,y:H.y*Xt+Le.y-fe,width:Me.width,height:H.height?Ut.height+fe:Me.height};if(Yt){const Yi=ve(ne,Ti,H.rotation);Ti.x+=Yi.x,Ti.y+=Yi.y}G.drawRect(Ti,H.rotation,H.flipX,H.flipY,[0,0,0,0],void 0,Ke,Me,je,!1,void 0,void 0,void 0,H.opacity,void 0,0,H.textOutlineColor)}}const ti=Jt(H,{id:H.id+"text",paddingTop:K,paddingRight:K,paddingBottom:K,paddingLeft:K});if(ti&&!H._prerender){Gt.push(ti);const Ce=G.textureGetSize(ti),xe={x:0,y:0},Ke={width:Ce.width/D*Xt,height:Ce.height/D*Xt},Pe=K*Xt/Wt,je={x:H.x*Xt+Le.x-Pe,y:H.y*Xt+Le.y-Pe,width:Ke.width,height:H.height?Ut.height+Pe:Ke.height};if(Yt){const fe=ve(ne,je,H.rotation);je.x+=fe.x,je.y+=fe.y}const Me=H.color||[0,0,0];H._prerender&&(Me[3]=0),G.drawRect(je,H.rotation,H.flipX,H.flipY,d,!1,ti,Ke,xe,!1,!1,void 0,void 0,H.opacity,void 0,H.feather,Me,H.inverted)}}else if(pt){Zt&&Gt.push(Zt);const Wt=ys(H);let K,Yt;Xt&&Le&&(Wt.x*=Xt,Wt.y*=Xt,Wt.x+=Le.x,Wt.y+=Le.y,Wt.width*=Xt,Wt.height*=Xt);const{backgroundRepeat:Ut="no-repeat"}=H,ne=$e&&G.textureGetSize($e);if(ne&&H.backgroundImage&&(H.backgroundSize||H.backgroundPosition||H.backgroundRepeat)){const De=qo(ne.width,ne.height);if(H.backgroundRepeat==="repeat"&&(K={...ne},Yt={x:0,y:0}),H.backgroundSize==="contain"){const re=Yr(Wt,De,Wt);K=ol(re),Yt=H.backgroundPosition?H.backgroundPosition:ot(.5*(Wt.width-K.width),.5*(Wt.height-K.height))}else if(H.backgroundSize==="cover"){const re=rs(Wt,De,Wt);K=ol(re),H.backgroundPosition?Yt=H.backgroundPosition:(Yt=ot(re.x,re.y),Yt=ot(.5*(Wt.width-K.width),.5*(Wt.height-K.height)))}else H.backgroundSize?(K=H.backgroundSize,Yt=H.backgroundPosition||{x:0,y:0}):H.backgroundPosition&&(K={...ne},Yt=H.backgroundPosition)}if(G.drawRect(Wt,H.rotation,H.flipX,H.flipY,Ne,H.backgroundColor,$e,K,Yt,Ut==="repeat",H.backgroundCorners&&v$(H.backgroundCorners),qe,H.strokeColor,H.opacity,void 0,H.feather,H.fillColor,H.inverted),ae||jt){H.backgroundColor&&H.backgroundColor[3]!==0||H.strokeColor&&H.strokeWidth||G.drawRect(Wt,H.rotation,H.flipX,H.flipY,Ne,jt?[1,.2549,.2118,.25*H.opacity]:[0,0,0,.25*H.opacity]);const De=ki(Wt);jt&&Re(De),ae&&ze(De)}}else Zt&&Gt.push(Zt)})};let ke=0;const fi=[{x:-5,y:-5},{x:5,y:5}],ye=[{x:5,y:-5},{x:-5,y:5}],Ot=uu({x:0,y:0},10,10,0,!1,!1,16);Ot.length=9;const ze=X=>{ke=Date.now()/50,G.drawEllipse(X,15,15,0,!1,!1,[0,0,0,.5]);const Gt=rl(Ot.map(H=>({x:H.x+X.x,y:H.y+X.y})),ke,X.x,X.y);G.drawPath(Gt,0,!1,!1,2,[1,1,1])},Re=X=>{G.drawEllipse(X,13,13,0,!1,!1,[1,.2549,.2118,.75]);const Gt=fi.map(Zt=>({x:Zt.x+X.x,y:Zt.y+X.y})),H=ye.map(Zt=>({x:Zt.x+X.x,y:Zt.y+X.y}));G.drawPath(Gt,0,!1,!1,3,[1,1,1]),G.drawPath(H,0,!1,!1,3,[1,1,1])},Oe=(X,Gt,H,Zt,ae,jt)=>G.drawRect(Gt,0,!1,!1,d,d,X,Zt,H,!0,void 0,0,void 0,jt,void 0,void 0,ae);let di=!1,bt=!0,le=!1;const Xe=[],Ve=[],At=[],Ge=X=>!X.aboveFrame,Ye=X=>X.aboveFrame,$i=()=>{At.length=0;const X=ut[0],{manipulationShapes:Gt,manipulationShapesDirty:H,annotationShapes:Zt,annotationShapesDirty:ae,interfaceShapes:jt,decorationShapes:$e,frameShapes:Xt,selectionShapes:Le}=F({opacity:X.opacity,rotation:X.rotation,scale:X.scale,images:ut,size:Un($t,vt),backgroundColor:[...c],selectionRect:l}),qe=[...c],Ne=l,pt=tn(s,0,1),Ht=a,ie=Math.abs(X.rotation.x/Math.PI*2-1),Fe=Math.abs(X.rotation.y/Math.PI*2-1),Wt=ie<.99||Fe<.99,K={...X.size},Yt=X.backgroundColor,Ut=X.backgroundImage,ne=Gt.length>0,De=Zt.length>0,re=Zt.filter(Ye).length>0,Bi=$e.filter(Ye).length>0,ti=Yt[3]>0,Ce=!!I&&C>=1;if(pt<1&&ti){const xe=qe[0],Ke=qe[1],Pe=qe[2],je=1-pt,Me=Yt[0]*je,fe=Yt[1]*je,Ti=Yt[2]*je,Yi=1-je;qe[0]=Me+xe*Yi,qe[1]=fe+Ke*Yi,qe[2]=Ti+Pe*Yi,qe[3]=1}if(G.setCanvasColor(f?d:qe),ne&&(H||di)?(G.disableMask(),G.drawToImageBlendBuffer(K),Xe.length=0,_(Gt,Xe)):ne||(Xe.length=0),At.push(...Xe),bt&&(G.drawToImageOverlayBuffer(K,D),bt=!1),Wt){if(De&&(ae||di)||!le){G.disableMask(),G.drawToImageOverlayBuffer(K,D),Ve.length=0;const xe=re?Zt.filter(Ge):Zt;_(xe,Ve)}else De||(Ve.length=0);le=!0}else le=!1;if(G.drawToCanvas(),G.enableMask(Ne,pt),tt&&N>=1&&k.length===2&&it&&((xe,Ke,Pe,je,Me)=>{const fe=Un(Ke,Ke),Ti=dt(p,"pixelated","repeat"),Yi=ot(-xe.x%Ke,-xe.y%Ke),En=ot(Yi.x+.5*fe.width,Yi.y);Oe(Ti,xe,Yi,fe,Pe,Me),Oe(Ti,xe,En,fe,je,Me)})(Ne,N,k[0],k[1],it),ti&&G.drawRect(Ne,0,!1,!1,d,Yt),Ut){G.enableMask(Ne,1);const xe=Math.max(b.width/Ut.width,b.height/Ut.height),Ke=Ut.width*xe,Pe=Ut.height*xe,je={x:b.x+.5*b.width-.5*Ke,y:b.y+.5*b.height-.5*Pe,width:Ke,height:Pe};G.drawRect(je,0,!1,!1,d,d,dt(Ut,"linear")),G.enableMask(Ne,pt)}if(Ce&&G.enablePreviewStencil(),At.push(...[...ut].reverse().map(xe=>be({...xe,texture:dt(xe.data),enableOverlay:Wt&&De,enableManipulation:ne,enableAntialiasing:!0,mask:Ne,maskOpacity:pt,overlayColor:Ht}))),G.enableMask(Ne,C),!Wt){Ce&&G.applyPreviewStencil(),G.resetCanvasMatrix(),G.updateCanvasMatrix(K,X.origin,X.translation,X.scale,X.rotation),Ve.length=0;const xe=re?Zt.filter(Ge):Zt;_(xe,Ve),Ce&&G.disablePreviewStencil()}if(At.push(...Ve),G.resetCanvasMatrix(),G.enableMask(Ne,C),_(Bi?$e.filter(Ge):$e,At),Xt.length){G.enableMask(Ne,1);const xe=Xt.filter(Pe=>!Pe.expandsCanvas),Ke=Xt.filter(Pe=>Pe.expandsCanvas);xe.length&&_(xe,At),Ke.length&&(G.enableMask({x:Ne.x+.5,y:Ne.y+.5,width:Ne.width-1,height:Ne.height-1},o),_(Ke,At))}if(re&&(G.resetCanvasMatrix(),G.updateCanvasMatrix(K,X.origin,X.translation,X.scale,X.rotation),_(Zt.filter(Ye),At),G.resetCanvasMatrix()),Bi&&(G.resetCanvasMatrix(),_($e.filter(Ye),At),G.resetCanvasMatrix()),gt&&Le.length&&!Wt){G.resetCanvasMatrix(),G.updateCanvasMatrix(K,X.origin,X.translation,X.scale,X.rotation);const xe=[...gt];xe[3]=.5;const Ke=[{id:"selection",color:xe,actions:[...Le]}].map(Pe=>oe(Pe,K));_(Ke,At),G.resetCanvasMatrix()}G.disableMask(),_(jt,At),at.forEach(xe=>{if(G.enableMask(xe.mask,xe.maskOpacity),xe.backgroundColor){const Pe=Ut&&rs({...xe.mask},Ut.width/Ut.height),je=Ut&&dt(Ut,"linear");G.drawRect(xe.mask,0,!1,!1,xe.maskCornerRadius,xe.backgroundColor,je,Pe,Pe,void 0,void 0,void 0,void 0,xe.opacity,xe.maskFeather),je&&At.push(je)}const Ke=be({...xe,texture:dt(xe.data),enableAntialiasing:!1,translation:{x:xe.translation.x+xe.offset.x-.5*$t,y:xe.translation.y+xe.offset.y-.5*vt}});At.push(Ke)}),G.disableMask(),(xe=>{Kt.forEach((Ke,Pe)=>{!xe.find(je=>je===Ke)&&Ap(Ke)&&(Array.from(U.values()).includes(Ke)||(Kt.delete(Pe),G.textureDelete(Ke)))})})(At),W(),di=!1};let bi,Mi=0;const Ci=()=>{clearTimeout(bi);const X=Date.now();X-Mi<48?bi=setTimeout(Ci,48):(Mi=X,$i())};return Yb(()=>r()),As(()=>i(31,G=Wv(g,{alpha:f}))),_o(()=>{G&&(se.forEach(({canvas:X})=>qn(X)),se.clear(),G.release(),i(31,G=void 0),i(0,g=void 0))}),t.$$set=X=>{"isAnimated"in X&&i(9,m=X.isAnimated),"isTransparent"in X&&i(10,f=X.isTransparent),"maskRect"in X&&i(11,b=X.maskRect),"maskOpacity"in X&&i(12,w=X.maskOpacity),"maskFrameOpacity"in X&&i(13,S=X.maskFrameOpacity),"maskMarkupOpacity"in X&&i(14,C=X.maskMarkupOpacity),"clipAnnotationsToImage"in X&&i(15,I=X.clipAnnotationsToImage),"pixelRatio"in X&&i(16,M=X.pixelRatio),"textPixelRatio"in X&&i(17,D=X.textPixelRatio),"backgroundColor"in X&&i(18,T=X.backgroundColor),"willRender"in X&&i(19,F=X.willRender),"didRender"in X&&i(20,W=X.didRender),"willRequest"in X&&i(21,O=X.willRequest),"csp"in X&&i(22,y=X.csp),"loadImageData"in X&&i(23,V=X.loadImageData),"enableGrid"in X&&i(24,tt=X.enableGrid),"gridColors"in X&&i(25,k=X.gridColors),"gridSize"in X&&i(26,N=X.gridSize),"gridOpacity"in X&&i(27,it=X.gridOpacity),"images"in X&&i(28,ut=X.images),"interfaceImages"in X&&i(29,at=X.interfaceImages),"selectionColor"in X&&i(30,gt=X.selectionColor)},t.$$.update=()=>{if(1&t.$$.dirty[0]&&g){const X=getComputedStyle(g).getPropertyValue("--color-transition-duration");i(32,J=(Gt=>{let H=parseFloat(Gt);return/^[0-9]+s$/.test(Gt)?1e3*H:H})(X))}262656&t.$$.dirty[0]|2&t.$$.dirty[1]&&T&&q.set(T,{duration:m?J:0}),4096&t.$$.dirty[0]&&lt(Z,hi(w)?w:1),8192&t.$$.dirty[0]&&lt(xt,hi(S)?S:1),2048&t.$$.dirty[0]&&b&&nt.set(b),48&t.$$.dirty[1]&&c&&mt.set([c[0],c[1],c[2],tn(s,0,1)]),268435462&t.$$.dirty[0]|1&t.$$.dirty[1]&&i(34,n=!!(G&&$t&&vt&&ut.length)),65542&t.$$.dirty[0]|1&t.$$.dirty[1]&&$t&&vt&&G&&(Mi=0,G.resize($t,vt,M)),8&t.$$.dirty[1]&&i(33,r=n?Zh()?Ci:$i:me),12&t.$$.dirty[1]&&n&&r&&r()},[g,$t,vt,h,q,Z,xt,nt,mt,m,f,b,w,S,C,I,M,D,T,F,W,O,y,V,tt,k,N,it,ut,at,gt,G,J,r,n,s,c,function(X){zi[X?"unshift":"push"](()=>{g=X,i(0,g)})},X=>{i(1,$t=X.detail.width),i(2,vt=X.detail.height),h("measure",{width:$t,height:vt})}]}class Yv extends ci{constructor(e){super(),li(this,e,Xv,Zv,oi,{isAnimated:9,isTransparent:10,maskRect:11,maskOpacity:12,maskFrameOpacity:13,maskMarkupOpacity:14,clipAnnotationsToImage:15,pixelRatio:16,textPixelRatio:17,backgroundColor:18,willRender:19,didRender:20,willRequest:21,csp:22,loadImageData:23,enableGrid:24,gridColors:25,gridSize:26,gridOpacity:27,images:28,interfaceImages:29,selectionColor:30},null,[-1,-1,-1])}}var mi=(t,e=Boolean,i=" ")=>t.filter(e).join(i);function w$(t,e,i){const n=t.slice();return n[17]=e[i],n}const qv=t=>({tab:4&t}),S$=t=>({tab:t[17]});function k$(t){let e,i,n,r=[],o=new Map,a=t[2];const s=l=>l[17].id;for(let l=0;l<a.length;l+=1){let c=w$(t,a,l),d=s(c);o.set(d,r[l]=C$(d,c))}return{c(){e=ht("ul");for(let l=0;l<r.length;l+=1)r[l].c();v(e,"class",i=mi(["PinturaTabList",t[0]])),v(e,"role","tablist"),v(e,"data-layout",t[1])},m(l,c){et(l,e,c);for(let d=0;d<r.length;d+=1)r[d].m(e,null);t[14](e),n=!0},p(l,c){1124&c&&(a=l[2],Ie(),r=La(r,c,s,1,l,a,o,e,Ls,C$,null,w$),Ee()),(!n||1&c&&i!==(i=mi(["PinturaTabList",l[0]])))&&v(e,"class",i),(!n||2&c)&&v(e,"data-layout",l[1])},i(l){if(!n){for(let c=0;c<a.length;c+=1)P(r[c]);n=!0}},o(l){for(let c=0;c<r.length;c+=1)z(r[c]);n=!1},d(l){l&&Q(e);for(let c=0;c<r.length;c+=1)r[c].d();t[14](null)}}}function C$(t,e){let i,n,r,o,a,s,l,c,d,u;const p=e[11].default,h=rr(p,e,e[10],S$);function g(...f){return e[12](e[17],...f)}function m(...f){return e[13](e[17],...f)}return{key:t,first:null,c(){i=ht("li"),n=ht("button"),h&&h.c(),o=pe(),v(n,"type","button"),n.disabled=r=e[17].disabled,v(i,"role","tab"),v(i,"aria-controls",a=e[17].href.substr(1)),v(i,"id",s=e[17].tabId),v(i,"aria-selected",l=e[17].selected),this.first=i},m(f,b){et(f,i,b),Ct(i,n),h&&h.m(n,null),Ct(i,o),c=!0,d||(u=[Mt(n,"keydown",g),Mt(n,"click",m)],d=!0)},p(f,b){e=f,h&&h.p&&(!c||1028&b)&&ar(h,p,e,e[10],c?or(p,e[10],b,qv):sr(e[10]),S$),(!c||4&b&&r!==(r=e[17].disabled))&&(n.disabled=r),(!c||4&b&&a!==(a=e[17].href.substr(1)))&&v(i,"aria-controls",a),(!c||4&b&&s!==(s=e[17].tabId))&&v(i,"id",s),(!c||4&b&&l!==(l=e[17].selected))&&v(i,"aria-selected",l)},i(f){c||(P(h,f),c=!0)},o(f){z(h,f),c=!1},d(f){f&&Q(i),h&&h.d(f),d=!1,Ui(u)}}}function Kv(t){let e,i,n=t[4]&&k$(t);return{c(){n&&n.c(),e=Tn()},m(r,o){n&&n.m(r,o),et(r,e,o),i=!0},p(r,[o]){r[4]?n?(n.p(r,o),16&o&&P(n,1)):(n=k$(r),n.c(),P(n,1),n.m(e.parentNode,e)):n&&(Ie(),z(n,1,1,()=>{n=null}),Ee())},i(r){i||(P(n),i=!0)},o(r){z(n),i=!1},d(r){n&&n.d(r),r&&Q(e)}}}function Jv(t,e,i){let n,r,o,{$$slots:a={},$$scope:s}=e,{class:l}=e,{name:c}=e,{selected:d}=e,{tabs:u=[]}=e,{layout:p}=e;const h=ba(),g=b=>{const w=o.querySelectorAll('[role="tab"] button')[b];w&&w.focus()},m=(b,w)=>{b.preventDefault(),b.stopPropagation(),h("select",w)},f=({key:b},w)=>{if(!/arrow/i.test(b))return;const S=u.findIndex(C=>C.id===w);return/right|down/i.test(b)?g(S<u.length-1?S+1:0):/left|up/i.test(b)?g(S>0?S-1:u.length-1):void 0};return t.$$set=b=>{"class"in b&&i(0,l=b.class),"name"in b&&i(7,c=b.name),"selected"in b&&i(8,d=b.selected),"tabs"in b&&i(9,u=b.tabs),"layout"in b&&i(1,p=b.layout),"$$scope"in b&&i(10,s=b.$$scope)},t.$$.update=()=>{896&t.$$.dirty&&i(2,n=u.map(b=>{const w=b.id===d;return{...b,tabId:`tab-${c}-${b.id}`,href:`#panel-${c}-${b.id}`,selected:w}})),4&t.$$.dirty&&i(4,r=n.length>1)},[l,p,n,o,r,m,f,c,d,u,s,a,(b,w)=>f(w,b.id),(b,w)=>m(w,b.id),function(b){zi[b?"unshift":"push"](()=>{o=b,i(3,o)})}]}class Iu extends ci{constructor(e){super(),li(this,e,Jv,Kv,oi,{class:0,name:7,selected:8,tabs:9,layout:1})}}const Qv=t=>({panel:16&t}),T$=t=>({panel:t[4][0].id,panelIsActive:!0});function M$(t,e,i){const n=t.slice();return n[14]=e[i].id,n[15]=e[i].shouldDraw,n[16]=e[i].panelId,n[17]=e[i].tabindex,n[18]=e[i].labelledBy,n[19]=e[i].isActive,n[20]=e[i].hidden,n[3]=e[i].visible,n}const t4=t=>({panel:16&t,panelIsActive:16&t}),P$=t=>({panel:t[14],panelIsActive:t[19]});function e4(t){let e,i,n,r,o,a;const s=t[11].default,l=rr(s,t,t[10],T$);return{c(){e=ht("div"),i=ht("div"),l&&l.c(),v(i,"class",n=mi([t[1]])),v(e,"class",t[0]),v(e,"style",t[2])},m(c,d){et(c,e,d),Ct(e,i),l&&l.m(i,null),r=!0,o||(a=[Mt(e,"measure",t[13]),Xi(yr.call(null,e))],o=!0)},p(c,d){l&&l.p&&(!r||1040&d)&&ar(l,s,c,c[10],r?or(s,c[10],d,Qv):sr(c[10]),T$),(!r||2&d&&n!==(n=mi([c[1]])))&&v(i,"class",n),(!r||1&d)&&v(e,"class",c[0]),(!r||4&d)&&v(e,"style",c[2])},i(c){r||(P(l,c),r=!0)},o(c){z(l,c),r=!1},d(c){c&&Q(e),l&&l.d(c),o=!1,Ui(a)}}}function i4(t){let e,i,n,r,o,a=[],s=new Map,l=t[4];const c=d=>d[14];for(let d=0;d<l.length;d+=1){let u=M$(t,l,d),p=c(u);s.set(p,a[d]=I$(p,u))}return{c(){e=ht("div");for(let d=0;d<a.length;d+=1)a[d].c();v(e,"class",i=mi(["PinturaTabPanels",t[0]])),v(e,"style",t[2])},m(d,u){et(d,e,u);for(let p=0;p<a.length;p+=1)a[p].m(e,null);n=!0,r||(o=[Mt(e,"measure",t[12]),Xi(yr.call(null,e,{observePosition:!0}))],r=!0)},p(d,u){1042&u&&(l=d[4],Ie(),a=La(a,u,c,1,d,l,s,e,Ls,I$,null,M$),Ee()),(!n||1&u&&i!==(i=mi(["PinturaTabPanels",d[0]])))&&v(e,"class",i),(!n||4&u)&&v(e,"style",d[2])},i(d){if(!n){for(let u=0;u<l.length;u+=1)P(a[u]);n=!0}},o(d){for(let u=0;u<a.length;u+=1)z(a[u]);n=!1},d(d){d&&Q(e);for(let u=0;u<a.length;u+=1)a[u].d();r=!1,Ui(o)}}}function R$(t){let e;const i=t[11].default,n=rr(i,t,t[10],P$);return{c(){n&&n.c()},m(r,o){n&&n.m(r,o),e=!0},p(r,o){n&&n.p&&(!e||1040&o)&&ar(n,i,r,r[10],e?or(i,r[10],o,t4):sr(r[10]),P$)},i(r){e||(P(n,r),e=!0)},o(r){z(n,r),e=!1},d(r){n&&n.d(r)}}}function I$(t,e){let i,n,r,o,a,s,l,c,d,u=e[15]&&R$(e);return{key:t,first:null,c(){i=ht("div"),u&&u.c(),n=pe(),v(i,"class",r=mi(["PinturaTabPanel",e[1]])),i.hidden=o=e[20],v(i,"id",a=e[16]),v(i,"tabindex",s=e[17]),v(i,"aria-labelledby",l=e[18]),v(i,"data-inert",c=!e[3]),this.first=i},m(p,h){et(p,i,h),u&&u.m(i,null),Ct(i,n),d=!0},p(p,h){(e=p)[15]?u?(u.p(e,h),16&h&&P(u,1)):(u=R$(e),u.c(),P(u,1),u.m(i,n)):u&&(Ie(),z(u,1,1,()=>{u=null}),Ee()),(!d||2&h&&r!==(r=mi(["PinturaTabPanel",e[1]])))&&v(i,"class",r),(!d||16&h&&o!==(o=e[20]))&&(i.hidden=o),(!d||16&h&&a!==(a=e[16]))&&v(i,"id",a),(!d||16&h&&s!==(s=e[17]))&&v(i,"tabindex",s),(!d||16&h&&l!==(l=e[18]))&&v(i,"aria-labelledby",l),(!d||16&h&&c!==(c=!e[3]))&&v(i,"data-inert",c)},i(p){d||(P(u),d=!0)},o(p){z(u),d=!1},d(p){p&&Q(i),u&&u.d()}}}function n4(t){let e,i,n,r;const o=[i4,e4],a=[];function s(l,c){return l[5]?0:1}return e=s(t),i=a[e]=o[e](t),{c(){i.c(),n=Tn()},m(l,c){a[e].m(l,c),et(l,n,c),r=!0},p(l,[c]){let d=e;e=s(l),e===d?a[e].p(l,c):(Ie(),z(a[d],1,1,()=>{a[d]=null}),Ee(),i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),P(i,1),i.m(n.parentNode,n))},i(l){r||(P(i),r=!0)},o(l){z(i),r=!1},d(l){a[e].d(l),l&&Q(n)}}}function r4(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,{class:s}=e,{name:l}=e,{selected:c}=e,{panelClass:d}=e,{panels:u=[]}=e,{visible:p}=e,{style:h}=e;const g={};return t.$$set=m=>{"class"in m&&i(0,s=m.class),"name"in m&&i(6,l=m.name),"selected"in m&&i(7,c=m.selected),"panelClass"in m&&i(1,d=m.panelClass),"panels"in m&&i(8,u=m.panels),"visible"in m&&i(3,p=m.visible),"style"in m&&i(2,h=m.style),"$$scope"in m&&i(10,a=m.$$scope)},t.$$.update=()=>{968&t.$$.dirty&&i(4,n=u.map(m=>{const f=m===c;f&&i(9,g[m]=!0,g);const b=p?p.indexOf(m)!==-1:f;return{id:m,panelId:`panel-${l}-${m}`,labelledBy:`tab-${l}-${m}`,isActive:f,hidden:!f,visible:b,tabindex:f?0:-1,shouldDraw:f||g[m]}})),16&t.$$.dirty&&i(5,r=n.length>1)},[s,d,h,p,n,r,l,c,u,g,a,o,function(m){Wr.call(this,t,m)},function(m){Wr.call(this,t,m)}]}class Eu extends ci{constructor(e){super(),li(this,e,r4,n4,oi,{class:0,name:6,selected:7,panelClass:1,panels:8,visible:3,style:2})}}var Xh=t=>{const e=Object.getOwnPropertyDescriptors(t.prototype);return Object.keys(e).filter(i=>!!e[i].get)};function E$(t){let e,i,n,r;const o=[t[5],{locale:t[1]}];function a(c){t[22](c)}var s=t[10];function l(c){let d={};for(let u=0;u<o.length;u+=1)d=Cn(d,o[u]);return c[3]!==void 0&&(d.name=c[3]),{props:d}}return s&&(e=yu(s,l(t)),zi.push(()=>mo(e,"name",a)),t[23](e),e.$on("measure",t[11])),{c(){e&&Et(e.$$.fragment),n=Tn()},m(c,d){e&&Rt(e,c,d),et(c,n,d),r=!0},p(c,d){const u=34&d[0]?fr(o,[32&d[0]&&Rr(c[5]),2&d[0]&&{locale:c[1]}]):{};if(!i&&8&d[0]&&(i=!0,u.name=c[3],vo(()=>i=!1)),s!==(s=c[10])){if(e){Ie();const p=e;z(p.$$.fragment,1,0,()=>{It(p,1)}),Ee()}s?(e=yu(s,l(c)),zi.push(()=>mo(e,"name",a)),c[23](e),e.$on("measure",c[11]),Et(e.$$.fragment),P(e.$$.fragment,1),Rt(e,n.parentNode,n)):e=null}else s&&e.$set(u)},i(c){r||(e&&P(e.$$.fragment,c),r=!0)},o(c){e&&z(e.$$.fragment,c),r=!1},d(c){t[23](null),c&&Q(n),e&&It(e,c)}}}function o4(t){let e,i,n,r=t[6]&&E$(t);return{c(){e=ht("div"),r&&r.c(),v(e,"data-util",t[3]),v(e,"class",i=mi(["PinturaUtilPanel",t[2]])),v(e,"style",t[7])},m(o,a){et(o,e,a),r&&r.m(e,null),t[24](e),n=!0},p(o,a){o[6]?r?(r.p(o,a),64&a[0]&&P(r,1)):(r=E$(o),r.c(),P(r,1),r.m(e,null)):r&&(Ie(),z(r,1,1,()=>{r=null}),Ee()),(!n||8&a[0])&&v(e,"data-util",o[3]),(!n||4&a[0]&&i!==(i=mi(["PinturaUtilPanel",o[2]])))&&v(e,"class",i),(!n||128&a[0])&&v(e,"style",o[7])},i(o){n||(P(r),n=!0)},o(o){z(r),n=!1},d(o){o&&Q(e),r&&r.d(),t[24](null)}}}function a4(t,e,i){let n,r,o,a,s;const l=ba();let{isActive:c=!0}=e,{stores:d}=e,{view:u}=e,{props:p}=e,{component:h}=e,{locale:g}=e,{class:m}=e;const f=sn("isAnimated");let b;A(t,f,N=>i(21,s=N));const w=pi(0),S=Ei(w,N=>tn(N,0,1));A(t,S,N=>i(20,a=N));let C=!c;const I=ue(c),M={isActive:Ei(I,async(N,it)=>{if(!N)return it(N);await Xy(),it(N)},!1),isActiveFraction:Ei(S,N=>N),isVisible:Ei(S,N=>N>0)},D=u,T=Xh(D),F=Object.keys(p||{}).reduce((N,it)=>(T.includes(it)&&(N[it]=p[it]),N),{}),W=Object.keys(M).reduce((N,it)=>(T.includes(it)&&(N[it]=M[it]),N),{});let O,y;const V=N=>{i(17,b={...N.detail}),k&&c&&l("measure",{...b})};po("measurable",yr);const tt=ll().$$.context;let k=!1;return As(()=>{if(i(19,k=!0),o)return;i(0,h=new D({target:y,props:{...r,locale:g},context:tt})),i(3,O=h.name);const N=h.$on("measure",V);return()=>{N(),h.$destroy()}}),t.$$set=N=>{"isActive"in N&&i(12,c=N.isActive),"stores"in N&&i(13,d=N.stores),"view"in N&&i(14,u=N.view),"props"in N&&i(15,p=N.props),"component"in N&&i(0,h=N.component),"locale"in N&&i(1,g=N.locale),"class"in N&&i(2,m=N.class)},t.$$.update=()=>{135169&t.$$.dirty[0]&&b&&c&&h&&l("measure",b),2101248&t.$$.dirty[0]&&w.set(c?1:0,{hard:s===!1}),1310720&t.$$.dirty[0]&&(a<=0&&!C?i(18,C=!0):a>0&&C&&i(18,C=!1)),786432&t.$$.dirty[0]&&k&&l(C?"hide":"show"),1048576&t.$$.dirty[0]&&l("fade",a),1048576&t.$$.dirty[0]&&i(7,n=a<1?"opacity: "+a:void 0),4096&t.$$.dirty[0]&&I.set(c),8192&t.$$.dirty[0]&&i(5,r={...F,...W,stores:d})},i(6,o=!T.includes("external")),[h,g,m,O,y,r,o,n,f,S,D,V,c,d,u,p,w,b,C,k,a,s,function(N){O=N,i(3,O)},function(N){zi[N?"unshift":"push"](()=>{h=N,i(0,h)})},function(N){zi[N?"unshift":"push"](()=>{y=N,i(4,y)})}]}class x2 extends ci{constructor(e){super(),li(this,e,a4,o4,oi,{isActive:12,stores:13,view:14,props:15,component:0,locale:1,class:2,opacity:16},null,[-1,-1])}get opacity(){return this.$$.ctx[16]}}function s4(t){let e,i,n;const r=t[5].default,o=rr(r,t,t[4],null);return{c(){e=gr("svg"),o&&o.c(),v(e,"class",t[3]),v(e,"style",t[2]),v(e,"width",t[0]),v(e,"height",t[1]),v(e,"viewBox",i="0 0 "+t[0]+`
    `+t[1]),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"aria-hidden","true"),v(e,"focusable","false"),v(e,"stroke-linecap","round"),v(e,"stroke-linejoin","round")},m(a,s){et(a,e,s),o&&o.m(e,null),n=!0},p(a,[s]){o&&o.p&&(!n||16&s)&&ar(o,r,a,a[4],n?or(r,a[4],s,null):sr(a[4]),null),(!n||8&s)&&v(e,"class",a[3]),(!n||4&s)&&v(e,"style",a[2]),(!n||1&s)&&v(e,"width",a[0]),(!n||2&s)&&v(e,"height",a[1]),(!n||3&s&&i!==(i="0 0 "+a[0]+`
    `+a[1]))&&v(e,"viewBox",i)},i(a){n||(P(o,a),n=!0)},o(a){z(o,a),n=!1},d(a){a&&Q(e),o&&o.d(a)}}}function l4(t,e,i){let{$$slots:n={},$$scope:r}=e,{width:o=24}=e,{height:a=24}=e,{style:s}=e,{class:l}=e;return t.$$set=c=>{"width"in c&&i(0,o=c.width),"height"in c&&i(1,a=c.height),"style"in c&&i(2,s=c.style),"class"in c&&i(3,l=c.class),"$$scope"in c&&i(4,r=c.$$scope)},[o,a,s,l,r,n]}class wo extends ci{constructor(e){super(),li(this,e,l4,s4,oi,{width:0,height:1,style:2,class:3})}}var b2=(t,e)=>e===t.target||e.contains(t.target),A$=(t,e,i)=>{const n=_e(e)?e:t;return i?`${n} (${r=i,r.map(o=>o==="CMD"?Tu()?"â":"Ctrl":o).join("+")})`:n;var r};function L$(t){let e,i;return e=new wo({props:{class:"PinturaButtonIcon",$$slots:{default:[c4]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};536870920&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function c4(t){let e;return{c(){e=gr("g")},m(i,n){et(i,e,n),e.innerHTML=t[3]},p(i,n){8&n&&(e.innerHTML=i[3])},d(i){i&&Q(e)}}}function z$(t){let e;return{c(){e=ht("span"),v(e,"class",t[11])},m(i,n){et(i,e,n),e.innerHTML=t[0]},p(i,n){1&n&&(e.innerHTML=i[0]),2048&n&&v(e,"class",i[11])},d(i){i&&Q(e)}}}function d4(t){let e,i,n,r,o;const a=t[27].default,s=rr(a,t,t[29],null),l=s||function(c){let d,u,p,h=c[3]&&L$(c),g=c[0]&&z$(c);return{c(){d=ht("span"),h&&h.c(),u=pe(),g&&g.c(),v(d,"class",c[13])},m(m,f){et(m,d,f),h&&h.m(d,null),Ct(d,u),g&&g.m(d,null),p=!0},p(m,f){m[3]?h?(h.p(m,f),8&f&&P(h,1)):(h=L$(m),h.c(),P(h,1),h.m(d,u)):h&&(Ie(),z(h,1,1,()=>{h=null}),Ee()),m[0]?g?g.p(m,f):(g=z$(m),g.c(),g.m(d,null)):g&&(g.d(1),g=null),(!p||8192&f)&&v(d,"class",m[13])},i(m){p||(P(h),p=!0)},o(m){z(h),p=!1},d(m){m&&Q(d),h&&h.d(),g&&g.d()}}}(t);return{c(){e=ht("button"),l&&l.c(),v(e,"type",t[6]),v(e,"style",t[4]),e.disabled=t[5],v(e,"class",t[12]),v(e,"title",i=A$(t[0],t[1],t[2]))},m(c,d){et(c,e,d),l&&l.m(e,null),t[28](e),n=!0,r||(o=[Mt(e,"keydown",function(){Zi(t[8])&&t[8].apply(this,arguments)}),Mt(e,"click",function(){Zi(t[7])&&t[7].apply(this,arguments)}),Mt(e,"pointerdown",function(){Zi(t[14])&&t[14].apply(this,arguments)}),Xi(t[9].call(null,e))],r=!0)},p(c,[d]){t=c,s?s.p&&(!n||536870912&d)&&ar(s,a,t,t[29],n?or(a,t[29],d,null):sr(t[29]),null):l&&l.p&&(!n||10249&d)&&l.p(t,n?d:-1),(!n||64&d)&&v(e,"type",t[6]),(!n||16&d)&&v(e,"style",t[4]),(!n||32&d)&&(e.disabled=t[5]),(!n||4096&d)&&v(e,"class",t[12]),(!n||7&d&&i!==(i=A$(t[0],t[1],t[2])))&&v(e,"title",i)},i(c){n||(P(l,c),n=!0)},o(c){z(l,c),n=!1},d(c){c&&Q(e),l&&l.d(c),t[28](null),r=!1,Ui(o)}}}function u4(t,e,i){let n,r,o,a,s,l,{$$slots:c={},$$scope:d}=e,{class:u}=e,{label:p}=e,{title:h}=e,{shortcut:g}=e,{labelClass:m}=e,{innerClass:f}=e,{hideLabel:b=!1}=e,{icon:w}=e,{style:S}=e,{disabled:C}=e,{type:I="button"}=e,{onclick:M}=e,{onkeydown:D}=e,{onhold:T}=e,{action:F=()=>{}}=e,{holdThreshold:W=500}=e,{holdSpeedUpFactor:O=.5}=e,{holdSpeedMin:y=20}=e;const V=k=>{i(25,l=setTimeout(()=>{T(),V(Math.max(k*O,y))},k))};let tt;return t.$$set=k=>{"class"in k&&i(15,u=k.class),"label"in k&&i(0,p=k.label),"title"in k&&i(1,h=k.title),"shortcut"in k&&i(2,g=k.shortcut),"labelClass"in k&&i(16,m=k.labelClass),"innerClass"in k&&i(17,f=k.innerClass),"hideLabel"in k&&i(18,b=k.hideLabel),"icon"in k&&i(3,w=k.icon),"style"in k&&i(4,S=k.style),"disabled"in k&&i(5,C=k.disabled),"type"in k&&i(6,I=k.type),"onclick"in k&&i(7,M=k.onclick),"onkeydown"in k&&i(8,D=k.onkeydown),"onhold"in k&&i(19,T=k.onhold),"action"in k&&i(9,F=k.action),"holdThreshold"in k&&i(20,W=k.holdThreshold),"holdSpeedUpFactor"in k&&i(21,O=k.holdSpeedUpFactor),"holdSpeedMin"in k&&i(22,y=k.holdSpeedMin),"$$scope"in k&&i(29,d=k.$$scope)},t.$$.update=()=>{101187584&t.$$.dirty&&i(26,r=T?()=>{l&&(clearTimeout(l),i(25,l=void 0),document.documentElement.removeEventListener("pointerup",r))}:me),68681728&t.$$.dirty&&i(14,n=T?()=>{document.documentElement.addEventListener("pointerup",r),V(W)}:me),131072&t.$$.dirty&&i(13,o=mi(["PinturaButtonInner",f])),294912&t.$$.dirty&&i(12,a=mi(["PinturaButton",b&&"PinturaButtonIconOnly",u])),327680&t.$$.dirty&&i(11,s=mi([b?"implicit":"PinturaButtonLabel",m]))},[p,h,g,w,S,C,I,M,D,F,tt,s,a,o,n,u,m,f,b,T,W,O,y,k=>b2(k,tt),()=>tt,l,r,c,function(k){zi[k?"unshift":"push"](()=>{tt=k,i(10,tt)})},d]}class zs extends ci{constructor(e){super(),li(this,e,u4,d4,oi,{class:15,label:0,title:1,shortcut:2,labelClass:16,innerClass:17,hideLabel:18,icon:3,style:4,disabled:5,type:6,onclick:7,onkeydown:8,onhold:19,action:9,holdThreshold:20,holdSpeedUpFactor:21,holdSpeedMin:22,isEventTarget:23,getElement:24})}get isEventTarget(){return this.$$.ctx[23]}get getElement(){return this.$$.ctx[24]}}var v2=(t,e)=>{const i=t.findIndex(e);if(i>=0)return t.splice(i,1)};const p4=80;var Fs=(t,e={})=>{const{inertia:i=!1,inertiaDurationMultiplier:n=p4,shouldStartInteraction:r=()=>!0,pinch:o=!1,multiTouch:a,getEventPosition:s=lt=>ot(lt.clientX,lt.clientY),observeKeys:l=!1}=e;function c(lt,kt){t.dispatchEvent(new CustomEvent(lt,{detail:kt}))}function d(){M&&M(),M=void 0}const u=[],p=lt=>lt.timeStamp===0?Date.now():lt.timeStamp,h=()=>{const lt=Be(u[0].position);if(u[1]){const kt=.5*(u[1].position.x-lt.x),J=.5*(u[1].position.y-lt.y);lt.x+=kt,lt.y+=J}return lt},g=lt=>{lt.origin.x=lt.position.x,lt.origin.y=lt.position.y,lt.translation.x=0,lt.translation.y=0},m=lt=>{const kt=(J=>u.findIndex(q=>q.event.pointerId===J.pointerId))(lt);if(!(kt<0))return u[kt]},f=()=>u.length===1,b=()=>u.length===2,w=lt=>{const kt=Do(lt.map(J=>J.position));return{center:kt,distance:((J,q)=>J.reduce((Z,xt)=>Z+ho(q,xt.position),0)/J.length)(lt,kt),velocity:Do(lt.map(J=>J.velocity)),translation:Do(lt.map(J=>J.translation))}};let S,C,I,M,D,T,F,W,O=0,y;t.addEventListener("pointerdown",it);const V=["Meta","Control","Alt","Shift"];function tt(lt){if(!V.includes(lt.key))return;const{metaKey:kt,ctrlKey:J,altKey:q,shiftKey:Z}=lt;N({metaKey:kt,ctrlKey:J,altKey:q,shiftKey:Z})}let k=Date.now();const N=lt=>{const kt=Be(u[0].translation);let J=F;o&&b()&&(J*=ho(u[0].position,u[1].position)/D,Dn(kt,u[1].translation)),Dn(kt,T);const q=Date.now();q-k<16||(k=q,c("interactionupdate",{position:h(),translation:kt,scalar:o?J:void 0,isMultiTouching:b(),...lt}))};function it(lt){if(!b()&&!(kt=>hi(kt.button)&&kt.button!==0)(lt)&&r(lt,t)){if(d(),(kt=>{const J=p(kt),q={timeStamp:J,timeStampInitial:J,position:s(kt),origin:s(kt),velocity:rn(),velocityHistory:[],velocityAverage:rn(),translation:rn(),interactionState:void 0,event:kt};u.push(q),q.interactionState=w(u)})(lt),l&&(window.addEventListener("keydown",tt),window.addEventListener("keyup",tt)),f())document.documentElement.addEventListener("pointermove",ut),document.documentElement.addEventListener("pointerup",at),document.documentElement.addEventListener("pointercancel",at),document.addEventListener("visibilitychange",G),W=!1,F=1,T=rn(),D=void 0,c("interactionstart",{origin:Be(m(lt).origin)});else if(o)W=!0,D=ho(u[0].position,u[1].position),T.x+=u[0].translation.x,T.y+=u[0].translation.y,g(u[0]);else if(a===!1)return u.length=0,vt(),c("interactioncancel")}}function ut(lt){lt.preventDefault(),(xt=>{const nt=m(xt);if(!nt)return;const mt=p(xt),zt=s(xt),oe=Math.max(1,mt-nt.timeStamp);nt.velocity.x=(zt.x-nt.position.x)/oe,nt.velocity.y=(zt.y-nt.position.y)/oe,nt.velocityHistory.push(Be(nt.velocity)),nt.velocityHistory=nt.velocityHistory.slice(-3),nt.velocityAverage=nt.velocityHistory.reduce((Dt,te,Kt,U)=>(Dt.x+=te.x/U.length,Dt.y+=te.y/U.length,Dt),rn()),nt.translation.x=zt.x-nt.origin.x,nt.translation.y=zt.y-nt.origin.y,nt.timeStamp=mt,nt.position.x=zt.x,nt.position.y=zt.y,nt.event=xt})(lt);const{metaKey:kt=!1,ctrlKey:J=!1,altKey:q=!1,shiftKey:Z=!1}=l?lt:{};N({metaKey:kt,ctrlKey:J,altKey:q,shiftKey:Z})}function at(lt){if(!m(lt))return;const kt=h(),J=(oe=>{const Dt=v2(u,te=>te.event.pointerId===oe.pointerId);if(Dt)return Dt[0]})(lt);if(o&&f()){const oe=ho(u[0].position,J.position);F*=oe/D,T.x+=u[0].translation.x+J.translation.x,T.y+=u[0].translation.y+J.translation.y,g(u[0])}let q=!1,Z=!1;if(!W&&J){const oe=performance.now(),Dt=oe-J.timeStampInitial;q=yo(J.translation)<64&&Dt<300,Z=!!(y&&q&&oe-O<700&&yo(y,J.position)<128),q&&(y=Be(J.position),O=oe)}if(u.length>0)return;vt();const xt=Be(J.translation),nt=Be(J.velocityAverage);let mt=!1;c("interactionrelease",{isTap:q,isDoubleTap:Z,position:kt,translation:xt,scalar:F,preventInertia:()=>mt=!0});const zt=ho(nt);if(mt||!i||zt<.25)return $t(xt,{isTap:q,isDoubleTap:Z});C=Be(kt),I=Be(xt),S=Gh(Be(xt),{easing:Nv,duration:zt*n}),S.set({x:xt.x+50*nt.x,y:xt.y+50*nt.y}).then(()=>{M&&$t(fa(S),{isTap:q,isDoubleTap:Z})}),M=S.subscribe(gt)}function gt(lt){lt&&c("interactionupdate",{position:ot(C.x+(lt.x-I.x),C.y+(lt.y-I.y)),translation:lt,scalar:o?F:void 0})}function G(lt){if(document.visibilityState==="visible"||!u.length)return;const kt=w(u);d(),c("interactionend",{...kt}),u.length=0,vt()}function $t(lt,kt){d(),c("interactionend",{...kt,translation:lt,scalar:o?F:void 0})}function vt(){l&&window.removeEventListener("keydown",tt),l&&window.removeEventListener("keyup",tt),document.documentElement.removeEventListener("pointermove",ut),document.documentElement.removeEventListener("pointerup",at),document.documentElement.removeEventListener("pointercancel",at),document.addEventListener("visibilitychange",G)}return{destroy(){d(),t.removeEventListener("pointerdown",it)}}},Ds=(t,e={})=>{const{direction:i,shiftMultiplier:n=10,bubbles:r=!1,preventDefault:o=!1,stopKeydownPropagation:a=!0}=e,s=i==="horizontal",l=i==="vertical",c=d=>{const{key:u}=d,p=d.shiftKey,h=/up|down/i.test(u),g=/left|right/i.test(u);if(!g&&!h||s&&h||l&&g)return;const m=p?n:1;a&&d.stopPropagation(),o&&d.preventDefault(),t.dispatchEvent(new CustomEvent("nudge",{bubbles:r,detail:ot((/left/i.test(u)?-1:/right/i.test(u)?1:0)*m,(/up/i.test(u)?-1:/down/i.test(u)?1:0)*m)}))};return t.addEventListener("keydown",c),{destroy(){t.removeEventListener("keydown",c)}}};function vs(t,e){return e?e*Math.sign(t)*Math.log10(1+Math.abs(t)/e):t}const F$=(t,e,i)=>{if(!e||!i)return{...t};const n=t.x+vs(e.x-t.x,i),r=t.x+t.width+vs(e.x+e.width-(t.x+t.width),i),o=t.y+vs(e.y-t.y,i);return{x:n,y:o,width:r-n,height:t.y+t.height+vs(e.y+e.height-(t.y+t.height),i)-o}},h4=(t,e,i)=>e&&i?ot(t.x+vs(e.x-t.x,i),t.y+vs(e.y-t.y,i)):{...t};var w2=(t,e)=>{if(t)return/em/.test(t)?16*parseInt(t,10):/px/.test(t)?parseInt(t,10):void 0},Au=(t,e)=>{let i=t.detail||0;const{deltaX:n,deltaY:r,wheelDelta:o,wheelDeltaX:a,wheelDeltaY:s}=t,{fixScrollDirection:l=!1}=e||{};return hi(a)&&Math.abs(a)>Math.abs(s)?i=a/-120:hi(n)&&Math.abs(n)>Math.abs(r)?i=n/20:(o||s)&&(i=(o||s)/-120),i||(i=r/20),(ya()||Ea())&&(i*=2),l&&Tu()&&(i*=-1),i};function m4(t){let e,i,n,r,o,a,s;const l=t[37].default,c=rr(l,t,t[36],null);return{c(){e=ht("div"),i=ht("div"),c&&c.c(),v(i,"style",t[5]),v(e,"class",n=mi(["PinturaScrollable",t[0]])),v(e,"style",t[4]),v(e,"data-direction",t[1]),v(e,"data-state",t[6])},m(d,u){et(d,e,u),Ct(e,i),c&&c.m(i,null),t[39](e),o=!0,a||(s=[Mt(i,"interactionstart",t[9]),Mt(i,"interactionupdate",t[11]),Mt(i,"interactionend",t[12]),Mt(i,"interactionrelease",t[10]),Xi(Fs.call(null,i,{inertia:!0})),Mt(i,"measure",t[38]),Xi(yr.call(null,i)),Mt(e,"wheel",t[14],{passive:!1}),Mt(e,"scroll",t[16]),Mt(e,"focusin",t[15]),Mt(e,"nudge",t[17]),Mt(e,"measure",t[13]),Xi(yr.call(null,e,{observePosition:!0})),Xi(r=Ds.call(null,e,{direction:t[1]==="x"?"horizontal":"vertical",stopKeydownPropagation:!1}))],a=!0)},p(d,u){c&&c.p&&(!o||32&u[1])&&ar(c,l,d,d[36],o?or(l,d[36],u,null):sr(d[36]),null),(!o||32&u[0])&&v(i,"style",d[5]),(!o||1&u[0]&&n!==(n=mi(["PinturaScrollable",d[0]])))&&v(e,"class",n),(!o||16&u[0])&&v(e,"style",d[4]),(!o||2&u[0])&&v(e,"data-direction",d[1]),(!o||64&u[0])&&v(e,"data-state",d[6]),r&&Zi(r.update)&&2&u[0]&&r.update.call(null,{direction:d[1]==="x"?"horizontal":"vertical",stopKeydownPropagation:!1})},i(d){o||(P(c,d),o=!0)},o(d){z(c,d),o=!1},d(d){d&&Q(e),c&&c.d(d),t[39](null),a=!1,Ui(s)}}}function $4(t,e,i){let n,r,o,a,s,l,c,d,u,{$$slots:p={},$$scope:h}=e;const g=ba();let m,f,b,w,S="idle",C=pi(0);A(t,C,q=>i(35,d=q));let{class:I}=e,{scrollBlockInteractionDist:M=5}=e,{scrollStep:D=10}=e,{scrollFocusMargin:T=64}=e,{scrollDirection:F="x"}=e,{scrollAutoCancel:W=!1}=e,{elasticity:O=0}=e,{onscroll:y=me}=e,{maskFeatherSize:V}=e,{maskFeatherStartOpacity:tt}=e,{maskFeatherEndOpacity:k}=e,{scroll:N}=e;const it=sn("fixScrollDirection");let ut;A(t,it,q=>i(46,u=q));let at="",gt=!0;const G=C.subscribe(q=>{const Z=rn();Z[F]=q,y(Z)}),$t=q=>Math.max(Math.min(0,q),b[n]-f[n]);let vt,lt,kt;const J=(q,Z={})=>{const{elastic:xt=!1,animate:nt=!1,preventScrollState:mt=!1}=Z;Math.abs(q-m)>M&&S==="idle"&&!w&&!mt&&i(28,S="scrolling");const zt=$t(q),oe=xt&&O&&!w?zt+vs(q-zt,O):zt;let Dt=!0;nt?Dt=!1:gt||(Dt=!w),gt=!1,C.set(oe,{hard:Dt}).then(te=>{w&&(gt=!0)})};return _o(()=>{G()}),t.$$set=q=>{"class"in q&&i(0,I=q.class),"scrollBlockInteractionDist"in q&&i(21,M=q.scrollBlockInteractionDist),"scrollStep"in q&&i(22,D=q.scrollStep),"scrollFocusMargin"in q&&i(23,T=q.scrollFocusMargin),"scrollDirection"in q&&i(1,F=q.scrollDirection),"scrollAutoCancel"in q&&i(24,W=q.scrollAutoCancel),"elasticity"in q&&i(25,O=q.elasticity),"onscroll"in q&&i(26,y=q.onscroll),"maskFeatherSize"in q&&i(20,V=q.maskFeatherSize),"maskFeatherStartOpacity"in q&&i(18,tt=q.maskFeatherStartOpacity),"maskFeatherEndOpacity"in q&&i(19,k=q.maskFeatherEndOpacity),"scroll"in q&&i(27,N=q.scroll),"$$scope"in q&&i(36,h=q.$$scope)},t.$$.update=()=>{if(2&t.$$.dirty[0]&&i(32,n=F==="x"?"width":"height"),2&t.$$.dirty[0]&&i(30,r=F.toUpperCase()),8&t.$$.dirty[0]&&i(34,o=ut&&getComputedStyle(ut)),8&t.$$.dirty[0]|8&t.$$.dirty[1]&&i(33,a=o&&w2(o.getPropertyValue("--scrollable-feather-size"))),537657348&t.$$.dirty[0]|22&t.$$.dirty[1]&&d!=null&&b&&a!=null&&f){const q=-1*d/a,Z=-(b[n]-f[n]-d)/a;i(18,tt=tn(1-q,0,1)),i(19,k=tn(1-Z,0,1)),i(20,V=a),i(4,at=`--scrollable-feather-start-opacity: ${tt};--scrollable-feather-end-opacity: ${k}`)}134217736&t.$$.dirty[0]&&ut&&N!==void 0&&(hi(N)?J(N):J(N.scrollOffset,N)),536870916&t.$$.dirty[0]|2&t.$$.dirty[1]&&i(31,s=b&&f?f[n]>b[n]:void 0),268435456&t.$$.dirty[0]|1&t.$$.dirty[1]&&i(6,l=mi([S,s?"overflows":void 0])),1073741824&t.$$.dirty[0]|17&t.$$.dirty[1]&&i(5,c=s?`transform: translate${r}(${d}px)`:void 0)},[I,F,f,ut,at,c,l,C,it,()=>{s&&(lt=!1,vt=!0,kt=ot(0,0),w=!1,i(28,S="idle"),m=fa(C))},({detail:q})=>{s&&(w=!0,i(28,S="idle"))},({detail:q})=>{s&&(lt||vt&&(vt=!1,yo(q.translation)<.1)||(!W||F!=="x"||(Z=>{const xt=bo(ot(Z.x-kt.x,Z.y-kt.y),Math.abs);kt=Be(Z);const nt=yo(xt),mt=xt.x-xt.y;return!(nt>1&&mt<-.5)})(q.translation)?J(m+q.translation[F],{elastic:!0}):lt=!0))},({detail:q})=>{if(!s||lt)return;const Z=m+q.translation[F],xt=$t(Z);gt=!1,C.set(xt).then(nt=>{w&&(gt=!0)})},({detail:q})=>{i(29,b=q),g("measure",{x:q.x,y:q.y,width:q.width,height:q.height})},q=>{if(!s)return;q.preventDefault(),q.stopPropagation();const Z=q.shiftKey,xt=Au(q,{fixScrollDirection:u})*(Z?-1:1),nt=fa(C);J(nt+xt*D,{animate:!0})},q=>{if(!s||!w)return;let Z=q.target;q.target.classList.contains("implicit")&&(Z=Z.parentNode);const xt=Z[F==="x"?"offsetLeft":"offsetTop"],nt=xt+Z[F==="x"?"offsetWidth":"offsetHeight"],mt=fa(C),zt=T+V;mt+xt<zt?J(-xt+zt):mt+nt>b[n]-zt&&J(b[n]-nt-zt,{animate:!0})},()=>{i(3,ut[F==="x"?"scrollLeft":"scrollTop"]=0,ut)},({detail:q})=>{if(ut.querySelector("[data-focus-visible]"))return;const Z=-2*q[F],xt=fa(C);J(xt+Z*D,{animate:!0,preventScrollState:!0})},tt,k,V,M,D,T,W,O,y,N,S,b,r,s,n,a,o,d,h,p,q=>i(2,f=q.detail),function(q){zi[q?"unshift":"push"](()=>{ut=q,i(3,ut)})}]}class va extends ci{constructor(e){super(),li(this,e,$4,m4,oi,{class:0,scrollBlockInteractionDist:21,scrollStep:22,scrollFocusMargin:23,scrollDirection:1,scrollAutoCancel:24,elasticity:25,onscroll:26,maskFeatherSize:20,maskFeatherStartOpacity:18,maskFeatherEndOpacity:19,scroll:27},null,[-1,-1])}}function g4(t){let e,i,n,r,o;return{c(){e=ht("span"),v(e,"class","PinturaStatusMessage")},m(a,s){et(a,e,s),e.innerHTML=t[0],n=!0,r||(o=[Mt(e,"measure",function(){Zi(t[1])&&t[1].apply(this,arguments)}),Xi(yr.call(null,e))],r=!0)},p(a,[s]){t=a,(!n||1&s)&&(e.innerHTML=t[0])},i(a){n||(Wl(()=>{i||(i=Jm(e,t[4],{duration:t[2]},!0)),i.run(1)}),n=!0)},o(a){i||(i=Jm(e,t[4],{duration:t[2]},!1)),i.run(0),n=!1},d(a){a&&Q(e),a&&i&&i.end(),r=!1,Ui(o)}}}function f4(t,e,i){let n,r,{text:o}=e,{onmeasure:a=me}=e;const s=sn("isAnimated");return A(t,s,l=>i(5,r=l)),t.$$set=l=>{"text"in l&&i(0,o=l.text),"onmeasure"in l&&i(1,a=l.onmeasure)},t.$$.update=()=>{32&t.$$.dirty&&i(2,n=r?500:0)},[o,a,n,s,function(l,{duration:c}){return{duration:c,tick:d=>{l.style.opacity=d}}},r]}class S2 extends ci{constructor(e){super(),li(this,e,f4,g4,oi,{text:0,onmeasure:1})}}function y4(t){let e,i,n,r,o,a,s,l,c;return{c(){e=ht("span"),i=gr("svg"),n=gr("g"),r=gr("circle"),o=gr("circle"),a=pe(),s=ht("span"),l=mn(t[3]),v(r,"class","PinturaProgressIndicatorBar"),v(r,"r","8.5"),v(r,"cx","10"),v(r,"cy","10"),v(r,"stroke-linecap","round"),v(r,"opacity",".25"),v(o,"class","PinturaProgressIndicatorFill"),v(o,"r","8.5"),v(o,"stroke-dasharray",t[2]),v(o,"cx","10"),v(o,"cy","10"),v(o,"transform","rotate(-90) translate(-20)"),v(n,"fill","none"),v(n,"stroke","currentColor"),v(n,"stroke-width","2.5"),v(n,"stroke-linecap","round"),v(n,"opacity",t[1]),v(i,"width","20"),v(i,"height","20"),v(i,"viewBox","0 0 20 20"),v(i,"xmlns","http://www.w3.org/2000/svg"),v(i,"aria-hidden","true"),v(i,"focusable","false"),v(s,"class","implicit"),v(e,"class","PinturaProgressIndicator"),v(e,"data-status",t[0]),v(e,"style",c="opacity:"+t[4])},m(d,u){et(d,e,u),Ct(e,i),Ct(i,n),Ct(n,r),Ct(n,o),Ct(e,a),Ct(e,s),Ct(s,l)},p(d,[u]){4&u&&v(o,"stroke-dasharray",d[2]),2&u&&v(n,"opacity",d[1]),8&u&&In(l,d[3]),1&u&&v(e,"data-status",d[0]),16&u&&c!==(c="opacity:"+d[4])&&v(e,"style",c)},i:ni,o:ni,d(d){d&&Q(e)}}}function x4(t,e,i){let n,r,o,a,s,l,c,d;const u=ba();let{progress:p}=e,{min:h=0}=e,{max:g=100}=e,{labelBusy:m="Busy"}=e,{opacity:f}=e;const b=sn("isAnimated");A(t,b,D=>i(14,s=D));const w=pi(f,{precision:.01});A(t,w,D=>i(4,d=D));const S=pi(0,{precision:.01}),C=pi(0,{precision:.01});A(t,C,D=>i(15,l=D));const I=Ei([S],D=>tn(D,h,g));A(t,I,D=>i(16,c=D));const M=I.subscribe(D=>{p===1&&Math.round(D)>=100&&u("complete")});return As(()=>{C.set(1,{hard:!s})}),_o(()=>{M()}),t.$$set=D=>{"progress"in D&&i(9,p=D.progress),"min"in D&&i(10,h=D.min),"max"in D&&i(11,g=D.max),"labelBusy"in D&&i(12,m=D.labelBusy),"opacity"in D&&i(13,f=D.opacity)},t.$$.update=()=>{24576&t.$$.dirty&&hi(f)&&w.set(f,{hard:!s}),16896&t.$$.dirty&&p&&p!==1/0&&S.set(100*p,{hard:!s}),70144&t.$$.dirty&&i(3,n=p===1/0?m:Math.round(c)+"%"),66048&t.$$.dirty&&i(2,r=p===1/0?"26.5 53":c/100*53+" 53"),32768&t.$$.dirty&&i(1,o=l),512&t.$$.dirty&&i(0,a=p===1/0?"busy":"loading")},[a,o,r,n,d,b,w,C,I,p,h,g,m,f,s,l,c]}class k2 extends ci{constructor(e){super(),li(this,e,x4,y4,oi,{progress:9,min:10,max:11,labelBusy:12,opacity:13})}}function b4(t){let e,i,n;const r=t[5].default,o=rr(r,t,t[4],null);return{c(){e=ht("span"),o&&o.c(),v(e,"class",i="PinturaStatusAside "+t[0]),v(e,"style",t[1])},m(a,s){et(a,e,s),o&&o.m(e,null),n=!0},p(a,[s]){o&&o.p&&(!n||16&s)&&ar(o,r,a,a[4],n?or(r,a[4],s,null):sr(a[4]),null),(!n||1&s&&i!==(i="PinturaStatusAside "+a[0]))&&v(e,"class",i),(!n||2&s)&&v(e,"style",a[1])},i(a){n||(P(o,a),n=!0)},o(a){z(o,a),n=!1},d(a){a&&Q(e),o&&o.d(a)}}}function v4(t,e,i){let n,{$$slots:r={},$$scope:o}=e,{offset:a=0}=e,{opacity:s=0}=e,{class:l}=e;return t.$$set=c=>{"offset"in c&&i(2,a=c.offset),"opacity"in c&&i(3,s=c.opacity),"class"in c&&i(0,l=c.class),"$$scope"in c&&i(4,o=c.$$scope)},t.$$.update=()=>{12&t.$$.dirty&&i(1,n=`transform:translateX(${a}px);opacity:${s}`)},[l,n,a,s,o,r]}class C2 extends ci{constructor(e){super(),li(this,e,v4,b4,oi,{offset:2,opacity:3,class:0})}}const{document:D$}=Yy;function w4(t){let e,i,n,r;return{c(){e=pe(),i=ht("button"),v(i,"class","PinturaImageButton"),v(i,"type","button"),v(i,"title",t[1]),i.disabled=t[2]},m(o,a){et(o,e,a),et(o,i,a),i.innerHTML=t[0],t[11](i),n||(r=[Mt(D$.body,"load",t[5],!0),Mt(D$.body,"error",t[6],!0),Mt(i,"pointerdown",t[4])],n=!0)},p(o,[a]){1&a&&(i.innerHTML=o[0]),2&a&&v(i,"title",o[1]),4&a&&(i.disabled=o[2])},i:ni,o:ni,d(o){o&&Q(e),o&&Q(i),t[11](null),n=!1,Ui(r)}}}function S4(t,e,i){let n,{html:r}=e,{title:o}=e,{onclick:a}=e,{disabled:s=!1}=e,{ongrab:l=me}=e,{ondrag:c=me}=e,{ondrop:d=me}=e;const u=f=>yo(p,ot(f.pageX,f.pageY))<256;let p;const h=f=>{document.documentElement.removeEventListener("pointermove",g),document.documentElement.removeEventListener("pointerup",h);const b=ot(f.pageX,f.pageY);if(yo(p,b)<32)return a(f);u(f)||d(f)},g=f=>{u(f)||c(f)},m=f=>n&&n.contains(f)&&f.nodeName==="IMG";return t.$$set=f=>{"html"in f&&i(0,r=f.html),"title"in f&&i(1,o=f.title),"onclick"in f&&i(7,a=f.onclick),"disabled"in f&&i(2,s=f.disabled),"ongrab"in f&&i(8,l=f.ongrab),"ondrag"in f&&i(9,c=f.ondrag),"ondrop"in f&&i(10,d=f.ondrop)},t.$$.update=()=>{8&t.$$.dirty&&n&&n.querySelector("img")&&i(3,n.dataset.loader=!0,n)},[r,o,s,n,f=>{p=ot(f.pageX,f.pageY),l(f),document.documentElement.addEventListener("pointermove",g),document.documentElement.addEventListener("pointerup",h)},({target:f})=>{m(f)&&i(3,n.dataset.load=!0,n)},({target:f})=>{m(f)&&i(3,n.dataset.error=!0,n)},a,l,c,d,function(f){zi[f?"unshift":"push"](()=>{n=f,i(3,n)})}]}class T2 extends ci{constructor(e){super(),li(this,e,S4,w4,oi,{html:0,title:1,onclick:7,disabled:2,ongrab:8,ondrag:9,ondrop:10})}}function B$(t,e,i){const n=t.slice();return n[14]=e[i],n}function O$(t,e){let i,n,r,o,a,s,l;function c(){return e[10](e[14])}function d(...h){return e[11](e[14],...h)}function u(...h){return e[12](e[14],...h)}function p(...h){return e[13](e[14],...h)}return n=new T2({props:{onclick:c,ongrab:d,ondrag:u,ondrop:p,disabled:e[1]||e[14].disabled,title:e[14].title,html:e[14].thumb}}),{key:t,first:null,c(){i=ht("li"),Et(n.$$.fragment),r=pe(),v(i,"style",e[6]),this.first=i},m(h,g){et(h,i,g),Rt(n,i,null),Ct(i,r),a=!0,s||(l=Xi(o=e[8].call(null,i,e[14])),s=!0)},p(h,g){e=h;const m={};5&g&&(m.onclick=c),9&g&&(m.ongrab=d),17&g&&(m.ondrag=u),33&g&&(m.ondrop=p),3&g&&(m.disabled=e[1]||e[14].disabled),1&g&&(m.title=e[14].title),1&g&&(m.html=e[14].thumb),n.$set(m),(!a||64&g)&&v(i,"style",e[6]),o&&Zi(o.update)&&1&g&&o.update.call(null,e[14])},i(h){a||(P(n.$$.fragment,h),a=!0)},o(h){z(n.$$.fragment,h),a=!1},d(h){h&&Q(i),It(n),s=!1,l()}}}function k4(t){let e,i,n=[],r=new Map,o=t[0];const a=s=>s[14].id;for(let s=0;s<o.length;s+=1){let l=B$(t,o,s),c=a(l);r.set(c,n[s]=O$(c,l))}return{c(){e=ht("ul");for(let s=0;s<n.length;s+=1)n[s].c();v(e,"class","PinturaImageButtonList")},m(s,l){et(s,e,l);for(let c=0;c<n.length;c+=1)n[c].m(e,null);i=!0},p(s,[l]){127&l&&(o=s[0],Ie(),n=La(n,l,a,1,s,o,r,e,Ls,O$,null,B$),Ee())},i(s){if(!i){for(let l=0;l<o.length;l+=1)P(n[l]);i=!0}},o(s){for(let l=0;l<n.length;l+=1)z(n[l]);i=!1},d(s){s&&Q(e);for(let l=0;l<n.length;l+=1)n[l].d()}}}function C4(t,e,i){let n,r,{items:o}=e,{disabled:a}=e,{onclickitem:s}=e,{ongrabitem:l}=e,{ondragitem:c}=e,{ondropitem:d}=e;const u=pi(0,{stiffness:.25,damping:.9});return A(t,u,p=>i(9,r=p)),As(()=>u.set(1)),t.$$set=p=>{"items"in p&&i(0,o=p.items),"disabled"in p&&i(1,a=p.disabled),"onclickitem"in p&&i(2,s=p.onclickitem),"ongrabitem"in p&&i(3,l=p.ongrabitem),"ondragitem"in p&&i(4,c=p.ondragitem),"ondropitem"in p&&i(5,d=p.ondropitem)},t.$$.update=()=>{512&t.$$.dirty&&i(6,n="opacity:"+r)},[o,a,s,l,c,d,n,u,(p,h)=>h.mount&&h.mount(p.firstChild,h),r,p=>s(p.id),(p,h)=>l&&l(p.id,h),(p,h)=>c&&c(p.id,h),(p,h)=>d&&d(p.id,h)]}class Yh extends ci{constructor(e){super(),li(this,e,C4,k4,oi,{items:0,disabled:1,onclickitem:2,ongrabitem:3,ondragitem:4,ondropitem:5})}}var Tc=()=>Pr()&&window.devicePixelRatio||1;let Lp=null;var Oc=t=>(Lp===null&&(Lp=Tc()===1?Math.round:e=>e),Lp(t)),ah=(t,e={})=>{if(t){if(e.preventScroll&&Ea()){const i=document.body.scrollTop;return t.focus(),void(document.body.scrollTop=i)}t.focus(e)}},M2=t=>/date|email|number|search|text|url/.test(t.type),Wc=t=>(e=>/textarea/i.test(e.nodeName))(t)||M2(t)||t.isContentEditable;const T4=t=>({}),W$=t=>({}),M4=t=>({}),_$=t=>({});function P4(t){let e,i;const n=[t[7]];let r={$$slots:{default:[I4]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new zs({props:r}),t[46](e),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=128&a[0]?fr(n,[Rr(o[7])]):{};524288&a[1]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){t[46](null),It(e,o)}}}function R4(t){let e,i;const n=[t[7]];let r={};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new zs({props:r}),t[45](e),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=128&a[0]?fr(n,[Rr(o[7])]):{};e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){t[45](null),It(e,o)}}}function I4(t){let e;const i=t[44].label,n=rr(i,t,t[50],_$);return{c(){n&&n.c()},m(r,o){n&&n.m(r,o),e=!0},p(r,o){n&&n.p&&(!e||524288&o[1])&&ar(n,i,r,r[50],e?or(i,r[50],o,M4):sr(r[50]),_$)},i(r){e||(P(n,r),e=!0)},o(r){z(n,r),e=!1},d(r){n&&n.d(r)}}}function V$(t){let e,i,n,r,o,a,s;const l=t[44].details,c=rr(l,t,t[50],W$);return{c(){e=ht("div"),c&&c.c(),i=pe(),n=ht("span"),v(n,"class","PinturaPanelTip"),v(n,"style",t[10]),v(e,"class",r=mi(["PinturaPanel","pintura-editor-panel",t[2]])),v(e,"tabindex","-1"),v(e,"style",t[11])},m(d,u){et(d,e,u),c&&c.m(e,null),Ct(e,i),Ct(e,n),t[47](e),o=!0,a||(s=[Mt(e,"close",t[48]),Mt(e,"keydown",t[18]),Mt(e,"measure",t[49]),Xi(yr.call(null,e))],a=!0)},p(d,u){c&&c.p&&(!o||524288&u[1])&&ar(c,l,d,d[50],o?or(l,d[50],u,T4):sr(d[50]),W$),(!o||1024&u[0])&&v(n,"style",d[10]),(!o||4&u[0]&&r!==(r=mi(["PinturaPanel","pintura-editor-panel",d[2]])))&&v(e,"class",r),(!o||2048&u[0])&&v(e,"style",d[11])},i(d){o||(P(c,d),o=!0)},o(d){z(c,d),o=!1},d(d){d&&Q(e),c&&c.d(d),t[47](null),a=!1,Ui(s)}}}function E4(t){let e,i,n,r,o,a,s,l,c;const d=[R4,P4],u=[];function p(g,m){return g[1]?0:1}i=p(t),n=u[i]=d[i](t);let h=t[6]&&V$(t);return{c(){e=pe(),n.c(),r=pe(),h&&h.c(),o=pe(),a=Tn()},m(g,m){et(g,e,m),u[i].m(g,m),et(g,r,m),h&&h.m(g,m),et(g,o,m),et(g,a,m),s=!0,l||(c=[Mt(document.body,"pointerdown",function(){Zi(t[9])&&t[9].apply(this,arguments)}),Mt(document.body,"pointerup",function(){Zi(t[8])&&t[8].apply(this,arguments)})],l=!0)},p(g,m){let f=i;i=p(t=g),i===f?u[i].p(t,m):(Ie(),z(u[f],1,1,()=>{u[f]=null}),Ee(),n=u[i],n?n.p(t,m):(n=u[i]=d[i](t),n.c()),P(n,1),n.m(r.parentNode,r)),t[6]?h?(h.p(t,m),64&m[0]&&P(h,1)):(h=V$(t),h.c(),P(h,1),h.m(o.parentNode,o)):h&&(Ie(),z(h,1,1,()=>{h=null}),Ee())},i(g){s||(P(n),P(h),P(!1),s=!0)},o(g){z(n),z(h),z(!1),s=!1},d(g){g&&Q(e),u[i].d(g),g&&Q(r),h&&h.d(g),g&&Q(o),g&&Q(a),l=!1,Ui(c)}}}function A4(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,I,{$$slots:M={},$$scope:D}=e,{buttonClass:T}=e,{buttonLabel:F}=e,{buttonLabelClass:W}=e,{buttonHideLabel:O}=e,{buttonIcon:y}=e,{buttonTitle:V}=e,{panelClass:tt}=e,{isActive:k=!1}=e,{onshow:N=({panel:U})=>ah(U,{preventScroll:!0})}=e,{onhide:it=me}=e;const ut=sn("isAnimated");A(t,ut,U=>i(43,I=U));const at=sn("rootPortal");A(t,at,U=>i(38,f=U));const gt=sn("rootRect");let G,$t,vt;A(t,gt,U=>i(41,S=U));const lt=()=>i(26,vt=n&&n.getBoundingClientRect());let kt=rn(),J=pi(0);A(t,J,U=>i(40,w=U));let q=rn();const Z=ue({x:0,y:0});A(t,Z,U=>i(39,b=U));const xt=pi(-5,{stiffness:.1,damping:.35,precision:.001});A(t,xt,U=>i(42,C=U));let nt=!0;const mt=U=>b2(U,f)||$t.isEventTarget(U);let zt,oe,Dt=!1;const te=U=>{Wc(U.target)||(k||lt(),i(31,oe=U),i(0,k=!k))},Kt=U=>{/down/i.test(U.key)&&(i(0,k=!0),i(31,oe=U))};return _o(()=>{if(!f||!zt)return;const U=zt;Xy().then(()=>{U.parentNode&&U.remove()})}),t.$$set=U=>{"buttonClass"in U&&i(19,T=U.buttonClass),"buttonLabel"in U&&i(1,F=U.buttonLabel),"buttonLabelClass"in U&&i(20,W=U.buttonLabelClass),"buttonHideLabel"in U&&i(21,O=U.buttonHideLabel),"buttonIcon"in U&&i(22,y=U.buttonIcon),"buttonTitle"in U&&i(23,V=U.buttonTitle),"panelClass"in U&&i(2,tt=U.panelClass),"isActive"in U&&i(0,k=U.isActive),"onshow"in U&&i(24,N=U.onshow),"onhide"in U&&i(25,it=U.onhide),"$$scope"in U&&i(50,D=U.$$scope)},t.$$.update=()=>{if(16&t.$$.dirty[0]&&(n=$t&&$t.getElement()),1073741825&t.$$.dirty[0]&&i(8,g=k?U=>{Dt&&(i(30,Dt=!1),mt(U)||i(0,k=!1))}:void 0),1&t.$$.dirty[0]|4096&t.$$.dirty[1]&&J.set(k?1:0,{hard:I===!1}),1&t.$$.dirty[0]|4096&t.$$.dirty[1]&&xt.set(k?0:-5,{hard:I===!1}),2048&t.$$.dirty[1]&&i(34,r=1-C/-5),1&t.$$.dirty[0]|1024&t.$$.dirty[1]&&S&&k&&lt(),67108873&t.$$.dirty[0]|1024&t.$$.dirty[1]&&S&&G&&vt&&k){i(29,nt=!0);let U=vt.x-S.x+.5*vt.width-.5*G.width,Tt=vt.y-S.y+vt.height;const dt=12,Jt=12,se=S.width-12,ee=S.height-12,be=U,ve=Tt,_=be+G.width,ke=ve+G.height;be<dt&&(i(28,q.x=be-dt,q),U=dt),_>se&&(i(28,q.x=_-se,q),U=se-G.width),ke>ee?(i(27,kt.y=-1,kt),Jt<Tt-G.height-vt.height?(i(28,q.y=0,q),Tt-=G.height+vt.height):(i(28,q.y=Tt-(ke-ee),q),Tt-=ke-ee-12,i(29,nt=!1))):i(27,kt.y=1,kt),wt(Z,b=bo(ot(U,Tt),Oc),b)}512&t.$$.dirty[1]&&i(6,o=w>0),512&t.$$.dirty[1]&&i(37,a=w<1),134217728&t.$$.dirty[0]|2304&t.$$.dirty[1]&&i(36,s=`translateX(${Math.round(b.x)+12*kt.x}px) translateY(${Math.round(b.y)+12*kt.y+kt.y*C}px)`),1024&t.$$.dirty[1]&&i(35,l=`--panel-max-height:${S.height-24}px`),624&t.$$.dirty[1]&&i(11,c=a?`opacity: ${w}; pointer-events: ${w<1?"none":"all"}; transform: ${s};${l}`:`transform: ${s};${l}`),8&t.$$.dirty[1]&&i(32,d=.5+.5*r),8&t.$$.dirty[1]&&i(33,u=r),939524104&t.$$.dirty[0]|262&t.$$.dirty[1]&&i(10,p=b&&G&&`opacity:${nt?u:0};transform:scaleX(${d})rotate(45deg);top:${kt.y<0?q.y+G.height:0}px;left:${q.x+.5*G.width}px`),1&t.$$.dirty[0]&&i(9,h=k?U=>{mt(U)||i(30,Dt=!0)}:void 0),96&t.$$.dirty[0]|128&t.$$.dirty[1]&&o&&f&&zt&&zt.parentNode!==f&&f.append(zt),1&t.$$.dirty[0]&&(k||i(31,oe=void 0)),16777313&t.$$.dirty[0]|1&t.$$.dirty[1]&&k&&o&&zt&&N({e:oe,panel:zt}),33554497&t.$$.dirty[0]&&o&&!k&&it(),16252930&t.$$.dirty[0]&&i(7,m={label:F,icon:y,class:mi(["PinturaPanelButton",T]),onkeydown:Kt,onclick:te,hideLabel:O,labelClass:W,title:V})},[k,F,tt,G,$t,zt,o,m,g,h,p,c,ut,at,gt,J,Z,xt,U=>{/esc/i.test(U.key)&&(i(0,k=!1),n.focus())},T,W,O,y,V,N,it,vt,kt,q,nt,Dt,oe,d,u,r,l,s,a,f,b,w,S,C,I,M,function(U){zi[U?"unshift":"push"](()=>{$t=U,i(4,$t)})},function(U){zi[U?"unshift":"push"](()=>{$t=U,i(4,$t)})},function(U){zi[U?"unshift":"push"](()=>{zt=U,i(5,zt)})},U=>{U.stopPropagation(),i(0,k=!1)},U=>i(3,G=Aa(U.detail)),D]}class Lu extends ci{constructor(e){super(),li(this,e,A4,E4,oi,{buttonClass:19,buttonLabel:1,buttonLabelClass:20,buttonHideLabel:21,buttonIcon:22,buttonTitle:23,panelClass:2,isActive:0,onshow:24,onhide:25},null,[-1,-1])}}var L4={Up:38,Down:40,Left:37,Right:39};function z4(t){let e,i,n,r,o,a,s,l;const c=t[15].default,d=rr(c,t,t[14],null);return{c(){e=ht("li"),i=ht("input"),n=pe(),r=ht("label"),d&&d.c(),v(i,"type","radio"),v(i,"class","implicit"),v(i,"id",t[7]),v(i,"name",t[0]),i.value=t[3],i.disabled=t[6],i.hidden=t[5],i.checked=t[4],v(r,"for",t[7]),v(r,"title",t[2]),v(e,"class",o=mi(["PinturaRadioGroupOption",t[1]])),v(e,"data-hidden",t[5]),v(e,"data-disabled",t[6]),v(e,"data-selected",t[4])},m(u,p){et(u,e,p),Ct(e,i),Ct(e,n),Ct(e,r),d&&d.m(r,null),a=!0,s||(l=[Mt(i,"change",Zb(t[16])),Mt(i,"keydown",t[9]),Mt(i,"click",t[10])],s=!0)},p(u,[p]){(!a||128&p)&&v(i,"id",u[7]),(!a||1&p)&&v(i,"name",u[0]),(!a||8&p)&&(i.value=u[3]),(!a||64&p)&&(i.disabled=u[6]),(!a||32&p)&&(i.hidden=u[5]),(!a||16&p)&&(i.checked=u[4]),d&&d.p&&(!a||16384&p)&&ar(d,c,u,u[14],a?or(c,u[14],p,null):sr(u[14]),null),(!a||128&p)&&v(r,"for",u[7]),(!a||4&p)&&v(r,"title",u[2]),(!a||2&p&&o!==(o=mi(["PinturaRadioGroupOption",u[1]])))&&v(e,"class",o),(!a||32&p)&&v(e,"data-hidden",u[5]),(!a||64&p)&&v(e,"data-disabled",u[6]),(!a||16&p)&&v(e,"data-selected",u[4])},i(u){a||(P(d,u),a=!0)},o(u){z(d,u),a=!1},d(u){u&&Q(e),d&&d.d(u),s=!1,Ui(l)}}}function F4(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,{name:s}=e,{class:l}=e,{label:c}=e,{id:d}=e,{value:u}=e,{checked:p}=e,{onkeydown:h}=e,{onclick:g}=e,{hidden:m=!1}=e,{disabled:f=!1}=e;const b=Object.values(L4),w=sn("keysPressed");return A(t,w,S=>i(17,r=S)),t.$$set=S=>{"name"in S&&i(0,s=S.name),"class"in S&&i(1,l=S.class),"label"in S&&i(2,c=S.label),"id"in S&&i(11,d=S.id),"value"in S&&i(3,u=S.value),"checked"in S&&i(4,p=S.checked),"onkeydown"in S&&i(12,h=S.onkeydown),"onclick"in S&&i(13,g=S.onclick),"hidden"in S&&i(5,m=S.hidden),"disabled"in S&&i(6,f=S.disabled),"$$scope"in S&&i(14,a=S.$$scope)},t.$$.update=()=>{2049&t.$$.dirty&&i(7,n=`${s}-${d}`)},[s,l,c,u,p,m,f,n,w,S=>{h(S)},S=>{r.some(C=>b.includes(C))||g(S)},d,h,g,a,o,function(S){Wr.call(this,t,S)}]}class P2 extends ci{constructor(e){super(),li(this,e,F4,z4,oi,{name:0,class:1,label:2,id:11,value:3,checked:4,onkeydown:12,onclick:13,hidden:5,disabled:6})}}var Cs=(t=[])=>t.reduce((e,i)=>(Rn(i)?Rn(i[1]):i.options)?e.concat(Rn(i)?i[1]:i.options):(e.push(i),e),[]);const Xd=(t,e,i)=>{let n;return Rn(t)?n={id:e,value:t[0],label:t[1],...t[2]||{}}:(n=t,n.id=n.id!=null?n.id:e),i?i(n):n};var nr=(t,e,i)=>on(t)?t(e,i):t;const R2=(t,e)=>t.map(([i,n,r])=>{if(Rn(n))return[nr(i,e),R2(n,e)];{const o=[i,nr(n,e)];if(r){let a={...r};r.icon&&(a.icon=nr(r.icon,e)),o.push(a)}return o}});var I2=(t,e)=>R2(t,e),E2=(t,e)=>Array.isArray(t)&&Array.isArray(e)?os(t,e):t===e;function N$(t,e,i){const n=t.slice();return n[27]=e[i],n}const D4=t=>({option:1024&t[0]}),H$=t=>({option:t[27]});function j$(t,e,i){const n=t.slice();return n[27]=e[i],n}const B4=t=>({option:1024&t[0]}),U$=t=>({option:t[27]}),O4=t=>({option:1024&t[0]}),G$=t=>({option:t[27]});function Z$(t){let e,i,n,r,o,a=[],s=new Map,l=t[1]&&X$(t),c=t[10];const d=u=>u[27].id;for(let u=0;u<c.length;u+=1){let p=N$(t,c,u),h=d(p);s.set(h,a[u]=tg(h,p))}return{c(){e=ht("fieldset"),l&&l.c(),i=pe(),n=ht("ul");for(let u=0;u<a.length;u+=1)a[u].c();v(n,"class","PinturaRadioGroupOptions"),v(e,"class",r=mi(["PinturaRadioGroup",t[3]])),v(e,"data-layout",t[5]),v(e,"title",t[7])},m(u,p){et(u,e,p),l&&l.m(e,null),Ct(e,i),Ct(e,n);for(let h=0;h<a.length;h+=1)a[h].m(n,null);o=!0},p(u,p){u[1]?l?l.p(u,p):(l=X$(u),l.c(),l.m(e,i)):l&&(l.d(1),l=null),8419153&p[0]&&(c=u[10],Ie(),a=La(a,p,d,1,u,c,s,n,Ls,tg,null,N$),Ee()),(!o||8&p[0]&&r!==(r=mi(["PinturaRadioGroup",u[3]])))&&v(e,"class",r),(!o||32&p[0])&&v(e,"data-layout",u[5]),(!o||128&p[0])&&v(e,"title",u[7])},i(u){if(!o){for(let p=0;p<c.length;p+=1)P(a[p]);o=!0}},o(u){for(let p=0;p<a.length;p+=1)z(a[p]);o=!1},d(u){u&&Q(e),l&&l.d();for(let p=0;p<a.length;p+=1)a[p].d()}}}function X$(t){let e,i,n;return{c(){e=ht("legend"),i=mn(t[1]),v(e,"class",n=t[2]&&"implicit")},m(r,o){et(r,e,o),Ct(e,i)},p(r,o){2&o[0]&&In(i,r[1]),4&o[0]&&n!==(n=r[2]&&"implicit")&&v(e,"class",n)},d(r){r&&Q(e)}}}function W4(t){let e,i;return e=new P2({props:{name:t[4],label:t[27].label,id:t[27].id,value:t[27].value,disabled:t[27].disabled,hidden:t[27].hidden,class:t[8],checked:t[12](t[27])===t[0],onkeydown:t[13](t[27]),onclick:t[14](t[27]),$$slots:{default:[N4]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.name=n[4]),1024&r[0]&&(o.label=n[27].label),1024&r[0]&&(o.id=n[27].id),1024&r[0]&&(o.value=n[27].value),1024&r[0]&&(o.disabled=n[27].disabled),1024&r[0]&&(o.hidden=n[27].hidden),256&r[0]&&(o.class=n[8]),1025&r[0]&&(o.checked=n[12](n[27])===n[0]),1024&r[0]&&(o.onkeydown=n[13](n[27])),1024&r[0]&&(o.onclick=n[14](n[27])),8389696&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function _4(t){let e,i,n,r,o,a,s=[],l=new Map;const c=t[22].group,d=rr(c,t,t[23],G$),u=d||function(g){let m,f,b=g[27].label+"";return{c(){m=ht("span"),f=mn(b),v(m,"class","PinturaRadioGroupOptionGroupLabel")},m(w,S){et(w,m,S),Ct(m,f)},p(w,S){1024&S[0]&&b!==(b=w[27].label+"")&&In(f,b)},d(w){w&&Q(m)}}}(t);let p=t[27].options;const h=g=>g[27].id;for(let g=0;g<p.length;g+=1){let m=j$(t,p,g),f=h(m);l.set(f,s[g]=Q$(f,m))}return{c(){e=ht("li"),u&&u.c(),i=pe(),n=ht("ul");for(let g=0;g<s.length;g+=1)s[g].c();r=pe(),v(n,"class","PinturaRadioGroupOptions"),v(e,"class",o=mi(["PinturaRadioGroupOptionGroup",t[9]]))},m(g,m){et(g,e,m),u&&u.m(e,null),Ct(e,i),Ct(e,n);for(let f=0;f<s.length;f+=1)s[f].m(n,null);Ct(e,r),a=!0},p(g,m){d?d.p&&(!a||8389632&m[0])&&ar(d,c,g,g[23],a?or(c,g[23],m,O4):sr(g[23]),G$):u&&u.p&&(!a||1024&m[0])&&u.p(g,a?m:[-1,-1]),8418641&m[0]&&(p=g[27].options,Ie(),s=La(s,m,h,1,g,p,l,n,Ls,Q$,null,j$),Ee()),(!a||512&m[0]&&o!==(o=mi(["PinturaRadioGroupOptionGroup",g[9]])))&&v(e,"class",o)},i(g){if(!a){P(u,g);for(let m=0;m<p.length;m+=1)P(s[m]);a=!0}},o(g){z(u,g);for(let m=0;m<s.length;m+=1)z(s[m]);a=!1},d(g){g&&Q(e),u&&u.d(g);for(let m=0;m<s.length;m+=1)s[m].d()}}}function Y$(t){let e,i;return e=new wo({props:{$$slots:{default:[V4]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8389632&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function V4(t){let e,i=t[27].icon+"";return{c(){e=gr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){1024&r[0]&&i!==(i=n[27].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function q$(t){let e,i,n=t[27].label+"";return{c(){e=ht("span"),i=mn(n),v(e,"class",t[6])},m(r,o){et(r,e,o),Ct(e,i)},p(r,o){1024&o[0]&&n!==(n=r[27].label+"")&&In(i,n),64&o[0]&&v(e,"class",r[6])},d(r){r&&Q(e)}}}function N4(t){let e;const i=t[22].option,n=rr(i,t,t[23],H$),r=n||function(o){let a,s,l,c=o[27].icon&&Y$(o),d=!o[27].hideLabel&&q$(o);return{c(){c&&c.c(),a=pe(),d&&d.c(),s=pe()},m(u,p){c&&c.m(u,p),et(u,a,p),d&&d.m(u,p),et(u,s,p),l=!0},p(u,p){u[27].icon?c?(c.p(u,p),1024&p[0]&&P(c,1)):(c=Y$(u),c.c(),P(c,1),c.m(a.parentNode,a)):c&&(Ie(),z(c,1,1,()=>{c=null}),Ee()),u[27].hideLabel?d&&(d.d(1),d=null):d?d.p(u,p):(d=q$(u),d.c(),d.m(s.parentNode,s))},i(u){l||(P(c),l=!0)},o(u){z(c),l=!1},d(u){c&&c.d(u),u&&Q(a),d&&d.d(u),u&&Q(s)}}}(t);return{c(){r&&r.c()},m(o,a){r&&r.m(o,a),e=!0},p(o,a){n?n.p&&(!e||8389632&a[0])&&ar(n,i,o,o[23],e?or(i,o[23],a,D4):sr(o[23]),H$):r&&r.p&&(!e||1088&a[0])&&r.p(o,e?a:[-1,-1])},i(o){e||(P(r,o),e=!0)},o(o){z(r,o),e=!1},d(o){r&&r.d(o)}}}function K$(t){let e,i;return e=new wo({props:{$$slots:{default:[H4]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8389632&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function H4(t){let e,i=t[27].icon+"";return{c(){e=gr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){1024&r[0]&&i!==(i=n[27].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function J$(t){let e,i,n=t[27].label+"";return{c(){e=ht("span"),i=mn(n),v(e,"class",t[6])},m(r,o){et(r,e,o),Ct(e,i)},p(r,o){1024&o[0]&&n!==(n=r[27].label+"")&&In(i,n),64&o[0]&&v(e,"class",r[6])},d(r){r&&Q(e)}}}function j4(t){let e;const i=t[22].option,n=rr(i,t,t[23],U$),r=n||function(o){let a,s,l,c=o[27].icon&&K$(o),d=!o[27].hideLabel&&J$(o);return{c(){c&&c.c(),a=pe(),d&&d.c(),s=pe()},m(u,p){c&&c.m(u,p),et(u,a,p),d&&d.m(u,p),et(u,s,p),l=!0},p(u,p){u[27].icon?c?(c.p(u,p),1024&p[0]&&P(c,1)):(c=K$(u),c.c(),P(c,1),c.m(a.parentNode,a)):c&&(Ie(),z(c,1,1,()=>{c=null}),Ee()),u[27].hideLabel?d&&(d.d(1),d=null):d?d.p(u,p):(d=J$(u),d.c(),d.m(s.parentNode,s))},i(u){l||(P(c),l=!0)},o(u){z(c),l=!1},d(u){c&&c.d(u),u&&Q(a),d&&d.d(u),u&&Q(s)}}}(t);return{c(){r&&r.c()},m(o,a){r&&r.m(o,a),e=!0},p(o,a){n?n.p&&(!e||8389632&a[0])&&ar(n,i,o,o[23],e?or(i,o[23],a,B4):sr(o[23]),U$):r&&r.p&&(!e||1088&a[0])&&r.p(o,e?a:[-1,-1])},i(o){e||(P(r,o),e=!0)},o(o){z(r,o),e=!1},d(o){r&&r.d(o)}}}function Q$(t,e){let i,n,r;return n=new P2({props:{name:e[4],label:e[27].label,id:e[27].id,value:e[27].value,disabled:e[27].disabled,hidden:e[27].hidden,class:e[8],checked:e[12](e[27])===e[0],onkeydown:e[13](e[27]),onclick:e[14](e[27]),$$slots:{default:[j4]},$$scope:{ctx:e}}}),{key:t,first:null,c(){i=Tn(),Et(n.$$.fragment),this.first=i},m(o,a){et(o,i,a),Rt(n,o,a),r=!0},p(o,a){e=o;const s={};16&a[0]&&(s.name=e[4]),1024&a[0]&&(s.label=e[27].label),1024&a[0]&&(s.id=e[27].id),1024&a[0]&&(s.value=e[27].value),1024&a[0]&&(s.disabled=e[27].disabled),1024&a[0]&&(s.hidden=e[27].hidden),256&a[0]&&(s.class=e[8]),1025&a[0]&&(s.checked=e[12](e[27])===e[0]),1024&a[0]&&(s.onkeydown=e[13](e[27])),1024&a[0]&&(s.onclick=e[14](e[27])),8389696&a[0]&&(s.$$scope={dirty:a,ctx:e}),n.$set(s)},i(o){r||(P(n.$$.fragment,o),r=!0)},o(o){z(n.$$.fragment,o),r=!1},d(o){o&&Q(i),It(n,o)}}}function tg(t,e){let i,n,r,o,a;const s=[_4,W4],l=[];function c(d,u){return d[27].options?0:1}return n=c(e),r=l[n]=s[n](e),{key:t,first:null,c(){i=Tn(),r.c(),o=Tn(),this.first=i},m(d,u){et(d,i,u),l[n].m(d,u),et(d,o,u),a=!0},p(d,u){let p=n;n=c(e=d),n===p?l[n].p(e,u):(Ie(),z(l[p],1,1,()=>{l[p]=null}),Ee(),r=l[n],r?r.p(e,u):(r=l[n]=s[n](e),r.c()),P(r,1),r.m(o.parentNode,o))},i(d){a||(P(r),a=!0)},o(d){z(r),a=!1},d(d){d&&Q(i),l[n].d(d),d&&Q(o)}}}function U4(t){let e,i,n,r=t[11].length&&Z$(t);return{c(){r&&r.c(),e=pe(),i=Tn()},m(o,a){r&&r.m(o,a),et(o,e,a),et(o,i,a),n=!0},p(o,a){o[11].length?r?(r.p(o,a),2048&a[0]&&P(r,1)):(r=Z$(o),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(Ie(),z(r,1,1,()=>{r=null}),Ee())},i(o){n||(P(r),P(!1),n=!0)},o(o){z(r),z(!1),n=!1},d(o){r&&r.d(o),o&&Q(e),o&&Q(i)}}}function G4(t,e,i){let n,r,o,{$$slots:a={},$$scope:s}=e;const l=ba();let{label:c}=e,{hideLabel:d=!0}=e,{class:u}=e,{name:p="radio-group-"+ea()}=e,{selectedIndex:h=-1}=e,{options:g=[]}=e,{onchange:m}=e,{layout:f}=e,{optionMapper:b}=e,{optionFilter:w}=e,{value:S}=e,{optionLabelClass:C}=e,{title:I}=e,{locale:M}=e,{optionClass:D}=e,{optionGroupClass:T}=e;const F=O=>o.findIndex(y=>y.id===O.id),W=(O,y)=>{i(0,h=F(O));const V={index:h,...O};((tt,...k)=>{tt&&tt(...k)})(m,V,y),l("change",V)};return t.$$set=O=>{"label"in O&&i(1,c=O.label),"hideLabel"in O&&i(2,d=O.hideLabel),"class"in O&&i(3,u=O.class),"name"in O&&i(4,p=O.name),"selectedIndex"in O&&i(0,h=O.selectedIndex),"options"in O&&i(15,g=O.options),"onchange"in O&&i(16,m=O.onchange),"layout"in O&&i(5,f=O.layout),"optionMapper"in O&&i(17,b=O.optionMapper),"optionFilter"in O&&i(18,w=O.optionFilter),"value"in O&&i(19,S=O.value),"optionLabelClass"in O&&i(6,C=O.optionLabelClass),"title"in O&&i(7,I=O.title),"locale"in O&&i(20,M=O.locale),"optionClass"in O&&i(8,D=O.optionClass),"optionGroupClass"in O&&i(9,T=O.optionGroupClass),"$$scope"in O&&i(23,s=O.$$scope)},t.$$.update=()=>{1343488&t.$$.dirty[0]&&i(11,n=I2(w?g.filter(w):g,M)),133120&t.$$.dirty[0]&&i(10,r=((O=[],y)=>{let V=0;return O.map(tt=>(V++,Rn(tt)?Rn(tt[1])?{id:V,label:tt[0],options:tt[1].map(k=>Xd(k,++V,y))}:Xd(tt,V,y):tt.options?{id:tt.id||V,label:tt.label,options:tt.options.map(k=>Xd(k,++V,y))}:Xd(tt,V,y)))})(n,b)),1024&t.$$.dirty[0]&&i(21,o=Cs(r)),2654209&t.$$.dirty[0]&&h<0&&(i(0,h=o.findIndex(O=>E2(O.value,S))),h<0&&i(0,h=(O=>O.findIndex(y=>y[0]===void 0))(g)))},[h,c,d,u,p,f,C,I,D,T,r,n,F,O=>y=>{var V;V=y.key,/enter| /i.test(V)&&W(O,y)},O=>y=>{W(O,y)},g,m,b,w,S,M,o,a,s]}class as extends ci{constructor(e){super(),li(this,e,G4,U4,oi,{label:1,hideLabel:2,class:3,name:4,selectedIndex:0,options:15,onchange:16,layout:5,optionMapper:17,optionFilter:18,value:19,optionLabelClass:6,title:7,locale:20,optionClass:8,optionGroupClass:9},null,[-1,-1])}}function eg(t){let e,i,n,r,o,a,s,l,c,d;return{c(){e=ht("div"),i=ht("button"),n=mn("â²"),o=pe(),a=ht("button"),s=mn("â¼"),v(i,"type","button"),v(i,"tabindex","-1"),v(i,"aria-label",r="increase "+t[7]),v(a,"type","button"),v(a,"tabindex","-1"),v(a,"aria-label",l="decrease "+t[7]),v(e,"class","PinturaInputSpinners")},m(u,p){et(u,e,p),Ct(e,i),Ct(i,n),Ct(e,o),Ct(e,a),Ct(a,s),c||(d=[Mt(i,"click",t[17]),Mt(a,"click",t[18])],c=!0)},p(u,p){128&p&&r!==(r="increase "+u[7])&&v(i,"aria-label",r),128&p&&l!==(l="decrease "+u[7])&&v(a,"aria-label",l)},d(u){u&&Q(e),c=!1,Ui(d)}}}function Z4(t){let e,i,n,r,o,a,s=t[1]==="number"&&t[9]&&eg(t);return{c(){e=ht("div"),i=ht("input"),r=pe(),s&&s.c(),v(i,"class","PinturaInputField"),v(i,"title",t[7]),v(i,"type",t[1]),v(i,"min",t[4]),v(i,"max",t[5]),v(i,"step",t[6]),v(i,"inputmode",t[3]),i.value=n=t[14]?t[13]:t[0],v(i,"style",t[11]),v(i,"placeholder",t[8]),v(i,"maxlength",t[12]),i.disabled=t[2],v(i,"spellcheck","false"),v(i,"autocorrect","off"),v(i,"autocapitalize","off"),v(e,"class","PinturaInput")},m(l,c){et(l,e,c),Ct(e,i),t[27](i),Ct(e,r),s&&s.m(e,null),o||(a=[Mt(i,"input",t[16]),Mt(i,"blur",function(){Zi(t[14]&&t[15])&&(t[14]&&t[15]).apply(this,arguments)}),Mt(i,"keydown",t[19]),Mt(i,"keyup",t[20])],o=!0)},p(l,[c]){t=l,128&c&&v(i,"title",t[7]),2&c&&v(i,"type",t[1]),16&c&&v(i,"min",t[4]),32&c&&v(i,"max",t[5]),64&c&&v(i,"step",t[6]),8&c&&v(i,"inputmode",t[3]),24577&c&&n!==(n=t[14]?t[13]:t[0])&&i.value!==n&&(i.value=n),2048&c&&v(i,"style",t[11]),256&c&&v(i,"placeholder",t[8]),4096&c&&v(i,"maxlength",t[12]),4&c&&(i.disabled=t[2]),t[1]==="number"&&t[9]?s?s.p(t,c):(s=eg(t),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},i:ni,o:ni,d(l){l&&Q(e),t[27](null),s&&s.d(),o=!1,Ui(a)}}}function X4(t,e,i){let n,r,o,a,s,l,c,{value:d}=e,{type:u="text"}=e,{disabled:p=!1}=e,{inputmode:h}=e,{min:g}=e,{max:m}=e,{step:f}=e,{onchange:b=me}=e,{onkeydown:w=me}=e,{title:S}=e,{stepMultiplier:C=10}=e,{placeholder:I}=e,{enableSpinButtons:M=!0}=e,{enableStopPropagation:D=!1}=e;const T=()=>{let y=l.value;return u==="number"&&(y=h==="numeric"?parseInt(y,10):parseFloat(y),!hi(y)||Number.isNaN(y)?y=g||0:n&&(y=tn(y,g,m))),y};let F=d;const W=()=>{const y=tn(T()+(c?f*C:f),g,m);y!==d&&(i(25,F=y),i(0,d=y),b(d))},O=()=>{const y=tn(T()-(c?f*C:f),g,m);y!==d&&(i(25,F=y),i(0,d=y),b(d))};return t.$$set=y=>{"value"in y&&i(0,d=y.value),"type"in y&&i(1,u=y.type),"disabled"in y&&i(2,p=y.disabled),"inputmode"in y&&i(3,h=y.inputmode),"min"in y&&i(4,g=y.min),"max"in y&&i(5,m=y.max),"step"in y&&i(6,f=y.step),"onchange"in y&&i(21,b=y.onchange),"onkeydown"in y&&i(22,w=y.onkeydown),"title"in y&&i(7,S=y.title),"stepMultiplier"in y&&i(23,C=y.stepMultiplier),"placeholder"in y&&i(8,I=y.placeholder),"enableSpinButtons"in y&&i(9,M=y.enableSpinButtons),"enableStopPropagation"in y&&i(24,D=y.enableStopPropagation)},t.$$.update=()=>{48&t.$$.dirty&&i(14,n=hi(g)&&hi(m)),33555457&t.$$.dirty&&i(13,r=l===document.activeElement?F:d),32&t.$$.dirty&&i(26,o=m?(m+"").length:void 0),67108872&t.$$.dirty&&i(12,a=h==="numeric"&&o?o:void 0),67108864&t.$$.dirty&&i(11,s=o?`min-width:${o}em`:void 0)},[d,u,p,h,g,m,f,S,I,M,l,s,a,r,n,()=>{i(25,F=T()),b(d)},()=>{i(25,F=l.value),b(T())},W,O,y=>{c=y.shiftKey,w(y);const{key:V}=y;D&&y.stopPropagation(),/up|down/i.test(V)&&(/up/i.test(V)&&W(),/down/i.test(V)&&O(),y.preventDefault(),y.stopPropagation())},y=>{const{key:V}=y;/up|down/i.test(V)&&(y.preventDefault(),y.stopPropagation())},b,w,C,D,F,o,function(y){zi[y?"unshift":"push"](()=>{l=y,i(10,l)})}]}class A2 extends ci{constructor(e){super(),li(this,e,X4,Z4,oi,{value:0,type:1,disabled:2,inputmode:3,min:4,max:5,step:6,onchange:21,onkeydown:22,title:7,stepMultiplier:23,placeholder:8,enableSpinButtons:9,enableStopPropagation:24})}}const Y4=t=>({}),ig=t=>({});function q4(t){let e,i,n,r,o=(t[2]||t[21])+"",a=t[6]&&ng(t);return{c(){a&&a.c(),e=pe(),i=ht("span"),v(i,"class",n=mi(["PinturaButtonLabel",t[3],t[5]&&"implicit"]))},m(s,l){a&&a.m(s,l),et(s,e,l),et(s,i,l),i.innerHTML=o,r=!0},p(s,l){s[6]?a?(a.p(s,l),64&l[0]&&P(a,1)):(a=ng(s),a.c(),P(a,1),a.m(e.parentNode,e)):a&&(Ie(),z(a,1,1,()=>{a=null}),Ee()),(!r||2097156&l[0])&&o!==(o=(s[2]||s[21])+"")&&(i.innerHTML=o),(!r||40&l[0]&&n!==(n=mi(["PinturaButtonLabel",s[3],s[5]&&"implicit"])))&&v(i,"class",n)},i(s){r||(P(a),r=!0)},o(s){z(a),r=!1},d(s){a&&a.d(s),s&&Q(e),s&&Q(i)}}}function K4(t){let e,i;return e=new A2({props:{value:t[10],onchange:t[17],enableStopPropagation:!0,type:"number",inputmode:"numeric",min:t[8].reduce(sg,1/0),max:t[8].reduce(lg,-1/0),enableSpinButtons:!1}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r[0]&&(o.value=n[10]),131072&r[0]&&(o.onchange=n[17]),256&r[0]&&(o.min=n[8].reduce(sg,1/0)),256&r[0]&&(o.max=n[8].reduce(lg,-1/0)),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function ng(t){let e,i;return e=new wo({props:{class:"PinturaButtonIcon",$$slots:{default:[J4]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};536870976&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function J4(t){let e;return{c(){e=gr("g")},m(i,n){et(i,e,n),e.innerHTML=t[6]},p(i,n){64&n[0]&&(e.innerHTML=i[6])},d(i){i&&Q(e)}}}function Q4(t){let e,i,n,r,o,a;const s=[K4,q4],l=[];function c(d,u){return d[18]?0:1}return i=c(t),n=l[i]=s[i](t),{c(){e=ht("span"),n.c(),v(e,"slot","label"),v(e,"title",r=nr(t[1],t[16])),v(e,"class",o=mi(["PinturaButtonInner",t[18]&&"PinturaComboBox",t[4]]))},m(d,u){et(d,e,u),l[i].m(e,null),a=!0},p(d,u){let p=i;i=c(d),i===p?l[i].p(d,u):(Ie(),z(l[p],1,1,()=>{l[p]=null}),Ee(),n=l[i],n?n.p(d,u):(n=l[i]=s[i](d),n.c()),P(n,1),n.m(e,null)),(!a||65538&u[0]&&r!==(r=nr(d[1],d[16])))&&v(e,"title",r),(!a||262160&u[0]&&o!==(o=mi(["PinturaButtonInner",d[18]&&"PinturaComboBox",d[4]])))&&v(e,"class",o)},i(d){a||(P(n),a=!0)},o(d){z(n),a=!1},d(d){d&&Q(e),l[i].d()}}}function t5(t){let e,i,n=t[31].label+"";return{c(){e=ht("span"),i=mn(n),v(e,"slot","group")},m(r,o){et(r,e,o),Ct(e,i)},p(r,o){1&o[1]&&n!==(n=r[31].label+"")&&In(i,n)},d(r){r&&Q(e)}}}function rg(t){let e,i;return e=new wo({props:{style:on(t[14])?t[14](t[31].value):t[14],$$slots:{default:[e5]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16384&r[0]|1&r[1]&&(o.style=on(n[14])?n[14](n[31].value):n[14]),536870912&r[0]|1&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function e5(t){let e,i=t[31].icon+"";return{c(){e=gr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){1&r[1]&&i!==(i=n[31].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function og(t){let e,i,n,r,o,a=t[31].label+"",s=t[31].sublabel&&ag(t);return{c(){e=ht("span"),i=new Pu(!1),n=pe(),s&&s.c(),i.a=n,v(e,"style",r=on(t[15])?t[15](t[31].value):t[15]),v(e,"class",o=mi(["PinturaDropdownOptionLabel",t[11]]))},m(l,c){et(l,e,c),i.m(a,e),Ct(e,n),s&&s.m(e,null)},p(l,c){1&c[1]&&a!==(a=l[31].label+"")&&i.p(a),l[31].sublabel?s?s.p(l,c):(s=ag(l),s.c(),s.m(e,null)):s&&(s.d(1),s=null),32768&c[0]|1&c[1]&&r!==(r=on(l[15])?l[15](l[31].value):l[15])&&v(e,"style",r),2048&c[0]&&o!==(o=mi(["PinturaDropdownOptionLabel",l[11]]))&&v(e,"class",o)},d(l){l&&Q(e),s&&s.d()}}}function ag(t){let e,i=t[31].sublabel+"";return{c(){e=ht("span"),v(e,"class","PinturaDropdownOptionSublabel")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){1&r[1]&&i!==(i=n[31].sublabel+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function i5(t){let e,i,n,r=t[31].icon&&rg(t),o=!t[31].hideLabel&&og(t);return{c(){e=ht("span"),r&&r.c(),i=pe(),o&&o.c(),v(e,"slot","option")},m(a,s){et(a,e,s),r&&r.m(e,null),Ct(e,i),o&&o.m(e,null),n=!0},p(a,s){a[31].icon?r?(r.p(a,s),1&s[1]&&P(r,1)):(r=rg(a),r.c(),P(r,1),r.m(e,i)):r&&(Ie(),z(r,1,1,()=>{r=null}),Ee()),a[31].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=og(a),o.c(),o.m(e,null))},i(a){n||(P(r),n=!0)},o(a){z(r),n=!1},d(a){a&&Q(e),r&&r.d(),o&&o.d()}}}function n5(t){let e,i,n,r,o,a;const s=t[27].controls,l=rr(s,t,t[29],ig);return n=new as({props:{class:"PinturaOptionsList PinturaScrollableContent",name:t[7],value:t[10],selectedIndex:t[9],optionFilter:t[12],optionMapper:t[13],optionLabelClass:mi(["PinturaDropdownOptionLabel",t[11]]),optionGroupClass:"PinturaListOptionGroup",optionClass:"PinturaListOption",options:t[19],onchange:t[22],$$slots:{option:[i5,({option:c})=>({31:c}),({option:c})=>[0,c?1:0]],group:[t5,({option:c})=>({31:c}),({option:c})=>[0,c?1:0]]},$$scope:{ctx:t}}}),{c(){e=ht("div"),l&&l.c(),i=pe(),Et(n.$$.fragment),v(e,"slot","details"),v(e,"class","PinturaOptionsListWrapper")},m(c,d){et(c,e,d),l&&l.m(e,null),Ct(e,i),Rt(n,e,null),r=!0,o||(a=Mt(e,"keydown",t[24]),o=!0)},p(c,d){l&&l.p&&(!r||536870912&d[0])&&ar(l,s,c,c[29],r?or(s,c[29],d,Y4):sr(c[29]),ig);const u={};128&d[0]&&(u.name=c[7]),1024&d[0]&&(u.value=c[10]),512&d[0]&&(u.selectedIndex=c[9]),4096&d[0]&&(u.optionFilter=c[12]),8192&d[0]&&(u.optionMapper=c[13]),2048&d[0]&&(u.optionLabelClass=mi(["PinturaDropdownOptionLabel",c[11]])),524288&d[0]&&(u.options=c[19]),536922112&d[0]|1&d[1]&&(u.$$scope={dirty:d,ctx:c}),n.$set(u)},i(c){r||(P(l,c),P(n.$$.fragment,c),r=!0)},o(c){z(l,c),z(n.$$.fragment,c),r=!1},d(c){c&&Q(e),l&&l.d(c),It(n),o=!1,a()}}}function r5(t){let e,i,n;function r(a){t[28](a)}let o={onshow:t[23],buttonClass:mi(["PinturaDropdownButton",t[0],t[5]&&"PinturaDropdownIconOnly"]),$$slots:{details:[n5],label:[Q4]},$$scope:{ctx:t}};return t[20]!==void 0&&(o.isActive=t[20]),e=new Lu({props:o}),zi.push(()=>mo(e,"isActive",r)),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};33&s[0]&&(l.buttonClass=mi(["PinturaDropdownButton",a[0],a[5]&&"PinturaDropdownIconOnly"])),540016638&s[0]&&(l.$$scope={dirty:s,ctx:a}),!i&&1048576&s[0]&&(i=!0,l.isActive=a[20],vo(()=>i=!1)),e.$set(l)},i(a){n||(P(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}const sg=(t,[e])=>e<t?e:t,lg=(t,[e])=>e>t?e:t;function o5(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,{class:s}=e,{title:l}=e,{label:c}=e,{labelClass:d}=e,{innerClass:u}=e,{hideLabel:p=!1}=e,{icon:h}=e,{name:g}=e,{options:m=[]}=e,{selectedIndex:f=-1}=e,{value:b}=e,{optionLabelClass:w}=e,{optionFilter:S}=e,{optionMapper:C}=e,{optionIconStyle:I}=e,{optionLabelStyle:M}=e,{locale:D}=e,{onchange:T=me}=e,{onload:F=me}=e,{ondestroy:W=me}=e,{enableInput:O=!1}=e,y;return As(()=>F({options:m})),_o(()=>W({options:m})),t.$$set=V=>{"class"in V&&i(0,s=V.class),"title"in V&&i(1,l=V.title),"label"in V&&i(2,c=V.label),"labelClass"in V&&i(3,d=V.labelClass),"innerClass"in V&&i(4,u=V.innerClass),"hideLabel"in V&&i(5,p=V.hideLabel),"icon"in V&&i(6,h=V.icon),"name"in V&&i(7,g=V.name),"options"in V&&i(8,m=V.options),"selectedIndex"in V&&i(9,f=V.selectedIndex),"value"in V&&i(10,b=V.value),"optionLabelClass"in V&&i(11,w=V.optionLabelClass),"optionFilter"in V&&i(12,S=V.optionFilter),"optionMapper"in V&&i(13,C=V.optionMapper),"optionIconStyle"in V&&i(14,I=V.optionIconStyle),"optionLabelStyle"in V&&i(15,M=V.optionLabelStyle),"locale"in V&&i(16,D=V.locale),"onchange"in V&&i(17,T=V.onchange),"onload"in V&&i(25,F=V.onload),"ondestroy"in V&&i(26,W=V.ondestroy),"enableInput"in V&&i(18,O=V.enableInput),"$$scope"in V&&i(29,a=V.$$scope)},t.$$.update=()=>{65792&t.$$.dirty[0]&&i(19,n=D?I2(m,D):m),525312&t.$$.dirty[0]&&i(21,r=n.reduce((V,tt)=>{if(V)return V;const k=Array.isArray(tt)?tt:[tt,tt],[N,it]=k;return E2(N,b)?it:void 0},void 0)||(V=>{const tt=V.find(k=>k[0]===void 0);if(tt)return tt[1]})(n)||b)},[s,l,c,d,u,p,h,g,m,f,b,w,S,C,I,M,D,T,O,n,y,r,V=>{i(21,r=V.value),T(V),i(20,y=!1)},({e:V,panel:tt})=>{if(V&&V.key&&/up|down/i.test(V.key))return ah(tt.querySelector("input:not([disabled])"));ah(tt.querySelector("fieldset"))},V=>{/tab/i.test(V.key)&&V.preventDefault()},F,W,o,function(V){y=V,i(20,y)},a]}class qh extends ci{constructor(e){super(),li(this,e,o5,r5,oi,{class:0,title:1,label:2,labelClass:3,innerClass:4,hideLabel:5,icon:6,name:7,options:8,selectedIndex:9,value:10,optionLabelClass:11,optionFilter:12,optionMapper:13,optionIconStyle:14,optionLabelStyle:15,locale:16,onchange:17,onload:25,ondestroy:26,enableInput:18},null,[-1,-1])}}function a5(t){let e;return{c(){e=ht("div"),v(e,"slot","details")},m(i,n){et(i,e,n),t[14](e)},p:ni,d(i){i&&Q(e),t[14](null)}}}function s5(t){let e,i,n;function r(a){t[15](a)}let o={buttonLabel:t[0],buttonClass:t[1],buttonIcon:t[2],buttonHideLabel:t[3],buttonTitle:t[4],buttonLabelClass:t[5],onshow:t[6],onhide:t[7],$$slots:{details:[a5]},$$scope:{ctx:t}};return t[9]!==void 0&&(o.isActive=t[9]),e=new Lu({props:o}),zi.push(()=>mo(e,"isActive",r)),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,[s]){const l={};1&s&&(l.buttonLabel=a[0]),2&s&&(l.buttonClass=a[1]),4&s&&(l.buttonIcon=a[2]),8&s&&(l.buttonHideLabel=a[3]),16&s&&(l.buttonTitle=a[4]),32&s&&(l.buttonLabelClass=a[5]),64&s&&(l.onshow=a[6]),128&s&&(l.onhide=a[7]),65792&s&&(l.$$scope={dirty:s,ctx:a}),!i&&512&s&&(i=!0,l.isActive=a[9],vo(()=>i=!1)),e.$set(l)},i(a){n||(P(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function l5(t,e,i){let{buttonLabel:n}=e,{buttonClass:r}=e,{buttonIcon:o}=e,{buttonHideLabel:a}=e,{buttonTitle:s}=e,{buttonLabelClass:l}=e,{root:c}=e,{ondestroy:d=me}=e,{onshow:u=me}=e,{onhide:p=me}=e,h,g=!1;return _o(d),t.$$set=m=>{"buttonLabel"in m&&i(0,n=m.buttonLabel),"buttonClass"in m&&i(1,r=m.buttonClass),"buttonIcon"in m&&i(2,o=m.buttonIcon),"buttonHideLabel"in m&&i(3,a=m.buttonHideLabel),"buttonTitle"in m&&i(4,s=m.buttonTitle),"buttonLabelClass"in m&&i(5,l=m.buttonLabelClass),"root"in m&&i(10,c=m.root),"ondestroy"in m&&i(11,d=m.ondestroy),"onshow"in m&&i(6,u=m.onshow),"onhide"in m&&i(7,p=m.onhide)},t.$$.update=()=>{1280&t.$$.dirty&&h&&c&&h.firstChild!==c&&(h.hasChildNodes()?h.replaceChild(c,h.firstChild):h.append(c))},[n,r,o,a,s,l,u,p,h,g,c,d,()=>i(9,g=!1),()=>i(9,g=!0),function(m){zi[m?"unshift":"push"](()=>{h=m,i(8,h)})},function(m){g=m,i(9,g)}]}class c5 extends ci{constructor(e){super(),li(this,e,l5,s5,oi,{buttonLabel:0,buttonClass:1,buttonIcon:2,buttonHideLabel:3,buttonTitle:4,buttonLabelClass:5,root:10,ondestroy:11,onshow:6,onhide:7,hide:12,show:13})}get hide(){return this.$$.ctx[12]}get show(){return this.$$.ctx[13]}}var Mc=(t,e,i)=>(t-e)/(i-e);const d5=t=>({}),cg=t=>({});function dg(t){let e,i,n,r,o,a,s,l;return i=new wo({props:{$$slots:{default:[u5]},$$scope:{ctx:t}}}),o=new wo({props:{$$slots:{default:[p5]},$$scope:{ctx:t}}}),{c(){e=ht("button"),Et(i.$$.fragment),n=pe(),r=ht("button"),Et(o.$$.fragment),v(e,"type","button"),v(e,"aria-label","Increase"),v(r,"type","button"),v(r,"aria-label","Decrease")},m(c,d){et(c,e,d),Rt(i,e,null),et(c,n,d),et(c,r,d),Rt(o,r,null),a=!0,s||(l=[Mt(e,"pointerdown",t[20](1)),Mt(r,"pointerdown",t[20](-1))],s=!0)},p(c,d){const u={};128&d[1]&&(u.$$scope={dirty:d,ctx:c}),i.$set(u);const p={};128&d[1]&&(p.$$scope={dirty:d,ctx:c}),o.$set(p)},i(c){a||(P(i.$$.fragment,c),P(o.$$.fragment,c),a=!0)},o(c){z(i.$$.fragment,c),z(o.$$.fragment,c),a=!1},d(c){c&&Q(e),It(i),c&&Q(n),c&&Q(r),It(o),s=!1,Ui(l)}}}function u5(t){let e;return{c(){e=gr("path"),v(e,"d","M8 12 h8 M12 8 v8")},m(i,n){et(i,e,n)},p:ni,d(i){i&&Q(e)}}}function p5(t){let e;return{c(){e=gr("path"),v(e,"d","M9 12 h6")},m(i,n){et(i,e,n)},p:ni,d(i){i&&Q(e)}}}function h5(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g,m,f,b;const w=t[36].default,S=rr(w,t,t[38],null),C=t[36].knob,I=rr(C,t,t[38],cg);let M=t[9]&&dg(t);return{c(){e=ht("div"),i=ht("div"),n=ht("input"),o=pe(),a=ht("div"),S&&S.c(),l=pe(),c=ht("div"),d=ht("div"),I&&I.c(),h=pe(),M&&M.c(),v(n,"type","range"),v(n,"id",t[3]),v(n,"min",t[0]),v(n,"max",t[1]),v(n,"step",t[2]),n.value=t[14],v(n,"style",r=t[10]?"pointer-events:none":""),v(a,"class",s=mi(["PinturaSliderTrack",t[5]])),v(a,"style",t[4]),v(d,"class",u=mi(["PinturaSliderKnob",t[7]])),v(d,"style",t[6]),v(c,"class","PinturaSliderKnobController"),v(c,"style",t[17]),v(i,"class","PinturaSliderControl"),v(i,"style",p="--slider-position:"+Math.round(t[15])),v(e,"class",g=mi(["PinturaSlider",t[12]])),v(e,"data-direction",t[8])},m(D,T){et(D,e,T),Ct(e,i),Ct(i,n),t[37](n),Ct(i,o),Ct(i,a),S&&S.m(a,null),Ct(i,l),Ct(i,c),Ct(c,d),I&&I.m(d,null),Ct(e,h),M&&M.m(e,null),m=!0,f||(b=[Mt(n,"input",t[18]),Mt(n,"nudge",t[19]),Xi(Ds.call(null,n)),Mt(i,"pointerdown",function(){Zi(t[11]&&t[13])&&(t[11]&&t[13]).apply(this,arguments)})],f=!0)},p(D,T){t=D,(!m||8&T[0])&&v(n,"id",t[3]),(!m||1&T[0])&&v(n,"min",t[0]),(!m||2&T[0])&&v(n,"max",t[1]),(!m||4&T[0])&&v(n,"step",t[2]),(!m||16384&T[0])&&(n.value=t[14]),(!m||1024&T[0]&&r!==(r=t[10]?"pointer-events:none":""))&&v(n,"style",r),S&&S.p&&(!m||128&T[1])&&ar(S,w,t,t[38],m?or(w,t[38],T,null):sr(t[38]),null),(!m||32&T[0]&&s!==(s=mi(["PinturaSliderTrack",t[5]])))&&v(a,"class",s),(!m||16&T[0])&&v(a,"style",t[4]),I&&I.p&&(!m||128&T[1])&&ar(I,C,t,t[38],m?or(C,t[38],T,d5):sr(t[38]),cg),(!m||128&T[0]&&u!==(u=mi(["PinturaSliderKnob",t[7]])))&&v(d,"class",u),(!m||64&T[0])&&v(d,"style",t[6]),(!m||131072&T[0])&&v(c,"style",t[17]),(!m||32768&T[0]&&p!==(p="--slider-position:"+Math.round(t[15])))&&v(i,"style",p),t[9]?M?(M.p(t,T),512&T[0]&&P(M,1)):(M=dg(t),M.c(),P(M,1),M.m(e,null)):M&&(Ie(),z(M,1,1,()=>{M=null}),Ee()),(!m||4096&T[0]&&g!==(g=mi(["PinturaSlider",t[12]])))&&v(e,"class",g),(!m||256&T[0])&&v(e,"data-direction",t[8])},i(D){m||(P(S,D),P(I,D),P(M),m=!0)},o(D){z(S,D),z(I,D),z(M),m=!1},d(D){D&&Q(e),t[37](null),S&&S.d(D),I&&I.d(D),M&&M.d(),f=!1,Ui(b)}}}function m5(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,{$$slots:w={},$$scope:S}=e,{min:C=0}=e,{max:I=100}=e,{step:M=1}=e,{id:D}=e,{value:T=0}=e,{valueMin:F}=e,{valueMax:W}=e,{trackStyle:O}=e,{trackClass:y}=e,{knobStyle:V}=e,{knobClass:tt}=e,{ongrab:k=me}=e,{onchange:N=me}=e,{onrelease:it=me}=e,{onexceed:ut=me}=e,{direction:at="x"}=e,{getValue:gt=Ki}=e,{setValue:G=Ki}=e,{enableSpinButtons:$t=!0}=e,{enableForceUseKnob:vt=!1}=e,{enableStopPropagation:lt=!0}=e,{enablePointerdownListener:kt=!0}=e,{maxInteractionDistance:J=6}=e,{class:q}=e;const Z=Tt=>G(((dt,Jt)=>(Jt=1/Jt,Math.round(dt*Jt)/Jt))(tn(Tt,C,I),M),T),xt=(Tt,dt,Jt={})=>{const{grabbed:se=!1,released:ee=!1}=Jt,be=Z(C+Tt/dt*r),ve=F||C,_=W||I;i(21,T=_e(be)?be:tn(be,ve,_)),b!==be&&(b=be,!_e(be)&&(be<ve||be>_)&&ut(T,be),T!==f&&(f=T,se&&k(T),N(T),ee&&it(T)))};let nt;const mt=Tt=>{const dt=Tt[d]-m;xt(g+dt,h)},zt=Tt=>{h=void 0,document.documentElement.removeEventListener("pointermove",mt),document.documentElement.removeEventListener("pointerup",zt),N(T),it(T)},oe=()=>{i(21,T=Z(n+te*M)),N(T)};let Dt,te=1,Kt=!1;const U=Tt=>{clearTimeout(Dt),Kt||oe(),it(T),document.removeEventListener("pointerup",U)};return t.$$set=Tt=>{"min"in Tt&&i(0,C=Tt.min),"max"in Tt&&i(1,I=Tt.max),"step"in Tt&&i(2,M=Tt.step),"id"in Tt&&i(3,D=Tt.id),"value"in Tt&&i(21,T=Tt.value),"valueMin"in Tt&&i(22,F=Tt.valueMin),"valueMax"in Tt&&i(23,W=Tt.valueMax),"trackStyle"in Tt&&i(4,O=Tt.trackStyle),"trackClass"in Tt&&i(5,y=Tt.trackClass),"knobStyle"in Tt&&i(6,V=Tt.knobStyle),"knobClass"in Tt&&i(7,tt=Tt.knobClass),"ongrab"in Tt&&i(24,k=Tt.ongrab),"onchange"in Tt&&i(25,N=Tt.onchange),"onrelease"in Tt&&i(26,it=Tt.onrelease),"onexceed"in Tt&&i(27,ut=Tt.onexceed),"direction"in Tt&&i(8,at=Tt.direction),"getValue"in Tt&&i(28,gt=Tt.getValue),"setValue"in Tt&&i(29,G=Tt.setValue),"enableSpinButtons"in Tt&&i(9,$t=Tt.enableSpinButtons),"enableForceUseKnob"in Tt&&i(10,vt=Tt.enableForceUseKnob),"enableStopPropagation"in Tt&&i(30,lt=Tt.enableStopPropagation),"enablePointerdownListener"in Tt&&i(11,kt=Tt.enablePointerdownListener),"maxInteractionDistance"in Tt&&i(31,J=Tt.maxInteractionDistance),"class"in Tt&&i(12,q=Tt.class),"$$scope"in Tt&&i(38,S=Tt.$$scope)},t.$$.update=()=>{270532608&t.$$.dirty[0]&&i(14,n=T!==void 0?gt(T):0),3&t.$$.dirty[0]&&(r=I-C),16387&t.$$.dirty[0]&&i(33,o=Mc(n,C,I)),4&t.$$.dirty[1]&&i(15,a=100*o),256&t.$$.dirty[0]&&i(34,s=at.toUpperCase()),256&t.$$.dirty[0]&&i(35,l=at==="x"?"Width":"Height"),16&t.$$.dirty[1]&&(c="offset"+l),t.$$.dirty[1],8&t.$$.dirty[1]&&(d="page"+s),32768&t.$$.dirty[0]|8&t.$$.dirty[1]&&i(17,u=`transform: translate${s}(${a}%)`)},[C,I,M,D,O,y,V,tt,at,$t,vt,kt,q,Tt=>{let dt=!1;lt&&Tt.stopPropagation(),clearTimeout(nt);const Jt=p.getBoundingClientRect();if(h=p[c],m=Tt[d],g=m-Jt[at],vt){if(Math.abs(g-o*h)>J)return;dt=!0,Tt.stopPropagation()}return document.activeElement!==p&&p.focus(),xt(g,h,{grabbed:!0}),document.documentElement.addEventListener("pointermove",mt),document.documentElement.addEventListener("pointerup",zt),dt},n,a,p,u,Tt=>{h||(i(21,T=G(parseFloat(Tt.target.value))),T!==f&&(f=T,N(T)))},Tt=>{const dt=p[c];xt(n/r*dt+Tt.detail[at],dt),clearTimeout(nt),nt=setTimeout(()=>{it(T)},250)},Tt=>dt=>{clearTimeout(nt),te=Tt,Kt=!1,Dt=setInterval(()=>{Kt=!0,oe()},100),document.addEventListener("pointercancel",U),document.addEventListener("pointerup",U)},T,F,W,k,N,it,ut,gt,G,lt,J,Tt=>{const dt=p.getBoundingClientRect(),Jt=Tt[d]-dt[at],se=p[c];return Math.abs(Jt-o*se)},o,s,l,w,function(Tt){zi[Tt?"unshift":"push"](()=>{p=Tt,i(16,p)})},S]}class Kh extends ci{constructor(e){super(),li(this,e,m5,h5,oi,{min:0,max:1,step:2,id:3,value:21,valueMin:22,valueMax:23,trackStyle:4,trackClass:5,knobStyle:6,knobClass:7,ongrab:24,onchange:25,onrelease:26,onexceed:27,direction:8,getValue:28,setValue:29,enableSpinButtons:9,enableForceUseKnob:10,enableStopPropagation:30,enablePointerdownListener:11,maxInteractionDistance:31,class:12,eventDistanceToKnob:32,handlePointerDown:13},null,[-1,-1])}get eventDistanceToKnob(){return this.$$.ctx[32]}get handlePointerDown(){return this.$$.ctx[13]}}function ug(t){let e,i;return e=new wo({props:{class:"PinturaButtonIcon",$$slots:{default:[$5]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1048580&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function $5(t){let e;return{c(){e=gr("g")},m(i,n){et(i,e,n),e.innerHTML=t[2]},p(i,n){4&n&&(e.innerHTML=i[2])},d(i){i&&Q(e)}}}function pg(t){let e,i,n=nr(t[8],t[6])+"";return{c(){e=ht("span"),i=mn(n),v(e,"class","PinturaButtonLabelPrefix")},m(r,o){et(r,e,o),Ct(e,i)},p(r,o){320&o&&n!==(n=nr(r[8],r[6])+"")&&In(i,n)},d(r){r&&Q(e)}}}function g5(t){let e,i,n,r,o,a,s,l,c,d=t[2]&&ug(t),u=t[8]&&pg(t);return{c(){e=ht("span"),d&&d.c(),i=pe(),u&&u.c(),n=pe(),r=ht("span"),o=mn(t[9]),v(r,"class",a=mi(["PinturaButtonLabel",t[3],t[5]&&"implicit"])),v(e,"slot","label"),v(e,"title",s=nr(t[1],t[6])),v(e,"class",l=mi(["PinturaButtonInner",t[4]]))},m(p,h){et(p,e,h),d&&d.m(e,null),Ct(e,i),u&&u.m(e,null),Ct(e,n),Ct(e,r),Ct(r,o),c=!0},p(p,h){p[2]?d?(d.p(p,h),4&h&&P(d,1)):(d=ug(p),d.c(),P(d,1),d.m(e,i)):d&&(Ie(),z(d,1,1,()=>{d=null}),Ee()),p[8]?u?u.p(p,h):(u=pg(p),u.c(),u.m(e,n)):u&&(u.d(1),u=null),(!c||512&h)&&In(o,p[9]),(!c||40&h&&a!==(a=mi(["PinturaButtonLabel",p[3],p[5]&&"implicit"])))&&v(r,"class",a),(!c||66&h&&s!==(s=nr(p[1],p[6])))&&v(e,"title",s),(!c||16&h&&l!==(l=mi(["PinturaButtonInner",p[4]])))&&v(e,"class",l)},i(p){c||(P(d),c=!0)},o(p){z(d),c=!1},d(p){p&&Q(e),d&&d.d(),u&&u.d()}}}function f5(t){let e,i,n,r,o;const a=[t[12],{value:t[7]},{onchange:t[11]}];let s={};for(let l=0;l<a.length;l+=1)s=Cn(s,a[l]);return i=new Kh({props:s}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"slot","details")},m(l,c){et(l,e,c),Rt(i,e,null),n=!0,r||(o=Mt(e,"keydown",t[10]),r=!0)},p(l,c){const d=6272&c?fr(a,[4096&c&&Rr(l[12]),128&c&&{value:l[7]},2048&c&&{onchange:l[11]}]):{};i.$set(d)},i(l){n||(P(i.$$.fragment,l),n=!0)},o(l){z(i.$$.fragment,l),n=!1},d(l){l&&Q(e),It(i),r=!1,o()}}}function y5(t){let e,i;return e=new Lu({props:{panelClass:"PinturaSliderPanel",buttonClass:mi(["PinturaSliderButton",t[0],t[5]&&"PinturaSliderIconOnly"]),$$slots:{details:[f5],label:[g5]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,[r]){const o={};33&r&&(o.buttonClass=mi(["PinturaSliderButton",n[0],n[5]&&"PinturaSliderIconOnly"])),1053694&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function x5(t,e,i){const n=["class","title","label","icon","labelClass","innerClass","hideLabel","locale","value","onchange","labelPrefix"];let r=Zm(e,n),{class:o}=e,{title:a}=e,{label:s=Math.round}=e,{icon:l}=e,{labelClass:c}=e,{innerClass:d}=e,{hideLabel:u=!1}=e,{locale:p}=e,{value:h}=e,{onchange:g=me}=e,{labelPrefix:m}=e;const{min:f,max:b,getValue:w=Ki}=r;let S;const C=I=>i(9,S=(M=>on(s)?s(w(M),f,b,M):s)(I));return t.$$set=I=>{e=Cn(Cn({},e),Dc(I)),i(12,r=Zm(e,n)),"class"in I&&i(0,o=I.class),"title"in I&&i(1,a=I.title),"label"in I&&i(13,s=I.label),"icon"in I&&i(2,l=I.icon),"labelClass"in I&&i(3,c=I.labelClass),"innerClass"in I&&i(4,d=I.innerClass),"hideLabel"in I&&i(5,u=I.hideLabel),"locale"in I&&i(6,p=I.locale),"value"in I&&i(7,h=I.value),"onchange"in I&&i(14,g=I.onchange),"labelPrefix"in I&&i(8,m=I.labelPrefix)},t.$$.update=()=>{8320&t.$$.dirty&&C(h)},[o,a,l,c,d,u,p,h,m,S,I=>{/tab/i.test(I.key)&&I.preventDefault()},I=>{C(I),g(I)},r,s,g]}class b5 extends ci{constructor(e){super(),li(this,e,x5,y5,oi,{class:0,title:1,label:13,icon:2,labelClass:3,innerClass:4,hideLabel:5,locale:6,value:7,onchange:14,labelPrefix:8})}}function hg(t){let e,i,n=nr(t[0],t[1])+"";return{c(){e=ht("span"),i=mn(n),v(e,"class",t[3])},m(r,o){et(r,e,o),Ct(e,i)},p(r,o){3&o&&n!==(n=nr(r[0],r[1])+"")&&In(i,n),8&o&&v(e,"class",r[3])},d(r){r&&Q(e)}}}function v5(t){let e,i,n,r,o=t[0]&&hg(t);return n=new oo({props:{items:t[2]}}),{c(){e=ht("li"),o&&o.c(),i=pe(),Et(n.$$.fragment),v(e,"class","PinturaShapeStyle")},m(a,s){et(a,e,s),o&&o.m(e,null),Ct(e,i),Rt(n,e,null),r=!0},p(a,[s]){a[0]?o?o.p(a,s):(o=hg(a),o.c(),o.m(e,i)):o&&(o.d(1),o=null);const l={};4&s&&(l.items=a[2]),n.$set(l)},i(a){r||(P(n.$$.fragment,a),r=!0)},o(a){z(n.$$.fragment,a),r=!1},d(a){a&&Q(e),o&&o.d(),It(n)}}}function w5(t,e,i){let n,{title:r}=e,{locale:o}=e,{items:a}=e,{hideTitle:s=!1}=e;return t.$$set=l=>{"title"in l&&i(0,r=l.title),"locale"in l&&i(1,o=l.locale),"items"in l&&i(2,a=l.items),"hideTitle"in l&&i(4,s=l.hideTitle)},t.$$.update=()=>{16&t.$$.dirty&&i(3,n="PinturaShapeStyleLabel"+(s?" implicit":""))},[r,o,a,n,s]}class S5 extends ci{constructor(e){super(),li(this,e,w5,v5,oi,{title:0,locale:1,items:2,hideTitle:4})}}var mg=(t,e,i)=>{let n,r,o;const a=Math.floor(6*t),s=6*t-a,l=i*(1-e),c=i*(1-s*e),d=i*(1-(1-s)*e);switch(a%6){case 0:n=i,r=d,o=l;break;case 1:n=c,r=i,o=l;break;case 2:n=l,r=i,o=d;break;case 3:n=l,r=c,o=i;break;case 4:n=d,r=l,o=i;break;case 5:n=i,r=l,o=c}return[n,r,o]};function k5(t){let e,i,n;return{c(){e=ht("div"),i=ht("span"),v(e,"class","PinturaColorPreview"),v(e,"title",t[0]),v(e,"style",n="--color:"+t[1])},m(r,o){et(r,e,o),Ct(e,i)},p(r,[o]){1&o&&v(e,"title",r[0]),2&o&&n!==(n="--color:"+r[1])&&v(e,"style",n)},i:ni,o:ni,d(r){r&&Q(e)}}}function C5(t,e,i){let n,{color:r}=e,{title:o}=e;return t.$$set=a=>{"color"in a&&i(2,r=a.color),"title"in a&&i(0,o=a.title)},t.$$.update=()=>{4&t.$$.dirty&&i(1,n=r?$r(r):"transparent")},[o,n,r]}class Jh extends ci{constructor(e){super(),li(this,e,C5,k5,oi,{color:2,title:0})}}var L2=t=>(t=t.trim(),/^rgba/.test(t)?t.substr(5).split(",").map(parseFloat).map((e,i)=>e/(i===3?1:255)):/^rgb/.test(t)?t.substr(4).split(",").map(parseFloat).map(e=>e/255):/^#/.test(t)?(e=>{const[,i,n,r,o]=e.split("");e=e.length>=4&&e.length<=5?`#${i}${i}${n}${n}${r}${r}${o?`${o}${o}`:""}`:e;const[a,s,l,c,d]=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(e)||[];if(a)return[s,l,c,d].filter(u=>u!==void 0).map(u=>parseInt(u,16)/255)})(t):/[0-9]{1,3}\s?,\s?[0-9]{1,3}\s?,\s?[0-9]{1,3}/.test(t)?t.split(",").map(e=>parseInt(e,10)).map(e=>e/255):void 0);function $g(t){let e,i;return{c(){e=ht("span"),i=mn(t[0])},m(n,r){et(n,e,r),Ct(e,i)},p(n,r){1&r[0]&&In(i,n[0])},d(n){n&&Q(e)}}}function T5(t){let e,i,n,r;i=new Jh({props:{color:t[4],title:nr(t[8],t[10])}});let o=!t[9]&&$g(t);return{c(){e=ht("span"),Et(i.$$.fragment),n=pe(),o&&o.c(),v(e,"slot","label"),v(e,"class","PinturaButtonLabel")},m(a,s){et(a,e,s),Rt(i,e,null),Ct(e,n),o&&o.m(e,null),r=!0},p(a,s){const l={};16&s[0]&&(l.color=a[4]),1280&s[0]&&(l.title=nr(a[8],a[10])),i.$set(l),a[9]?o&&(o.d(1),o=null):o?o.p(a,s):(o=$g(a),o.c(),o.m(e,null))},i(a){r||(P(i.$$.fragment,a),r=!0)},o(a){z(i.$$.fragment,a),r=!1},d(a){a&&Q(e),It(i),o&&o.d()}}}function gg(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g;c=new Kh({props:{class:"PinturaHuePicker",knobStyle:"background-color:"+t[20],onchange:t[26],value:t[15],min:0,max:1,step:.01}});let m=t[11]&&fg(t),f=t[14]&&yg(t);return{c(){e=ht("div"),i=ht("div"),n=ht("div"),r=ht("div"),l=pe(),Et(c.$$.fragment),d=pe(),m&&m.c(),u=pe(),f&&f.c(),v(r,"role","button"),v(r,"aria-label","Saturation slider"),v(r,"class","PinturaPickerKnob"),v(r,"tabindex","0"),v(r,"style",o=`background-color:${t[19]};`),v(n,"class","PinturaPickerKnobController"),v(n,"style",a=`transform:translate(${t[24]}%,${t[23]}%)`),v(i,"class","PinturaSaturationPicker"),v(i,"style",s="background-color: "+t[20]),v(e,"class","PinturaPicker")},m(b,w){et(b,e,w),Ct(e,i),Ct(i,n),Ct(n,r),t[38](i),Ct(e,l),Rt(c,e,null),Ct(e,d),m&&m.m(e,null),Ct(e,u),f&&f.m(e,null),p=!0,h||(g=[Mt(r,"nudge",t[29]),Xi(Ds.call(null,r,{preventDefault:!0})),Mt(i,"pointerdown",t[28])],h=!0)},p(b,w){(!p||524288&w[0]&&o!==(o=`background-color:${b[19]};`))&&v(r,"style",o),(!p||25165824&w[0]&&a!==(a=`transform:translate(${b[24]}%,${b[23]}%)`))&&v(n,"style",a),(!p||1048576&w[0]&&s!==(s="background-color: "+b[20]))&&v(i,"style",s);const S={};1048576&w[0]&&(S.knobStyle="background-color:"+b[20]),32768&w[0]&&(S.value=b[15]),c.$set(S),b[11]?m?(m.p(b,w),2048&w[0]&&P(m,1)):(m=fg(b),m.c(),P(m,1),m.m(e,u)):m&&(Ie(),z(m,1,1,()=>{m=null}),Ee()),b[14]?f?f.p(b,w):(f=yg(b),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},i(b){p||(P(c.$$.fragment,b),P(m),p=!0)},o(b){z(c.$$.fragment,b),z(m),p=!1},d(b){b&&Q(e),t[38](null),It(c),m&&m.d(),f&&f.d(),h=!1,Ui(g)}}}function fg(t){let e,i;return e=new Kh({props:{class:"PinturaOpacityPicker",knobStyle:"background-color:"+t[17],trackStyle:`background-image:linear-gradient(to right,${t[18]},${t[19]})`,onchange:t[27],value:t[16],min:0,max:1,step:.01}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};131072&r[0]&&(o.knobStyle="background-color:"+n[17]),786432&r[0]&&(o.trackStyle=`background-image:linear-gradient(to right,${n[18]},${n[19]})`),65536&r[0]&&(o.value=n[16]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function yg(t){let e,i,n;return{c(){e=ht("input"),v(e,"class","PinturaColorPickerInput"),v(e,"type","text"),e.value=t[22]},m(r,o){et(r,e,o),i||(n=[Mt(e,"keydown",t[31]),Mt(e,"input",t[30])],i=!0)},p(r,o){4194304&o[0]&&e.value!==r[22]&&(e.value=r[22])},d(r){r&&Q(e),i=!1,Ui(n)}}}function xg(t){let e,i;return e=new as({props:{label:nr(t[10].labelColorPalette,t[10]),class:mi(["PinturaColorPresets",t[9]?"PinturaColorPresetsGrid":"PinturaColorPresetsList"]),hideLabel:!1,name:t[1],value:t[4],optionGroupClass:"PinturaListOptionGroup",optionClass:"PinturaListOption",options:t[2].map(t[39]),selectedIndex:t[3],optionMapper:t[7],optionLabelClass:t[6],onchange:t[40],$$slots:{option:[P5,({option:n})=>({52:n}),({option:n})=>[0,n?2097152:0]],group:[M5,({option:n})=>({52:n}),({option:n})=>[0,n?2097152:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r[0]&&(o.label=nr(n[10].labelColorPalette,n[10])),512&r[0]&&(o.class=mi(["PinturaColorPresets",n[9]?"PinturaColorPresetsGrid":"PinturaColorPresetsList"])),2&r[0]&&(o.name=n[1]),16&r[0]&&(o.value=n[4]),1028&r[0]&&(o.options=n[2].map(n[39])),8&r[0]&&(o.selectedIndex=n[3]),128&r[0]&&(o.optionMapper=n[7]),64&r[0]&&(o.optionLabelClass=n[6]),512&r[0]|6291456&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function M5(t){let e,i,n=t[52].label+"";return{c(){e=ht("span"),i=mn(n),v(e,"slot","group")},m(r,o){et(r,e,o),Ct(e,i)},p(r,o){2097152&o[1]&&n!==(n=r[52].label+"")&&In(i,n)},d(r){r&&Q(e)}}}function bg(t){let e,i,n=t[52].label+"";return{c(){e=ht("span"),i=mn(n),v(e,"class","PinturaButtonLabel")},m(r,o){et(r,e,o),Ct(e,i)},p(r,o){2097152&o[1]&&n!==(n=r[52].label+"")&&In(i,n)},d(r){r&&Q(e)}}}function P5(t){let e,i,n,r;i=new Jh({props:{title:t[52].label,color:t[52].value}});let o=!t[9]&&bg(t);return{c(){e=ht("span"),Et(i.$$.fragment),n=pe(),o&&o.c(),v(e,"slot","option")},m(a,s){et(a,e,s),Rt(i,e,null),Ct(e,n),o&&o.m(e,null),r=!0},p(a,s){const l={};2097152&s[1]&&(l.title=a[52].label),2097152&s[1]&&(l.color=a[52].value),i.$set(l),a[9]?o&&(o.d(1),o=null):o?o.p(a,s):(o=bg(a),o.c(),o.m(e,null))},i(a){r||(P(i.$$.fragment,a),r=!0)},o(a){z(i.$$.fragment,a),r=!1},d(a){a&&Q(e),It(i),o&&o.d()}}}function R5(t){let e,i,n,r=t[13]&&gg(t),o=t[12]&&xg(t);return{c(){e=ht("div"),r&&r.c(),i=pe(),o&&o.c(),v(e,"slot","details"),v(e,"class","PinturaColorPickerPanel")},m(a,s){et(a,e,s),r&&r.m(e,null),Ct(e,i),o&&o.m(e,null),n=!0},p(a,s){a[13]?r?(r.p(a,s),8192&s[0]&&P(r,1)):(r=gg(a),r.c(),P(r,1),r.m(e,i)):r&&(Ie(),z(r,1,1,()=>{r=null}),Ee()),a[12]?o?(o.p(a,s),4096&s[0]&&P(o,1)):(o=xg(a),o.c(),P(o,1),o.m(e,null)):o&&(Ie(),z(o,1,1,()=>{o=null}),Ee())},i(a){n||(P(r),P(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){a&&Q(e),r&&r.d(),o&&o.d()}}}function I5(t){let e,i;return e=new Lu({props:{buttonClass:mi(["PinturaColorPickerButton",t[5]]),$$slots:{details:[R5],label:[T5]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};32&r[0]&&(o.buttonClass=mi(["PinturaColorPickerButton",n[5]])),33554399&r[0]|4194304&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function E5(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,{label:b}=e,{name:w}=e,{options:S=[]}=e,{selectedIndex:C=-1}=e,{value:I}=e,{buttonClass:M}=e,{optionLabelClass:D}=e,{optionMapper:T}=e,{onchange:F}=e,{title:W}=e,{hidePresetLabel:O=!0}=e,{locale:y}=e,{enableOpacity:V=!0}=e,{enablePresets:tt=!0}=e,{enablePicker:k=!0}=e,{enableInput:N=!1}=e;const it=(Z,xt)=>{if(u=[Z[0],Z[1],Z[2]],xt){let nt=((mt,zt,oe)=>{let Dt=Math.max(mt,zt,oe),te=Dt-Math.min(mt,zt,oe),Kt=te&&(Dt==mt?(zt-oe)/te:Dt==zt?2+(oe-mt)/te:4+(mt-zt)/te);return[60*(Kt<0?Kt+6:Kt)/360,Dt&&te/Dt,Dt]})(...u);i(15,s=nt[0]),i(33,l=nt[1]),i(34,c=nt[2]),i(16,d=hi(Z[3])?Z[3]:1)}i(17,p=$r(Z)),i(18,h=$r([...u,0])),i(19,g=$r([...u,1])),i(20,m=$r(mg(s,1,1)))},ut=()=>{const Z=[...mg(s,l,c),d];it(Z),F(Z)},at=Z=>{const xt=Z.length===3?[...Z,1]:Z;it(xt,!0),F(xt)},gt=(Z,xt)=>{const nt=tn(Z.x/xt.width,0,1),mt=tn(Z.y/xt.height,0,1);var zt;zt=1-mt,i(33,l=nt),i(34,c=zt),d===0&&i(16,d=1),ut()};let G,$t,vt,lt;const kt=Z=>{const xt=Bn(mm(Z),lt);gt(Dn(Be(vt),xt),$t)},J=Z=>{$t=void 0,document.documentElement.removeEventListener("pointermove",kt),document.documentElement.removeEventListener("pointerup",J)};let q;return t.$$set=Z=>{"label"in Z&&i(0,b=Z.label),"name"in Z&&i(1,w=Z.name),"options"in Z&&i(2,S=Z.options),"selectedIndex"in Z&&i(3,C=Z.selectedIndex),"value"in Z&&i(4,I=Z.value),"buttonClass"in Z&&i(5,M=Z.buttonClass),"optionLabelClass"in Z&&i(6,D=Z.optionLabelClass),"optionMapper"in Z&&i(7,T=Z.optionMapper),"onchange"in Z&&i(32,F=Z.onchange),"title"in Z&&i(8,W=Z.title),"hidePresetLabel"in Z&&i(9,O=Z.hidePresetLabel),"locale"in Z&&i(10,y=Z.locale),"enableOpacity"in Z&&i(11,V=Z.enableOpacity),"enablePresets"in Z&&i(12,tt=Z.enablePresets),"enablePicker"in Z&&i(13,k=Z.enablePicker),"enableInput"in Z&&i(14,N=Z.enableInput)},t.$$.update=()=>{16&t.$$.dirty[0]|16&t.$$.dirty[1]&&(!I||f&&os(I,f)||(i(35,f=[...I]),it(I,!0))),4&t.$$.dirty[1]&&i(24,n=100*l),8&t.$$.dirty[1]&&i(23,r=100-100*c),32&t.$$.dirty[1]&&i(37,o=!!q&&q.length>=4&&q.length<=5),18448&t.$$.dirty[0]|64&t.$$.dirty[1]&&i(22,a=N&&I?((Z,xt,nt)=>{let mt=Z.map(zt=>Math.round(255*zt).toString(16).toLowerCase().padStart(2,"0"));return(!xt&&mt.length>3||mt[3]==="ff")&&mt.pop(),nt&&(mt=mt.map(zt=>zt.substring(0,1))),"#"+mt.join("")})(I,V,o):void 0)},[b,w,S,C,I,M,D,T,W,O,y,V,tt,k,N,s,d,p,h,g,m,G,a,r,n,at,Z=>{i(15,s=Z),d===0&&i(16,d=1),ut()},Z=>{i(16,d=Z),ut()},Z=>{Z.stopPropagation(),$t=Un(G.offsetWidth,G.offsetHeight),vt=(xt=>ot(xt.offsetX,xt.offsetY))(Z),lt=mm(Z),gt(vt,$t),document.documentElement.addEventListener("pointermove",kt),document.documentElement.addEventListener("pointerup",J)},Z=>{$t=Un(G.offsetWidth,G.offsetHeight);const xt=n/100*$t.width,nt=r/100*$t.height;gt({x:xt+Z.detail.x,y:nt+Z.detail.y},$t)},Z=>{const{value:xt}=Z.target,nt=xt.length;if(!xt.startsWith("#")||nt<4||nt===6||nt===8||nt>9||!V&&nt>7)return;const mt=L2(xt);mt&&(i(36,q=xt),it(mt),F(mt))},Z=>{Z.stopPropagation()},F,l,c,f,q,o,function(Z){zi[Z?"unshift":"push"](()=>{G=Z,i(21,G)})},([Z,xt])=>[Z,on(xt)?xt(y):xt],Z=>at(Z.value)]}class A5 extends ci{constructor(e){super(),li(this,e,E5,I5,oi,{label:0,name:1,options:2,selectedIndex:3,value:4,buttonClass:5,optionLabelClass:6,optionMapper:7,onchange:32,title:8,hidePresetLabel:9,locale:10,enableOpacity:11,enablePresets:12,enablePicker:13,enableInput:14},null,[-1,-1])}}function L5(t){let e,i,n;return i=new oo({props:{items:t[0]}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaShorthandControl PinturaShapeStyle")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,[o]){const a={};1&o&&(a.items=r[0]),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function z5(t,e,i){let n,r,{value:o}=e,{onchange:a}=e,{controls:s=[]}=e;return t.$$set=l=>{i(6,e=Cn(Cn({},e),Dc(l))),"value"in l&&i(1,o=l.value),"onchange"in l&&i(2,a=l.onchange),"controls"in l&&i(3,s=l.controls)},t.$$.update=()=>{i(4,n=(l=>{const{controls:c,...d}=l;return d})(e)),30&t.$$.dirty&&i(0,r=s.map((l,c)=>{const[d,u,p]=l;return[d,u,{...n,...p,value:o[c],onchange:h=>{const g=[...o];g[c]=h,a(g)}}]}))},e=Dc(e),[r,o,a,s,n]}class F5 extends ci{constructor(e){super(),li(this,e,z5,L5,oi,{value:1,onchange:2,controls:3})}}function D5(t){let e,i;return e=new qh({props:{label:t[4],options:t[1],title:t[2],selectedIndex:t[5],onchange:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,[r]){const o={};16&r&&(o.label=n[4]),2&r&&(o.options=n[1]),4&r&&(o.title=n[2]),32&r&&(o.selectedIndex=n[5]),9&r&&(o.onchange=n[10]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function B5(t,e,i){let n,r,o,a,{options:s}=e,{title:l}=e,{onchange:c}=e,{selectedIndex:d=-1}=e,{value:u}=e,{label:p}=e;return t.$$set=h=>{"options"in h&&i(1,s=h.options),"title"in h&&i(2,l=h.title),"onchange"in h&&i(3,c=h.onchange),"selectedIndex"in h&&i(0,d=h.selectedIndex),"value"in h&&i(6,u=h.value),"label"in h&&i(7,p=h.label)},t.$$.update=()=>{67&t.$$.dirty&&i(9,n=((h,g,m)=>{if(h)return g>-1?h[g]:m!==void 0?h.find(f=>f[0]===m):h[0]})(s,d,u)),514&t.$$.dirty&&i(5,r=s&&s.findIndex(h=>h===n)),512&t.$$.dirty&&i(8,o=n&&n[1]),384&t.$$.dirty&&i(4,a=p||o)},[d,s,l,c,a,r,u,p,o,n,h=>{i(0,d=h.index),c&&c(h)}]}class O5 extends ci{constructor(e){super(),li(this,e,B5,D5,oi,{options:1,title:2,onchange:3,selectedIndex:0,value:6,label:7})}}function vg(t,e,i){const n=t.slice();return n[9]=e[i][0],n[0]=e[i][1],n[10]=e[i][2],n[2]=e[i][3],n}function W5(t){let e,i,n;const r=[t[10]];var o=t[3][t[9]]||t[9];function a(s){let l={};for(let c=0;c<r.length;c+=1)l=Cn(l,r[c]);return{props:l}}return o&&(e=yu(o,a())),{c(){e&&Et(e.$$.fragment),i=Tn()},m(s,l){e&&Rt(e,s,l),et(s,i,l),n=!0},p(s,l){const c=4&l?fr(r,[Rr(s[10])]):{};if(o!==(o=s[3][s[9]]||s[9])){if(e){Ie();const d=e;z(d.$$.fragment,1,0,()=>{It(d,1)}),Ee()}o?(e=yu(o,a()),Et(e.$$.fragment),P(e.$$.fragment,1),Rt(e,i.parentNode,i)):e=null}else o&&e.$set(c)},i(s){n||(e&&P(e.$$.fragment,s),n=!0)},o(s){e&&z(e.$$.fragment,s),n=!1},d(s){s&&Q(i),e&&It(e,s)}}}function _5(t){let e,i=t[9],n=t[9]&&zp(t);return{c(){n&&n.c(),e=Tn()},m(r,o){n&&n.m(r,o),et(r,e,o)},p(r,o){r[9]?i?oi(i,r[9])?(n.d(1),n=zp(r),n.c(),n.m(e.parentNode,e)):n.p(r,o):(n=zp(r),n.c(),n.m(e.parentNode,e)):i&&(n.d(1),n=null),i=r[9]},i:ni,o(r){z(n)},d(r){r&&Q(e),n&&n.d(r)}}}function V5(t){let e,i,n=t[10].innerHTML+"";return{c(){e=new Pu(!1),i=Tn(),e.a=i},m(r,o){e.m(n,r,o),et(r,i,o)},p(r,o){4&o&&n!==(n=r[10].innerHTML+"")&&e.p(n)},i:ni,o:ni,d(r){r&&Q(i),r&&e.d()}}}function N5(t){let e,i=t[10].textContent+"";return{c(){e=mn(i)},m(n,r){et(n,e,r)},p(n,r){4&r&&i!==(i=n[10].textContent+"")&&In(e,i)},i:ni,o:ni,d(n){n&&Q(e)}}}function H5(t){let e,i;return e=new oo({props:{items:t[2],discardEmptyItems:!0}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4&r&&(o.items=n[2]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function zp(t){let e,i,n,r,o;const a=[H5,N5,V5],s=[];function l(u,p){return u[2]&&u[2].length?0:u[10].textContent?1:u[10].innerHTML?2:-1}~(i=l(t))&&(n=s[i]=a[i](t));let c=[t[4](t[10])],d={};for(let u=0;u<c.length;u+=1)d=Cn(d,c[u]);return{c(){e=ht(t[9]),n&&n.c(),r=pe(),/-/.test(t[9])?Ym(e,d):Xm(e,d)},m(u,p){et(u,e,p),~i&&s[i].m(e,null),Ct(e,r),o=!0},p(u,p){let h=i;i=l(u),i===h?~i&&s[i].p(u,p):(n&&(Ie(),z(s[h],1,1,()=>{s[h]=null}),Ee()),~i?(n=s[i],n?n.p(u,p):(n=s[i]=a[i](u),n.c()),P(n,1),n.m(e,r)):n=null),d=fr(c,[4&p&&u[4](u[10])]),/-/.test(u[9])?Ym(e,d):Xm(e,d)},i(u){o||(P(n),o=!0)},o(u){z(n),o=!1},d(u){u&&Q(e),~i&&s[i].d()}}}function wg(t,e){let i,n,r,o,a,s;const l=[_5,W5],c=[];function d(u,p){return 4&p&&(n=null),n==null&&(n=!u[5](u[9])),n?0:1}return r=d(e,-1),o=c[r]=l[r](e),{key:t,first:null,c(){i=Tn(),o.c(),a=Tn(),this.first=i},m(u,p){et(u,i,p),c[r].m(u,p),et(u,a,p),s=!0},p(u,p){let h=r;r=d(e=u,p),r===h?c[r].p(e,p):(Ie(),z(c[h],1,1,()=>{c[h]=null}),Ee(),o=c[r],o?o.p(e,p):(o=c[r]=l[r](e),o.c()),P(o,1),o.m(a.parentNode,a))},i(u){s||(P(o),s=!0)},o(u){z(o),s=!1},d(u){u&&Q(i),c[r].d(u),u&&Q(a)}}}function j5(t){let e,i,n=[],r=new Map,o=t[2];const a=s=>s[0]+s[1];for(let s=0;s<o.length;s+=1){let l=vg(t,o,s),c=a(l);r.set(c,n[s]=wg(c,l))}return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=Tn()},m(s,l){for(let c=0;c<n.length;c+=1)n[c].m(s,l);et(s,e,l),i=!0},p(s,[l]){62&l&&(o=s[2],Ie(),n=La(n,l,a,1,s,o,r,e.parentNode,Ls,wg,e,vg),Ee())},i(s){if(!i){for(let l=0;l<o.length;l+=1)P(n[l]);i=!0}},o(s){for(let l=0;l<n.length;l+=1)z(n[l]);i=!1},d(s){for(let l=0;l<n.length;l+=1)n[l].d(s);s&&Q(e)}}}function U5(t,e,i){let n,r,{items:o}=e,{discardEmptyItems:a=!0}=e,{key:s=""}=e;const l={Button:zs,ImageButton:T2,ImageButtonList:Yh,Dropdown:qh,Select:O5,RadioGroup:as,Input:A2,Panel:c5,ProgressIndicator:k2,ShapeStyle:S5,ToggleSlider:b5,ColorPicker:A5,ShorthandControl:F5},c=u=>!_e(u)||!!l[u],d=u=>{if(!u)return!1;const[p,,h,g=[]]=u;return!!c(p)||g.some(d)||h.textContent||h.innerHTML};return t.$$set=u=>{"items"in u&&i(6,o=u.items),"discardEmptyItems"in u&&i(7,a=u.discardEmptyItems),"key"in u&&i(0,s=u.key)},t.$$.update=()=>{1&t.$$.dirty&&i(1,n=s),192&t.$$.dirty&&i(2,r=(o&&a?o.filter(d):o)||[])},[s,n,r,l,(u={})=>{const{textContent:p,innerHTML:h,...g}=u;return g},c,o,a]}class oo extends ci{constructor(e){super(),li(this,e,U5,j5,oi,{items:6,discardEmptyItems:7,key:0})}get items(){return this.$$.ctx[6]}set items(e){this.$$set({items:e}),E()}get discardEmptyItems(){return this.$$.ctx[7]}set discardEmptyItems(e){this.$$set({discardEmptyItems:e}),E()}get key(){return this.$$.ctx[0]}set key(e){this.$$set({key:e}),E()}}let Fp=null;var G5=t=>{if(Fp===null&&(Fp=Pr()&&"visualViewport"in window),!Fp)return!1;const e=visualViewport.height,i=()=>{t(visualViewport.height<e?"visible":"hidden")};return visualViewport.addEventListener("resize",i),()=>visualViewport.removeEventListener("resize",i)};function Sg(t){let e,i;const n=[{onclick:t[1]},t[3]];let r={};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new zs({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=10&a[0]?fr(n,[2&a[0]&&{onclick:o[1]},8&a[0]&&Rr(o[3])]):{};e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function kg(t){let e,i;const n=[{onclick:t[0]},{class:"PinturaInputFormButtonConfirm"},t[2]];let r={};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new zs({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=5&a[0]?fr(n,[1&a[0]&&{onclick:o[0]},n[1],4&a[0]&&Rr(o[2])]):{};e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function Z5(t){let e,i,n,r,o,a,s,l,c=t[3]&&Sg(t);const d=t[24].default,u=rr(d,t,t[23],null);let p=t[2]&&kg(t);return{c(){e=ht("div"),i=ht("div"),c&&c.c(),n=pe(),r=ht("div"),u&&u.c(),o=pe(),p&&p.c(),v(r,"class","PinturaInputFormFields"),v(i,"class","PinturaInputFormInner"),v(e,"class","PinturaInputForm"),v(e,"data-layout",t[4]),v(e,"style",t[6])},m(h,g){et(h,e,g),Ct(e,i),c&&c.m(i,null),Ct(i,n),Ct(i,r),u&&u.m(r,null),Ct(i,o),p&&p.m(i,null),t[25](e),a=!0,s||(l=[Mt(r,"keydown",t[10]),Mt(e,"focusin",t[7]),Mt(e,"focusout",t[8]),Mt(e,"measure",t[9]),Xi(yr.call(null,e))],s=!0)},p(h,g){h[3]?c?(c.p(h,g),8&g[0]&&P(c,1)):(c=Sg(h),c.c(),P(c,1),c.m(i,n)):c&&(Ie(),z(c,1,1,()=>{c=null}),Ee()),u&&u.p&&(!a||8388608&g[0])&&ar(u,d,h,h[23],a?or(d,h[23],g,null):sr(h[23]),null),h[2]?p?(p.p(h,g),4&g[0]&&P(p,1)):(p=kg(h),p.c(),P(p,1),p.m(i,null)):p&&(Ie(),z(p,1,1,()=>{p=null}),Ee()),(!a||16&g[0])&&v(e,"data-layout",h[4]),(!a||64&g[0])&&v(e,"style",h[6])},i(h){a||(P(c),P(u,h),P(p),a=!0)},o(h){z(c),z(u,h),z(p),a=!1},d(h){h&&Q(e),c&&c.d(),u&&u.d(h),p&&p.d(),t[25](null),s=!1,Ui(l)}}}function X5(t,e,i){let n,r,o,a,s,{$$slots:l={},$$scope:c}=e,{onconfirm:d}=e,{oncancel:u}=e,{autoFocus:p=!0}=e,{autoPositionCursor:h=!0}=e,{buttonConfirm:g}=e,{buttonCancel:m}=e,{layout:f="stack"}=e,{parentRect:b}=e,{align:w}=e,{justify:S}=e,{parentMargin:C=16}=e,{panelOffset:I=rn()}=e,M=!1,D,T,F="",W=0;const O=()=>{const k=s.querySelector("input, textarea");k.focus(),W>=1||k.select()},y=()=>{M=!0,tt||!ia()&&!Su()||i(19,F="top:1em;bottom:auto;"),ia()&&(k=>{let N;const it=at=>N=at.touches[0].screenY,ut=at=>{const gt=at.touches[0].screenY,G=at.target;/textarea/i.test(G.nodeName)?(gt>N?G.scrollTop==0&&at.preventDefault():gt<N?G.scrollTop+G.offsetHeight==G.scrollHeight&&at.preventDefault():at.preventDefault(),N=gt):at.preventDefault()};k.addEventListener("touchstart",it),k.addEventListener("touchmove",ut)})(s),i(20,W=1)};let V;const tt=G5(k=>{o?k!=="hidden"||M?(clearTimeout(T),T=void 0,i(19,F=`top:${visualViewport.height-D.height-I.y}px`),k==="visible"?(i(5,s.dataset.stick=!0,s),O(),y()):(M=!1,i(20,W=0))):O():i(19,F="top: 4.5em; bottom: auto")});return As(()=>{p&&O()}),_o(()=>{tt&&tt()}),t.$$set=k=>{"onconfirm"in k&&i(0,d=k.onconfirm),"oncancel"in k&&i(1,u=k.oncancel),"autoFocus"in k&&i(11,p=k.autoFocus),"autoPositionCursor"in k&&i(12,h=k.autoPositionCursor),"buttonConfirm"in k&&i(2,g=k.buttonConfirm),"buttonCancel"in k&&i(3,m=k.buttonCancel),"layout"in k&&i(4,f=k.layout),"parentRect"in k&&i(13,b=k.parentRect),"align"in k&&i(14,w=k.align),"justify"in k&&i(15,S=k.justify),"parentMargin"in k&&i(16,C=k.parentMargin),"panelOffset"in k&&i(17,I=k.panelOffset),"$$scope"in k&&i(23,c=k.$$scope)},t.$$.update=()=>{385024&t.$$.dirty[0]&&i(21,n=b&&D?((k,N,it,ut,at)=>{let gt,G;return gt=ut==="center"?k.x+.5*k.width-.5*N.width:ut==="right"?k.x+k.width-N.width-at:k.x+at,G=it==="center"?k.y+.5*k.height-.5*N.height:it==="bottom"?k.y+k.height-N.height-at:k.y+at,`left:${gt}px;top:${G}px;right:auto;bottom:auto;`})(b,D,w,S,C):void 0),32&t.$$.dirty[0]&&i(22,r=s&&getComputedStyle(s)),4194304&t.$$.dirty[0]&&(o=r&&r.getPropertyValue("--editor-modal")==="1"),3670016&t.$$.dirty[0]&&i(6,a=`opacity:${W};${n||F}`)},[d,u,g,m,f,s,a,k=>{var N;((it=>/textarea/i.test(it))(k.target)||M2(k.target))&&(V=Date.now(),h&&((N=k.target).selectionStart=N.selectionEnd=N.value.length),clearTimeout(T),T=setTimeout(y,200))},k=>{Date.now()-V>50||(k.stopPropagation(),O())},({detail:k})=>{i(18,D={width:k.width,height:k.height})},k=>k.key==="Enter"?d():k.key==="Escape"?u():void 0,p,h,b,w,S,C,I,D,F,W,n,r,c,l,function(k){zi[k?"unshift":"push"](()=>{s=k,i(5,s)})}]}class z2 extends ci{constructor(e){super(),li(this,e,X5,Z5,oi,{onconfirm:0,oncancel:1,autoFocus:11,autoPositionCursor:12,buttonConfirm:2,buttonCancel:3,layout:4,parentRect:13,align:14,justify:15,parentMargin:16,panelOffset:17},null,[-1,-1])}}var Cg=(t,e)=>{t.fastSeek&&t.fastSeek(e),t.currentTime=e};const Y5=["aspectRatio","isRotatedSideways","flip","cropSize"],Tg=_h.map(([t])=>t).filter(t=>!Y5.includes(t));var fs=(t,e)=>new CustomEvent("ping",{detail:{type:t,data:e},cancelable:!0,bubbles:!0}),F2=(t,e)=>(e?Hh(t,e):t).replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\s+/g,"-").toLowerCase(),Mg=(t,e=Ki)=>{const{subscribe:i,set:n}=ue(void 0);return{subscribe:i,destroy:((r,o)=>{const a=matchMedia(r);return a.addListener(o),o(a),{get matches(){return a.matches},destroy:()=>a.removeListener(o)}})(t,({matches:r})=>n(e(r))).destroy}},Pg=(t,e,i)=>new Promise((n,r)=>{(async()=>{cl(t)&&n(await c2(t));const o=await e.read(t),a=l=>Jf(l,i).then(c=>e.apply(c,o)).then(n).catch(r);if(Kf(t)||!qf()||Ea()||ia())return a(t);let s;try{s=await Hc((l,c)=>createImageBitmap(l).then(d=>c(null,d)).catch(c),[t])}catch{}s&&s.width?await wu()?Uh()&&o>1?n(await(async l=>Nc(await Nl(l)))(s)):n(s):n(e.apply(s,o)):a(t)})()}),Rg=(t,e)=>new Promise(async i=>{if(t.width<e.width&&t.height<e.height)return i(t);const n=Math.min(e.width/t.width,e.height/t.height),r=n*t.width,o=n*t.height,a=xn("canvas",{width:r,height:o}),s=a.getContext("2d",{willReadFrequently:!0}),l=Fl(t)?await Nl(t):t;s.drawImage(l,0,0,r,o),i(Nc(a))});let Dp=null;var q5=()=>{if(Dp===null){let t=xn("canvas");Dp=!!Ru(t),qn(t),t=void 0}return Dp};const Ig=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],il={precision:1e-4},Yd={precision:.01*il.precision};var K5=()=>{const t=[],e=[],i=[],n=()=>{e.forEach(o=>o(i))},r=o=>{o.unsub=o.subscribe(a=>((s,l)=>{const c=t.indexOf(s);c<0||(i[c]=l,n())})(o,a)),n()};return{get length(){return t.length},clear:()=>{t.forEach(o=>o.unsub()),t.length=0,i.length=0},unshift:o=>{t.unshift(o),r(o)},get:o=>t[o],push:o=>{t.push(o),r(o)},remove:o=>{o.unsub();const a=t.indexOf(o);t.splice(a,1),i.splice(a,1)},forEach:o=>t.forEach(o),filter:o=>t.filter(o),subscribe:o=>(e.push(o),o(i),()=>{e.splice(e.indexOf(o),1)})}},Bp=t=>t[0]<.25&&t[1]<.25&&t[2]<.25,D2=(t={})=>new Promise(e=>{const{accept:i="image/*"}=t,n=xn("input",{style:"position:absolute;visibility:hidden;width:0;height:0;",type:"file",accept:i}),r=()=>{const[o]=n.files;n.parentNode&&n.remove(),n.removeEventListener("change",r),e(o)};n.addEventListener("change",r),ia()&&document.body.append(n),n.click()}),_c=t=>{try{return t()}catch(e){console.error(e)}},J5=([t,e])=>t+.5*(e-t),Ts=t=>Math.round(100*t),Qh=t=>ot(t.clientX,t.clientY),sh=(t,e,i)=>{const n=Qh(t);return Bn(Bn(n,e),i)};function Q5(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,I,M,D,{root:T}=e,{locale:F}=e,{stores:W}=e,{allowPan:O=!0}=e,{allowZoom:y=!0}=e,{enablePan:V=!0}=e,{enableZoom:tt=!0}=e,{enableZoomControls:k=tt}=e,{enableZoomInput:N=!0}=e,{enablePanInput:it=!0}=e,{enablePanLimit:ut=!0}=e,{panLimitGutterScalar:at=0}=e,{zoomOptions:gt=[.25,.5,1,1.25,1.5,2,3,4,6,8,16]}=e,{zoomAdjustStep:G=.25}=e,{zoomAdjustFactor:$t=.1}=e,{zoomAdjustWheelFactor:vt=1}=e,{elasticity:lt=5}=e,{imageSelectionRectCentered:kt}=e,{imageSelectionRectScalar:J}=e,{zoomLevel:q=null}=e,{zoomControls:Z}=e,{zoomMultiTouching:xt=!1}=e;const{isAnimated:nt,isInteracting:mt,rootRect:zt,stageRect:oe,stageScalar:Dt,imageSelectionPan:te,imageSelectionZoom:Kt,imageSelectionStageFitScalar:U,imageSelectionRect:Tt,imageSelectionStoredState:dt,imagePreviewUpscale:Jt}=W;A(t,nt,K=>i(70,M=K)),A(t,mt,K=>i(69,C=K)),A(t,zt,K=>i(66,b=K)),A(t,oe,K=>i(65,f=K)),A(t,Dt,K=>i(46,I=K)),A(t,te,K=>i(64,h=K)),A(t,Kt,K=>i(43,p=K)),A(t,U,K=>i(44,g=K)),A(t,Tt,K=>i(67,w=K)),A(t,dt,K=>i(71,D=K)),A(t,Jt,K=>i(45,m=K));const se=sn("fixScrollDirection");A(t,se,K=>i(68,S=K));let ee=!1,be,ve,_,ke;const fi=K=>{const Yt=T.querySelector(".PinturaMain > .PinturaUtilMain")||T.querySelector('div[tabindex="0"] .PinturaUtilMain');return!!Yt&&!!Yt.contains(K.target)&&!Wc(K.target)},ye=(K={})=>{const{pan:Yt=h,zoom:Ut=p}=K;wt(dt,D={translation:Yt,zoom:Ut},D)},Ot=()=>h&&h.x===0&&h.y===0,ze=()=>{wt(Kt,p=void 0,p),Ot()||wt(te,h=rn(),h),Oe.set(void 0,{hard:!0})},Re=()=>{ze(),ye()},Oe=pi(void 0,{precision:.01});Oe.subscribe(K=>{if(K===void 0)return wt(Kt,p=void 0,p),void(Ot()||wt(te,h=rn(),h));const Yt=p;K<=1?Ot()||wt(te,h=rn(),h):K<=Yt&&wt(te,h=Mr(h,.8),h),wt(Kt,p=K,p)});const di=K=>{Oe.update(Yt=>{const Ut=K(Yt||g);return ye({zoom:Ut}),Ut})},bt=K=>{K?Oe.set(K,{hard:M===!1}):(K=void 0,Oe.set(void 0,{hard:!0})),wt(Kt,p=K,p),ye({zoom:K})},le=(K,Yt)=>{const Ut=J*Yt,ne={...kt},De=1-tn(at,0,1);Tr(ne,Ut<De?Ut:De);const re={...kt};Tr(re,Ut),Jo(re,K);const Bi={...re};return re.x>ne.x&&(Bi.x=ne.x),re.y>ne.y&&(Bi.y=ne.y),re.x+re.width<ne.x+ne.width&&(Bi.x=ne.x+ne.width-re.width),re.y+re.height<ne.y+ne.height&&(Bi.y=ne.y+ne.height-re.height),Bn(ki(Bi),ki(ne))},Xe=({translation:K,zoom:Yt=1,elastify:Ut=!0})=>{if(!be)return;let ne=K;const De=ot(be.x+ne.x,be.y+ne.y);if(!ut)return De;const re=le(De,Yt);return Ut?h4(re,De,lt):re};let Ve,At;const Ge=()=>{At=void 0,wt(mt,C=!0,C),i(34,ee=it),Ve=!1,_=!1,be={...h},ve=m?p||g:o?p||1:p||g},Ye=K=>{const{scalar:Yt,translation:Ut,isMultiTouching:ne}=K.detail;if(!be||!ne&&!it)return;ne&&Mr(Ut,.5),(it||ne)&&(Ve=!0),xt||i(13,xt=ne);const De=n?tn(ve*Yt,s,l):1,re=Xe({translation:Ut,zoom:De,elastify:!0}),Bi=ws(re);ke=ws(h),_=Bi<ke,n&&Kt.set(De),te.set(re),At=xt&&{translation:K.detail.translation,scalar:Yt}},$i=K=>{wt(mt,C=!1,C),i(34,ee=!1),i(13,xt=!1),_&&ke<50&&(be=void 0,ve=void 0,te.set(rn()))},bi=K=>{wt(mt,C=!1,C),i(34,ee=!1),i(13,xt=!1),Promise.resolve().then(()=>{if(Ve&&be){const Yt=At||K.detail,Ut=n?tn(ve*Yt.scalar,s,l):1,ne=Xe({elastify:!1,translation:Yt.translation,zoom:Ut});te.set(ne)}be=void 0,ve=void 0,it&&K.detail.isDoubleTap&&Re(),ye()})};let Mi,Ci=Date.now(),X=0,Gt=!1,H=!1;const Zt=K=>{if(!fi(K)||(K.preventDefault(),K.stopPropagation(),H))return;clearTimeout(Mi);const Yt=Au(K,{fixScrollDirection:S}),Ut=Date.now(),ne=Ut-Ci;Ci=Ut;const De=Math.abs(Yt/ne)>.2;X=De?X+1:0;const re=1+-1*Yt*vt/(De?50:100),Bi=sh(K,b,f);ae(Bi,re,{isZoomingFast:De})},ae=(K,Yt,{isZoomingFast:Ut})=>{const ne=m?p||g:o?p||1:p||g,De=ne*Yt,re=rn(),Bi=h,ti=m?g:o?1:g,Ce=Math.abs(De-ti),xe=De<ne,Ke=ne>ti&&xe||ne<ti&&De>ne,Pe=X>=5;if(Ut||(Gt=!1),X>0&&!Gt&&(Gt=Ke),Pe&&Gt)return Re(),H=!0,void setTimeout(()=>{H=!1},100);if(Pe)return;!Ut&&Ke&&Ce<=.05&&(Mi=setTimeout(()=>{Re()},250)),wt(Kt,p=tn(De,s,l),p);const je=Si(w);Tr(je,ne),Jo(je,Bi);const Me=ki(je),fe=Si(je);Tr(fe,p-ne+1,K);const Ti=ki(fe),Yi=$m(Bn(Ti,Me),ne);((En,bn,Vn)=>{En.x=bn,En.y=Vn})(re,Bi.x+Yi.x,Bi.y+Yi.y),wt(te,h=xe&&Ut?Mr(Be(h),.85):le(re,ne),h),ye()},jt=K=>(K?"add":"remove")+"EventListener";let $e,Xt,Le,qe;const Ne=K=>{K.preventDefault(),Xt={...h},qe=Si(w),Le=sh(K,b,f),$e=m?p||g:o?p||1:p||g},pt=K=>{K.preventDefault(),wt(Kt,p=tn(K.scale*$e,s,l),p);const Yt=Si(qe);Tr(Yt,$e),Jo(Yt,Xt);const Ut=ki(Yt),ne=Si(Yt);Tr(ne,p-$e+1,Le);const De=ki(ne),re=$m(Bn(De,Ut),$e),Bi={x:Xt.x+re.x,y:Xt.y+re.y};wt(te,h=le(Bi,p),h)},Ht=K=>{K.preventDefault()},ie=K=>{T[jt(K)]("wheel",Zt),ia()||(T[jt(K)]("gesturestart",Ne),T[jt(K)]("gesturechange",pt),T[jt(K)]("gestureend",Ht))},Fe=K=>{const Yt=jt(K);T[Yt]("interactionstart",Ge),T[Yt]("interactionupdate",Ye),T[Yt]("interactionrelease",$i),T[Yt]("interactionend",bi)};let Wt;return As(()=>{Wt=Fs(T,{drag:!0,pinch:!0,inertia:!0,inertiaDurationMultiplier:10,shouldStartInteraction:fi})}),_o(()=>{ie(!1),Fe(!1),Wt.destroy(),Wt=void 0}),t.$$set=K=>{"root"in K&&i(14,T=K.root),"locale"in K&&i(15,F=K.locale),"stores"in K&&i(16,W=K.stores),"allowPan"in K&&i(17,O=K.allowPan),"allowZoom"in K&&i(18,y=K.allowZoom),"enablePan"in K&&i(19,V=K.enablePan),"enableZoom"in K&&i(20,tt=K.enableZoom),"enableZoomControls"in K&&i(21,k=K.enableZoomControls),"enableZoomInput"in K&&i(22,N=K.enableZoomInput),"enablePanInput"in K&&i(23,it=K.enablePanInput),"enablePanLimit"in K&&i(24,ut=K.enablePanLimit),"panLimitGutterScalar"in K&&i(25,at=K.panLimitGutterScalar),"zoomOptions"in K&&i(26,gt=K.zoomOptions),"zoomAdjustStep"in K&&i(27,G=K.zoomAdjustStep),"zoomAdjustFactor"in K&&i(28,$t=K.zoomAdjustFactor),"zoomAdjustWheelFactor"in K&&i(29,vt=K.zoomAdjustWheelFactor),"elasticity"in K&&i(30,lt=K.elasticity),"imageSelectionRectCentered"in K&&i(31,kt=K.imageSelectionRectCentered),"imageSelectionRectScalar"in K&&i(32,J=K.imageSelectionRectScalar),"zoomLevel"in K&&i(33,q=K.zoomLevel),"zoomControls"in K&&i(12,Z=K.zoomControls),"zoomMultiTouching"in K&&i(13,xt=K.zoomMultiTouching)},t.$$.update=()=>{var K,Yt;5505024&t.$$.dirty[0]&&i(36,n=y&&tt&&N),655360&t.$$.dirty[0]&&i(35,r=O&&V),393216&t.$$.dirty[0]&&(O||y?(wt(Kt,p=tt?D.zoom:void 0,p),wt(te,h=V?Be(D.translation):Ot()?h:rn(),h),Oe.set(p)):ze()),32768&t.$$.dirty[1]&&(o=I>=1),67141632&t.$$.dirty[0]|57344&t.$$.dirty[1]&&i(40,a=[(m||I<1)&&[g,Ts(g)+"%",{sublabel:F.labelZoomFit}],...gt.map(Ut=>[Ut,Ts(Ut)+"%"])].filter(Boolean).map(Ut=>(Ut[0]===1&&(Ut[2]={sublabel:F.labelZoomActual}),Ut)).sort((Ut,ne)=>{const De=Ut[0]||g,re=ne[0]||g;return De<re?-1:re<De?1:0})),8704&t.$$.dirty[1]&&i(38,s=Math.min(a.reduce((Ut,[ne])=>ne<Ut?ne:Ut,Number.MAX_SAFE_INTEGER),g)),512&t.$$.dirty[1]&&i(37,l=a.reduce((Ut,[ne])=>ne>Ut?ne:Ut,Number.MIN_SAFE_INTEGER)),4&t.$$.dirty[1]&&q!==null&&bt(q),61440&t.$$.dirty[1]&&i(42,d=p||(m||I<1?g:1)),2560&t.$$.dirty[1]&&i(39,(K=a.map(([Ut])=>Ut),Yt=d,c=K.findIndex(Ut=>Ut===Yt))),2048&t.$$.dirty[1]&&i(41,u=Ts(d)+"%"),405045248&t.$$.dirty[0]|6080&t.$$.dirty[1]&&i(12,Z=(y||y)&&k?[["Button","zoom-out",{hideLabel:!0,label:F.labelZoomOut,icon:F.iconZoomOut,disabled:p===s,onclick:()=>di(Ut=>Math.max(s,Ut-G)),onhold:()=>di(Ut=>Math.max(s,Ut*(1-$t)))}],["Dropdown","zoom-level",{label:u,labelClass:"PinturaFixedWidthCharacters",options:a,selectedIndex:c,onchange:Ut=>bt(Ut.value)}],["Button","zoom-in",{hideLabel:!0,label:F.labelZoomIn,icon:F.iconZoomIn,disabled:p===l,onclick:()=>di(Ut=>Math.min(l,Ut+G)),onhold:()=>di(Ut=>Math.min(l,Ut*(1+$t)))}]]:[]),16384&t.$$.dirty[0]|32&t.$$.dirty[1]&&T&&ie(n),16384&t.$$.dirty[0]|16&t.$$.dirty[1]&&T&&Fe(r),8404992&t.$$.dirty[0]|24&t.$$.dirty[1]&&T&&T.style.setProperty("--cursor",r&&it?ee?"grabbing":"grab":"")},[nt,mt,zt,oe,Dt,te,Kt,U,Tt,dt,Jt,se,Z,xt,T,F,W,O,y,V,tt,k,N,it,ut,at,gt,G,$t,vt,lt,kt,J,q,ee,r,n,l,s,c,a,u,d,p,g,m,I]}class t3 extends ci{constructor(e){super(),li(this,e,Q5,null,oi,{root:14,locale:15,stores:16,allowPan:17,allowZoom:18,enablePan:19,enableZoom:20,enableZoomControls:21,enableZoomInput:22,enablePanInput:23,enablePanLimit:24,panLimitGutterScalar:25,zoomOptions:26,zoomAdjustStep:27,zoomAdjustFactor:28,zoomAdjustWheelFactor:29,elasticity:30,imageSelectionRectCentered:31,imageSelectionRectScalar:32,zoomLevel:33,zoomControls:12,zoomMultiTouching:13},null,[-1,-1,-1,-1])}}const{window:nl}=Yy;function Eg(t){let e,i,n,r=t[41]&&Ag(t),o=t[38]&&Dg(t);return{c(){r&&r.c(),e=pe(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[41]?r?(r.p(a,s),1024&s[1]&&P(r,1)):(r=Ag(a),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(Ie(),z(r,1,1,()=>{r=null}),Ee()),a[38]?o?(o.p(a,s),128&s[1]&&P(o,1)):(o=Dg(a),o.c(),P(o,1),o.m(i.parentNode,i)):o&&(Ie(),z(o,1,1,()=>{o=null}),Ee())},i(a){n||(P(r),P(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function Ag(t){let e,i,n,r,o,a;const s=[i3,e3],l=[];function c(d,u){return d[39]?0:d[35]?1:-1}return~(n=c(t))&&(r=l[n]=s[n](t)),{c(){e=ht("div"),i=ht("p"),r&&r.c(),v(i,"style",t[72]),v(e,"class","PinturaStatus"),v(e,"style",o="opacity: "+t[54])},m(d,u){et(d,e,u),Ct(e,i),~n&&l[n].m(i,null),a=!0},p(d,u){let p=n;n=c(d),n===p?~n&&l[n].p(d,u):(r&&(Ie(),z(l[p],1,1,()=>{l[p]=null}),Ee()),~n?(r=l[n],r?r.p(d,u):(r=l[n]=s[n](d),r.c()),P(r,1),r.m(i,null)):r=null),(!a||1024&u[2])&&v(i,"style",d[72]),(!a||8388608&u[1]&&o!==(o="opacity: "+d[54]))&&v(e,"style",o)},i(d){a||(P(r),a=!0)},o(d){z(r),a=!1},d(d){d&&Q(e),~n&&l[n].d()}}}function e3(t){let e,i,n,r;e=new S2({props:{text:t[35].text||"",onmeasure:t[221]}});let o=t[35].aside&&Lg(t);return{c(){Et(e.$$.fragment),i=pe(),o&&o.c(),n=Tn()},m(a,s){Rt(e,a,s),et(a,i,s),o&&o.m(a,s),et(a,n,s),r=!0},p(a,s){const l={};16&s[1]&&(l.text=a[35].text||""),e.$set(l),a[35].aside?o?(o.p(a,s),16&s[1]&&P(o,1)):(o=Lg(a),o.c(),P(o,1),o.m(n.parentNode,n)):o&&(Ie(),z(o,1,1,()=>{o=null}),Ee())},i(a){r||(P(e.$$.fragment,a),P(o),r=!0)},o(a){z(e.$$.fragment,a),z(o),r=!1},d(a){It(e,a),a&&Q(i),o&&o.d(a),a&&Q(n)}}}function i3(t){let e,i,n,r;return e=new S2({props:{text:t[39],onmeasure:t[221]}}),n=new C2({props:{class:"PinturaStatusIcon",offset:t[82],opacity:t[83],$$slots:{default:[o3]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment),i=pe(),Et(n.$$.fragment)},m(o,a){Rt(e,o,a),et(o,i,a),Rt(n,o,a),r=!0},p(o,a){const s={};256&a[1]&&(s.text=o[39]),e.$set(s);const l={};1048576&a[2]&&(l.offset=o[82]),2097152&a[2]&&(l.opacity=o[83]),8&a[0]|1024&a[19]&&(l.$$scope={dirty:a,ctx:o}),n.$set(l)},i(o){r||(P(e.$$.fragment,o),P(n.$$.fragment,o),r=!0)},o(o){z(e.$$.fragment,o),z(n.$$.fragment,o),r=!1},d(o){It(e,o),o&&Q(i),It(n,o)}}}function Lg(t){let e,i;return e=new C2({props:{class:"PinturaStatusButton",offset:t[82],opacity:t[83],$$slots:{default:[n3]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1048576&r[2]&&(o.offset=n[82]),2097152&r[2]&&(o.opacity=n[83]),16&r[1]|1024&r[19]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function zg(t){let e,i;return e=new k2({props:{progress:t[35].progressIndicator.progress}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[1]&&(o.progress=n[35].progressIndicator.progress),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Fg(t){let e,i;const n=[t[35].closeButton,{hideLabel:!0}];let r={};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new zs({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=16&a[1]?fr(n,[Rr(o[35].closeButton),n[1]]):{};e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function n3(t){let e,i,n,r=t[35].progressIndicator.visible&&zg(t),o=t[35].closeButton&&t[35].text&&Fg(t);return{c(){r&&r.c(),e=pe(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[35].progressIndicator.visible?r?(r.p(a,s),16&s[1]&&P(r,1)):(r=zg(a),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(Ie(),z(r,1,1,()=>{r=null}),Ee()),a[35].closeButton&&a[35].text?o?(o.p(a,s),16&s[1]&&P(o,1)):(o=Fg(a),o.c(),P(o,1),o.m(i.parentNode,i)):o&&(Ie(),z(o,1,1,()=>{o=null}),Ee())},i(a){n||(P(r),P(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function r3(t){let e,i=t[3].iconSupportError+"";return{c(){e=gr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){8&r[0]&&i!==(i=n[3].iconSupportError+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function o3(t){let e,i;return e=new wo({props:{$$slots:{default:[r3]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8&r[0]|1024&r[19]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Dg(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g,m=t[10]&&Bg(t),f=t[46]&&t[45]&&Og(t);const b=[p3,u3],w=[];function S(T,F){return T[46]?0:1}function C(T){t[438](T)}function I(T){t[439](T)}function M(T){t[440](T)}n=S(t),r=w[n]=b[n](t),a=new Yv({props:{isAnimated:t[53],isTransparent:t[20],pixelRatio:t[57],textPixelRatio:t[6],backgroundColor:t[56],maskRect:t[58],maskOpacity:t[73]?t[73].maskOpacity:1,maskMarkupOpacity:t[7],maskFrameOpacity:t[5],clipAnnotationsToImage:t[85],images:t[55],interfaceImages:t[86],loadImageData:t[28],enableGrid:t[11],gridSize:t[87],gridColors:[t[88],t[89]],gridOpacity:t[90],selectionColor:t[91],csp:t[92]||{},willRequest:t[81]||t[93],willRender:t[435],didRender:t[436]}});let D={root:t[2],locale:t[3],stores:t[202],allowPan:t[95],enablePan:t[17],enablePanLimit:t[21],panLimitGutterScalar:t[22],enablePanInput:t[96],allowZoom:t[97],enableZoom:t[18],enableZoomInput:t[19]!==void 0?t[19]:t[98],enableZoomControls:t[99],zoomOptions:t[13]||t[23],zoomAdjustStep:t[14]||t[24],zoomAdjustFactor:t[15]||t[25],zoomAdjustWheelFactor:t[16]||t[26],imageSelectionRectCentered:t[100],imageSelectionRectScalar:t[101],elasticity:lh*t[8]};return t[0]!==void 0&&(D.zoomLevel=t[0]),t[33]!==void 0&&(D.zoomControls=t[33]),t[34]!==void 0&&(D.zoomMultiTouching=t[34]),d=new t3({props:D}),zi.push(()=>mo(d,"zoomLevel",C)),zi.push(()=>mo(d,"zoomControls",I)),zi.push(()=>mo(d,"zoomMultiTouching",M)),{c(){m&&m.c(),e=pe(),f&&f.c(),i=pe(),r.c(),o=pe(),Et(a.$$.fragment),s=pe(),l=ht("div"),c=pe(),Et(d.$$.fragment),v(l,"class","PinturaRootPortal")},m(T,F){m&&m.m(T,F),et(T,e,F),f&&f.m(T,F),et(T,i,F),w[n].m(T,F),et(T,o,F),Rt(a,T,F),et(T,s,F),et(T,l,F),t[437](l),et(T,c,F),Rt(d,T,F),g=!0},p(T,F){T[10]?m?(m.p(T,F),1024&F[0]&&P(m,1)):(m=Bg(T),m.c(),P(m,1),m.m(e.parentNode,e)):m&&(Ie(),z(m,1,1,()=>{m=null}),Ee()),T[46]&&T[45]?f?(f.p(T,F),49152&F[1]&&P(f,1)):(f=Og(T),f.c(),P(f,1),f.m(i.parentNode,i)):f&&(Ie(),z(f,1,1,()=>{f=null}),Ee());let W=n;n=S(T),n===W?w[n].p(T,F):(Ie(),z(w[W],1,1,()=>{w[W]=null}),Ee(),r=w[n],r?r.p(T,F):(r=w[n]=b[n](T),r.c()),P(r,1),r.m(o.parentNode,o));const O={};4194304&F[1]&&(O.isAnimated=T[53]),1048576&F[0]&&(O.isTransparent=T[20]),67108864&F[1]&&(O.pixelRatio=T[57]),64&F[0]&&(O.textPixelRatio=T[6]),33554432&F[1]&&(O.backgroundColor=T[56]),134217728&F[1]&&(O.maskRect=T[58]),2048&F[2]&&(O.maskOpacity=T[73]?T[73].maskOpacity:1),128&F[0]&&(O.maskMarkupOpacity=T[7]),32&F[0]&&(O.maskFrameOpacity=T[5]),8388608&F[2]&&(O.clipAnnotationsToImage=T[85]),16777216&F[1]&&(O.images=T[55]),16777216&F[2]&&(O.interfaceImages=T[86]),268435456&F[0]&&(O.loadImageData=T[28]),2048&F[0]&&(O.enableGrid=T[11]),33554432&F[2]&&(O.gridSize=T[87]),201326592&F[2]&&(O.gridColors=[T[88],T[89]]),268435456&F[2]&&(O.gridOpacity=T[90]),536870912&F[2]&&(O.selectionColor=T[91]),1073741824&F[2]&&(O.csp=T[92]||{}),524288&F[2]|1&F[3]&&(O.willRequest=T[81]||T[93]),512&F[0]|270991424&F[1]|2&F[3]&&(O.willRender=T[435]),62&F[2]&&(O.didRender=T[436]),a.$set(O);const y={};4&F[0]&&(y.root=T[2]),8&F[0]&&(y.locale=T[3]),4&F[3]&&(y.allowPan=T[95]),131072&F[0]&&(y.enablePan=T[17]),2097152&F[0]&&(y.enablePanLimit=T[21]),4194304&F[0]&&(y.panLimitGutterScalar=T[22]),8&F[3]&&(y.enablePanInput=T[96]),16&F[3]&&(y.allowZoom=T[97]),262144&F[0]&&(y.enableZoom=T[18]),524288&F[0]|32&F[3]&&(y.enableZoomInput=T[19]!==void 0?T[19]:T[98]),64&F[3]&&(y.enableZoomControls=T[99]),8396800&F[0]&&(y.zoomOptions=T[13]||T[23]),16793600&F[0]&&(y.zoomAdjustStep=T[14]||T[24]),33587200&F[0]&&(y.zoomAdjustFactor=T[15]||T[25]),67174400&F[0]&&(y.zoomAdjustWheelFactor=T[16]||T[26]),128&F[3]&&(y.imageSelectionRectCentered=T[100]),256&F[3]&&(y.imageSelectionRectScalar=T[101]),256&F[0]&&(y.elasticity=lh*T[8]),!u&&1&F[0]&&(u=!0,y.zoomLevel=T[0],vo(()=>u=!1)),!p&&4&F[1]&&(p=!0,y.zoomControls=T[33],vo(()=>p=!1)),!h&&8&F[1]&&(h=!0,y.zoomMultiTouching=T[34],vo(()=>h=!1)),d.$set(y)},i(T){g||(P(m),P(f),P(r),P(a.$$.fragment,T),P(d.$$.fragment,T),g=!0)},o(T){z(m),z(f),z(r),z(a.$$.fragment,T),z(d.$$.fragment,T),g=!1},d(T){m&&m.d(T),T&&Q(e),f&&f.d(T),T&&Q(i),w[n].d(T),T&&Q(o),It(a,T),T&&Q(s),T&&Q(l),t[437](null),T&&Q(c),It(d,T)}}}function Bg(t){let e,i,n,r,o;return i=new oo({props:{items:t[69]}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaNav PinturaNavTools")},m(a,s){et(a,e,s),Rt(i,e,null),n=!0,r||(o=[Mt(e,"measure",t[424]),Xi(yr.call(null,e))],r=!0)},p(a,s){const l={};128&s[2]&&(l.items=a[69]),i.$set(l)},i(a){n||(P(i.$$.fragment,a),n=!0)},o(a){z(i.$$.fragment,a),n=!1},d(a){a&&Q(e),It(i),r=!1,Ui(o)}}}function Og(t){let e,i,n;return i=new va({props:{elasticity:t[8]*ch,scrollDirection:t[76]?"y":"x",$$slots:{default:[d3]},$$scope:{ctx:t}}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaNav PinturaNavMain")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};256&o[0]&&(a.elasticity=r[8]*ch),16384&o[2]&&(a.scrollDirection=r[76]?"y":"x"),12288&o[1]|135168&o[2]|1024&o[19]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function a3(t){let e,i;const n=[t[79],{tabs:t[44]}];let r={$$slots:{default:[c3,({tab:o})=>({598:o}),({tab:o})=>[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o?512:0]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new Iu({props:r}),e.$on("select",t[425]),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=8192&a[1]|131072&a[2]?fr(n,[131072&a[2]&&Rr(o[79]),8192&a[1]&&{tabs:o[44]}]):{};1536&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function s3(t){let e,i;return e=new oo({props:{items:t[44]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8192&r[1]&&(o.items=n[44]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function l3(t){let e,i=t[598].icon+"";return{c(){e=gr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){512&r[19]&&i!==(i=n[598].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function c3(t){let e,i,n,r,o,a=t[598].label+"";return e=new wo({props:{$$slots:{default:[l3]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment),i=pe(),n=ht("span"),r=mn(a)},m(s,l){Rt(e,s,l),et(s,i,l),et(s,n,l),Ct(n,r),o=!0},p(s,l){const c={};1536&l[19]&&(c.$$scope={dirty:l,ctx:s}),e.$set(c),(!o||512&l[19])&&a!==(a=s[598].label+"")&&In(r,a)},i(s){o||(P(e.$$.fragment,s),o=!0)},o(s){z(e.$$.fragment,s),o=!1},d(s){It(e,s),s&&Q(i),s&&Q(n)}}}function d3(t){let e,i,n,r;const o=[s3,a3],a=[];function s(l,c){return l[74]?0:1}return e=s(t),i=a[e]=o[e](t),{c(){i.c(),n=Tn()},m(l,c){a[e].m(l,c),et(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?a[e].p(l,c):(Ie(),z(a[d],1,1,()=>{a[d]=null}),Ee(),i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),P(i,1),i.m(n.parentNode,n))},i(l){r||(P(i),r=!0)},o(l){z(i),r=!1},d(l){a[e].d(l),l&&Q(n)}}}function u3(t){let e,i,n;function r(a){t[431](a)}let o={locale:t[3],class:"PinturaMain",view:t[207](t[43]),props:t[206](t[43],t[27]),stores:t[202]};return t[1][t[43]]!==void 0&&(o.component=t[1][t[43]]),e=new x2({props:o}),zi.push(()=>mo(e,"component",r)),e.$on("measure",t[233]),e.$on("show",t[432]),e.$on("hide",t[433]),e.$on("fade",t[434]),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};8&s[0]&&(l.locale=a[3]),4096&s[1]&&(l.view=a[207](a[43])),134217728&s[0]|4096&s[1]&&(l.props=a[206](a[43],a[27])),!i&&2&s[0]|4096&s[1]&&(i=!0,l.component=a[1][a[43]],vo(()=>i=!1)),e.$set(l)},i(a){n||(P(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function p3(t){let e,i;const n=[{class:"PinturaMain"},{visible:t[62]},t[79],{panels:t[78]}];let r={$$slots:{default:[h3,({panel:o,panelIsActive:a})=>({596:o,597:a}),({panel:o,panelIsActive:a})=>[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(o?128:0)|(a?256:0)]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new Eu({props:r}),e.$on("measure",t[430]),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=196609&a[2]?fr(n,[n[0],1&a[2]&&{visible:o[62]},131072&a[2]&&Rr(o[79]),65536&a[2]&&{panels:o[78]}]):{};134217738&a[0]|1408&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function h3(t){let e,i,n;function r(a){t[426](a,t[596])}let o={locale:t[3],view:t[207](t[596]),props:t[206](t[596],t[27]),isActive:t[597],stores:t[202]};return t[1][t[596]]!==void 0&&(o.component=t[1][t[596]]),e=new x2({props:o}),zi.push(()=>mo(e,"component",r)),e.$on("measure",t[233]),e.$on("show",function(){return t[427](t[596])}),e.$on("hide",function(){return t[428](t[596])}),e.$on("fade",function(...a){return t[429](t[596],...a)}),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){t=a;const l={};8&s[0]&&(l.locale=t[3]),128&s[19]&&(l.view=t[207](t[596])),134217728&s[0]|128&s[19]&&(l.props=t[206](t[596],t[27])),256&s[19]&&(l.isActive=t[597]),!i&&2&s[0]|128&s[19]&&(i=!0,l.component=t[1][t[596]],vo(()=>i=!1)),e.$set(l)},i(a){n||(P(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function Wg(t){let e,i;return{c(){e=ht("span"),v(e,"class","PinturaEditorOverlay"),v(e,"style",i="opacity:"+t[102])},m(n,r){et(n,e,r)},p(n,r){512&r[3]&&i!==(i="opacity:"+n[102])&&v(e,"style",i)},d(n){n&&Q(e)}}}function _g(t){let e,i;const n=[{layout:"row"},{parentRect:t[50]},t[60]];let r={$$slots:{default:[m3]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new z2({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=537395200&a[1]?fr(n,[n[0],524288&a[1]&&{parentRect:o[50]},536870912&a[1]&&Rr(o[60])]):{};1610612736&a[1]|1024&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function m3(t){let e,i,n;return{c(){e=ht("input"),e.value=i=t[60].text,v(e,"placeholder",n=t[60].placeholder),v(e,"type","text"),v(e,"spellcheck","false"),v(e,"autocorrect","off"),v(e,"autocapitalize","off")},m(r,o){et(r,e,o),t[441](e)},p(r,o){536870912&o[1]&&i!==(i=r[60].text)&&e.value!==i&&(e.value=i),536870912&o[1]&&n!==(n=r[60].placeholder)&&v(e,"placeholder",n)},d(r){r&&Q(e),t[441](null)}}}function $3(t){let e,i,n,r,o,a;Wl(t[423]);let s=t[40]&&Eg(t),l=t[102]>0&&Wg(t),c=t[60]&&_g(t);return{c(){e=ht("div"),s&&s.c(),i=pe(),l&&l.c(),n=pe(),c&&c.c(),v(e,"id",t[4]),v(e,"class",t[77]),v(e,"data-env",t[75]),v(e,"dir",t[12])},m(d,u){et(d,e,u),s&&s.m(e,null),Ct(e,i),l&&l.m(e,null),Ct(e,n),c&&c.m(e,null),t[442](e),r=!0,o||(a=[Mt(nl,"keydown",t[224]),Mt(nl,"keyup",t[225]),Mt(nl,"blur",t[226]),Mt(nl,"paste",t[230]),Mt(nl,"resize",t[423]),Mt(e,"ping",function(){Zi(t[68])&&t[68].apply(this,arguments)}),Mt(e,"contextmenu",t[227]),Mt(e,"touchstart",t[222],{passive:!1}),Mt(e,"touchmove",function(){Zi(t[71])&&t[71].apply(this,arguments)}),Mt(e,"pointermove",function(){Zi(t[70])&&t[70].apply(this,arguments)}),Mt(e,"transitionend",t[212]),Mt(e,"dropfiles",t[228]),Mt(e,"measure",t[443]),Mt(e,"click",function(){Zi(t[42]?t[229]:me)&&(t[42]?t[229]:me).apply(this,arguments)}),Xi(yr.call(null,e,{observeViewRect:!0,isMeasureRoot:!0})),Xi(Uv.call(null,e)),Xi(y2.call(null,e))],o=!0)},p(d,u){(t=d)[40]?s?(s.p(t,u),512&u[1]&&P(s,1)):(s=Eg(t),s.c(),P(s,1),s.m(e,i)):s&&(Ie(),z(s,1,1,()=>{s=null}),Ee()),t[102]>0?l?l.p(t,u):(l=Wg(t),l.c(),l.m(e,n)):l&&(l.d(1),l=null),t[60]?c?(c.p(t,u),536870912&u[1]&&P(c,1)):(c=_g(t),c.c(),P(c,1),c.m(e,null)):c&&(Ie(),z(c,1,1,()=>{c=null}),Ee()),(!r||16&u[0])&&v(e,"id",t[4]),(!r||32768&u[2])&&v(e,"class",t[77]),(!r||8192&u[2])&&v(e,"data-env",t[75]),(!r||4096&u[0])&&v(e,"dir",t[12])},i(d){r||(P(s),P(c),r=!0)},o(d){z(s),z(c),r=!1},d(d){d&&Q(e),s&&s.d(),l&&l.d(),c&&c.d(),t[442](null),o=!1,Ui(a)}}}const lh=1,ch=10;function g3(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,I,M,D,T,F,W,O,y,V,tt,k,N,it,ut,at,gt,G,$t,vt,lt,kt,J,q,Z,xt,nt,mt,zt,oe,Dt,te,Kt,U,Tt,dt,Jt,se,ee,be,ve,_,ke,fi,ye,Ot,ze,Re,Oe,di,bt,le,Xe,Ve,At,Ge,Ye,$i,bi,Mi,Ci,X,Gt,H,Zt,ae,jt,$e,Xt,Le,qe,Ne,pt,Ht,ie,Fe,Wt,K,Yt,Ut,ne,De,re,Bi,ti,Ce,xe,Ke,Pe,je,Me,fe,Ti,Yi,En,bn,Vn,An,qr,ao,Ln,xr,vn,Nn,$n,So,Wi,gn,On,Vo,Kr,$o,ko,dr,cn,en,so,No,br,vr,lo,la,Co,To,_r,Jr,Ir,ur,wr,Wn,_i,Vi,lr,Ji,Vr,co,Qr,pr,zn,Sr,uo,cr,Kn,Hn,Er,to,eo,Mn,Ar,B,ce,vi,Ue,Pt,ge,yi,Gi,dn,wi,Ni,Lr,ca,da,wa,Ho,Nr,Mo,Po,za,Hr,R,Te,We,gi,Oi,Hi,ei,ai,Ai,Fi,un,Sn,fn,Di,Pi,zr,jo,Sa,Fa,Da,Ba,Uo,ss,ul,Oa,Wa,jr=ni,Ur=ni;A(t,Hv,$=>i(411,Gi=$)),t.$$.on_destroy.push(()=>jr()),t.$$.on_destroy.push(()=>Ur());const Gr=ns(),hr=ba();let{class:pn}=e,{layout:Ro}=e,{stores:_a}=e,{locale:Ri}=e,{id:Bs}=e,{util:ls}=e,{utils:jl}=e,{animations:ka="auto"}=e,{disabled:cs=!1}=e,{status:Zr}=e,{previewUpscale:Os=!1}=e,{previewPad:Va=!1}=e,{previewMaskOpacity:x=.95}=e,{previewImageDataMaxSize:j}=e,{previewImageTextPixelRatio:L}=e,{markupMaskOpacity:rt=1}=e,{zoomMaskOpacity:ct=.85}=e,{elasticityMultiplier:Lt=10}=e,{willRevert:Nt=()=>Promise.resolve(!0)}=e,{willProcessImage:Vt=()=>Promise.resolve(!0)}=e,{willRenderCanvas:Bt=Ki}=e,{willRenderToolbar:Ft=Ki}=e,{willRenderUtilTabs:_t=Ki}=e,{willSetHistoryInitialState:qt=Ki}=e,{enableButtonExport:ri=!0}=e,{enableButtonRevert:de=!0}=e,{enableNavigateHistory:he=!0}=e,{enableToolbar:we=!0}=e,{enableUtils:Se=!0}=e,{enableButtonClose:Ze=!1}=e,{enableDropImage:ii=!1}=e,{enablePasteImage:xi=!1}=e,{enableBrowseImage:ui=!1}=e,{enableTransparencyGrid:Ii=!1}=e,{layoutDirectionPreference:ln="auto"}=e,{layoutHorizontalUtilsPreference:ji="left"}=e,{layoutVerticalUtilsPreference:Li="bottom"}=e,{layoutVerticalToolbarPreference:yn="top"}=e,{layoutVerticalControlGroupsPreference:Qi="bottom"}=e,{layoutVerticalControlTabsPreference:Gn="bottom"}=e,{textDirection:an}=e,{markupEditorZoomLevel:kr=null}=e,{markupEditorZoomLevels:Xr}=e,{markupEditorZoomAdjustStep:io}=e,{markupEditorZoomAdjustFactor:Na}=e,{markupEditorZoomAdjustWheelFactor:Ha}=e,{markupEditorInteractionMode:ds=!1}=e,{muteAudio:ja=!0}=e,{willSetMediaInitialTimeOffset:ua=($,Y)=>$*J5(Y[0])}=e,{enablePan:Go=!0}=e,{enableZoom:Io=!0}=e,{enableZoomControls:Ua=!0}=e,{enableZoomInput:Ca}=e,{enablePanInput:us}=e,{enableCanvasAlpha:go=!1}=e,{enablePanLimit:Ga}=e,{panLimitGutterScalar:ps}=e,{zoomPresetOptions:Ws=[.25,.5,1,1.25,1.5,2,3,4,6,8,16]}=e,{zoomAdjustStep:Ul=.25}=e,{zoomAdjustFactor:Ta=.1}=e,{zoomAdjustWheelFactor:Za=1}=e,{zoomLevel:Fn=null}=e,{fixScrollDirection:Eo=!1}=e;const o0=ue(Eo);let Gl,Gc;po("fixScrollDirection",o0);let{imagePreviewSrc:Ou}=e,{imageOrienter:Zc={read:()=>1,apply:$=>$}}=e,{pluginComponents:pl}=e,{pluginOptions:_s={}}=e;const ex=Gr.sub,Ao={};let{root:Jn}=e;const Wu=()=>{re.setAttribute("data-redraw","true"),Ns.set({})},_u=ue(!0);A(t,_u,$=>i(475,vn=$));const Zl=ue(void 0);A(t,Zl,$=>i(421,gi=$));const Xa=ue(0);A(t,Xa,$=>i(418,R=$));const a0=ue(!1),Xc=$=>{a0.set($.type==="play"),Gr.pub($.type)};let s0,Vu,l0,Nu,Hu=!1;const ju=()=>{if(!o||!hl())return;Nu=u,wt(Zl,gi=void 0,gi);const $=re;Hu=!1;const Y=1/24,ft=Ya();(Math.abs(c*ft-R*ft)<=Y||ft-ft*R<=Y)&&wt(Xa,R=l,R),Yc(R*Ya()),$.play().catch(()=>{});let St=Yl();const st=()=>{if(hl())return;l0=requestAnimationFrame(st);let yt=Yl();yt-St<=0&&(yt=St+.01),St=yt,wt(Xa,R=yt/Ya(),R),Nu>=0&&R>=c&&(wt(Xa,R=c,R),Vs()),u>-1&&(Hu=!0),Hu&&u===-1&&p>0&&(wt(Xa,R=s[p][0],R),Yc(R*Ya())),wt(Kc,Mo=R*Ya(),Mo),Wu()};st()},Vs=()=>{o&&!hl()&&(wt(Zl,gi=void 0,gi),Nu=void 0,re.pause(),cancelAnimationFrame(l0),Wu())},hl=()=>re&&re.paused,Uu=()=>{if(o)return hl()?ju():Vs()},Gu=()=>{o&&(re.muted=!0)},Zu=()=>{o&&(re.muted=!1)},c0=()=>{o&&wt(Xl,We=!We,We)},Xl=ue(ja);A(t,Xl,$=>i(420,We=$));const Ya=()=>{if(o)return re.duration},Yl=()=>{if(o)return re.currentTime},Yc=$=>{o&&(Cg(re,$),wt(Xa,R=$/Te,R))},Ns=ue({});A(t,Ns,$=>i(52,So=$)),po("redrawTrigger",Ns);const qc=ue(Lt);A(t,qc,$=>i(492,za=$)),po("elasticityMultiplier",qc);let ql=[];const Xu=pi();A(t,Xu,$=>i(102,Wa=$));const d0=jh()||1024,u0=Un(d0,d0),p0=r2(),ix=$=>Promise.resolve(Po&&Po($,{resourceType:"image"})).then(Y=>{if(Y===!1)return;const{headers:ft,credentials:St}=Y||{};return fetch($,{headers:ft,credentials:St}).then(st=>{if(st.status!==200)throw`${st.status} (${st.statusText})`;return st.blob()}).then(st=>Pg(st,Zc,p0)).then(st=>Rg(st,m))});let{imageSourceToImageData:Yu=$=>_e($)?ix($):Bl($)?new Promise(Y=>Y(Nc($))):Th($)||jc($)?Pg($,Zc,p0).then(Y=>Rg(Y,m)):void 0}=e;const qu=(()=>{let $,Y;const ft=Tg.reduce((St,st)=>(St[st]=function(yt,Qt,Je){let Qe=[];return{set:Qt,update:Je,publish:He=>{Qe.forEach(hn=>hn(He))},subscribe:He=>(Qe.push(He),yt(He),()=>{Qe=Qe.filter(hn=>hn!==He)})}}(yt=>{if(!Y)return yt();Y.stores[st].subscribe(yt)()},yt=>{Y&&Y.stores[st].set(yt)},yt=>{Y&&Y.stores[st].update(yt)}),St),{});return{update:St=>{if(Y=St,$&&($.forEach(st=>st()),$=void 0),!St)return ft.file.publish(void 0),void ft.loadState.publish(void 0);$=Tg.map(st=>St.stores[st].subscribe(yt=>{ft[st].publish(yt)}))},stores:ft,destroy:()=>{$&&$.forEach(St=>St())}}})(),{file:Ku,size:Hs,duration:Ju,currentTime:Kc,trim:Qu,volume:h0,minDuration:nx,maxDuration:t1,loadState:Jc,processState:e1,cropAspectRatio:Qc,cropLimitToImage:i1,crop:pa,cropMinSize:rx,cropMaxSize:ox,cropRange:ax,cropOrigin:sx,cropRectAspectRatio:lx,rotation:ml,rotationRange:cx,targetSize:dx,flipX:td,flipY:ed,backgroundColor:id,backgroundImage:m0,colorMatrix:$0,convolutionMatrix:g0,gamma:f0,vignette:y0,noise:x0,decoration:n1,annotation:r1,manipulation:o1,redaction:a1,frame:js,selection:s1,state:nd}=qu.stores;A(t,Ku,$=>i(395,Jr=$)),A(t,Hs,$=>i(368,Ce=$)),A(t,Ju,$=>i(419,Te=$)),A(t,Kc,$=>i(491,Mo=$)),A(t,Qu,$=>i(416,Nr=$)),A(t,h0,$=>i(417,Hr=$)),A(t,t1,$=>i(422,Oi=$)),A(t,Jc,$=>i(387,en=$)),A(t,e1,$=>i(386,cn=$)),A(t,Qc,$=>i(488,wi=$)),A(t,i1,$=>i(85,Ai=$)),A(t,pa,$=>i(406,Hn=$)),A(t,ml,$=>i(371,Pe=$)),A(t,td,$=>i(370,Ke=$)),A(t,ed,$=>i(369,xe=$)),A(t,id,$=>i(377,ao=$)),A(t,n1,$=>i(48,ti=$)),A(t,r1,$=>i(49,je=$)),A(t,o1,$=>i(374,Vn=$)),A(t,a1,$=>i(375,An=$)),A(t,js,$=>i(47,Bi=$)),A(t,s1,$=>i(59,da=$)),A(t,nd,$=>i(477,wr=$)),po("components",{DynamicComponentTree:oo}),po("previewcontrols",{play:ju,pause:Vs,togglePlayPause:Uu,mute:Gu,unmute:Zu,toggleMute:c0,setCurrentTime:Yc,getCurrentTime:Yl,getDuration:Ya,frameOffset:Xa,framePeekOffset:Zl,isPlaying:a0,isMuted:Xl});const b0=($,Y,ft=0)=>new Promise((St,st)=>{if(cl($))return void s2($).then(Qe=>{const He=hi(Mo)?Mo:ua(Qe.duration,Nr||[[0,1]]);l2(Qe,He).then(St)});let yt,Qt=!1;Y.cancel=()=>Qt=!0;const Je=Date.now();Yu($).then(Qe=>{const He=Date.now()-Je;clearTimeout(yt),yt=setTimeout(()=>{Qt||St(Qe)},Math.max(0,ft-He))}).catch(st)}),{images:v0,shapePreprocessor:w0,imageScrambler:S0,imageRedactionRendering:k0,willRequest:C0,willRequestResource:T0,csp:M0}=_a;let Kl;A(t,v0,$=>i(415,Ho=$)),A(t,w0,$=>i(414,wa=$)),A(t,S0,$=>i(378,Ln=$)),A(t,k0,$=>i(376,qr=$)),A(t,C0,$=>i(81,Po=$)),A(t,T0,$=>i(93,jo=$)),A(t,M0,$=>i(92,zr=$));const ux=Ei(m0,($,Y)=>{if(!$)return Y(void 0);Kl&&(Kl.cancel(),Kl=void 0),Kl={cancel:me},b0($,Kl).then(Y).catch(ft=>{})}),px=nd.subscribe($=>Gr.pub("update",$)),hx=ue();po("ui",ue({})),po("selection",s1);const l1=ue(!0);A(t,l1,$=>i(95,Fa=$));const c1=ue(!0);A(t,c1,$=>i(97,Ba=$));const d1=ue(!0);A(t,d1,$=>i(413,ca=$));const rd=ue(!0);A(t,rd,$=>i(489,Ni=$));const u1=ue(!0);A(t,u1,$=>i(98,Uo=$));const p1=ue();A(t,p1,$=>i(99,ss=$));const od=ue();A(t,od,$=>i(490,Lr=$));const h1=Ei([od,rd],()=>Lr!==void 0?Lr:Ni);A(t,h1,$=>i(96,Da=$));const Jl=ue([0,0,0]);A(t,Jl,$=>i(56,Ji=$));const ad=ue([1,1,1]);A(t,ad,$=>i(473,bn=$));const Ql=pi([1,1,1]);A(t,Ql,$=>i(472,En=$));const m1=ue();A(t,m1,$=>i(91,Pi=$));const P0=ue(),$1=ue();A(t,$1,$=>i(51,Nn=$));const $l=ue();A(t,$l,$=>i(372,fe=$));const gl=ue(Ss());A(t,gl,$=>i(80,Wn=$));const g1=ue(0);A(t,g1,$=>i(412,dn=$));const tc=ue(Ss());A(t,tc,$=>i(84,ai=$));const Us=ue();A(t,Us,$=>i(470,De=$));const sd=Mg("(pointer: fine)",$=>$?"pointer-fine":"pointer-coarse");A(t,sd,$=>i(393,To=$));const ld=Mg("(hover: hover)",$=>$?"pointer-hover":"pointer-no-hover");A(t,ld,$=>i(392,Co=$));const R0=ue(!1),ec=ue(!1);A(t,ec,$=>i(373,Yi=$));const f1=Rl(void 0,$=>{const Y=pi(0),ft=[ec.subscribe(St=>{Y.set(St?1:0,{hard:!gn})}),Y.subscribe($)];return()=>ft.forEach(St=>St())});A(t,f1,$=>i(471,Ti=$));const cd=ue();A(t,cd,$=>i(476,vr=$));const dd=ue();let y1;A(t,dd,$=>i(53,gn=$)),po("isAnimated",dd);const ud=ue(Os);A(t,ud,$=>i(396,Ir=$));const Gs=ue(!1);A(t,Gs,$=>i(482,eo=$)),po("imageIsStatic",Gs);const ic=ue();A(t,ic,$=>i(483,Mn=$));const x1=ue();A(t,x1,$=>i(480,Er=$));const I0=Rl(void 0,$=>{const Y=ue(void 0),ft=[pa.subscribe(()=>{if(!Hn)return;if(eo)return Y.set(Si(Hn));const St=F$(Hn,Er,5*Lt);Y.set(St)}),Y.subscribe($)];return()=>ft.forEach(St=>St())}),Zo=ue();A(t,Zo,$=>i(479,Kn=$));const pd=ue();A(t,pd,$=>i(481,to=$));const b1=ue(void 0);A(t,b1,$=>i(486,Pt=$));const E0=ue(rn());A(t,E0,$=>i(487,ge=$));const A0=($,Y)=>{if(!Y||!$)return{top:0,right:0,bottom:0,left:0};const ft=Iy(Y,$,f),St=Ry(ft,$);return{top:Math.abs(St.top),right:Math.abs(St.right),bottom:Math.abs(St.bottom),left:Math.abs(St.left)}},L0=ue({}),v1=Ei([Us,gl,tc,L0],([$,Y,ft,St],st)=>{if(!$)return st(void 0);let yt=0;k.length!==1||h||yn==="bottom"||(yt=ft.y+ft.height),st(Pn($.x+Y.x,$.y+Y.y+yt,$.width,$.height))});let nc={left:0,right:0,top:0,bottom:0};const hd=ue(!1),fl=Ei([hd,js,v1,ec],([$,Y,ft,St],st)=>{if(!ft)return st({left:0,right:0,top:0,bottom:0});if(!$)return;const yt=Math.min(ft.width,ft.height),Qt=A0({width:yt,height:yt},Y);si(nc.top,4)===si(Qt.top,4)&&si(nc.bottom,4)===si(Qt.bottom,4)&&si(nc.right,4)===si(Qt.right,4)&&si(nc.left,4)===si(Qt.left,4)||(nc=Qt,st(Qt))});A(t,fl,$=>i(404,Sr=$));const yl=Ei([hd,fl],([$,Y],ft)=>{if(!$)return ft(!1);ft(Object.values(Y).some(St=>St>0))});A(t,yl,$=>i(405,uo=$));const mx=Ei([hd,Us,yl,fl],([$,Y,ft,St],st)=>{if(Y)return $&&ft?void st(Pn(Y.x+St.left,Y.y+St.top,Y.width-St.left-St.right,Y.height-St.top-St.bottom)):st({...Y})}),Ma=Ei([v1,yl,fl],([$,Y,ft],St)=>$?Y?void St(Pn($.x+ft.left,$.y+ft.top,$.width-ft.left-ft.right,$.height-ft.top-ft.bottom)):St($):St(void 0));A(t,Ma,$=>i(50,Me=$));const $x=Ei([Gs,Hs,ml],([$,Y,ft],St)=>{if(!$||!Y)return St(void 0);const st=Or(Y);St(mr(st,ft))}),w1=Ei([$x],([$],Y)=>{if(!$)return Y(void 0);const ft=er($);Y(Fc(ft))});A(t,w1,$=>i(408,ce=$));const qa=Ei([Ma,pa,w1,ud],([$,Y,ft,St],st)=>{if(!$||!Y||!(!Mn&&!Er))return;const{width:yt,height:Qt}=ft||Y,Je=Math.min($.width/yt,$.height/Qt);st(St?Je:Math.min(1,Je))});A(t,qa,$=>i(407,B=$)),po("imageStaticVisualCorners",Ei([Gs,Hs,ml,Ma,Us,qa],([$,Y,ft,St,st,yt],Qt)=>{if(!($&&St&&st&&Y))return Qt(void 0);const Je=Or(Y),Qe=Fc(Tr(Je,yt)),He=eu(St,Qe);Qe.x=He.x,Qe.y=He.y,Qt(mr(Qe,ft))}));const xl=ue(void 0);A(t,xl,$=>i(410,yi=$));const z0=Ei([pa,Ma],([$,Y])=>{if(Y&&$)return Math.min(Y.width/$.width,Y.height/$.height)}),S1=Ei([pa,Zo],([$,Y])=>$&&Y?Math.min($.width/Y.width,$.height/Y.height):1);A(t,S1,$=>i(101,Oa=$));const rc=Ei([xl,S1],([$,Y])=>$&&Y?Y*$:1);A(t,rc,$=>i(485,vi=$));const bl=ue(rn());A(t,bl,$=>i(409,Ue=$));const F0=ue({scalar:vi,translation:Ue}),D0=()=>{F0.set({scalar:void 0,translation:rn()})},md=Rl(void 0,$=>{const Y=pi(void 0,{precision:1e-4}),ft=Tc()===1?yt=>Bo(yt,Math.round):Ki,St=()=>{if(!Kn)return;const yt=Yi||!vr;if(eo){const Je=Si(Kn);return Jo(Je,ge),Jo(Je,Me),Y.set(Je,{hard:yt})}const Qt=F$(Kn,Pt,lh*Lt);Qt.width<0&&(Qt.width=0,Qt.x=Kn.x),Qt.height<0&&(Qt.height=0,Qt.y=Kn.y),Jo(Qt,Me),Jo(Qt,Ue),Tr(Qt,vi),!yt&&ft(Qt),Y.set(Qt,{hard:yt})},st=[Ma.subscribe(St),Zo.subscribe(St),rc.subscribe(St),bl.subscribe(St),js.subscribe(St),Y.subscribe($)];return()=>st.forEach(yt=>yt())});A(t,md,$=>i(58,zn=$));const k1=ue(1);A(t,k1,$=>i(478,cr=$));const C1=()=>{if(!Hn||!Me)return;let $=ks(Si(Hn),B||1);const Y=eu(Me,ks(Si(ce),B));Jo($,Y);const ft=De.width/$.width,St=De.height/$.height,st=Math.min(1,ft,St);k1.set(st),Tr($,st),((yt,Qt)=>{const[Je,Qe,He,hn]=al(yt);Je<Qt.y&&(yt.y=Math.max(Qt.y,yt.y)),Qe>Qt.width&&(yt.x=Qt.width-yt.width),He>Qt.height&&(yt.y=Qt.height-yt.height),hn<Qt.x&&(yt.x=Math.max(Qt.x,yt.x))})($,{...De,x:0,y:0}),Zo.set($)},B0=Ei([Ma,qa,pa,Hs],([$,Y,ft,St],st)=>{$&&(ft||St)&&st(O0($,Y||1,ft||St))});A(t,B0,$=>i(100,ul=$));const O0=($,Y,ft)=>ft.width<=$.width&&ft.height<=$.height?eu($,ks(Si(ft),Y)):Yr($,ir(ft));let T1,W0;const M1=$=>{if(h&&T1&&Qo(T1,$)&&W0===B)return;if(eo)return C1();T1=$,W0=B;const Y=O0($,B,Hn||Ce);Zo.set(Y)};let _0=!1;const gx=qa.subscribe($=>{!_0&&$!==void 0&&Hn&&(M1(Me),_0=!0)}),fx=Ma.subscribe($=>{$&&B!==void 0&&Hn&&M1($)}),yx=Gs.subscribe($=>{!$&&Me&&M1(Me)});let P1;const xx=pd.subscribe($=>{if(!$)return P1=void 0,void wt(ic,Mn=void 0,Mn);P1=Ar;const Y=Si(Hn);ic.set(Y)}),bx=Zo.subscribe($=>{if(!$||!to)return;const Y=(ft=Si($),St=to,ft.x-=St.x,ft.y-=St.y,ft.width-=St.width,ft.height-=St.height,ft);var ft,St;((yt,Qt)=>{yt.x/=Qt,yt.y/=Qt,yt.width/=Qt,yt.height/=Qt})(Y,P1);const st=((yt,Qt)=>(yt.x+=Qt.x,yt.y+=Qt.y,yt.width+=Qt.width,yt.height+=Qt.height,yt))(Si(Mn),Y);pa.set(st)}),vx=pa.subscribe($=>{if(!$||!Kn)return;if(eo)return void(to||C1());if(Yi||to||Er)return;const Y=ir(Kn),ft=ir($);if(si(Y,6)===si(ft,6))return;const{width:St,height:st}=Hn,yt=Math.min(Me.width/St,Me.height/st),Qt=Un($.width*yt,$.height*yt),Je=.5*(Kn.width-Qt.width),Qe=.5*(Kn.height-Qt.height),He=Pn(Math.max(0,Math.min(Me.width-Qt.width,Kn.x+Je)),Math.max(0,Math.min(Me.height-Qt.height,Kn.y+Qe)),Qt.width,Qt.height);Zo.set(He)}),V0=Ei([qa,pa,Zo,Gs],([$,Y,ft,St],st)=>{if(!$||!Y||!ft)return;if(St)return st(cr);const yt=ft.width/Y.width,Qt=ft.height/Y.height;st(Math.max(yt,Qt)/$)}),$d=Ei([qa,V0],([$,Y],ft)=>{Y&&ft($*Y)});A(t,$d,$=>i(484,Ar=$));let vl={left:0,right:0,top:0,bottom:0};const N0=Ei([js,Zo],([$,Y],ft)=>{if(!Y)return ft(vl);const St=A0(Y,$);si(vl.top,4)===si(St.top,4)&&si(vl.bottom,4)===si(St.bottom,4)&&si(vl.right,4)===si(St.right,4)&&si(vl.left,4)===si(St.left,4)||(vl=St,ft(St))}),wx=Ei([N0],([$],Y)=>{Y(Object.values($).some(ft=>ft>0))}),R1=pi(.075,{stiffness:.03,damping:.4,precision:.001}),Sx=Ei([Ql,Jl,R1,md,rc,js,wx,N0,yl],([$,Y,ft,St,st,yt,Qt,Je,Qe],He)=>{if(!St||h)return He([]);let{x:hn,y:kn,width:Cr,height:nn}=St;hn+=.5,kn+=.5,Cr-=.5,nn-=.5;const Qn=[];if(yt){if(Qt){let{left:qi,right:Yo,top:Ys,bottom:Sl}=Je;qi*=st,Yo*=st,Ys*=st,Sl*=st;const ip=Bp(Y)?[1,1,1,.125]:[0,0,0,.075];Qn.push({x:hn-qi-.5,y:kn-Ys-.5,width:Cr+qi+Yo+1,height:nn+Ys+Sl+1,strokeWidth:1,strokeColor:ip,opacity:Qe?1:.5})}const Lo=Bp($);yt&&yt.frameColor&&Bp(yt.frameColor)||Lo||(Qn.push({x:hn-1,y:kn-1,width:Cr+2,height:nn+2,strokeWidth:2,strokeColor:[0,0,0,.1],opacity:ft}),Qn.push({x:hn+1,y:kn+1,width:Cr-2,height:nn-2,strokeWidth:2,strokeColor:[0,0,0,.1],opacity:ft}))}He([...Qn,{x:hn,y:kn,width:Cr,height:nn,strokeWidth:1,strokeColor:$,opacity:ft}])}),oc=ue([]);A(t,oc,$=>i(398,_i=$));const H0=Ei([Sx,oc],([$,Y],ft)=>{ft([...$,...Y])});A(t,H0,$=>i(94,Sa=$));const I1=pi(0,{precision:.001});A(t,I1,$=>i(400,lr=$));const E1=pi();A(t,E1,$=>i(403,Qr=$));const A1=pi();A(t,A1,$=>i(402,co=$));const L1=pi();A(t,L1,$=>i(401,Vr=$));const z1=pi();A(t,z1,$=>i(399,Vi=$));const ac=ue(!1);A(t,ac,$=>i(385,dr=$));const sc=ue();let hs;A(t,sc,$=>i(388,so=$));const F1=Ei([ac,sc],([$,Y],ft)=>{if(!$||!Y)return void ft(void 0);if(hs&&(hs.cancel(),i(291,hs=void 0)),Uc(Y))return ft(Zf(Y));const St=Xo.length?0:gn?250:0;i(291,hs={cancel:me}),b0(Y,hs,St).then(ft).catch(st=>{wt(Jc,en.error=st,en)}).finally(()=>{i(291,hs=void 0)})});jr(),jr=Br(F1,$=>i(367,re=$));let{imagePreviewCurrent:lc}=e;const D1=ue({});A(t,D1,$=>i(390,lo=$));const gd=ue([]);A(t,gd,$=>i(86,Fi=$));const fd=Ei([Ma,$l,Hs,I0,Zo,$d,ml,td,ed,rc,bl,R0],([$,Y,ft,St,st,yt,Qt,Je,Qe,He,hn,kn],Cr)=>{if(!$||!st)return;const nn=Pv($,Y,ft,St,st,He,hn,yt,Qt,Je,Qe);!kn&&y(nn),Cr(nn)});A(t,fd,$=>i(391,la=$));const j0=Ei([$0,g0,f0,y0,x0],([$,Y,ft,St,st],yt)=>{const Qt=$&&Object.keys($).map(Je=>$[Je]).filter(Boolean);yt({gamma:ft||void 0,vignette:St||void 0,noise:st||void 0,convolutionMatrix:Y||void 0,colorMatrix:Qt&&Qt.length&&Dh(Qt)})});let yd,B1;const U0=(()=>{if(!ia())return!1;const $=navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/i)||[],[,Y,ft]=$.map(St=>parseInt(St,10)||0);return Y>13||Y===13&&ft>=4})(),cc=ue({});A(t,cc,$=>i(379,$n=$)),po("env",cc);const G0=Tc(),O1=Rl(G0,$=>{const Y=()=>$(Tc()),ft=matchMedia(`(resolution: ${G0}dppx)`);return ft.addListener(Y),()=>ft.removeListener(Y)});A(t,O1,$=>i(57,pr=$));const Pa=(($,Y)=>{const{sub:ft,pub:St}=ns(),st=[],yt=ue(0),Qt=[],Je=()=>Qt.forEach(He=>He({index:fa(yt),length:st.length})),Qe={get index(){return fa(yt)},set index(He){He=Number.isInteger(He)?He:0,He=tn(He,0,st.length-1),yt.set(He),Y(st[Qe.index]),Je()},get state(){return st[st.length-1]},length:()=>st.length,undo(){const He=Qe.index--;return St("undo",He),He},redo(){const He=Qe.index++;return St("redo",Qe.index),He},revert(){st.length=1,Qe.index=0,St("revert")},write(He){He&&Y({...$(),...He});const hn=$(),kn=st[st.length-1];JSON.stringify(hn)!==JSON.stringify(kn)&&(st.length=Qe.index+1,st.push(hn),yt.set(st.length-1),Je(),St("writehistory"))},set(He={}){st.length=0,Qe.index=0;const hn=Array.isArray(He)?He:[He];st.push(...hn),Qe.index=st.length-1},get:()=>[...st],subscribe:He=>(Qt.push(He),He({index:Qe.index,length:st.length}),()=>Qt.splice(Qt.indexOf(He),1)),on:ft};return Qe})(()=>wr,$=>{wt(nd,wr=$,wr),gl.set(Wn)});Ur(),Ur=Br(Pa,$=>i(397,ur=$));const Z0=()=>{const $={x:0,y:0,...Ce},Y=Bo(Yr($,wr.cropAspectRatio),Math.round),ft=qt({...wr,rotation:0,crop:Y},wr),St=[ft];JSON.stringify(ft)!==JSON.stringify(wr)&&St.push({...wr}),Pa.set(St)},kx=Jc.subscribe($=>{$&&$.complete&&Z0()}),Cx=()=>Nt().then($=>$&&Pa.revert()),ms=ue(!1);A(t,ms,$=>i(380,Wi=$));const Tx=()=>{wt(ms,Wi=!0,Wi),Vt().then($=>{if(!$)return void wt(ms,Wi=!1,Wi);let Y;Y=uc.subscribe(ft=>{ft===1&&(Y&&Y(),hr("processImage"))})})},Mx=e1.subscribe($=>{if(!$)return void wt(ms,Wi=!1,Wi);wt(ms,Wi=!0,Wi);const{complete:Y,abort:ft}=$;(Y||ft)&&wt(ms,Wi=!1,Wi)}),Xo=K5();A(t,Xo,$=>i(55,No=$));const Px=Ei([Xo],([$],Y)=>{if(!$.length)return Y();const{origin:ft,translation:St,rotation:st,scale:yt}=$[0];Y({origin:ft,translation:St,rotation:st,scale:yt})}),xd=ue();A(t,xd,$=>i(394,_r=$));let bd,vd=[];const X0=ue(),W1=ue(),Rx=Ei([xl,W1,qa,z0],([$,Y,ft,St])=>$||(Y||ft<1?St:1)),Y0={..._a,imageFile:Ku,imageSize:Hs,mediaDuration:Ju,mediaMinDuration:nx,mediaMaxDuration:t1,mediaTrim:Qu,imageBackgroundColor:id,imageBackgroundImage:m0,imageCropAspectRatio:Qc,imageCropMinSize:rx,imageCropMaxSize:ox,imageCropLimitToImage:i1,imageCropRect:pa,imageCropRectOrigin:sx,imageCropRectSnapshot:ic,imageCropRectAspectRatio:lx,imageCropRange:ax,imageRotation:ml,imageRotationRange:cx,imageFlipX:td,imageFlipY:ed,imageOutputSize:dx,imageColorMatrix:$0,imageConvolutionMatrix:g0,imageGamma:f0,imageVignette:y0,imageNoise:x0,imageManipulation:o1,imageDecoration:n1,imageAnnotation:r1,imageRedaction:a1,imageFrame:js,imagePreview:F1,imagePreviewSource:sc,imageTransforms:fd,imagePreviewModifiers:D1,history:Pa,animation:cd,pixelRatio:O1,elasticityMultiplier:Lt,scrollElasticity:ch,rangeInputElasticity:5,redrawTrigger:Ns,pointerAccuracy:sd,pointerHoverable:ld,env:cc,rootRect:$l,stageRect:Ma,stageRectBase:v1,stageRecenter:L0,stageScalar:qa,stagePadding:fl,stagePadded:yl,presentationScalar:$d,imagePreviewUpscale:W1,utilRect:Us,utilRectPadded:mx,allowPlayPause:_u,allowPan:l1,allowZoom:c1,allowZoomControls:d1,enableZoomInput:u1,enablePanInput:rd,enablePanInputStatus:h1,imageSelectionMultiTouching:X0,rootBackgroundColor:Jl,rootForegroundColor:ad,rootLineColor:Ql,rootColorSecondary:P0,imageOutlineOpacity:R1,utilTools:xd,imageSelectionPan:bl,imageSelectionZoom:xl,imageSelectionZoomCurrent:Rx,imageSelectionStageFitScalar:z0,imageSelectionStoredState:F0,imageOverlayMarkup:oc,interfaceImages:gd,isInteracting:ec,isTransformingImage:R0,isInteractingFraction:f1,imageCropRectIntent:x1,imageCropRectPresentation:I0,imageSelectionRect:Zo,imageSelectionRectIntent:b1,imageSelectionRectPresentation:md,imageSelectionRectSnapshot:pd,imageScalar:V0,imageTransformsInterpolated:Px,imageEffects:j0};delete Y0.image;const Ix="util-"+ea();let _1=[];const q0=$=>N.find(([Y])=>$===Y);let dc=[];const V1=$=>{i(62,dc=dc.concat($))},N1=$=>{i(62,dc=dc.filter(Y=>Y!==$))},H1=($,Y)=>{i(297,gt[$]=Y,gt)};let K0=ia();const J0=($,Y,ft)=>{let St=ke.getPropertyValue($);St=ft?ft(St):/^[0-9]+$/.test(St)?parseFloat(St):void 0,Y.set(St,{hard:!gn})},Zs=($,Y,ft=!1)=>{const St=(st=>{const yt=ke.getPropertyValue(st);return L2(yt)})($);St&&St[3]!==0&&(ft||(St.length=3),Y.set(St,{hard:!gn}))},j1=ue();A(t,j1,$=>i(87,un=$));const U1=ue();A(t,U1,$=>i(88,Sn=$));const G1=ue();A(t,G1,$=>i(89,fn=$));const wd=pi(0,{damping:.9});A(t,wd,$=>i(90,Di=$));const Q0=()=>{Zs("color",ad),Zs(go?"--color-background":"background-color",Jl),Zs("outline-color",Ql),Zs("--color-primary",m1),Zs("--color-secondary",P0),Zs("--grid-color-even",U1,!0),Zs("--grid-color-odd",G1,!0),J0("--grid-size",j1),J0("--editor-inset-top",g1,$=>parseInt($,10))},tm=Ei([fd,j0,id,ux],([$,Y,ft,St])=>$&&{...$,...Y,backgroundColor:ft,backgroundImage:St});A(t,tm,$=>i(389,br=$));const Ex=()=>{const $=Xo.length?void 0:{resize:1.05},Y=((ft,St,st={})=>{const{resize:yt=1,opacity:Qt=0}=st,Je={opacity:[pi(Qt,{...il,stiffness:.1}),Ki],resize:[pi(yt,{...il,stiffness:.1}),Ki],translation:[pi(void 0,il),Ki],rotation:[pi(void 0,Yd),Ki],origin:[pi(void 0,il),Ki],scale:[pi(void 0,Yd),Ki],gamma:[pi(void 0,Yd),nn=>nn||1],vignette:[pi(void 0,Yd),nn=>nn||0],colorMatrix:[pi([...Ig],il),nn=>nn||[...Ig]],convolutionMatrix:[ue(void 0),nn=>nn&&nn.clarity||void 0],backgroundColor:[pi(void 0,il),(nn,Qn,Lo)=>{if(Array.isArray(nn)){if(Array.isArray(Qn)){const qi=[...nn];Qn[3]===0?(qi[3]=0,Lo(qi)):qi[3]===0&&((nn=[...Qn])[3]=0)}return nn}}],backgroundImage:[ue(void 0),Ki]},Qe=Object.entries(Je).map(([nn,Qn])=>[nn,Qn[0]]),He=Qe.map(([,nn])=>nn),hn=Object.entries(Je).reduce((nn,[Qn,Lo])=>{const[qi,Yo]=Lo;return nn[Qn]=(Ys,Sl)=>qi.set(Yo(Ys,kn[Qn],ip=>{qi.set(ip,{hard:!0})}),Sl),nn},{});let kn;const Cr=Ei(He,nn=>(kn=nn.reduce((Qn,Lo,qi)=>(Qn[Qe[qi][0]]=Lo,Qn),{}),kn.data=ft,kn.size=St,kn.scale*=nn[1],kn));return Cr.get=()=>kn,Cr.set=(nn,Qn)=>{const Lo={hard:!Qn};Object.entries(nn).forEach(([qi,Yo])=>{hn[qi]&&hn[qi](Yo,Lo)})},Cr})(re,Ce,$);Xo.unshift(Y),em(br)},em=$=>{Xo.forEach((Y,ft)=>{const St=ft===0?1:0;Y.set({...$,opacity:St,resize:1},vr)})};let Sd;const uc=Gh(void 0,{duration:500});let Z1;A(t,uc,$=>i(54,$o=$));const kd=ue(!1);let Ka;A(t,kd,$=>i(384,ko=$));const Cd=pi(void 0,{stiffness:.1,damping:.7,precision:.25});A(t,Cd,$=>i(82,Hi=$));const Td=pi(0,{stiffness:.1,precision:.05});A(t,Td,$=>i(83,ei=$));const pc=pi(0,{stiffness:.02,damping:.5,precision:.25});A(t,pc,$=>i(382,Vo=$));const X1=pi(void 0,{stiffness:.02,damping:.5,precision:.25});A(t,X1,$=>i(383,Kr=$));const Md=pi(void 0,{stiffness:.02,damping:.5,precision:.25});let Pd;A(t,Md,$=>i(381,On=$));const Ax=()=>{hr("abortLoadImage")},Lx=()=>{hr("abortProcessImage"),wt(ms,Wi=!1,Wi)},im=$=>{$.target&&$.target.dataset.touchScroll==="true"||$.preventDefault()},zx=U0?$=>{const Y=$.touches?$.touches[0]:$;Y.pageX>20&&Y.pageX<window.innerWidth-20||im($)}:me,Xs=ue([]);A(t,Xs,$=>i(474,xr=$)),po("keysPressed",Xs);const Y1=$=>{!$||Ol($)&&!(Y=>/^image/.test(Y.type)&&!/svg/.test(Y.type))($)||!Ol($)&&!/^http/.test($)||hr("loadImage",$)},Fx=$=>{$&&Y1($)};let wl,hc,q1=[];const nm=ue();po("rootPortal",nm),po("rootRect",$l);const rm=()=>({foregroundColor:[...bn],lineColor:[...En],utilVisibility:{...gt},isInteracting:Yi,isInteractingFraction:Ti,rootRect:Si(fe),stageRect:Si(Me),manipulationShapesDirty:zd,annotationShapesDirty:Id,decorationShapesDirty:Ad,frameShapesDirty:Ld}),om=($,Y,ft)=>Zn($,Un(Math.round(Y.width/ft),Math.round(Y.height/ft))),am=($,Y,ft)=>{var St;return $._translate=ot((St=Y).x,St.y),$._scale=ft,$},Rd=$=>{const Y=[];return $.forEach(ft=>Y.push(Dx(ft))),Y.filter(Boolean)},Dx=$=>tr($)?($.points=[ot($.x1,$.y1),ot($.x2,$.y2)],$):(!(Y=>Xn(Y)&&!Y.text.length)($)||$.backgroundColor&&$.backgroundColor[3]!==0||($u($)&&($.width=5,$.height=$.lineHeight),$.strokeWidth=1,$.strokeColor=[1,1,1,.5],$.backgroundColor=[0,0,0,.1]),$);let sm,K1=[],J1=[],Q1=[],tp=[],ep=[],lm={};const cm=($,Y,ft,St,st,yt,Qt)=>{const{manipulationShapesDirty:Je,annotationShapesDirty:Qe,decorationShapesDirty:He,frameShapesDirty:hn,selectionRect:kn,scale:Cr}=$,nn=sm!==Cr,Qn=nn||!Qo(lm,kn);Qn&&(sm=Cr,lm=kn),Je&&(Q1=Y.filter(Wd).map(jn).map(qi=>Zn(qi,Ce))),(Qe||ft!==je)&&(K1=ft.filter(Wd).map(jn).sort((qi,Yo)=>qi.alwaysOnTop?1:Yo.alwaysOnTop?-1:0).map(qi=>Zn(qi,Ce))),(nn||Ed||Qe||ft!==je)&&(J1=Rd(K1.map(qi=>f(qi,{flipX:Ke,flipY:xe,rotation:Pe,scale:Cr,context:Or(Ce)})).flat())),(He||St!==ti||Qn)&&(tp=Rd(St.filter(Wd).map(jn).sort((qi,Yo)=>qi.alwaysOnTop?1:Yo.alwaysOnTop?-1:0).map(qi=>om(qi,kn,Cr)).map(qi=>f(qi,{context:kn})).flat().map(qi=>am(qi,kn,Cr)))),(hn||yt!==Bi||Qn)&&(ep=yt?Rd([yt].map(jn).map(qi=>om(qi,kn,Cr)).map(f).flat().map(qi=>am(qi,kn,Cr))):[]);let Lo=Rd(st.filter(Wd));return typeof window<"u"&&(qi=>{if(qi&&qi._u5rlc3k)return;const[Yo]=[[85,110,108,105,99,101,110,115,101,100,32,80,105,110,116,117,114,97,32,105,110,115,116,97,110,99,101]].map(Ys=>Ys.map(Sl=>String.fromCharCode(Sl)).join(""));Lo=[...Lo,{x:kn.x+.5*kn.width-82,y:kn.y+kn.height-16-12,width:164,height:16,text:Yo,fontWeight:900,fontSize:12,color:[1,1,1,.25]}]})(window),{manipulationShapesDirty:Je,manipulationShapes:Q1,annotationShapesDirty:Qe,annotationShapes:J1,decorationShapesDirty:He,decorationShapes:tp,frameShapesDirty:hn,frameShapes:ep,interfaceShapes:Lo,selectionShapes:Qt.map(jn).map(qi=>Zn(qi,Ce))}};let Id=!0,Ed=!0,Ad=!0,Ld=!0,zd=!0;return _o(()=>{Vs(),re&&_e(re.src)&&/^blob:/.test(re.src)&&URL.revokeObjectURL(re.src),px(),fx(),gx(),yx(),xx(),bx(),vx(),kx(),Mx(),sd.destroy(),ld.destroy(),qu.destroy(),Xo.clear(),K1.length=0,J1.length=0,Q1.length=0,tp.length=0,ep.length=0;try{i(235,lc=void 0),i(292,Sd=void 0)}catch{}}),t.$$set=$=>{"class"in $&&i(236,pn=$.class),"layout"in $&&i(237,Ro=$.layout),"stores"in $&&i(238,_a=$.stores),"locale"in $&&i(3,Ri=$.locale),"id"in $&&i(4,Bs=$.id),"util"in $&&i(239,ls=$.util),"utils"in $&&i(240,jl=$.utils),"animations"in $&&i(241,ka=$.animations),"disabled"in $&&i(242,cs=$.disabled),"status"in $&&i(234,Zr=$.status),"previewUpscale"in $&&i(243,Os=$.previewUpscale),"previewPad"in $&&i(244,Va=$.previewPad),"previewMaskOpacity"in $&&i(5,x=$.previewMaskOpacity),"previewImageDataMaxSize"in $&&i(245,j=$.previewImageDataMaxSize),"previewImageTextPixelRatio"in $&&i(6,L=$.previewImageTextPixelRatio),"markupMaskOpacity"in $&&i(7,rt=$.markupMaskOpacity),"zoomMaskOpacity"in $&&i(246,ct=$.zoomMaskOpacity),"elasticityMultiplier"in $&&i(8,Lt=$.elasticityMultiplier),"willRevert"in $&&i(247,Nt=$.willRevert),"willProcessImage"in $&&i(248,Vt=$.willProcessImage),"willRenderCanvas"in $&&i(9,Bt=$.willRenderCanvas),"willRenderToolbar"in $&&i(249,Ft=$.willRenderToolbar),"willRenderUtilTabs"in $&&i(250,_t=$.willRenderUtilTabs),"willSetHistoryInitialState"in $&&i(251,qt=$.willSetHistoryInitialState),"enableButtonExport"in $&&i(252,ri=$.enableButtonExport),"enableButtonRevert"in $&&i(253,de=$.enableButtonRevert),"enableNavigateHistory"in $&&i(254,he=$.enableNavigateHistory),"enableToolbar"in $&&i(10,we=$.enableToolbar),"enableUtils"in $&&i(255,Se=$.enableUtils),"enableButtonClose"in $&&i(256,Ze=$.enableButtonClose),"enableDropImage"in $&&i(257,ii=$.enableDropImage),"enablePasteImage"in $&&i(258,xi=$.enablePasteImage),"enableBrowseImage"in $&&i(259,ui=$.enableBrowseImage),"enableTransparencyGrid"in $&&i(11,Ii=$.enableTransparencyGrid),"layoutDirectionPreference"in $&&i(260,ln=$.layoutDirectionPreference),"layoutHorizontalUtilsPreference"in $&&i(261,ji=$.layoutHorizontalUtilsPreference),"layoutVerticalUtilsPreference"in $&&i(262,Li=$.layoutVerticalUtilsPreference),"layoutVerticalToolbarPreference"in $&&i(263,yn=$.layoutVerticalToolbarPreference),"layoutVerticalControlGroupsPreference"in $&&i(264,Qi=$.layoutVerticalControlGroupsPreference),"layoutVerticalControlTabsPreference"in $&&i(265,Gn=$.layoutVerticalControlTabsPreference),"textDirection"in $&&i(12,an=$.textDirection),"markupEditorZoomLevel"in $&&i(266,kr=$.markupEditorZoomLevel),"markupEditorZoomLevels"in $&&i(13,Xr=$.markupEditorZoomLevels),"markupEditorZoomAdjustStep"in $&&i(14,io=$.markupEditorZoomAdjustStep),"markupEditorZoomAdjustFactor"in $&&i(15,Na=$.markupEditorZoomAdjustFactor),"markupEditorZoomAdjustWheelFactor"in $&&i(16,Ha=$.markupEditorZoomAdjustWheelFactor),"markupEditorInteractionMode"in $&&i(267,ds=$.markupEditorInteractionMode),"muteAudio"in $&&i(268,ja=$.muteAudio),"willSetMediaInitialTimeOffset"in $&&i(269,ua=$.willSetMediaInitialTimeOffset),"enablePan"in $&&i(17,Go=$.enablePan),"enableZoom"in $&&i(18,Io=$.enableZoom),"enableZoomControls"in $&&i(270,Ua=$.enableZoomControls),"enableZoomInput"in $&&i(19,Ca=$.enableZoomInput),"enablePanInput"in $&&i(271,us=$.enablePanInput),"enableCanvasAlpha"in $&&i(20,go=$.enableCanvasAlpha),"enablePanLimit"in $&&i(21,Ga=$.enablePanLimit),"panLimitGutterScalar"in $&&i(22,ps=$.panLimitGutterScalar),"zoomPresetOptions"in $&&i(23,Ws=$.zoomPresetOptions),"zoomAdjustStep"in $&&i(24,Ul=$.zoomAdjustStep),"zoomAdjustFactor"in $&&i(25,Ta=$.zoomAdjustFactor),"zoomAdjustWheelFactor"in $&&i(26,Za=$.zoomAdjustWheelFactor),"zoomLevel"in $&&i(0,Fn=$.zoomLevel),"fixScrollDirection"in $&&i(272,Eo=$.fixScrollDirection),"imagePreviewSrc"in $&&i(275,Ou=$.imagePreviewSrc),"imageOrienter"in $&&i(276,Zc=$.imageOrienter),"pluginComponents"in $&&i(277,pl=$.pluginComponents),"pluginOptions"in $&&i(27,_s=$.pluginOptions),"root"in $&&i(2,Jn=$.root),"imageSourceToImageData"in $&&i(28,Yu=$.imageSourceToImageData),"imagePreviewCurrent"in $&&i(235,lc=$.imagePreviewCurrent)},t.$$.update=()=>{if(16777216&t.$$.dirty[8]&&o0.set(Eo),8&t.$$.dirty[0]&&i(349,n=!!Ri),1&t.$$.dirty[0]|262144&t.$$.dirty[8]&&i(0,Fn=Fn===null?kr:Fn),2&t.$$.dirty[0]|536870912&t.$$.dirty[8]){let st=!1;pl.forEach(([yt])=>{Ao[yt]||(i(1,Ao[yt]={},Ao),st=!0)}),st&&i(289,ql=[...pl])}var $,Y,ft,St;if(8388608&t.$$.dirty[7]|1024&t.$$.dirty[9]|256&t.$$.dirty[11]&&i(347,k=n&&ql.length?jl||ql.map(([st])=>st):[]),134217728&t.$$.dirty[0]|1024&t.$$.dirty[9]|64&t.$$.dirty[11]|8388608&t.$$.dirty[12]&&i(348,N=((st,yt,Qt,Je)=>{const Qe=yt.filter(([He])=>st.includes(He)).filter(([He,{isSupported:hn}])=>hn({...Je,...Qt[He]})).map(([He,hn])=>[He,hn.Component]);return os(Qe,_1,(He,hn)=>He[0]===hn[0]&&He[1]===hn[1])?_1:(_1=Qe,Qe)})(k,ql,_s,{src:Jr})),128&t.$$.dirty[11]&&i(301,it=N.length),8&t.$$.dirty[0]|4194304&t.$$.dirty[9]|64&t.$$.dirty[11]&&i(346,ut=it&&k.map(st=>{const yt=q0(st);if(yt)return{id:st,view:yt[1],tabIcon:Ri[st+"Icon"],tabLabel:Ri[st+"Label"]}}).filter(Boolean)||[]),32&t.$$.dirty[11]&&i(366,r=!!ut.find(st=>st.id==="trim")),100663296&t.$$.dirty[11]|65536&t.$$.dirty[13]&&i(300,o=!!(Te&&re&&r)),4194304&t.$$.dirty[7]|4194304&t.$$.dirty[9]&&i(43,at=it&&ls&&typeof ls=="string"&&q0(ls)?ls:it>0?N[0][0]:void 0),4096&t.$$.dirty[1]|2097152&t.$$.dirty[9]&&o&&at&&Vs(),2097152&t.$$.dirty[9]|67108864&t.$$.dirty[11]&&(o?(re.addEventListener("play",Xc),re.addEventListener("pause",Xc)):re&&re.nodeName==="video"&&(re.removeEventListener("play",Xc),re.removeEventListener("pause",Xc))),2097152&t.$$.dirty[9]&&o&&Xa.set(Yl()/Ya()),294912&t.$$.dirty[13]&&(st=>{if(!hl())return;const yt=Date.now();if(Vu&&yt-Vu<16)return;Vu=yt;const Qt=Te*st;if(Qt.toFixed(1)===s0)return;s0=Qt.toFixed(1);const Je=re,Qe=()=>{Je.removeEventListener("seeked",Qe),Wu()};Je.addEventListener("seeked",Qe),Cg(Je,Qt)})(gi||R),32768&t.$$.dirty[13]&&i(364,a=R&&si(R,6)),598016&t.$$.dirty[13]&&i(362,s=Nr||[[0,Math.min(Te,Oi)/Te]]),2097152&t.$$.dirty[11]&&(l=s[0][0]),2097152&t.$$.dirty[11]&&(c=s[s.length-1][1]),2097152&t.$$.dirty[11]&&i(365,d=s.map(([st,yt])=>[si(st,6),si(yt,6)])),25165824&t.$$.dirty[11]&&i(363,u=d.findIndex(([st,yt])=>a>=st&&a<=yt)),29360128&t.$$.dirty[11]&&(p=u===-1&&d.findIndex((st,yt,Qt)=>{const Je=Qt[yt-1];return Je?a<=st[0]&&a>=Je[1]:a<=st[0]})),1048576&t.$$.dirty[8]&&Xl.set(ja),67108864&t.$$.dirty[11]|131072&t.$$.dirty[13]&&(re&&We?Gu():Zu()),2097152&t.$$.dirty[9]|32768&t.$$.dirty[13]&&o&&Kc.set(Ya()*R),67108864&t.$$.dirty[11]|16384&t.$$.dirty[13]&&re&&(st=>{o&&(re.volume=Math.min(1,st))})(Hr),256&t.$$.dirty[0]&&wt(qc,za=Lt,za),1048576&t.$$.dirty[7]&&i(358,h=Ro==="overlay"),128&t.$$.dirty[8]|131072&t.$$.dirty[11]&&i(45,g=Se&&!h),134217730&t.$$.dirty[0]&&_s&&Object.entries(_s).forEach(([st,yt])=>{Object.entries(yt).forEach(([Qt,Je])=>{Ao[st]&&i(1,Ao[st][Qt]=Je,Ao)})}),256&t.$$.dirty[13]&&i(359,S=!Gi),16777216&t.$$.dirty[7]|786432&t.$$.dirty[11]&&wt(dd,gn=ka==="always"?b:ka!=="never"&&b&&S,gn),4194304&t.$$.dirty[1]|33554432&t.$$.dirty[7]&&Xu.set(cs?1:0,{hard:!gn}),268435456&t.$$.dirty[7]&&(m=j?($=j,Y=u0,Un(Math.min($.width,Y.width),Math.min($.height,Y.height))):u0),4096&t.$$.dirty[13]&&qu.update(Ho[0]),2048&t.$$.dirty[13]&&(f=wa?(st,yt)=>wa(st,{flipX:void 0,flipY:void 0,rotation:void 0,...yt,isPreview:!0}):Ki),268435456&t.$$.dirty[1]&&Array.isArray(da)&&hr("selectionchange",[...da]),4194304&t.$$.dirty[8]|1024&t.$$.dirty[13]&&p1.set(ca&&Ua),8912896&t.$$.dirty[8]&&od.set(ds==="pan"||us),1048576&t.$$.dirty[1]&&Nn&&$l.set(Pn(Nn.x,Nn.y,Nn.width,Nn.height)),131072&t.$$.dirty[11]|32769&t.$$.dirty[12]&&fe&&h&&en&&en.complete&&(()=>{const st=wi,yt=ir(fe);st&&st===yt||(Qc.set(ir(fe)),Z0())})(),64&t.$$.dirty[11]&&i(46,lt=k.length>1),32768&t.$$.dirty[1]&&(lt||gl.set(Ss())),1024&t.$$.dirty[0]|512&t.$$.dirty[13]&&(we||tc.set(Pn(0,dn,0,0))),524288&t.$$.dirty[11]|2&t.$$.dirty[12]&&i(361,w=!Yi&&b),1048576&t.$$.dirty[1]&&i(302,ie=Nn&&Nn.width>0&&Nn.height>0),8&t.$$.dirty[0]|12582912&t.$$.dirty[9]&&i(40,Fe=ie&&Ri&&!!it),512&t.$$.dirty[1]&&setTimeout(()=>i(290,y1=Fe),1),16777216&t.$$.dirty[7]|2048&t.$$.dirty[9]|1310720&t.$$.dirty[11]&&wt(cd,vr=ka==="always"?w:ka!=="never"&&w&&y1&&S,vr),67108864&t.$$.dirty[7]|131072&t.$$.dirty[11]&&ud.set(Os||h),134217728&t.$$.dirty[7]&&hd.set(Va),4&t.$$.dirty[0]|144&t.$$.dirty[13]&&Jn&&(Jn.dispatchEvent(fs("markupzoom",yi)),Jn.dispatchEvent(fs("zoom",hi(yi)?yi:B))),4&t.$$.dirty[0]|64&t.$$.dirty[13]&&Jn&&(Jn.dispatchEvent(fs("markuppan",Ue)),Jn.dispatchEvent(fs("pan",Ue))),8&t.$$.dirty[13]&&Hn&&D0(),32&t.$$.dirty[13]&&ce&&C1(),4198400&t.$$.dirty[1]&&at&&R1.set(.075,{hard:!gn}),536870912&t.$$.dirty[7]&&i(356,C=ct),6&t.$$.dirty[13]&&i(357,I=uo?-Math.max(...Object.values(Sr)):0),138936320&t.$$.dirty[1]|98304&t.$$.dirty[11]&&zn){let st=zn.x-Me.x,yt=Me.x+Me.width-(zn.x+zn.width),Qt=zn.y-Me.y,Je=Me.y+Me.height-(zn.y+zn.height),Qe=Math.min(st,Qt,yt,Je);I1.set(Qe>I?0:Math.min(C,Math.abs(Qe/64)),{hard:!gn})}if(67108864&t.$$.dirty[1]&&i(355,M=.55/pr),4718592&t.$$.dirty[1]|16384&t.$$.dirty[11]&&Me&&E1.set({x:0,y:Me.y,width:Me.x<64?0:Me.x,height:Me.height+M},{hard:!gn}),4718592&t.$$.dirty[1]|16384&t.$$.dirty[11]|1&t.$$.dirty[12]&&Me&&A1.set({x:0,y:0,width:fe.width,height:Me.y+M},{hard:!gn}),4718592&t.$$.dirty[1]|16384&t.$$.dirty[11]|1&t.$$.dirty[12]&&Me){let st=Me.x+Me.width,yt=fe.width-(Me.x+Me.width);yt<64&&(st+=yt,yt=0),L1.set({x:st,y:Me.y,width:yt,height:Me.height+M},{hard:!gn})}if(4718592&t.$$.dirty[1]|1&t.$$.dirty[12]&&Me&&z1.set({x:0,y:Me.y+Me.height,width:fe.width,height:fe.height-(Me.y+Me.height)},{hard:!gn}),33554432&t.$$.dirty[1]|268435456&t.$$.dirty[12]|1&t.$$.dirty[13]&&i(351,D=Qr&&{id:"stage-overlay",backgroundColor:Ji,opacity:lr,...Qr}),33554432&t.$$.dirty[1]|1342177280&t.$$.dirty[12]&&i(354,T=co&&{id:"stage-overlay",backgroundColor:Ji,opacity:lr,...co}),33554432&t.$$.dirty[1]|805306368&t.$$.dirty[12]&&i(353,F=Vr&&{id:"stage-overlay",backgroundColor:Ji,opacity:lr,...Vr}),33554432&t.$$.dirty[1]|402653184&t.$$.dirty[12]&&i(352,W=Vi&&{id:"stage-overlay",backgroundColor:Ji,opacity:lr,...Vi}),15360&t.$$.dirty[11]&&i(350,O=[T,F,W,D].filter(Boolean)),512&t.$$.dirty[11]|67108864&t.$$.dirty[12]&&O&&_i&&oc.update(st=>[...st.filter(yt=>yt.id!=="stage-overlay"),...O]),134217728&t.$$.dirty[8]|8388608&t.$$.dirty[12]&&sc.set(Ou||Jr||void 0),4&t.$$.dirty[0]|262144&t.$$.dirty[7]|67108864&t.$$.dirty[11]&&(i(235,lc=re),re&&Jn.dispatchEvent(fs("loadpreview",lc))),65536&t.$$.dirty[12]&&so&&(bl.set(rn()),xl.set(void 0),D0(),gd.set([])),33554432&t.$$.dirty[12]&&i(306,V=ur.index>0),33554432&t.$$.dirty[12]&&i(305,tt=ur.index<ur.length-1),8&t.$$.dirty[1]&&X0.set(bd),16777216&t.$$.dirty[12]&&W1.set(Ir),4096&t.$$.dirty[1]&&hx.set(at),262144&t.$$.dirty[9]|32&t.$$.dirty[11]&&i(297,gt=ut.reduce((st,yt)=>(st[yt.id]=gt&&gt[yt.id]||0,st),{})),4096&t.$$.dirty[1]&&i(79,G={name:Ix,selected:at}),32&t.$$.dirty[11]&&i(328,$t=ut.map(st=>({id:st.id,icon:st.tabIcon,label:st.tabLabel}))),32&t.$$.dirty[11]&&i(78,vt=ut.map(st=>st.id)),524288&t.$$.dirty[7]&&i(77,kt=mi(["PinturaRoot","PinturaRootComponent",pn])),1&t.$$.dirty[12]&&i(342,J=fe&&(fe.width>1e3?"wide":fe.width<600?"narrow":void 0)),1&t.$$.dirty[12]&&i(329,q=fe&&(fe.width<=320||fe.height<=460)),1&t.$$.dirty[12]&&i(341,Z=fe&&(fe.height>1e3?"tall":fe.height<600?"short":void 0)),4&t.$$.dirty[0]&&i(308,xt=Jn&&Jn.parentNode&&Jn.parentNode.classList.contains("PinturaModal")),1&t.$$.dirty[1]|536870912&t.$$.dirty[9]|1&t.$$.dirty[12]&&i(334,nt=xt&&fe&&yd>fe.width),2&t.$$.dirty[1]|536870912&t.$$.dirty[9]|1&t.$$.dirty[12]&&i(333,mt=xt&&fe&&B1>fe.height),25165824&t.$$.dirty[10]&&i(335,zt=nt&&mt),1048576&t.$$.dirty[0]&&i(332,oe=go),2&t.$$.dirty[11]&&i(303,Dt=J==="narrow"),4096&t.$$.dirty[8]|1&t.$$.dirty[12]&&i(343,(ft=fe,St=ln,te=fe?St==="auto"?ft.width>ft.height?"landscape":"portrait":St==="horizontal"?ft.width<500?"portrait":"landscape":St==="vertical"?ft.height<400?"landscape":"portrait":void 0:"landscape")),4&t.$$.dirty[11]&&i(76,Kt=te==="landscape"),16777216&t.$$.dirty[9]|1&t.$$.dirty[11]&&i(331,U=Dt||Z==="short"),1&t.$$.dirty[1]|1&t.$$.dirty[12]&&i(330,Tt=K0&&fe&&yd===fe.width&&!U0),4&t.$$.dirty[1]|4194304&t.$$.dirty[12]&&i(304,dt=[..._r||[],...vd].filter(Boolean)),8192&t.$$.dirty[8]&&i(340,Jt="has-navigation-preference-"+ji),16384&t.$$.dirty[8]&&i(339,se="has-navigation-preference-"+Li),32768&t.$$.dirty[8]&&i(336,ee="has-toolbar-preference-"+yn),65536&t.$$.dirty[8]&&i(338,be="has-controlgroups-preference-"+Qi),131072&t.$$.dirty[8]&&i(337,ve="has-controltabs-preference-"+Gn),1&t.$$.dirty[12]&&i(345,_=fe!==void 0&&fe.width>0&&fe.height>0),4&t.$$.dirty[0]|16&t.$$.dirty[11]&&i(344,ke=_&&Jn&&getComputedStyle(Jn)),8&t.$$.dirty[11]&&ke&&Q0(),1024&t.$$.dirty[0]|4243456&t.$$.dirty[1]|34603008&t.$$.dirty[7]|536870912&t.$$.dirty[9]|2146959360&t.$$.dirty[10]|7&t.$$.dirty[11]|3145856&t.$$.dirty[12]&&cc.set({...$n,layoutMode:Ro,orientation:te,horizontalSpace:J,verticalSpace:Z,navigationHorizontalPreference:Jt,navigationVerticalPreference:se,controlGroupsVerticalPreference:be,controlTabsVerticalpreference:ve,toolbarVerticalPreference:ee,isModal:xt,isDisabled:cs,isCentered:zt,isCenteredHorizontally:nt,isCenteredVertically:mt,isAnimated:gn,isTransparent:oe,pointerAccuracy:To,pointerHoverable:Co,isCompact:U,hasSwipeNavigation:Tt,hasLimitedSpace:q,hasToolbar:we,hasNavigation:lt&&g,isIOS:K0,browserVersion:Uh()?"chrome-"+(navigator.userAgent.match(/Chrome\/([0-9]+)/)||[])[1]:void 0}),128&t.$$.dirty[12]&&i(75,fi=Object.entries($n).map(([st,yt])=>/^is|has/.test(st)?yt?F2(st):void 0:yt).filter(Boolean).join(" ")),4096&t.$$.dirty[1]&&at&&xd.set([]),4096&t.$$.dirty[1]|4&t.$$.dirty[8]|262144&t.$$.dirty[10]|128&t.$$.dirty[12]&&i(44,ye=_t($t.map(st=>({...st,selected:at===st.id})),{...$n},()=>Ns.set({}))),8192&t.$$.dirty[1]&&i(74,Ot=!!ye.find(st=>Array.isArray(st))),786432&t.$$.dirty[12]&&i(73,ze=la&&Object.entries(lo).filter(([,st])=>st!=null).reduce((st,[,yt])=>st={...st,...yt},{})),32768&t.$$.dirty[12]&&i(325,bt=en&&en.task==="any-to-file"),32768&t.$$.dirty[10]&&bt&&Xo&&Xo.clear(),131072&t.$$.dirty[12]&&i(327,Re=!!br&&!!br.translation),8192&t.$$.dirty[9]|131072&t.$$.dirty[10]|67108864&t.$$.dirty[11]&&Re&&re&&re!==Sd&&(i(292,Sd=re),Ex()),131072&t.$$.dirty[10]|131072&t.$$.dirty[12]&&Re&&em(br),16777216&t.$$.dirty[1]&&No&&No.length>1){let st=[];Xo.forEach((yt,Qt)=>{Qt!==0&&yt.get().opacity<=0&&st.push(yt)}),st.forEach(yt=>Xo.remove(yt))}if(8&t.$$.dirty[0]|65536&t.$$.dirty[10]&&i(39,di=Ri&&Oe.length&&Ri.labelSupportError(Oe)),32768&t.$$.dirty[12]&&i(317,le=en&&!!en.error),32768&t.$$.dirty[12]&&i(42,Xe=!en||!en.complete&&en.task===void 0),32768&t.$$.dirty[12]&&i(318,Ve=en&&(en.taskLengthComputable?en.taskProgress:1/0)),32768&t.$$.dirty[10]&&bt&&wt(ac,dr=!1,dr),4194304&t.$$.dirty[1]|16384&t.$$.dirty[9]|32768&t.$$.dirty[12]&&en&&en.complete){const st=gn?250:0;clearTimeout(Z1),i(293,Z1=setTimeout(()=>{wt(ac,dr=!0,dr)},st))}if(2048&t.$$.dirty[1]|128&t.$$.dirty[10]|40960&t.$$.dirty[12]&&i(322,At=en&&!le&&!Xe&&!dr),4096&t.$$.dirty[9]|67108864&t.$$.dirty[11]|65536&t.$$.dirty[12]&&i(321,Ge=!(!so||re&&!hs)),4194304&t.$$.dirty[1]|8192&t.$$.dirty[12]&&(dr?setTimeout(()=>wd.set(1,{hard:!gn}),gn?500:0):wd.set(0,{hard:!gn})),16640&t.$$.dirty[12]&&i(316,Ye=!!(Wi||cn&&cn.progress!==void 0&&!cn.complete)),64&t.$$.dirty[10]&&Ye&&Vs(),2048&t.$$.dirty[1]|32768&t.$$.dirty[12]&&i(319,$i=en&&!(en.error||Xe)),8&t.$$.dirty[0]|32768&t.$$.dirty[12]&&i(320,bi=Ri&&(en?!en.complete||en.error?Hh(Ri.statusLabelLoadImage(en),en.error&&en.error.metadata,"{","}"):Ri.statusLabelLoadImage({progress:1/0,task:"blob-to-bitmap"}):Ri.statusLabelLoadImage(en))),8&t.$$.dirty[0]|16384&t.$$.dirty[12]&&i(315,Mi=cn&&Ri&&Ri.statusLabelProcessImage(cn)),16384&t.$$.dirty[12]&&i(313,Ci=cn&&(cn.taskLengthComputable?cn.taskProgress:1/0)),16384&t.$$.dirty[12]&&i(314,X=cn&&!cn.error),16384&t.$$.dirty[12]&&i(312,Gt=!(!cn||!cn.error)),8&t.$$.dirty[0]|2048&t.$$.dirty[1]|131072&t.$$.dirty[7]|8188&t.$$.dirty[10])if(Zr){let st,yt,Qt,Je,Qe;_e(Zr)&&(st=Zr),hi(Zr)?yt=Zr:Array.isArray(Zr)&&([st,yt,Qe]=Zr,yt===!1&&(Je=!0),hi(yt)&&(Qt=!0)),i(35,Ka=(st||yt)&&{text:st,aside:Je||Qt,progressIndicator:{visible:Qt,progress:yt},closeButton:Je&&{label:Ri.statusLabelButtonClose,icon:Ri.statusIconButtonClose,onclick:Qe||(()=>i(234,Zr=void 0))}})}else i(35,Ka=Ri&&Xe||le||At||Ge?{text:bi,aside:le||$i,progressIndicator:{visible:$i,progress:Ve},closeButton:le&&{label:Ri.statusLabelButtonClose,icon:Ri.statusIconButtonClose,onclick:Ax}}:Ri&&Ye&&Mi?{text:Mi,aside:Gt||X,progressIndicator:{visible:X,progress:Ci},closeButton:Gt&&{label:Ri.statusLabelButtonClose,icon:Ri.statusIconButtonClose,onclick:Lx}}:void 0);if(131072&t.$$.dirty[7]&&i(324,H=Zr!==void 0),4194304&t.$$.dirty[1]|536870912&t.$$.dirty[9]|16384&t.$$.dirty[12]&&xt&&cn&&cn.complete&&(kd.set(!0),setTimeout(()=>kd.set(!1),gn?100:0)),4&t.$$.dirty[0]|4096&t.$$.dirty[1]|8192&t.$$.dirty[12]&&dr&&Jn&&Jn.dispatchEvent(fs("selectutil",at)),2304&t.$$.dirty[1]|22720&t.$$.dirty[10]|4096&t.$$.dirty[12]&&i(323,Zt=ko||di||Xe||le||At||Ge||Ye||H),8192&t.$$.dirty[10]&&wt(uc,$o=Zt?1:0,$o),4194304&t.$$.dirty[1]|8192&t.$$.dirty[10]&&uc.set(Zt?1:0,{duration:gn?500:1}),8388608&t.$$.dirty[1]&&i(41,ae=$o>0),16&t.$$.dirty[1]&&i(311,jt=!(!Ka||!Ka.aside)),4195344&t.$$.dirty[1]|32768&t.$$.dirty[9]|2&t.$$.dirty[10]|2048&t.$$.dirty[12]&&ae&&Ka){clearTimeout(Pd);const st={hard:gn===!1};if(jt){const yt=!!Ka.error||!gn;Td.set(1,st),Cd.set(Kr,{hard:yt}),i(294,Pd=setTimeout(()=>{pc.set(16,st)},1))}else Td.set(0,st),i(294,Pd=setTimeout(()=>{pc.set(0,st)},1))}if(1024&t.$$.dirty[1]&&(ae||(Md.set(void 0,{hard:!0}),Cd.set(void 0,{hard:!0}),pc.set(0,{hard:!0}))),1024&t.$$.dirty[12]&&i(310,$e=.5*Vo),1&t.$$.dirty[10]|512&t.$$.dirty[12]&&i(72,Xt=`transform: translateX(${On-$e}px)`),256&t.$$.dirty[1]|201326592&t.$$.dirty[11]&&i(38,ne=re&&Ce&&!di),128&t.$$.dirty[1]|1610612736&t.$$.dirty[9]&&i(307,qe=Le&&(ne||xt)?im:me),268435456&t.$$.dirty[9]&&i(71,Ne=qe),268435456&t.$$.dirty[9]&&i(70,pt=qe),8&t.$$.dirty[0]|2097152&t.$$.dirty[1]|370&t.$$.dirty[8]|251658240&t.$$.dirty[9]|128&t.$$.dirty[12]&&i(69,Ht=Ri&&So&&_c(()=>Ft([["div","alpha",{class:"PinturaNavGroup"},[["div","alpha-set",{class:"PinturaNavSet"},[Ze&&["Button","close",{label:Ri.labelClose,icon:Ri.iconButtonClose,onclick:()=>hr("close"),hideLabel:!0}],de&&["Button","revert",{label:Ri.labelButtonRevert,icon:Ri.iconButtonRevert,disabled:!V,onclick:Cx,hideLabel:!0}]]]]],["div","beta",{class:"PinturaNavGroup PinturaNavGroupFloat"},[he&&["div","history",{class:"PinturaNavSet"},[["Button","undo",{label:Ri.labelButtonUndo,icon:Ri.iconButtonUndo,disabled:!V,onclick:Pa.undo,hideLabel:!0}],["Button","redo",{label:Ri.labelButtonRedo,icon:Ri.iconButtonRedo,disabled:!tt,onclick:Pa.redo,hideLabel:!0}]]],dt.length&&["div","plugin-tools",{class:"PinturaNavSet"},dt.filter(Boolean).map(([st,yt,Qt])=>[st,yt,{...Qt}])]]],["div","gamma",{class:"PinturaNavGroup"},[ri&&["Button","export",{label:Ri.labelButtonExport,icon:Dt&&Ri.iconButtonExport,class:"PinturaButtonExport",onclick:Tx,hideLabel:Dt}]]]],{...$n},()=>Ns.set({})))),8&t.$$.dirty[12]&&i(299,Wt=An&&!!An.length),1048576&t.$$.dirty[9]|134217728&t.$$.dirty[11]|8&t.$$.dirty[12]&&i(298,K=Wt&&By(Ce,An)),1572864&t.$$.dirty[9]|67108864&t.$$.dirty[11]|96&t.$$.dirty[12]&&Wt&&((st,yt,Qt,Je)=>{if(!yt)return;const Qe={dataSizeScalar:Qt};Je&&Je[3]>0&&(Qe.backgroundColor=[...Je]),yt(st,Qe).then(He=>{wl&&qn(wl),i(295,wl=He)})})(re,Ln,K,ao),65536&t.$$.dirty[9]|134217728&t.$$.dirty[11]|24&t.$$.dirty[12]&&An&&wl&&Ce){const{width:st,height:yt}=Ce,Qt=Ea()?"pixelated":qr==="auto"?"auto":"pixelated";i(296,q1=An.map(Je=>{const Qe=Pn(Je.x,Je.y,Je.width,Je.height),He=mr(Si(Qe),Je.rotation).map(hn=>ot(hn.x/st,hn.y/yt));return{...Je,id:"redaction",flipX:!1,flipY:!1,cornerRadius:0,strokeWidth:0,strokeColor:void 0,backgroundColor:[0,0,0,0],backgroundImage:wl,backgroundImageRendering:Qt,backgroundCorners:He}}))}131072&t.$$.dirty[9]|4&t.$$.dirty[12]&&i(37,Yt=[...q1,...Vn||[]]),32&t.$$.dirty[1]&&hc&&nm.set(hc),4&t.$$.dirty[0]|128&t.$$.dirty[1]&&ne&&Jn&&Jn.dispatchEvent(fs("ready")),262144&t.$$.dirty[1]&&i(63,Id=!0),2013265920&t.$$.dirty[11]&&i(64,Ed=!0),131072&t.$$.dirty[1]&&i(65,Ad=!0),65536&t.$$.dirty[1]&&i(66,Ld=!0),64&t.$$.dirty[1]&&i(67,zd=!0)},i(360,b=!Zh()),y=Tc()===1?$=>{$&&(bo($.origin,Math.round),bo($.translation,Math.round))}:Ki,i(326,Oe=[!q5()&&"WebGL"].filter(Boolean)),i(309,Le=ia()||Su()&&ya()),i(68,Ut=(($,Y=!0)=>ft=>{ft.type==="ping"&&(Y&&ft.stopPropagation(),$(ft.detail.type,ft.detail.data))})(Gr.pub)),[Fn,Ao,Jn,Ri,Bs,x,L,rt,Lt,Bt,we,Ii,an,Xr,io,Na,Ha,Go,Io,Ca,go,Ga,ps,Ws,Ul,Ta,Za,_s,Yu,F1,Pa,yd,B1,vd,bd,Ka,hc,Yt,ne,di,Fe,ae,Xe,at,ye,g,lt,Bi,ti,je,Me,Nn,So,gn,$o,No,Ji,pr,zn,da,Gl,Gc,dc,Id,Ed,Ad,Ld,zd,Ut,Ht,pt,Ne,Xt,ze,Ot,fi,Kt,kt,vt,G,Wn,Po,Hi,ei,ai,Ai,Fi,un,Sn,fn,Di,Pi,zr,jo,Sa,Fa,Da,Ba,Uo,ss,ul,Oa,Wa,_u,Zl,Xa,Xl,Ns,qc,Xu,Ku,Hs,Ju,Kc,Qu,h0,t1,Jc,e1,Qc,i1,pa,ml,td,ed,id,n1,r1,o1,a1,js,s1,nd,v0,w0,S0,k0,C0,T0,M0,l1,c1,d1,rd,u1,p1,od,h1,Jl,ad,Ql,m1,$1,$l,gl,g1,tc,Us,sd,ld,ec,f1,cd,dd,ud,Gs,ic,x1,Zo,pd,b1,E0,fl,yl,Ma,w1,qa,xl,S1,rc,bl,md,k1,B0,$d,oc,H0,I1,E1,A1,L1,z1,ac,sc,D1,gd,fd,cc,O1,ms,Xo,xd,Y0,V1,N1,H1,($,Y)=>Y[$],$=>ut.find(Y=>Y.id===$).view,j1,U1,G1,wd,({target:$,propertyName:Y})=>{$===Jn&&/background|outline/.test(Y)&&ke&&Q0()},tm,uc,kd,Cd,Td,pc,X1,Md,$=>{const Y=!(!Ka||!Ka.closeButton)||!gn;X1.set($.detail.width,{hard:Y}),Md.set(Math.round(.5*-$.detail.width),{hard:Y})},zx,Xs,$=>{const{keyCode:Y,metaKey:ft,ctrlKey:St,shiftKey:st}=$;if(Y===9&&cs)return void $.preventDefault();if($.target&&Y===32&&Jn.contains($.target)&&!Wc($.target)&&(vn&&o&&Uu(),$.preventDefault()),Y===90&&(ft||St))return void(st&&ft?Pa.redo():Pa.undo());if(Y===89&&St)return void Pa.redo();if(Y===229)return;const yt=new Set([...xr,Y]);Xs.set(Array.from(yt))},({key:$,keyCode:Y})=>{if($==="Meta")return Xs.set([]);Xs.set(xr.filter(ft=>ft!==Y))},()=>{Xs.set([])},$=>{Wc($.target)||$.preventDefault()},$=>{ii&&Y1($.detail.resources[0])},()=>{ui&&D2().then(Fx)},$=>{if(!xi)return;const Y=tn((window.innerWidth-Math.abs(fe.x))/fe.width,0,1),ft=tn((window.innerHeight-Math.abs(fe.y))/fe.height,0,1);Y<.75&&ft<.75||Y1(($.clipboardData||window.clipboardData).files[0])},rm,cm,$=>{De&&Qo($.detail,De)||wt(Us,De=$.detail,De)},Zr,lc,pn,Ro,_a,ls,jl,ka,cs,Os,Va,j,ct,Nt,Vt,Ft,_t,qt,ri,de,he,Se,Ze,ii,xi,ui,ln,ji,Li,yn,Qi,Gn,kr,ds,ja,ua,Ua,us,Eo,()=>i(60,Gl=void 0),($,Y,ft)=>{const{text:St="",placeholder:st="",autoClose:yt=!0,align:Qt="top",justify:Je="center",buttonConfirm:Qe,buttonCancel:He}=ft;i(60,Gl={align:Qt,justify:Je,text:St,placeholder:st,buttonConfirm:Qe,buttonCancel:He,onconfirm:()=>{$(Gc.value),yt&&i(60,Gl=void 0)},oncancel:()=>{Y(void 0),i(60,Gl=void 0)}})},Ou,Zc,pl,ex,ju,Vs,hl,Uu,Gu,Zu,c0,Ya,Yl,Yc,ql,y1,hs,Sd,Z1,Pd,wl,q1,gt,K,Wt,o,it,ie,Dt,dt,tt,V,qe,xt,Le,$e,jt,Gt,Ci,X,Mi,Ye,le,Ve,$i,bi,Ge,At,Zt,H,bt,Oe,Re,$t,q,Tt,U,oe,mt,nt,zt,ee,ve,be,se,Jt,Z,J,te,ke,_,ut,k,N,n,O,D,W,F,T,M,C,I,h,S,b,w,s,u,a,d,r,re,Ce,xe,Ke,Pe,fe,Yi,Vn,An,qr,ao,Ln,$n,Wi,On,Vo,Kr,ko,dr,cn,en,so,br,lo,la,Co,To,_r,Jr,Ir,ur,_i,Vi,lr,Vr,co,Qr,Sr,uo,Hn,B,ce,Ue,yi,Gi,dn,ca,wa,Ho,Nr,Hr,R,Te,We,gi,Oi,function(){i(31,yd=nl.innerWidth),i(32,B1=nl.innerHeight)},$=>wt(tc,ai=$.detail,ai),({detail:$})=>i(43,at=$),function($,Y){t.$$.not_equal(Ao[Y],$)&&(Ao[Y]=$,i(1,Ao),i(277,pl),i(27,_s))},$=>V1($),$=>N1($),($,{detail:Y})=>H1($,Y),$=>wt(gl,Wn=$.detail,Wn),function($){t.$$.not_equal(Ao[at],$)&&(Ao[at]=$,i(1,Ao),i(277,pl),i(27,_s))},()=>V1(at),()=>N1(at),({detail:$})=>H1(at,$),$=>{const Y={...$,...rm()},{annotationShapes:ft,decorationShapes:St,interfaceShapes:st,frameShapes:yt,selectionShapes:Qt}=Bt({annotationShapes:je,decorationShapes:ti,interfaceShapes:Sa,frameShapes:Bi,selectionShapes:da},Y);return cm(Y,Yt,ft,St,st,yt,Qt)},()=>{i(63,Id=!1),i(64,Ed=!1),i(65,Ad=!1),i(66,Ld=!1),i(67,zd=!1)},function($){zi[$?"unshift":"push"](()=>{hc=$,i(36,hc)})},function($){Fn=$,i(0,Fn),i(266,kr)},function($){vd=$,i(33,vd)},function($){bd=$,i(34,bd)},function($){zi[$?"unshift":"push"](()=>{Gc=$,i(61,Gc)})},function($){zi[$?"unshift":"push"](()=>{Jn=$,i(2,Jn)})},$=>wt($1,Nn=$.detail,Nn)]}class Vg extends ci{constructor(e){super(),li(this,e,g3,$3,oi,{class:236,layout:237,stores:238,locale:3,id:4,util:239,utils:240,animations:241,disabled:242,status:234,previewUpscale:243,previewPad:244,previewMaskOpacity:5,previewImageDataMaxSize:245,previewImageTextPixelRatio:6,markupMaskOpacity:7,zoomMaskOpacity:246,elasticityMultiplier:8,willRevert:247,willProcessImage:248,willRenderCanvas:9,willRenderToolbar:249,willRenderUtilTabs:250,willSetHistoryInitialState:251,enableButtonExport:252,enableButtonRevert:253,enableNavigateHistory:254,enableToolbar:10,enableUtils:255,enableButtonClose:256,enableDropImage:257,enablePasteImage:258,enableBrowseImage:259,enableTransparencyGrid:11,layoutDirectionPreference:260,layoutHorizontalUtilsPreference:261,layoutVerticalUtilsPreference:262,layoutVerticalToolbarPreference:263,layoutVerticalControlGroupsPreference:264,layoutVerticalControlTabsPreference:265,textDirection:12,markupEditorZoomLevel:266,markupEditorZoomLevels:13,markupEditorZoomAdjustStep:14,markupEditorZoomAdjustFactor:15,markupEditorZoomAdjustWheelFactor:16,markupEditorInteractionMode:267,muteAudio:268,willSetMediaInitialTimeOffset:269,enablePan:17,enableZoom:18,enableZoomControls:270,enableZoomInput:19,enablePanInput:271,enableCanvasAlpha:20,enablePanLimit:21,panLimitGutterScalar:22,zoomPresetOptions:23,zoomAdjustStep:24,zoomAdjustFactor:25,zoomAdjustWheelFactor:26,zoomLevel:0,fixScrollDirection:272,hideTextInput:273,showTextInput:274,imagePreviewSrc:275,imageOrienter:276,pluginComponents:277,pluginOptions:27,sub:278,pluginInterface:1,root:2,play:279,pause:280,isPaused:281,togglePlayPause:282,mute:283,unmute:284,toggleMute:285,getDuration:286,getCurrentTime:287,setCurrentTime:288,imageSourceToImageData:28,imagePreview:29,imagePreviewCurrent:235,history:30},null,[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1])}get class(){return this.$$.ctx[236]}set class(e){this.$$set({class:e}),E()}get layout(){return this.$$.ctx[237]}set layout(e){this.$$set({layout:e}),E()}get stores(){return this.$$.ctx[238]}set stores(e){this.$$set({stores:e}),E()}get locale(){return this.$$.ctx[3]}set locale(e){this.$$set({locale:e}),E()}get id(){return this.$$.ctx[4]}set id(e){this.$$set({id:e}),E()}get util(){return this.$$.ctx[239]}set util(e){this.$$set({util:e}),E()}get utils(){return this.$$.ctx[240]}set utils(e){this.$$set({utils:e}),E()}get animations(){return this.$$.ctx[241]}set animations(e){this.$$set({animations:e}),E()}get disabled(){return this.$$.ctx[242]}set disabled(e){this.$$set({disabled:e}),E()}get status(){return this.$$.ctx[234]}set status(e){this.$$set({status:e}),E()}get previewUpscale(){return this.$$.ctx[243]}set previewUpscale(e){this.$$set({previewUpscale:e}),E()}get previewPad(){return this.$$.ctx[244]}set previewPad(e){this.$$set({previewPad:e}),E()}get previewMaskOpacity(){return this.$$.ctx[5]}set previewMaskOpacity(e){this.$$set({previewMaskOpacity:e}),E()}get previewImageDataMaxSize(){return this.$$.ctx[245]}set previewImageDataMaxSize(e){this.$$set({previewImageDataMaxSize:e}),E()}get previewImageTextPixelRatio(){return this.$$.ctx[6]}set previewImageTextPixelRatio(e){this.$$set({previewImageTextPixelRatio:e}),E()}get markupMaskOpacity(){return this.$$.ctx[7]}set markupMaskOpacity(e){this.$$set({markupMaskOpacity:e}),E()}get zoomMaskOpacity(){return this.$$.ctx[246]}set zoomMaskOpacity(e){this.$$set({zoomMaskOpacity:e}),E()}get elasticityMultiplier(){return this.$$.ctx[8]}set elasticityMultiplier(e){this.$$set({elasticityMultiplier:e}),E()}get willRevert(){return this.$$.ctx[247]}set willRevert(e){this.$$set({willRevert:e}),E()}get willProcessImage(){return this.$$.ctx[248]}set willProcessImage(e){this.$$set({willProcessImage:e}),E()}get willRenderCanvas(){return this.$$.ctx[9]}set willRenderCanvas(e){this.$$set({willRenderCanvas:e}),E()}get willRenderToolbar(){return this.$$.ctx[249]}set willRenderToolbar(e){this.$$set({willRenderToolbar:e}),E()}get willRenderUtilTabs(){return this.$$.ctx[250]}set willRenderUtilTabs(e){this.$$set({willRenderUtilTabs:e}),E()}get willSetHistoryInitialState(){return this.$$.ctx[251]}set willSetHistoryInitialState(e){this.$$set({willSetHistoryInitialState:e}),E()}get enableButtonExport(){return this.$$.ctx[252]}set enableButtonExport(e){this.$$set({enableButtonExport:e}),E()}get enableButtonRevert(){return this.$$.ctx[253]}set enableButtonRevert(e){this.$$set({enableButtonRevert:e}),E()}get enableNavigateHistory(){return this.$$.ctx[254]}set enableNavigateHistory(e){this.$$set({enableNavigateHistory:e}),E()}get enableToolbar(){return this.$$.ctx[10]}set enableToolbar(e){this.$$set({enableToolbar:e}),E()}get enableUtils(){return this.$$.ctx[255]}set enableUtils(e){this.$$set({enableUtils:e}),E()}get enableButtonClose(){return this.$$.ctx[256]}set enableButtonClose(e){this.$$set({enableButtonClose:e}),E()}get enableDropImage(){return this.$$.ctx[257]}set enableDropImage(e){this.$$set({enableDropImage:e}),E()}get enablePasteImage(){return this.$$.ctx[258]}set enablePasteImage(e){this.$$set({enablePasteImage:e}),E()}get enableBrowseImage(){return this.$$.ctx[259]}set enableBrowseImage(e){this.$$set({enableBrowseImage:e}),E()}get enableTransparencyGrid(){return this.$$.ctx[11]}set enableTransparencyGrid(e){this.$$set({enableTransparencyGrid:e}),E()}get layoutDirectionPreference(){return this.$$.ctx[260]}set layoutDirectionPreference(e){this.$$set({layoutDirectionPreference:e}),E()}get layoutHorizontalUtilsPreference(){return this.$$.ctx[261]}set layoutHorizontalUtilsPreference(e){this.$$set({layoutHorizontalUtilsPreference:e}),E()}get layoutVerticalUtilsPreference(){return this.$$.ctx[262]}set layoutVerticalUtilsPreference(e){this.$$set({layoutVerticalUtilsPreference:e}),E()}get layoutVerticalToolbarPreference(){return this.$$.ctx[263]}set layoutVerticalToolbarPreference(e){this.$$set({layoutVerticalToolbarPreference:e}),E()}get layoutVerticalControlGroupsPreference(){return this.$$.ctx[264]}set layoutVerticalControlGroupsPreference(e){this.$$set({layoutVerticalControlGroupsPreference:e}),E()}get layoutVerticalControlTabsPreference(){return this.$$.ctx[265]}set layoutVerticalControlTabsPreference(e){this.$$set({layoutVerticalControlTabsPreference:e}),E()}get textDirection(){return this.$$.ctx[12]}set textDirection(e){this.$$set({textDirection:e}),E()}get markupEditorZoomLevel(){return this.$$.ctx[266]}set markupEditorZoomLevel(e){this.$$set({markupEditorZoomLevel:e}),E()}get markupEditorZoomLevels(){return this.$$.ctx[13]}set markupEditorZoomLevels(e){this.$$set({markupEditorZoomLevels:e}),E()}get markupEditorZoomAdjustStep(){return this.$$.ctx[14]}set markupEditorZoomAdjustStep(e){this.$$set({markupEditorZoomAdjustStep:e}),E()}get markupEditorZoomAdjustFactor(){return this.$$.ctx[15]}set markupEditorZoomAdjustFactor(e){this.$$set({markupEditorZoomAdjustFactor:e}),E()}get markupEditorZoomAdjustWheelFactor(){return this.$$.ctx[16]}set markupEditorZoomAdjustWheelFactor(e){this.$$set({markupEditorZoomAdjustWheelFactor:e}),E()}get markupEditorInteractionMode(){return this.$$.ctx[267]}set markupEditorInteractionMode(e){this.$$set({markupEditorInteractionMode:e}),E()}get muteAudio(){return this.$$.ctx[268]}set muteAudio(e){this.$$set({muteAudio:e}),E()}get willSetMediaInitialTimeOffset(){return this.$$.ctx[269]}set willSetMediaInitialTimeOffset(e){this.$$set({willSetMediaInitialTimeOffset:e}),E()}get enablePan(){return this.$$.ctx[17]}set enablePan(e){this.$$set({enablePan:e}),E()}get enableZoom(){return this.$$.ctx[18]}set enableZoom(e){this.$$set({enableZoom:e}),E()}get enableZoomControls(){return this.$$.ctx[270]}set enableZoomControls(e){this.$$set({enableZoomControls:e}),E()}get enableZoomInput(){return this.$$.ctx[19]}set enableZoomInput(e){this.$$set({enableZoomInput:e}),E()}get enablePanInput(){return this.$$.ctx[271]}set enablePanInput(e){this.$$set({enablePanInput:e}),E()}get enableCanvasAlpha(){return this.$$.ctx[20]}set enableCanvasAlpha(e){this.$$set({enableCanvasAlpha:e}),E()}get enablePanLimit(){return this.$$.ctx[21]}set enablePanLimit(e){this.$$set({enablePanLimit:e}),E()}get panLimitGutterScalar(){return this.$$.ctx[22]}set panLimitGutterScalar(e){this.$$set({panLimitGutterScalar:e}),E()}get zoomPresetOptions(){return this.$$.ctx[23]}set zoomPresetOptions(e){this.$$set({zoomPresetOptions:e}),E()}get zoomAdjustStep(){return this.$$.ctx[24]}set zoomAdjustStep(e){this.$$set({zoomAdjustStep:e}),E()}get zoomAdjustFactor(){return this.$$.ctx[25]}set zoomAdjustFactor(e){this.$$set({zoomAdjustFactor:e}),E()}get zoomAdjustWheelFactor(){return this.$$.ctx[26]}set zoomAdjustWheelFactor(e){this.$$set({zoomAdjustWheelFactor:e}),E()}get zoomLevel(){return this.$$.ctx[0]}set zoomLevel(e){this.$$set({zoomLevel:e}),E()}get fixScrollDirection(){return this.$$.ctx[272]}set fixScrollDirection(e){this.$$set({fixScrollDirection:e}),E()}get hideTextInput(){return this.$$.ctx[273]}get showTextInput(){return this.$$.ctx[274]}get imagePreviewSrc(){return this.$$.ctx[275]}set imagePreviewSrc(e){this.$$set({imagePreviewSrc:e}),E()}get imageOrienter(){return this.$$.ctx[276]}set imageOrienter(e){this.$$set({imageOrienter:e}),E()}get pluginComponents(){return this.$$.ctx[277]}set pluginComponents(e){this.$$set({pluginComponents:e}),E()}get pluginOptions(){return this.$$.ctx[27]}set pluginOptions(e){this.$$set({pluginOptions:e}),E()}get sub(){return this.$$.ctx[278]}get pluginInterface(){return this.$$.ctx[1]}get root(){return this.$$.ctx[2]}set root(e){this.$$set({root:e}),E()}get play(){return this.$$.ctx[279]}get pause(){return this.$$.ctx[280]}get isPaused(){return this.$$.ctx[281]}get togglePlayPause(){return this.$$.ctx[282]}get mute(){return this.$$.ctx[283]}get unmute(){return this.$$.ctx[284]}get toggleMute(){return this.$$.ctx[285]}get getDuration(){return this.$$.ctx[286]}get getCurrentTime(){return this.$$.ctx[287]}get setCurrentTime(){return this.$$.ctx[288]}get imageSourceToImageData(){return this.$$.ctx[28]}set imageSourceToImageData(e){this.$$set({imageSourceToImageData:e}),E()}get imagePreview(){return this.$$.ctx[29]}get imagePreviewCurrent(){return this.$$.ctx[235]}set imagePreviewCurrent(e){this.$$set({imagePreviewCurrent:e}),E()}get history(){return this.$$.ctx[30]}}typeof window<"u"&&(t=>{if(t&&t._u5rlc3k)return;const[e,i,n]=[[99,111,110,115,111,108,101],[108,111,103],[84,104,105,115,32,118,101,114,115,105,111,110,32,111,102,32,80,105,110,116,117,114,97,32,105,115,32,102,111,114,32,116,101,115,116,105,110,103,32,112,117,114,112,111,115,101,115,32,111,110,108,121,46,32,86,105,115,105,116,32,104,116,116,112,115,58,47,47,112,113,105,110,97,46,110,108,47,112,105,110,116,117,114,97,32,116,111,32,112,117,114,99,104,97,115,101,32,97,32,108,105,99,101,110,115,101,46,32,86,105,115,105,116,32,104,116,116,112,115,58,47,47,112,113,105,110,97,46,110,108,47,112,105,110,116,117,114,97,47,99,104,97,116,32,105,102,32,121,111,117,32,104,97,118,101,32,97,110,121,32,113,117,101,115,116,105,111,110,115,46]].map(r=>r.map(o=>String.fromCharCode(o)).join(""));t&&t[e]&&t[e][i](n)})(window);const f3=["klass","stores","isVisible","isActive","isActiveFraction","locale"],y3=["history","klass","stores","navButtons","pluginComponents","pluginInterface","pluginOptions","sub","imagePreviewSrc","imagePreview","imagePreviewCurrent"],x3=["locale"];let Op;const B2=new Set([]),su={},dh=new Map,b3=(...t)=>{t.filter(e=>!!e.util).forEach(e=>{const[i,n,r=()=>!0]=e.util;dh.has(i)||(dh.set(i,{Component:n,isSupported:r}),Xh(n).filter(o=>!f3.includes(o)).forEach(o=>{B2.add(o),su[o]?su[o].push(i):su[o]=[i]}))})};var O2=[...i2,"init","update","undo","redo","revert","writehistory","destroy","show","hide","close","ready","zoom","pan","loadpreview","selectshape","blurshape","updateshape","addshape","removeshape","selectstyle","markuptap","markupzoom","markuppan","selectutil","selectcontrol","selectiondown","selectionup","selectionchange"],W2=(t,e,i={})=>{const{prefix:n="pintura:"}=i;return O2.map(r=>t.on(r,o=>Bl(e)?((a,s,l)=>a.dispatchEvent(new CustomEvent(s,{detail:l,bubbles:!0,cancelable:!0})))(e,`${n}${r}`,o):e(r,o)))};const v3=t=>_e(t[0]),w3=t=>!v3(t),_2=t=>t[1],uh=t=>t[3]||[],S3=(t,e)=>{const i=ph(t,e);return v2(i,n=>_2(n)===t),i},ph=(t,e)=>{if(w3(e)){if(e.find(n=>_2(n)===t))return e;const i=e.find(n=>ph(t,uh(n)));return i&&i[3]}return ph(t,uh(e))},k3=()=>[.75,.25,.25,0,0,.25,.75,.25,0,0,.25,.25,.75,0,0,0,0,0,1,0],C3=()=>[1.398,-.316,.065,-.273,.201,-.051,1.278,-.08,-.273,.201,-.051,.119,1.151,-.29,.215,0,0,0,1,0],T3=()=>[1.073,-.015,.092,-.115,-.017,.107,.859,.184,-.115,-.017,.015,.077,1.104,-.115,-.017,0,0,0,1,0],M3=()=>[1.06,0,0,0,0,0,1.01,0,0,0,0,0,.93,0,0,0,0,0,1,0],P3=()=>[1.1,0,0,0,-.1,0,1.1,0,0,-.1,0,0,1.2,0,-.1,0,0,0,1,0],R3=()=>[.212,.715,.114,0,0,.212,.715,.114,0,0,.212,.715,.114,0,0,0,0,0,1,0],I3=()=>[.15,1.3,-.25,.1,-.2,.15,1.3,-.25,.1,-.2,.15,1.3,-.25,.1,-.2,0,0,0,1,0],E3=()=>[.163,.518,.084,-.01,.208,.163,.529,.082,-.02,.21,.171,.529,.084,0,.214,0,0,0,1,0],A3=()=>[.338,.991,.117,.093,-.196,.302,1.049,.096,.078,-.196,.286,1.016,.146,.101,-.196,0,0,0,1,0],L3=()=>[.393,.768,.188,0,0,.349,.685,.167,0,0,.272,.533,.13,0,0,0,0,0,1,0],z3=()=>[.289,.62,.185,0,.077,.257,.566,.163,0,.115,.2,.43,.128,0,.188,0,0,0,1,0],F3=()=>[.269,.764,.172,.05,.1,.239,.527,.152,0,.176,.186,.4,.119,0,.159,0,0,0,1,0],D3=()=>[.547,.764,.134,0,-.147,.281,.925,.12,0,-.135,.225,.558,.33,0,-.113,0,0,0,1,0],B3={chrome:C3,fade:T3,pastel:k3,cold:P3,warm:M3,monoDefault:R3,monoWash:E3,monoNoir:I3,monoStark:A3,sepiaDefault:L3,sepiaRust:F3,sepiaBlues:z3,sepiaColor:D3};var O3={filterFunctions:B3,filterOptions:[["Default",[[void 0,t=>t.labelDefault]]],["Classic",[["chrome",t=>t.filterLabelChrome],["fade",t=>t.filterLabelFade],["cold",t=>t.filterLabelCold],["warm",t=>t.filterLabelWarm],["pastel",t=>t.filterLabelPastel]]],["Monochrome",[["monoDefault",t=>t.filterLabelMonoDefault],["monoNoir",t=>t.filterLabelMonoNoir],["monoStark",t=>t.filterLabelMonoStark],["monoWash",t=>t.filterLabelMonoWash]]],["Sepia",[["sepiaDefault",t=>t.filterLabelSepiaDefault],["sepiaRust",t=>t.filterLabelSepiaRust],["sepiaBlues",t=>t.filterLabelSepiaBlues],["sepiaColor",t=>t.filterLabelSepiaColor]]]]};const W3={base:0,min:-.25,max:.25,getLabel:t=>Ts(t/.25),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.brightness)return t.brightness[4]},setValue:(t,e)=>t.update(i=>({...i,brightness:[1,0,0,0,e,0,1,0,0,e,0,0,1,0,e,0,0,0,1,0]}))},_3={base:1,min:.5,max:1.5,getLabel:t=>Ts(2*(t-.5)-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.contrast)return t.contrast[0]},setValue:(t,e)=>t.update(i=>({...i,contrast:[e,0,0,0,.5*(1-e),0,e,0,0,.5*(1-e),0,0,e,0,.5*(1-e),0,0,0,1,0]}))},V3={base:1,min:0,max:2,getLabel:t=>Ts(t-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.saturation)return(t.saturation[0]-.213)/.787},setValue:(t,e)=>t.update(i=>({...i,saturation:[.213+.787*e,.715-.715*e,.072-.072*e,0,0,.213-.213*e,.715+.285*e,.072-.072*e,0,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,0,1,0]}))},N3={base:1,min:.5,max:1.5,getLabel:t=>Ts(2*(t-.5)-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.exposure)return t.exposure[0]},setValue:(t,e)=>t.update(i=>({...i,exposure:[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0]}))},H3={base:1,min:.15,max:4,getLabel:t=>Ts(t<1?(t-.15)/.85-1:(t-1)/3),getStore:({imageGamma:t})=>t},j3={base:0,min:-1,max:1,getStore:({imageVignette:t})=>t},U3={base:0,min:-1,max:1,getStore:({imageConvolutionMatrix:t})=>t,getValue:t=>{if(t.clarity)return t.clarity[0]===0?t.clarity[1]/-1:t.clarity[1]/-2},setValue:(t,e)=>{t.update(i=>({...i,clarity:e>=0?[0,-1*e,0,-1*e,1+4*e,-1*e,0,-1*e,0]:[-1*e,-2*e,-1*e,-2*e,1+-3*e,-2*e,-1*e,-2*e,-1*e]}))}},G3={base:0,min:-1,max:1,getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(!t.temperature)return;const e=t.temperature[0];return e>=1?(e-1)/.1:(1-e)/-.15},setValue:(t,e)=>t.update(i=>({...i,temperature:e>0?[1+.1*e,0,0,0,0,0,1,0,0,0,0,0,1+.1*-e,0,0,0,0,0,1,0]:[1+.15*e,0,0,0,0,0,1+.05*e,0,0,0,0,0,1+.15*-e,0,0,0,0,0,1,0]}))};var Z3={finetuneControlConfiguration:{gamma:H3,brightness:W3,contrast:_3,saturation:V3,exposure:N3,temperature:G3,clarity:U3,vignette:j3},finetuneOptions:[["brightness",t=>t.finetuneLabelBrightness],["contrast",t=>t.finetuneLabelContrast],["saturation",t=>t.finetuneLabelSaturation],["exposure",t=>t.finetuneLabelExposure],["temperature",t=>t.finetuneLabelTemperature],["gamma",t=>t.finetuneLabelGamma],!Zh()&&["clarity",t=>t.finetuneLabelClarity],["vignette",t=>t.finetuneLabelVignette]].filter(Boolean)};const X3={shape:{frameColor:[1,1,1],frameStyle:"solid",frameSize:"2.5%"},thumb:'<rect stroke-width="5" x="0" y="0" width="100%" height="100%"/>'},Y3={shape:{frameColor:[1,1,1],frameStyle:"solid",frameSize:"2.5%",frameRound:!0},thumb:'<rect stroke-width="5" x="0" y="0" width="100%" height="100%" rx="12%"/>'},q3={shape:{frameColor:[1,1,1],frameStyle:"line",frameInset:"2.5%",frameSize:".3125%",frameRadius:0},thumb:'<div style="top:.5em;left:.5em;right:.5em;bottom:.5em;box-shadow:inset 0 0 0 1px currentColor"></div>'},K3={shape:{frameColor:[1,1,1],frameStyle:"line",frameAmount:2,frameInset:"2.5%",frameSize:".3125%",frameOffset:"1.25%",frameRadius:0},thumb:'<div style="top:.75em;left:.75em;right:.75em;bottom:.75em; outline: 3px double"></div>'},J3={shape:{frameColor:[1,1,1],frameStyle:"edge",frameInset:"2.5%",frameOffset:"5%",frameSize:".3125%"},thumb:'<div style="top:.75em;left:.5em;bottom:.75em;border-left:1px solid"></div><div style="top:.75em;right:.5em;bottom:.75em;border-right:1px solid"></div><div style="top:.5em;left:.75em;right:.75em;border-top:1px solid"></div><div style="bottom:.5em;left:.75em;right:.75em;border-bottom:1px solid"></div>'},Q3={shape:{frameColor:[1,1,1],frameStyle:"edge",frameInset:"2.5%",frameSize:".3125%"},thumb:'<div style="top:-.5em;left:.5em;right:.5em;bottom:-.5em; box-shadow: inset 0 0 0 1px currentColor"></div><div style="top:.5em;left:-.5em;right:-.5em;bottom:.5em;box-shadow:inset 0 0 0 1px currentColor"></div>'},tw={shape:{frameColor:[1,1,1],frameStyle:"edge",frameOffset:"1.5%",frameSize:".3125%"},thumb:'<div style="top:.3125em;left:.5em;bottom:.3125em;border-left:1px solid"></div><div style="top:.3125em;right:.5em;bottom:.3125em;border-right:1px solid"></div><div style="top:.5em;left:.3125em;right:.3125em;border-top:1px solid"></div><div style="bottom:.5em;left:.3125em;right:.3125em;border-bottom:1px solid"></div>'},ew={shape:{frameColor:[1,1,1],frameStyle:"hook",frameInset:"2.5%",frameSize:".3125%",frameLength:"5%"},thumb:'<div style="top:.5em;left:.5em;width:.75em;height:.75em; border-left: 1px solid;border-top: 1px solid;"></div><div style="top:.5em;right:.5em;width:.75em;height:.75em; border-right: 1px solid;border-top: 1px solid;"></div><div style="bottom:.5em;left:.5em;width:.75em;height:.75em; border-left: 1px solid;border-bottom: 1px solid;"></div><div style="bottom:.5em;right:.5em;width:.75em;height:.75em; border-right: 1px solid;border-bottom: 1px solid;"></div>'},iw={shape:{frameColor:[1,1,1],frameStyle:"polaroid"},thumb:'<rect stroke-width="20%" x="-5%" y="-5%" width="110%" height="96%"/>'};var nw={frameStyles:{solidSharp:X3,solidRound:Y3,lineSingle:q3,lineMultiple:K3,edgeSeparate:J3,edgeCross:Q3,edgeOverlap:tw,hook:ew,polaroid:iw},frameOptions:[[void 0,t=>t.labelNone],["solidSharp",t=>t.frameLabelMatSharp],["solidRound",t=>t.frameLabelMatRound],["lineSingle",t=>t.frameLabelLineSingle],["lineMultiple",t=>t.frameLabelLineMultiple],["edgeCross",t=>t.frameLabelEdgeCross],["edgeSeparate",t=>t.frameLabelEdgeSeparate],["edgeOverlap",t=>t.frameLabelEdgeOverlap],["hook",t=>t.frameLabelCornerHooks],["polaroid",t=>t.frameLabelPolaroid]]},_l=t=>t.charAt(0).toUpperCase()+t.slice(1);let bc=null;var Wp=()=>{if(bc===null)if(Pr())try{bc=document.fonts.check("16px TestNonExistingFont")===!1}catch{bc=!1}else bc=!1;return bc};const Vc=(t,e)=>i=>i[e?`${e}${_l(t)}`:t],rw=t=>[t,""+t],zu=(t,e)=>i=>[t[i],Vc(i,e)],V2=t=>Array.isArray(t)&&t.every(hi)?t.map(rw):t,tl=[1,.2549,.2118],Ng=[1,1,1,0],ow=t=>{const{hideLabel:e=!0}=t||{};return xw(["new","add","subtract"].map(i=>[i,Vc(i,"shapeLabelSelectionMode"),{icon:Vc(i,"shapeIconSelectionMode"),hideLabel:e}]),{title:i=>i.shapeTitleSelectionMode,layout:"radio"})},aw=t=>N2(t,{title:e=>e.shapeTitleBrushSize,layout:"radio",optionHideLabel:!0,optionIcon:(e,i)=>`<circle fill="currentColor" stroke-width=".05em" stroke="currentColor" fill-opacity=".25" cx="12" cy="12" r="${2+8*i}"/>`}),Hg={eraser:()=>({eraseRadius:8,cursorStyle:"ellipse",cursorSize:"eraseRadius"}),path:()=>({points:[],disableAddPoints:!1}),line:()=>({x1:0,y1:0,x2:0,y2:0,disableErase:!1}),rectangle:()=>({x:0,y:0,width:0,height:0}),ellipse:()=>({x:0,y:0,rx:0,ry:0}),text:()=>({x:0,y:0,text:"Text"})},$s=(t,e={},i)=>{if(!Hg[t])return;const{position:n="relative",inputMode:r="drag",isSelection:o=!1}=i||{};return[{...Hg[t](),...e},{position:n,inputMode:r,isSelection:o}]},sw=t=>({sharpie:$s("path",{bitmap:!0,strokeJoin:"round",strokeCap:"round",strokeWidth:"0.5%",strokeColor:[...tl],cursorStyle:"ellipse",cursorSize:"strokeWidth",disableErase:!1,disableResize:!0,disableMove:!0}),eraser:$s("eraser"),path:$s("path",{pathClose:void 0,strokeWidth:"0.5%",strokeColor:[...tl],backgroundColor:[0,0,0,0]},{inputMode:"step"}),line:$s("line",{strokeColor:[...tl],strokeWidth:"0.5%"}),arrow:$s("line",{lineStart:"none",lineEnd:"arrow-solid",strokeColor:[...tl],strokeWidth:"0.5%"}),rectangle:$s("rectangle",{strokeColor:[...Ng],backgroundColor:[...tl]}),ellipse:$s("ellipse",{strokeColor:[...Ng],backgroundColor:[...tl]}),text:$s("text",{color:[...tl],fontSize:"2%"}),...t}),_p=(t,e,i)=>[t,e||Vc(t,"shapeLabelTool"),{icon:Vc(t,"shapeIconTool"),...i}],lw=(t=["move","view","sharpie","eraser","path","line","arrow","rectangle","ellipse","text","preset"])=>t.map(e=>_e(e)?_p(e):Array.isArray(e)?sl(e[1])?_p(e[0],void 0,e[1]):_p(e[0],e[1],e[2]):void 0).filter(Boolean),cw=t=>Object.keys(t).map(zu(t,"shapeTitleColor")),dw=t=>Object.keys(t).map(zu(t,"labelSize")),uw=t=>Object.keys(t).map(zu(t,"labelSize")),jg=t=>Object.keys(t).map(zu(t,"labelSize")),pw=t=>[...t],hw=t=>t.map(e=>[e,i=>i["shapeLabelFontStyle"+e.filter(n=>n!=="normal").map(_l).join("")]]),mw=t=>t.map(e=>[F2(e),i=>i["shapeTitleLineDecoration"+_l(e)],{icon:i=>i["shapeIconLineDecoration"+_l(e)]}]),xa=(t,e)=>{const{defaultKey:i,defaultValue:n,defaultOptions:r}=e||{},o=[];return i&&(o[0]=[n,a=>a[i],{...r}]),[...o,...t]},Ug=t=>t.split(",").map(e=>e.trim()).some(e=>document.fonts.check("16px "+e)),Gg=(t={})=>["ToggleSlider",{...t}],$w=(t,e={defaultKey:"labelDefault"})=>["Dropdown",{title:i=>i.shapeTitleFontFamily,onload:({options:i=[]})=>{Wp()&&i.map(([n])=>n).filter(Boolean).filter(n=>!Ug(n)).forEach(n=>{const r="PinturaFontTest-"+n.replace(/[^a-zA-Z0-9]+/g,"").toLowerCase();document.getElementById(r)||document.body.append(xn("span",{textContent:" ",id:r,class:"PinturaFontTest",style:`font-family:${n};font-size:0;color:transparent;`}))})},ondestroy:()=>{Wp()&&document.querySelectorAll(".PinturaFontTest").forEach(i=>i.remove())},optionLabelStyle:i=>"font-family: "+i,options:xa(t,e),optionFilter:i=>{if(!Wp())return!0;const[n]=i;return n?Ug(n):!0}}],Fu=(t,e={})=>["ColorPicker",{options:xa(t),...e}],gw=(t,e={})=>Fu(t,{title:i=>i.labelColor,...e}),fw=(t,e={})=>Fu(t,{title:i=>i.shapeTitleBackgroundColor,...e}),yw=(t,e={})=>Fu(t,{title:i=>i.shapeTitleStrokeColor,options:xa(t),buttonClass:"PinturaColorPickerButtonStroke",onchange:(i,n)=>{const r=n.strokeWidth;(hi(r)||_e(r)?parseFloat(r):0)>0||(n.strokeWidth=e&&e.defaultStrokeWidth||"0.5%")},...e}),N2=(t,e)=>{const{title:i,optionHideLabel:n=!1,layout:r,optionIcon:o=!1}=e||{},a=V2(t),s=t.map(([u])=>_e(u)?parseFloat(u):u),l=Math.max(...s),c=Math.min(...s),d=l-c;return[r==="radio"?"RadioGroup":"Dropdown",{title:i===!1?void 0:i||(u=>u.shapeTitleStrokeWidth),options:u=>{const p=e?a.map(h=>{const[g,m,f={}]=h,b=_e(g)?parseFloat(g):g,w=(b-c)/d;let S;return o==="line"?S=`<path stroke="currentColor" stroke-linecap="square" stroke-width="${.1+.875*w}em" d="M3,12 H20"/>`:o==="dot"?S=`<circle fill="currentColor" cx="12" cy="12" r="${2+8*w}"/>`:_e(o)?S=o:on(o)&&(S=o(b,w)),[g,m,{icon:S,hideLabel:n,...f}]}):a;return Ae(u,"backgroundColor")?xa(p,{defaultKey:"shapeLabelStrokeNone"}):xa(p)},onchange:(u,p)=>{if(!u)return;const h=p.strokeColor||[];if(h[3])return;const g=[...h];g[3]=1,p.strokeColor=g}}]},xw=(t,e)=>{const{title:i,layout:n}=e||{};return[n==="radio"?"RadioGroup":"Dropdown",{title:i,options:xa(t)}]},H2=(t,e,i)=>["Dropdown",{title:n=>n[e],options:xa(t,{defaultKey:"labelNone",defaultOptions:{icon:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H14"/></g>'}}),optionIconStyle:i}],bw=t=>H2(t,"shapeTitleLineStart","transform: scaleX(-1)"),vw=t=>H2(t,"shapeTitleLineEnd"),ww=t=>Fu(t,{title:e=>e.shapeTitleTextColor,options:xa(t)}),Sw=t=>["Dropdown",{title:e=>e.shapeTitleFontStyle,optionLabelStyle:e=>e&&`font-style:${e[0]};font-weight:${e[1]}`,options:xa(t,{defaultKey:"shapeLabelFontStyleNormal"})}],j2=t=>["ShorthandControl",t],U2=(t,e,i,n)=>{n||t.find(([o])=>o===i)||(n={defaultKey:"labelAuto",defaultValue:i});const r=V2(t);return["Dropdown",{title:e,options:xa(r,n),...n}]},kw=(t,e)=>U2(t,i=>i.shapeTitleFontSize,"4%",e),Cw=(t,e)=>U2(t,i=>i.shapeTitleLineHeight,"120%",e),Tw=t=>["RadioGroup",{title:e=>e.shapeTitleTextAlign,options:xa(t)}],Vp={colorOptions:()=>cw({transparent:[1,1,1,0],white:[1,1,1],silver:[.8667,.8667,.8667],gray:[.6667,.6667,.6667],black:[0,0,0],navy:[0,.1216,.2471],blue:[0,.4549,.851],aqua:[.498,.8588,1],teal:[.2235,.8,.8],olive:[.2392,.6,.4392],green:[.1804,.8,.251],yellow:[1,.8627,0],orange:[1,.5216,.1059],red:[1,.2549,.2118],maroon:[.5216,.0784,.2941],fuchsia:[.9412,.0706,.7451],purple:[.6941,.051,.7882]}),lineEndStyleOptions:()=>mw(["bar","arrow","arrowSolid","circle","circleSolid","square","squareSolid"]),fontFamilyOptions:()=>pw([["Helvetica, Arial, Verdana, 'Droid Sans', sans-serif","Sans Serif"],["'Arial Black', 'Avenir-Black', 'Arial Bold'","Black"],["'Arial Narrow', 'Futura-CondensedMedium'","Narrow"],["'Trebuchet MS'","Humanist"],["Georgia, 'Avenir-Black', 'Times New Roman', 'Droid Serif', serif","Serif"],["Palatino","Old-Style"],["'Times New Roman', 'TimesNewRomanPSMT'","Transitional"],["Menlo, Monaco, 'Lucida Console', monospace","Monospaced"],["'Courier New', monospace","Slab Serif"]]),fontStyleOptions:()=>hw([["normal","bold"],["italic","normal"],["italic","bold"]]),textAlignOptions:()=>["left","center","right"].map(t=>[t,e=>e["shapeTitleTextAlign"+_l(t)],{hideLabel:!0,icon:e=>e["shapeIconTextAlign"+_l(t)]}]),strokeWidthOptions:()=>jg({extraSmall:"0.25%",small:"0.5%",mediumSmall:"1%",medium:"1.75%",mediumLarge:"2.5%",large:"3.5%",extraLarge:"5%"}),brushSizeOptions:()=>jg(Object.entries({extraSmall:"0.25%",small:"0.5%",mediumSmall:"1%",medium:"1.75%",mediumLarge:"2.5%",large:"3.5%",extraLarge:"5%"}).reduce((t,[e,i])=>(t[e]=2*parseFloat(i)+"%",t),{})),fontSizeOptions:()=>dw({extraSmall:"2%",small:"4%",mediumSmall:"8%",medium:"10%",mediumLarge:"15%",large:"20%",extraLarge:"25%"}),lineHeightOptions:()=>uw({extraSmall:"40%",small:"60%",mediumSmall:"100%",medium:"120%",mediumLarge:"140%",large:"180%",extraLarge:"220%"})},Mw=new Intl.NumberFormat("default",{minimumFractionDigits:1,maximumFractionDigits:1}),G2=(t,e)=>_e(e)?t+"%":t,Z2=(t,e,i,n)=>_e(n)?Math.round(t/i*100)+"%":""+Mw.format(t),Np={getValue:t=>parseFloat(t),setValue:G2,label:Z2,step:.05,labelClass:"PinturaPercentageLabel"},Pw={factory:j2,options:{title:"Text shadow",controls:[["ToggleSlider","x",{...Np,min:-100,max:100,labelPrefix:"X"}],["ToggleSlider","y",{...Np,min:-100,max:100,labelPrefix:"Y"}],["ToggleSlider","blur",{...Np,min:0,max:25,labelPrefix:t=>t.shapeTitleTextShadowBlur}],["ColorPicker","color",{enablePresets:!1}]]}},qd={defaultColor:{factory:gw,items:"colorOptions"},defaultNumber:{factory:Gg},defaultPercentage:{factory:Gg,options:{getValue:t=>parseFloat(t),setValue:t=>t+"%",step:.05,label:(t,e,i)=>Math.round(t/i*100)+"%",labelClass:"PinturaPercentageLabel"}},backgroundColor:{items:"colorOptions",factory:fw},strokeColor:{items:"colorOptions",factory:yw},strokeWidth:{items:"strokeWidthOptions",factory:N2},brushSize:{items:"brushSizeOptions",factory:aw},drawMode:{factory:ow},lineStart:{items:"lineEndStyleOptions",factory:bw},lineEnd:{items:"lineEndStyleOptions",factory:vw},color:{items:"colorOptions",factory:ww},fontFamily:{items:"fontFamilyOptions",factory:$w},fontStyle_fontWeight:{items:"fontStyleOptions",factory:Sw},fontSize:{items:"fontSizeOptions",factory:kw},lineHeight:{items:"lineHeightOptions",factory:Cw},textAlign:{items:"textAlignOptions",factory:Tw},textShadowX_textShadowY_textShadowBlur_textShadowColor:Pw,textOutlineWidth_textOutlineColor:{factory:j2,options:{title:"Text outline",controls:[["ToggleSlider","width",{getValue:t=>parseFloat(t),setValue:G2,label:Z2,min:0,max:15,step:.05,labelClass:"PinturaPercentageLabel",labelPrefix:t=>t.shapeTitleTextOutlineWidth}],["ColorPicker","color",{enablePresets:!1}]]}},cornerRadius:{factory:"defaultPercentage",options:{min:0,max:50,title:t=>t.shapeTitleCornerRadius}},frameColor:{factory:"defaultColor"},frameSize:{factory:"defaultPercentage",options:{min:.2,max:10,title:t=>t.labelSize}},frameInset:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelOffset}},frameOffset:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelOffset}},frameRadius:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelRadius}},frameAmount:{factory:"defaultNumber",options:{min:1,max:5,step:1,title:t=>t.labelAmount}}},X2=(t={})=>{const e={...qd,...t},i={};return Object.entries(e).forEach(([n,r])=>{if(!/Options$/.test(n))if(qd[n]&&sl(r)&&!Rn(r)){const{component:o,factory:a,items:s,options:l={}}=e[n];if(_e(a))i[n]=[a,l];else{const c=qd[n].items;let d=_e(c)?e[c]||Vp[c]():void 0;_e(s)&&Vp[s]?d=e[s]?e[s].every(p=>!Array.isArray(p))?e[s].map(p=>[p,p]):e[s]:Vp[s]():(s||l.items)&&(d=s||l.items);let u=a||qd[n].factory;on(u)?i[n]=d?u(d,l):u(l):o&&(i[n]=[o,{...l,items:s}])}}else i[n]=r}),i};function Rw(t){let e,i,n,r,o;const a=t[7].default,s=rr(a,t,t[6],null);return{c(){e=ht("div"),i=ht("div"),s&&s.c(),v(i,"class","PinturaToolbarInner"),v(e,"class","PinturaToolbar"),v(e,"data-layout",t[1]),v(e,"data-overflow",t[0])},m(l,c){et(l,e,c),Ct(e,i),s&&s.m(i,null),n=!0,r||(o=[Mt(i,"measure",t[3]),Xi(yr.call(null,i)),Mt(e,"measure",t[2]),Xi(yr.call(null,e))],r=!0)},p(l,[c]){s&&s.p&&(!n||64&c)&&ar(s,a,l,l[6],n?or(a,l[6],c,null):sr(l[6]),null),(!n||2&c)&&v(e,"data-layout",l[1]),(!n||1&c)&&v(e,"data-overflow",l[0])},i(l){n||(P(s,l),n=!0)},o(l){z(s,l),n=!1},d(l){l&&Q(e),s&&s.d(l),r=!1,Ui(o)}}}function Iw(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,s=0,l=0,c=0;const d=()=>{i(0,r=n==="compact"&&s>c?"overflow":void 0)};return t.$$set=u=>{"$$scope"in u&&i(6,a=u.$$scope)},t.$$.update=()=>{48&t.$$.dirty&&i(1,n=l>c?"compact":"default")},[r,n,({detail:u})=>{const{width:p}=u;i(5,c=p),d()},({detail:u})=>{const{width:p}=u;p>l&&i(4,l=p),s=p,r||d()},l,c,a,o]}class Y2 extends ci{constructor(e){super(),li(this,e,Iw,Rw,oi,{})}}function Ew(t){let e,i,n,r;const o=t[5].default,a=rr(o,t,t[4],null);return{c(){e=ht("div"),a&&a.c(),v(e,"class",t[0])},m(s,l){et(s,e,l),a&&a.m(e,null),i=!0,n||(r=[Mt(e,"measure",function(){Zi(t[1]&&t[3])&&(t[1]&&t[3]).apply(this,arguments)}),Xi(t[2].call(null,e))],n=!0)},p(s,[l]){t=s,a&&a.p&&(!i||16&l)&&ar(a,o,t,t[4],i?or(o,t[4],l,null):sr(t[4]),null),(!i||1&l)&&v(e,"class",t[0])},i(s){i||(P(a,s),i=!0)},o(s){z(a,s),i=!1},d(s){s&&Q(e),a&&a.d(s),n=!1,Ui(r)}}}function Aw(t,e,i){let{$$slots:n={},$$scope:r}=e;const o=ba();let{class:a=null}=e;const s=sn("measurable");let l=!1;return As(()=>i(1,l=!0)),t.$$set=c=>{"class"in c&&i(0,a=c.class),"$$scope"in c&&i(4,r=c.$$scope)},[a,l,s,({detail:c})=>o("measure",c),r,n]}class Lw extends ci{constructor(e){super(),li(this,e,Aw,Ew,oi,{class:0})}}const zw=t=>({}),Zg=t=>({}),Fw=t=>({}),Xg=t=>({}),Dw=t=>({}),Yg=t=>({});function qg(t){let e,i;const n=t[4].header,r=rr(n,t,t[3],Yg);return{c(){e=ht("div"),r&&r.c(),v(e,"class","PinturaUtilHeader")},m(o,a){et(o,e,a),r&&r.m(e,null),i=!0},p(o,a){r&&r.p&&(!i||8&a)&&ar(r,n,o,o[3],i?or(n,o[3],a,Dw):sr(o[3]),Yg)},i(o){i||(P(r,o),i=!0)},o(o){z(r,o),i=!1},d(o){o&&Q(e),r&&r.d(o)}}}function Kg(t){let e,i;const n=t[4].footer,r=rr(n,t,t[3],Zg);return{c(){e=ht("div"),r&&r.c(),v(e,"class","PinturaUtilFooter")},m(o,a){et(o,e,a),r&&r.m(e,null),i=!0},p(o,a){r&&r.p&&(!i||8&a)&&ar(r,n,o,o[3],i?or(n,o[3],a,zw):sr(o[3]),Zg)},i(o){i||(P(r,o),i=!0)},o(o){z(r,o),i=!1},d(o){o&&Q(e),r&&r.d(o)}}}function Bw(t){let e,i,n,r,o,a,s=t[1]&&qg(t);const l=t[4].main,c=rr(l,t,t[3],Xg),d=c||function(p){let h,g;return h=new Lw({props:{class:"PinturaStage"}}),h.$on("measure",p[5]),{c(){Et(h.$$.fragment)},m(m,f){Rt(h,m,f),g=!0},p:ni,i(m){g||(P(h.$$.fragment,m),g=!0)},o(m){z(h.$$.fragment,m),g=!1},d(m){It(h,m)}}}(t);let u=t[2]&&Kg(t);return{c(){s&&s.c(),e=pe(),i=ht("div"),d&&d.c(),n=pe(),u&&u.c(),r=pe(),o=Tn(),v(i,"class","PinturaUtilMain")},m(p,h){s&&s.m(p,h),et(p,e,h),et(p,i,h),d&&d.m(i,null),t[6](i),et(p,n,h),u&&u.m(p,h),et(p,r,h),et(p,o,h),a=!0},p(p,[h]){p[1]?s?(s.p(p,h),2&h&&P(s,1)):(s=qg(p),s.c(),P(s,1),s.m(e.parentNode,e)):s&&(Ie(),z(s,1,1,()=>{s=null}),Ee()),c&&c.p&&(!a||8&h)&&ar(c,l,p,p[3],a?or(l,p[3],h,Fw):sr(p[3]),Xg),p[2]?u?(u.p(p,h),4&h&&P(u,1)):(u=Kg(p),u.c(),P(u,1),u.m(r.parentNode,r)):u&&(Ie(),z(u,1,1,()=>{u=null}),Ee())},i(p){a||(P(s),P(d,p),P(u),P(!1),a=!0)},o(p){z(s),z(d,p),z(u),z(!1),a=!1},d(p){s&&s.d(p),p&&Q(e),p&&Q(i),d&&d.d(p),t[6](null),p&&Q(n),u&&u.d(p),p&&Q(r),p&&Q(o)}}}function Ow(t,e,i){let{$$slots:n={},$$scope:r}=e,{hasHeader:o=!!e.$$slots.header}=e,{hasFooter:a=!!e.$$slots.footer}=e,{root:s}=e;return t.$$set=l=>{i(7,e=Cn(Cn({},e),Dc(l))),"hasHeader"in l&&i(1,o=l.hasHeader),"hasFooter"in l&&i(2,a=l.hasFooter),"root"in l&&i(0,s=l.root),"$$scope"in l&&i(3,r=l.$$scope)},e=Dc(e),[s,o,a,r,n,function(l){Wr.call(this,t,l)},function(l){zi[l?"unshift":"push"](()=>{s=l,i(0,s)})}]}class dl extends ci{constructor(e){super(),li(this,e,Ow,Bw,oi,{hasHeader:1,hasFooter:2,root:0})}}function Jg(t){let e,i;return{c(){e=ht("div"),v(e,"class","PinturaRangeInputMeter"),v(e,"style",i=`transform: translateX(${t[9].x-t[12].x}px) translateY(${t[9].y-t[12].y}px)`)},m(n,r){et(n,e,r),e.innerHTML=t[7]},p(n,r){128&r[0]&&(e.innerHTML=n[7]),512&r[0]&&i!==(i=`transform: translateX(${n[9].x-n[12].x}px) translateY(${n[9].y-n[12].y}px)`)&&v(e,"style",i)},d(n){n&&Q(e)}}}function Ww(t){let e,i,n,r,o,a,s,l,c,d,u,p=t[9]&&Jg(t);return{c(){e=ht("div"),i=ht("span"),n=pe(),r=ht("button"),o=mn(t[1]),s=pe(),l=ht("div"),p&&p.c(),v(i,"class","PinturaRangeInputValue"),v(r,"class","PinturaRangeInputReset"),v(r,"type","button"),r.disabled=a=t[0]===t[2],v(l,"class","PinturaRangeInputInner"),v(l,"style",t[8]),v(l,"data-value-limited",t[5]),v(e,"class","PinturaRangeInput"),v(e,"tabindex","0")},m(h,g){et(h,e,g),Ct(e,i),i.innerHTML=t[3],Ct(e,n),Ct(e,r),Ct(r,o),Ct(e,s),Ct(e,l),p&&p.m(l,null),d||(u=[Mt(r,"click",t[17]),Mt(l,"interactionstart",t[13]),Mt(l,"interactionupdate",t[15]),Mt(l,"interactionend",t[16]),Mt(l,"interactionrelease",t[14]),Xi(c=Fs.call(null,l,{inertia:t[6]})),Mt(l,"measure",t[37]),Xi(yr.call(null,l)),Mt(e,"wheel",t[19],{passive:!1}),Mt(e,"nudge",t[20]),Xi(Ds.call(null,e,{direction:"horizontal",preventDefault:!0}))],d=!0)},p(h,g){8&g[0]&&(i.innerHTML=h[3]),2&g[0]&&In(o,h[1]),5&g[0]&&a!==(a=h[0]===h[2])&&(r.disabled=a),h[9]?p?p.p(h,g):(p=Jg(h),p.c(),p.m(l,null)):p&&(p.d(1),p=null),256&g[0]&&v(l,"style",h[8]),32&g[0]&&v(l,"data-value-limited",h[5]),c&&Zi(c.update)&&64&g[0]&&c.update.call(null,{inertia:h[6]})},i:ni,o:ni,d(h){h&&Q(e),p&&p.d(),d=!1,Ui(u)}}}function _w(t,e,i){let n,r,o,a,s,l,c,d,u,p,{labelReset:h="Reset"}=e,{direction:g="x"}=e,{min:m=0}=e,{max:f=1}=e,{base:b=m}=e,{value:w=0}=e,{valueLabel:S=0}=e,{valueMin:C}=e,{valueMax:I}=e,{oninputstart:M=me}=e,{oninputmove:D=me}=e,{oninputend:T=me}=e,{elasticity:F=0}=e,{nudgeMultiplier:W}=e,{step:O=8}=e;const y=sn("isAnimated");A(t,y,nt=>i(6,d=nt));const V=sn("fixScrollDirection");A(t,V,nt=>i(43,u=nt));const tt=(nt,mt,zt)=>Math.ceil((nt-zt)/mt)*mt+zt;let k,N,it;const ut={x:2,y:0},at=(nt,mt,zt)=>`M ${nt-zt} ${mt} a ${zt} ${zt} 0 1 0 0 -1`;let gt,G,$t=!1,vt={snap:!1,elastic:!1};const lt=(nt,mt,zt)=>{const oe=nt[g]+mt[g],Dt=tn(oe,gt[1][g],gt[0][g]),te=F?Dt+vs(oe-Dt,F):Dt,Kt=zt.elastic?te:Dt,U=ot(0,0);return U[g]=Kt,kt.set(U,{hard:zt.snap}),tn(q(U,g),m,f)},kt=pi();A(t,kt,nt=>i(9,p=nt));const J=(nt,mt)=>{const zt=.5*(k[mt]-a[mt])-(Mc(nt,m,f)*a[mt]-.5*a[mt]);return{x:mt==="x"?zt:0,y:mt==="y"?zt:0}},q=(nt,mt)=>{const zt=-(nt[mt]-.5*k[mt])/a[mt];return m+zt*n},Z=kt.subscribe(nt=>{nt&&G&&D(tn(q(nt,g),m,f))}),xt=nt=>{const mt=[J(C??m,g),J(I??f,g)],zt={x:g==="x"?p.x+nt:0,y:g==="y"?p.y+nt:0},oe=tn(zt[g],mt[1][g],mt[0][g]),Dt={...p,[g]:oe};wt(kt,p=Dt,p);const te=tn(q(Dt,g),m,f);M(),D(te),T(te)};return _o(()=>{Z()}),t.$$set=nt=>{"labelReset"in nt&&i(1,h=nt.labelReset),"direction"in nt&&i(21,g=nt.direction),"min"in nt&&i(22,m=nt.min),"max"in nt&&i(23,f=nt.max),"base"in nt&&i(2,b=nt.base),"value"in nt&&i(0,w=nt.value),"valueLabel"in nt&&i(3,S=nt.valueLabel),"valueMin"in nt&&i(24,C=nt.valueMin),"valueMax"in nt&&i(25,I=nt.valueMax),"oninputstart"in nt&&i(26,M=nt.oninputstart),"oninputmove"in nt&&i(27,D=nt.oninputmove),"oninputend"in nt&&i(28,T=nt.oninputend),"elasticity"in nt&&i(29,F=nt.elasticity),"nudgeMultiplier"in nt&&i(30,W=nt.nudgeMultiplier),"step"in nt&&i(31,O=nt.step)},t.$$.update=()=>{if(12582912&t.$$.dirty[0]&&i(33,n=f-m),20971520&t.$$.dirty[0]&&i(35,r=C!=null?Math.max(C,m):m),41943040&t.$$.dirty[0]&&i(34,o=I!=null?Math.min(I,f):f),12582916&t.$$.dirty[0]&&i(36,s=Mc(b,m,f)),16&t.$$.dirty[0]|32&t.$$.dirty[1]&&k){const nt=.5*k.y;let mt,zt=40*s,oe="",Dt=k.y,te="";for(let Kt=0;Kt<=40;Kt++){const U=ut.x+10*Kt,Tt=nt;oe+=at(U,Tt,Kt%5==0?2:.75)+" ",mt=U+ut.x,Kt===zt&&(te=`<path d="M${U} ${Tt-4} l2 3 l-2 -1 l-2 1 z"/>`)}i(7,N=`<svg width="${mt}" height="${Dt}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${mt} ${Dt}" aria-hidden="true" focusable="false">
        ${te}
        <rect rx="4" ry="4" y="${nt-4}"" height="8"/>
        <path fill-rule="evenodd" d="${oe.trim()}"/></svg>`),i(32,it={x:mt-2*ut.x,y:Dt})}16&t.$$.dirty[0]|2&t.$$.dirty[1]&&(a=k&&it),12582912&t.$$.dirty[0]|24&t.$$.dirty[1]&&i(5,l=r!==m||o!==f),32&t.$$.dirty[0]|24&t.$$.dirty[1]&&i(8,c=l?function(nt,mt){const oe=Mc(nt,m,f),Dt=Mc(mt,m,f);return`--range-mask-from:${100*si(tt(oe,.025,0)-.0125)}%;--range-mask-to:${100*si(tt(Dt,.025,0)-.0125)}%`}(r,o):""),2097233&t.$$.dirty[0]|4&t.$$.dirty[1]&&n&&k&&k.x&&k.y&&kt.set(J(w,g),{hard:d===!1})},[w,h,b,S,k,l,d,N,c,p,y,V,ut,()=>{$t=!1,G=fa(kt),gt=[J(C??m,g),J(I??f,g)],M()},()=>{$t=!0},({detail:nt})=>{vt.snap=!$t,vt.elastic=!$t,lt(G,nt.translation,vt)},({detail:nt})=>{vt.snap=!1,vt.elastic=!1;const mt=lt(G,nt.translation,vt);if(G=void 0,gt=void 0,Math.abs(mt-b)<.01)return T(b);T(mt)},()=>{i(0,w=tn(b,r,o)),M(),T(w)},kt,nt=>{nt.preventDefault(),nt.stopPropagation();const mt=Au(nt,{fixScrollDirection:u})*O;xt(mt)},({detail:nt})=>{xt(nt[g]*Math.abs(W||8))},g,m,f,C,I,M,D,T,F,W,O,it,n,o,r,s,nt=>i(4,k=(mt=>ot(mt.width,mt.height))(nt.detail))]}class t0 extends ci{constructor(e){super(),li(this,e,_w,Ww,oi,{labelReset:1,direction:21,min:22,max:23,base:2,value:0,valueLabel:3,valueMin:24,valueMax:25,oninputstart:26,oninputmove:27,oninputend:28,elasticity:29,nudgeMultiplier:30,step:31},null,[-1,-1])}}var Vw={[Ms]:t=>({x:t.x,y:t.y}),[ra]:t=>({x:t.x+t.width,y:t.y}),[Ps]:t=>({x:t.x+t.width,y:t.y}),[oa]:t=>({x:t.x+t.width,y:t.y+t.height}),[Rs]:t=>({x:t.x,y:t.y+t.height}),[aa]:t=>({x:t.x,y:t.y+t.height}),[Is]:t=>({x:t.x,y:t.y}),[na]:t=>({x:t.x,y:t.y})};function Qg(t,e,i){const n=t.slice();return n[14]=e[i].key,n[15]=e[i].translate,n[16]=e[i].scale,n[17]=e[i].type,n[18]=e[i].opacity,n}function tf(t,e){let i,n,r,o,a,s,l,c;return{key:t,first:null,c(){i=ht("div"),v(i,"role","button"),v(i,"aria-label",n=`Drag ${e[17]} ${e[14]}`),v(i,"tabindex",r=e[17]==="edge"?-1:0),v(i,"class","PinturaRectManipulator"),v(i,"data-direction",o=e[14]),v(i,"data-shape",a=e[17]==="edge"?"edge":""+e[0]),v(i,"style",s=`--tx:${e[15].x};--ty:${e[15].y};--sx:${e[16].x};--sy:${e[16].y};opacity:${e[18]}`),this.first=i},m(d,u){et(d,i,u),l||(c=[Mt(i,"nudge",function(){Zi(e[6](e[14]))&&e[6](e[14]).apply(this,arguments)}),Xi(Ds.call(null,i,{preventDefault:!0})),Mt(i,"interactionstart",function(){Zi(e[5]("resizestart",e[14]))&&e[5]("resizestart",e[14]).apply(this,arguments)}),Mt(i,"interactionupdate",function(){Zi(e[5]("resizemove",e[14]))&&e[5]("resizemove",e[14]).apply(this,arguments)}),Mt(i,"interactionend",function(){Zi(e[5]("resizeend",e[14]))&&e[5]("resizeend",e[14]).apply(this,arguments)}),Xi(Fs.call(null,i))],l=!0)},p(d,u){e=d,2&u&&n!==(n=`Drag ${e[17]} ${e[14]}`)&&v(i,"aria-label",n),2&u&&r!==(r=e[17]==="edge"?-1:0)&&v(i,"tabindex",r),2&u&&o!==(o=e[14])&&v(i,"data-direction",o),3&u&&a!==(a=e[17]==="edge"?"edge":""+e[0])&&v(i,"data-shape",a),2&u&&s!==(s=`--tx:${e[15].x};--ty:${e[15].y};--sx:${e[16].x};--sy:${e[16].y};opacity:${e[18]}`)&&v(i,"style",s)},d(d){d&&Q(i),l=!1,Ui(c)}}}function Nw(t){let e,i=[],n=new Map,r=t[1];const o=a=>a[14];for(let a=0;a<r.length;a+=1){let s=Qg(t,r,a),l=o(s);n.set(l,i[a]=tf(l,s))}return{c(){for(let a=0;a<i.length;a+=1)i[a].c();e=Tn()},m(a,s){for(let l=0;l<i.length;l+=1)i[l].m(a,s);et(a,e,s)},p(a,[s]){99&s&&(r=a[1],i=La(i,s,o,1,a,r,n,e.parentNode,qy,tf,e,Qg))},i:ni,o:ni,d(a){for(let s=0;s<i.length;s+=1)i[s].d(a);a&&Q(e)}}}function Hw(t,e,i){let n,r,o,a,{rect:s=null}=e,{visible:l=!1}=e,{style:c}=e;const d=sn("isAnimated");A(t,d,m=>i(11,a=m));const u=pi(void 0,{precision:1e-4,stiffness:.2,damping:.4});A(t,u,m=>i(10,o=m));const p=pi(0,{precision:.001});let h;A(t,p,m=>i(9,r=m));const g=ba();return t.$$set=m=>{"rect"in m&&i(7,s=m.rect),"visible"in m&&i(8,l=m.visible),"style"in m&&i(0,c=m.style)},t.$$.update=()=>{2304&t.$$.dirty&&u.set(l?1:.5,{hard:a===!1}),2304&t.$$.dirty&&p.set(l?1:0,{hard:a===!1}),1664&t.$$.dirty&&i(1,n=Object.keys(jp).map((m,f)=>{const b=jp[m],w=Vw[b](s),S=b.length===1?"edge":"corner",C=S==="corner";return{key:b,type:S,scale:{x:/^(t|b)$/.test(b)?s.width:C?tn(o,.5,1.25):1,y:/^(r|l)$/.test(b)?s.height:C?tn(o,.5,1.25):1},translate:{x:w.x,y:w.y},opacity:r}}))},[c,n,d,u,p,(m,f)=>({detail:b})=>{h&&f!==h||m!=="resizestart"&&h===void 0||(m==="resizestart"&&(h=f),m==="resizeend"&&(h=void 0),g(m,{direction:f,translation:b&&b.translation}))},m=>({detail:f})=>{g("resizestart",{direction:m,translation:{x:0,y:0}}),g("resizemove",{direction:m,translation:f}),g("resizeend",{direction:m,translation:{x:0,y:0}})},s,l,r,o,a]}class jw extends ci{constructor(e){super(),li(this,e,Hw,Nw,oi,{rect:7,visible:8,style:0})}}var Uw=t=>{function e(a,s){t.dispatchEvent(new CustomEvent(a,{detail:s}))}const i=a=>{a.preventDefault(),t.addEventListener("gesturechange",n),t.addEventListener("gestureend",r),e("gesturedown")},n=a=>{a.preventDefault(),e("gestureupdate",a.scale)},r=a=>{e("gestureup",a.scale),a.preventDefault(),o()},o=()=>{t.removeEventListener("gesturechange",n),t.removeEventListener("gestureend",r)};return t.addEventListener("gesturestart",i),{destroy:()=>{o(),t.removeEventListener("gesturestart",i)}}},e0={[Ms]:Rs,[Ps]:Is,[Rs]:Ms,[Is]:Ps,[na]:oa,[ra]:aa,[oa]:na,[aa]:ra},i0=t=>{const e=t===Is||t===Ps,i=t===Ms||t===Rs;return[t===Ps||t===ra||t===oa,t===Is||t===aa||t===na,t===Ms||t===ra||t===na,t===Rs||t===oa||t===aa,e,i,e||i]},ef=(t,e,i,n={})=>{const{target:r,translate:o}=e,{aspectRatio:a,minSize:s,maxSize:l}=n,c=Lc[e0[r]],d=Dn(ot(t.x,t.y),ot(c[0]*t.width,c[1]*t.height)),u=Lc[r],p=Dn(Si(t),ot(u[0]*t.width,u[1]*t.height)),[h,g,m,f,b,w,S]=i0(r);let C=o.x,I=o.y;b?I=0:w&&(C=0);const{inner:M,outer:D}=Gw(d,r,i,{aspectRatio:a,minSize:s,maxSize:l});let[T,F,W,O]=al(t);if(h?O=d.x:g&&(F=d.x),f?T=d.y:m&&(W=d.y),h){const y=M.x+M.width,V=D.x+D.width;F=tn(p.x+C,y,V)}else if(g){const y=D.x,V=M.x;O=tn(p.x+C,y,V)}if(f){const y=M.y+M.height,V=D.y+D.height;W=tn(p.y+I,y,V)}else if(m){const y=D.y,V=M.y;T=tn(p.y+I,y,V)}if(O>M.x&&(O=M.x),F<M.x+M.width&&(F=M.x+M.width),T>M.y&&(T=M.y),W<M.y+M.height&&(W=M.y+M.height),O<D.x){const y=D.x-O;O=D.x,F+=y}if(F>D.x+D.width){const y=F-(D.x+D.width);F=D.x+D.width,O-=y}if(T<D.y){const y=D.y-T;T=D.y,W+=y}if(W>D.y+D.height){const y=W-(D.y+D.height);W=D.y+D.height,T-=y}if(a)if(S){let y=F-O,V=W-T;b?(V=y/a,T=d.y-.5*V,W=d.y+.5*V):w&&(y=V*a,O=d.x-.5*y,F=d.x+.5*y)}else{const y=ot(p.x+C-d.x,p.y+I-d.y);r===ra?(y.x=Math.max(0,y.x),y.y=Math.min(0,y.y)):r===oa?(y.x=Math.max(0,y.x),y.y=Math.max(0,y.y)):r===aa?(y.x=Math.min(0,y.x),y.y=Math.max(0,y.y)):r===na&&(y.x=Math.min(0,y.x),y.y=Math.min(0,y.y));const V=ws(y),tt=ws(ot(M.width,M.height)),k=ws(ot(D.width,D.height)),N=tn(V,tt,k),it=ot(a,1),ut=Mr(ro(it),N);r===ra?(F=d.x+ut.x,T=d.y-ut.y):r===oa?(F=d.x+ut.x,W=d.y+ut.y):r===aa?(O=d.x-ut.x,W=d.y+ut.y):r===na&&(O=d.x-ut.x,T=d.y-ut.y)}return Pn(O,T,F-O,W-T)};const Gw=(t,e,i,n)=>{const{aspectRatio:r,minSize:o,maxSize:a}=n,s=e===Ps||e===ra||e===oa,l=e===Is||e===aa||e===na,c=e===Ms||e===ra||e===na,d=e===Rs||e===oa||e===aa,u=e===Is||e===Ps,p=e===Ms||e===Rs,h=Si(i);s?(h.x=t.x,h.width-=t.x):l&&(h.width=t.x),d?(h.y=t.y,h.height-=t.y):c&&(h.height=t.y);const g=((M,D)=>sa(0,0,M,D))(Math.min(h.width,a.width),Math.min(h.height,a.height));if(r){if(u){const M=Math.min(t.y,i.height-t.y);g.height=Math.min(2*M,g.height)}else if(p){const M=Math.min(t.x,i.width-t.x);g.width=Math.min(2*M,g.width)}}const m=r?ol(rs(Or(o),r)):o,f=r?ol(Yr(g,r)):g;let b,w,S,C;s?b=t.x:l&&(w=t.x),d?S=t.y:c&&(C=t.y),s?w=b+m.width:l&&(b=w-m.width),d?C=S+m.height:c&&(S=C-m.height),u?(S=t.y-.5*m.height,C=t.y+.5*m.height):p&&(b=t.x-.5*m.width,w=t.x+.5*m.width);const I=er([ot(b,S),ot(w,C)]);return s?w=b+f.width:l&&(b=w-f.width),d?C=S+f.height:c&&(S=C-f.height),u?(S=t.y-.5*f.height,C=t.y+.5*f.height):p&&(b=t.x-.5*f.width,w=t.x+.5*f.width),b=Math.max(i.x,b),w=Math.min(i.x+i.width,w),S=Math.max(i.y,S),C=Math.min(i.y+i.height,C),{inner:I,outer:er([ot(b,S),ot(w,C)])}};var nf=t=>180*t/Math.PI;function Zw(t){let e,i,n;return i=new t0({props:{elasticity:t[5],min:t[9],max:t[10],value:t[11],valueMin:Math.max(t[9],t[0]),valueMax:Math.min(t[10],t[1]),labelReset:t[6],base:t[12],valueLabel:Math.round(nf(t[11]))+"&deg;",oninputstart:t[2],oninputmove:t[17],oninputend:t[18]}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaImageRotator")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,[o]){const a={};32&o&&(a.elasticity=r[5]),512&o&&(a.min=r[9]),1024&o&&(a.max=r[10]),2048&o&&(a.value=r[11]),513&o&&(a.valueMin=Math.max(r[9],r[0])),1026&o&&(a.valueMax=Math.min(r[10],r[1])),64&o&&(a.labelReset=r[6]),4096&o&&(a.base=r[12]),2048&o&&(a.valueLabel=Math.round(nf(r[11]))+"&deg;"),4&o&&(a.oninputstart=r[2]),392&o&&(a.oninputmove=r[17]),400&o&&(a.oninputend=r[18]),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function Xw(t,e,i){let n,r,o,a,s,l,c,{rotation:d}=e,{valueMin:u}=e,{valueMax:p}=e,{oninputstart:h=me}=e,{oninputmove:g=me}=e,{oninputend:m=me}=e,{elasticity:f=0}=e,{labelReset:b}=e,{rotationMin:w}=e,{rotationMax:S}=e;return t.$$set=C=>{"rotation"in C&&i(13,d=C.rotation),"valueMin"in C&&i(0,u=C.valueMin),"valueMax"in C&&i(1,p=C.valueMax),"oninputstart"in C&&i(2,h=C.oninputstart),"oninputmove"in C&&i(3,g=C.oninputmove),"oninputend"in C&&i(4,m=C.oninputend),"elasticity"in C&&i(5,f=C.elasticity),"labelReset"in C&&i(6,b=C.labelReset),"rotationMin"in C&&i(14,w=C.rotationMin),"rotationMax"in C&&i(15,S=C.rotationMax)},t.$$.update=()=>{16384&t.$$.dirty&&i(9,n=w+1e-9),32768&t.$$.dirty&&i(10,r=S-1e-9),1536&t.$$.dirty&&i(12,o=n+.5*(r-n)),32768&t.$$.dirty&&i(16,a=2*S),8192&t.$$.dirty&&i(8,s=Math.sign(d)),73728&t.$$.dirty&&i(7,l=Math.round(Math.abs(d)/a)*a),8576&t.$$.dirty&&i(11,c=d-s*l)},[u,p,h,g,m,f,b,l,s,n,r,c,o,d,w,S,a,C=>g(s*l+C),C=>m(s*l+C)]}class Yw extends ci{constructor(e){super(),li(this,e,Xw,Zw,oi,{rotation:13,valueMin:0,valueMax:1,oninputstart:2,oninputmove:3,oninputend:4,elasticity:5,labelReset:6,rotationMin:14,rotationMax:15})}}function qw(t){let e,i,n,r,o;return{c(){e=ht("div"),i=ht("p"),n=mn(t[0]),r=mn(" Ã "),o=mn(t[1]),v(e,"class","PinturaImageInfo")},m(a,s){et(a,e,s),Ct(e,i),Ct(i,n),Ct(i,r),Ct(i,o)},p(a,[s]){1&s&&In(n,a[0]),2&s&&In(o,a[1])},i:ni,o:ni,d(a){a&&Q(e)}}}function Kw(t,e,i){let{width:n}=e,{height:r}=e;return t.$$set=o=>{"width"in o&&i(0,n=o.width),"height"in o&&i(1,r=o.height)},[n,r]}class Jw extends ci{constructor(e){super(),li(this,e,Kw,qw,oi,{width:0,height:1})}}function Qw(t){let e,i;return e=new as({props:{class:"PinturaPresetListFilter",layout:"row",options:t[8],selectedIndex:t[7],onchange:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};256&r&&(o.options=n[8]),128&r&&(o.selectedIndex=n[7]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function tS(t){let e,i;return e=new qh({props:{icon:t[0],label:t[1],labelClass:t[2],hideLabel:t[3],options:t[9],selectedIndex:t[4],onchange:t[5],optionMapper:t[6],$$slots:{controls:[Qw]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,[r]){const o={};1&r&&(o.icon=n[0]),2&r&&(o.label=n[1]),4&r&&(o.labelClass=n[2]),8&r&&(o.hideLabel=n[3]),512&r&&(o.options=n[9]),16&r&&(o.selectedIndex=n[4]),32&r&&(o.onchange=n[5]),64&r&&(o.optionMapper=n[6]),262528&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}const rf='fill="none" stroke="currentColor"';function eS(t,e,i){let n,r,o,{icon:a}=e,{label:s}=e,{labelClass:l}=e,{hideLabel:c}=e,{options:d}=e,{selectedIndex:u}=e,{onchange:p}=e,{optionMapper:h}=e,{filter:g="landscape"}=e,{onfilterchange:m=me}=e;const f=(w,S,C,I,M)=>`
    <rect ${rf} x="${w}" y="${S}" width="${C}" height="${I}" rx="${M}"/>`,b=(w,S)=>`<path ${rf} d="M${w} ${S} l2 2 l3 -4"/>`;return t.$$set=w=>{"icon"in w&&i(0,a=w.icon),"label"in w&&i(1,s=w.label),"labelClass"in w&&i(2,l=w.labelClass),"hideLabel"in w&&i(3,c=w.hideLabel),"options"in w&&i(12,d=w.options),"selectedIndex"in w&&i(4,u=w.selectedIndex),"onchange"in w&&i(5,p=w.onchange),"optionMapper"in w&&i(6,h=w.optionMapper),"filter"in w&&i(11,g=w.filter),"onfilterchange"in w&&i(13,m=w.onfilterchange)},t.$$.update=()=>{6144&t.$$.dirty&&i(9,n=((w,S)=>(w||[]).map(C=>_e(C[0])?(C[1]=C[1].map(S),C):S(C)))(d,(w=>S=>{const[C,I,M={}]=S;return hi(C)&&(M.hidden=w==="landscape"?C<1:C>1),[C,I,M]})(g))),2048&t.$$.dirty&&i(7,r=g==="landscape"?0:1),128&t.$$.dirty&&i(8,o=[["landscape","Landscape",{hideLabel:!0,icon:f(2,6,19,12,2)+(r===0?b(9,12):"")}],["portrait","Portrait",{hideLabel:!0,icon:f(5,3,13,18,2)+(r===1?b(9,12):"")}]])},[a,s,l,c,u,p,h,r,o,n,w=>{i(11,g=w.value),m(w.value)},g,d,m]}class iS extends ci{constructor(e){super(),li(this,e,eS,tS,oi,{icon:0,label:1,labelClass:2,hideLabel:3,options:12,selectedIndex:4,onchange:5,optionMapper:6,filter:11,onfilterchange:13})}}const of=t=>bo(t,e=>si(e,6)),af=t=>Bo(t,e=>si(e,6)),gs=(t,e,i=1e-4)=>Math.abs(t-e)<i;var nS=(t,e,i,n,r={})=>{const{aspectRatio:o}=r;t=af(t),n=n.map(of);const a=ym(t,e0[i.target]),s=bo(a,b=>si(b,6)),l=o?rs(r.minSize,o):r.minSize,c=o?Yr(r.maxSize,o):r.maxSize,d=ym(e,i.target);if(ho(d,a)<1){e=Si(t);const b=Math.min(l.width/t.width,l.height/t.height);Tr(e,b,a)}e=fm(Si(e),l,c,a);let u=Si(e);e=af(e);const p=cy(n,1),h=Oo(t),g=Oo(e),m=h.findIndex(b=>bs(bo(b,w=>si(w,6)),s)),f=b=>p.map(w=>wh(w,b)).filter(Boolean).pop();if(o){const b=g.map((w,S)=>{if(S===m)return;const C=ot(a.x-w.x,a.y-w.y);ro(C),Mr(C,.5);const I=ot(a.x-C.x,a.y-C.y),M=Es(I,of(w)),D=f(M);if(!D)return;const T=h[S];return{intersection:D,cornerDist:ho(a,T),intersectionDist:ho(a,D)}}).filter(Boolean);if(b.length){const w=b.reduce((S,C)=>{const I=C.intersectionDist/C.cornerDist;return I<S?I:S},Number.MAX_SAFE_INTEGER);u=Si(t),Tr(u,w,a)}}else{const b=i.target.length===1,w=!(n[0].y===n[1].y||n[0].x===n[1].x),S=h.map((C,I)=>{if(I===m)return;const M=g[I],D=!gs(M.x,s.x)&&!gs(M.y,s.y);if(!b&&!w&&D||b&&(gs(M.x,s.x)||gs(M.y,s.y)))return;const T=Be(b?C:a),F=Bn(Be(T),M);ro(F),Mr(F,.5),b?Dn(T,F):Bn(T,F);const W=Es(T,M);return f(W)||void 0}).filter(Boolean);if(S.length){const[C,I,M,D]=i0(i.target);let[T,F,W,O]=al(e);S.forEach(({x:y,y:V})=>{const tt=si(y,6),k=si(V,6);M&&!gs(k,s.y)&&(T=Math.max(T,V)),C&&!gs(tt,s.x)&&(F=Math.min(F,y)),D&&!gs(k,s.y)&&(W=Math.min(W,V)),I&&!gs(tt,s.x)&&(O=Math.max(O,y))}),u=ob([T,F,W,O]),Tr(u,.9999,a)}}return fm(u,l,c,a),u};function rS(t){let e,i;return e=new oo({props:{items:t[11]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};2048&r[0]&&(o.items=n[11]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function oS(t){let e,i,n;return i=new Y2({props:{$$slots:{default:[rS]},$$scope:{ctx:t}}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"slot","header")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};2048&o[0]|4&o[7]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function sf(t){let e,i;return e=new zs({props:{onclick:t[88],label:t[4].cropLabelButtonRecenter,icon:t[4].cropIconButtonRecenter,class:"PinturaButtonCenter",disabled:!t[9],hideLabel:!0,style:`opacity: ${t[29]}; transform: translate3d(${t[30].x}px, ${t[30].y}px, 0)`}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.label=n[4].cropLabelButtonRecenter),16&r[0]&&(o.icon=n[4].cropIconButtonRecenter),512&r[0]&&(o.disabled=!n[9]),1610612736&r[0]&&(o.style=`opacity: ${n[29]}; transform: translate3d(${n[30].x}px, ${n[30].y}px, 0)`),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function lf(t){let e,i;return e=new jw({props:{rect:t[8],visible:t[12],style:t[1]}}),e.$on("resizestart",t[68]),e.$on("resizemove",t[69]),e.$on("resizeend",t[70]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};256&r[0]&&(o.rect=n[8]),4096&r[0]&&(o.visible=n[12]),2&r[0]&&(o.style=n[1]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function cf(t){let e,i;return e=new Jw({props:{width:Math.round(t[13].width),height:Math.round(t[13].height)}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8192&r[0]&&(o.width=Math.round(n[13].width)),8192&r[0]&&(o.height=Math.round(n[13].height)),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function aS(t){let e,i,n,r,o,a,s,l,c=t[21]&&t[10]&&sf(t),d=t[21]&&lf(t),u=t[22]&&cf(t);return{c(){e=ht("div"),i=ht("div"),c&&c.c(),n=pe(),d&&d.c(),o=pe(),u&&u.c(),v(i,"class","PinturaStage"),v(e,"slot","main")},m(p,h){et(p,e,h),Ct(e,i),c&&c.m(i,null),Ct(i,n),d&&d.m(i,null),t[162](i),Ct(e,o),u&&u.m(e,null),a=!0,s||(l=[Xi(yr.call(null,i)),Mt(i,"measure",t[160]),Mt(i,"wheel",function(){Zi(t[2]&&t[87])&&(t[2]&&t[87]).apply(this,arguments)},{passive:!1}),Mt(i,"interactionstart",t[74]),Mt(i,"interactionupdate",t[75]),Mt(i,"interactionrelease",t[77]),Mt(i,"interactionend",t[76]),Xi(r=Fs.call(null,i,{drag:!0,inertia:!0,pinch:t[2],shouldStartInteraction:uf,getEventPosition:t[163]})),Mt(i,"gesturedown",t[84]),Mt(i,"gestureupdate",t[85]),Mt(i,"gestureup",t[86]),Xi(Uw.call(null,i))],s=!0)},p(p,h){(t=p)[21]&&t[10]?c?(c.p(t,h),2098176&h[0]&&P(c,1)):(c=sf(t),c.c(),P(c,1),c.m(i,n)):c&&(Ie(),z(c,1,1,()=>{c=null}),Ee()),t[21]?d?(d.p(t,h),2097152&h[0]&&P(d,1)):(d=lf(t),d.c(),P(d,1),d.m(i,null)):d&&(Ie(),z(d,1,1,()=>{d=null}),Ee()),r&&Zi(r.update)&&16777220&h[0]&&r.update.call(null,{drag:!0,inertia:!0,pinch:t[2],shouldStartInteraction:uf,getEventPosition:t[163]}),t[22]?u?(u.p(t,h),4194304&h[0]&&P(u,1)):(u=cf(t),u.c(),P(u,1),u.m(e,null)):u&&(Ie(),z(u,1,1,()=>{u=null}),Ee())},i(p){a||(P(c),P(d),P(u),a=!0)},o(p){z(c),z(d),z(u),a=!1},d(p){p&&Q(e),c&&c.d(),d&&d.d(),t[162](null),u&&u.d(),s=!1,Ui(l)}}}function df(t){let e,i,n,r;const o=[{class:"PinturaControlList"},{tabs:t[7]},t[18]];let a={$$slots:{default:[sS,({tab:c})=>({218:c}),({tab:c})=>[0,0,0,0,0,0,0,c?2:0]]},$$scope:{ctx:t}};for(let c=0;c<o.length;c+=1)a=Cn(a,o[c]);e=new Iu({props:a}),e.$on("select",t[161]);const s=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[17]},t[18]];let l={$$slots:{default:[dS,({panel:c})=>({217:c}),({panel:c})=>[0,0,0,0,0,0,0,c?1:0]]},$$scope:{ctx:t}};for(let c=0;c<s.length;c+=1)l=Cn(l,s[c]);return n=new Eu({props:l}),{c(){Et(e.$$.fragment),i=pe(),Et(n.$$.fragment)},m(c,d){Rt(e,c,d),et(c,i,d),Rt(n,c,d),r=!0},p(c,d){const u=262272&d[0]?fr(o,[o[0],128&d[0]&&{tabs:c[7]},262144&d[0]&&Rr(c[18])]):{};6&d[7]&&(u.$$scope={dirty:d,ctx:c}),e.$set(u);const p=393216&d[0]?fr(s,[s[0],s[1],131072&d[0]&&{panels:c[17]},262144&d[0]&&Rr(c[18])]):{};511721496&d[0]|5&d[7]&&(p.$$scope={dirty:d,ctx:c}),n.$set(p)},i(c){r||(P(e.$$.fragment,c),P(n.$$.fragment,c),r=!0)},o(c){z(e.$$.fragment,c),z(n.$$.fragment,c),r=!1},d(c){It(e,c),c&&Q(i),It(n,c)}}}function sS(t){let e,i,n=t[218].label+"";return{c(){e=ht("span"),i=mn(n)},m(r,o){et(r,e,o),Ct(e,i)},p(r,o){2&o[7]&&n!==(n=r[218].label+"")&&In(i,n)},d(r){r&&Q(e)}}}function lS(t){let e,i;return e=new t0({props:{elasticity:t[25]*t[44],base:mS,min:t[23],max:hS,valueMin:t[27][0],valueMax:t[27][1],value:t[28],labelReset:t[4].labelReset,valueLabel:Math.round(100*t[28])+"%",oninputstart:t[81],oninputmove:t[82],oninputend:t[83]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};33554432&r[0]&&(o.elasticity=n[25]*n[44]),8388608&r[0]&&(o.min=n[23]),134217728&r[0]&&(o.valueMin=n[27][0]),134217728&r[0]&&(o.valueMax=n[27][1]),268435456&r[0]&&(o.value=n[28]),16&r[0]&&(o.labelReset=n[4].labelReset),268435456&r[0]&&(o.valueLabel=Math.round(100*n[28])+"%"),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function cS(t){let e,i;return e=new Yw({props:{elasticity:t[25]*t[44],rotation:t[14],labelReset:t[4].labelReset,valueMin:t[26][0],valueMax:t[26][1],rotationMin:-t[3],rotationMax:t[3],oninputstart:t[71],oninputmove:t[72],oninputend:t[73]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};33554432&r[0]&&(o.elasticity=n[25]*n[44]),16384&r[0]&&(o.rotation=n[14]),16&r[0]&&(o.labelReset=n[4].labelReset),67108864&r[0]&&(o.valueMin=n[26][0]),67108864&r[0]&&(o.valueMax=n[26][1]),8&r[0]&&(o.rotationMin=-n[3]),8&r[0]&&(o.rotationMax=n[3]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function dS(t){let e,i,n,r;const o=[cS,lS],a=[];function s(l,c){return l[217]===l[93]+"-rotation"?0:l[217]===l[93]+"-zoom"?1:-1}return~(e=s(t))&&(i=a[e]=o[e](t)),{c(){i&&i.c(),n=Tn()},m(l,c){~e&&a[e].m(l,c),et(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?~e&&a[e].p(l,c):(i&&(Ie(),z(a[d],1,1,()=>{a[d]=null}),Ee()),~e?(i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),P(i,1),i.m(n.parentNode,n)):i=null)},i(l){r||(P(i),r=!0)},o(l){z(i),r=!1},d(l){~e&&a[e].d(l),l&&Q(n)}}}function uS(t){let e,i,n=t[19]&&df(t);return{c(){e=ht("div"),n&&n.c(),v(e,"slot","footer"),v(e,"style",t[16])},m(r,o){et(r,e,o),n&&n.m(e,null),i=!0},p(r,o){r[19]?n?(n.p(r,o),524288&o[0]&&P(n,1)):(n=df(r),n.c(),P(n,1),n.m(e,null)):n&&(Ie(),z(n,1,1,()=>{n=null}),Ee()),(!i||65536&o[0])&&v(e,"style",r[16])},i(r){i||(P(n),i=!0)},o(r){z(n),i=!1},d(r){r&&Q(e),n&&n.d()}}}function pS(t){let e,i,n;function r(a){t[164](a)}let o={hasHeader:t[20],$$slots:{footer:[uS],main:[aS],header:[oS]},$$scope:{ctx:t}};return t[15]!==void 0&&(o.root=t[15]),e=new dl({props:o}),zi.push(()=>mo(e,"root",r)),e.$on("measure",t[165]),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};1048576&s[0]&&(l.hasHeader=a[20]),2146402302&s[0]|4&s[7]&&(l.$$scope={dirty:s,ctx:a}),!i&&32768&s[0]&&(i=!0,l.root=a[15],vo(()=>i=!1)),e.$set(l)},i(a){n||(P(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}const hS=1,mS=0,uf=(t,e)=>t.target===e;function $S(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,I,M,D,T,F,W,O,y,V,tt,k,N,it,ut,at,gt,G,$t,vt,lt,kt,J,q,Z,xt,nt,mt,zt,oe,Dt,te,Kt,U,Tt,dt,Jt,se,ee,be,ve,_,ke,fi,ye,Ot,ze,Re,Oe,di,bt,le,Xe,Ve,At,Ge=ni,Ye=()=>(Ge(),Ge=Br($i,R=>i(12,k=R)),$i);t.$$.on_destroy.push(()=>Ge());let{isActive:$i}=e;Ye();let{stores:bi}=e,{cropImageSelectionCornerStyle:Mi="circle"}=e,{cropWillRenderImageSelectionGuides:Ci=(R,Te)=>{const We=R=="rotate";return{rows:We?5:3,cols:We?5:3,opacity:.25*Te}}}=e,{cropAutoCenterImageSelectionTimeout:X}=e,{cropEnableZoomMatchImageAspectRatio:Gt=!0}=e,{cropEnableRotateMatchImageAspectRatio:H="never"}=e,{cropEnableRotationInput:Zt=!0}=e,{cropEnableZoom:ae=!0}=e,{cropEnableZoomInput:jt=!0}=e,{cropEnableZoomAutoHide:$e=!0}=e,{cropEnableImageSelection:Xt=!0}=e,{cropEnableInfoIndicator:Le=!1}=e,{cropEnableZoomTowardsWheelPosition:qe=!0}=e,{cropEnableLimitWheelInputToCropSelection:Ne=!0}=e,{cropEnableCenterImageSelection:pt=!0}=e,{cropEnableButtonRotateLeft:Ht=!0}=e,{cropEnableButtonRotateRight:ie=!1}=e,{cropEnableButtonFlipHorizontal:Fe=!0}=e,{cropEnableButtonFlipVertical:Wt=!1}=e,{cropSelectPresetOptions:K}=e,{cropEnableSelectPreset:Yt=!0}=e,{cropEnableFilterMatchAspectRatio:Ut=!0}=e,{cropSelectPresetFilter:ne=!1}=e,{cropEnableButtonToggleCropLimit:De=!1}=e,{cropWillRenderTools:re=Ki}=e,{cropActiveTransformTool:Bi="rotation"}=e,{cropMinimizeToolbar:ti="auto"}=e,{cropInteractionFocus:Ce="image"}=e,{cropRotationRange:xe=Ko}=e,{cropMaskOpacity:Ke=.85}=e,{locale:Pe={}}=e;const je=sn("isAnimated");A(t,je,R=>i(139,N=R));const Me=sn("elasticityMultiplier");A(t,Me,R=>i(25,di=R));const fe=sn("redrawTrigger");A(t,fe,R=>i(159,Oe=R));const Ti=sn("imageIsStatic");A(t,Ti,R=>i(145,vt=R));const Yi=sn("imageStaticVisualCorners");A(t,Yi,R=>i(181,ve=R));const En=sn("fixScrollDirection");A(t,En,R=>i(175,U=R));let bn="idle";const Vn=ue();A(t,Vn,R=>i(156,Ot=R));const An=()=>ee===void 0,qr=R=>1/R,ao=R=>{Ut&&ne!==R&&(i(95,ne=R),ee&&ee!==1&&Ln()&&wt(pr,ee=qr(ee),ee))},Ln=()=>{if(ee===1||!n)return!1;const R=qr(ee);return!!Cs(Ot).find(([Te])=>Te===R)},xr=(R,Te,We)=>Ra(We)?Te.width===Math.round(R.height)||Te.height===Math.round(R.width):Te.width===Math.round(R.width)||Te.height===Math.round(R.height),vn=()=>(An()||H==="always"&&Ln())&&((R,Te,We)=>{const gi=is(iy(no(Te),We),ei=>Math.abs(Math.round(ei))),Oi=Dl(gi),Hi=ki(R);return bs(Oi,Hi)})(lt,oe,Dt)&&xr(lt,oe,Dt),Nn=R=>{if(H!=="never"&&vn()){wt(_r,Dt+=R,Dt);const Te=Ra(Dt),We=Te?oe.height:oe.width,gi=Te?oe.width:oe.height;wt(Ji,lt=Pn(0,0,We,gi),lt),An()||wt(pr,ee=qo(We,gi),ee)}else wt(_r,Dt+=R,Dt)},{history:$n,env:So,isInteracting:Wi,isInteractingFraction:gn,isTransformingImage:On,rootRect:Vo,stageRect:Kr,utilRect:$o,utilRectPadded:ko,rootLineColor:dr,allowPan:cn,allowZoom:en,allowPlayPause:so,rangeInputElasticity:No,presentationScalar:br,utilTools:vr,imagePreviewModifiers:lo,imageOutlineOpacity:la,imageFlipX:Co,imageFlipY:To,imageRotation:_r,imageRotationRange:Jr,imageOutputSize:Ir,imageSelectionRect:ur,imageSelectionRectSnapshot:wr,imageSelectionRectIntent:Wn,imageSelectionRectPresentation:_i,imageCropRectIntent:Vi,imageCropRectOrigin:lr,imageCropRect:Ji,imageCropMinSize:Vr,imageCropMaxSize:co,imageCropRange:Qr,imageCropAspectRatio:pr,imageCropLimitToImage:zn,imageSize:Sr,imageScalar:uo,imageOverlayMarkup:cr,stagePadded:Kn,stageRecenter:Hn}=bi;let Er;A(t,So,R=>i(140,it=R)),A(t,Wi,R=>i(144,$t=R)),A(t,On,R=>i(173,mt=R)),A(t,Vo,R=>i(24,Tt=R)),A(t,Kr,R=>i(151,nt=R)),A(t,ko,R=>i(148,q=R)),A(t,br,R=>i(147,J=R)),A(t,vr,R=>i(183,ke=R)),A(t,lo,R=>i(172,gt=R)),A(t,Co,R=>i(158,Re=R)),A(t,To,R=>i(157,ze=R)),A(t,_r,R=>i(14,Dt=R)),A(t,Jr,R=>i(26,bt=R)),A(t,Ir,R=>i(184,fi=R)),A(t,ur,R=>i(150,xt=R)),A(t,wr,R=>i(149,Z=R)),A(t,Wn,R=>i(182,_=R)),A(t,_i,R=>i(143,G=R)),A(t,Vi,R=>i(176,dt=R)),A(t,lr,R=>i(178,se=R)),A(t,Ji,R=>i(13,lt=R)),A(t,Vr,R=>i(154,Kt=R)),A(t,co,R=>i(180,be=R)),A(t,Qr,R=>i(177,Jt=R)),A(t,pr,R=>i(179,ee=R)),A(t,zn,R=>i(153,te=R)),A(t,Sr,R=>i(152,oe=R)),A(t,uo,R=>i(146,kt=R)),A(t,Kn,R=>i(142,at=R));const to=(R,Te)=>{const We={target:R,translate:Te},gi=Bd(no(Kt),J),Oi=Bd(no(be),J);let Hi=ef(Z,We,{...q,x:0,y:0},{aspectRatio:ee,minSize:gi,maxSize:Oi});if(Hi=((ai,Ai,Fi)=>{const[un,Sn,fn,Di]=al(ai),Pi={...ai};if(un<Ai.y&&(ai.height=ai.height-(Ai.y-un),ai.y=Ai.y),Sn>Ai.x+Ai.width&&(ai.width=Ai.x+Ai.width-ai.x),fn>Ai.y+Ai.height&&(ai.height=Ai.y+Ai.height-ai.y),Di<Ai.x&&(ai.width=ai.width-(Ai.x-Di),ai.x=Ai.x),Fi){const zr=Math.min(1,Pi.width/ai.width,Pi.height/ai.height);return ks(Pi,zr)}return ai})(Hi,{...q,x:0,y:0},ee),!te)return{boundsLimited:Hi,boundsIntent:Hi};let ei=nS(Z,Hi,We,ve,{aspectRatio:ee,minSize:gi,maxSize:Oi});return{boundsLimited:ei,boundsIntent:ei}},eo=(R,Te)=>{const We={target:R,translate:Te},gi=Bd(no(Kt),J),Oi=Bd(no(be),J),Hi=((ei,ai,Ai={})=>{const{target:Fi,translate:un}=ai,{aspectRatio:Sn,minSize:fn}=Ai,Di=Lc[e0[Fi]],Pi=Dn(Si(ei),ot(Di[0]*ei.width,Di[1]*ei.height)),zr=Lc[Fi],jo=Dn(Si(ei),ot(zr[0]*ei.width,zr[1]*ei.height)),[Sa,Fa,Da,Ba,Uo,ss,ul]=i0(Fi);let Oa=un.x,Wa=un.y;Uo?Wa=0:ss&&(Oa=0);let[jr,Ur,Gr,hr]=al(ei);if(Sa?hr=Pi.x:Fa&&(Ur=Pi.x),Ba?jr=Pi.y:Da&&(Gr=Pi.y),Sa?Ur=jo.x+Oa:Fa&&(hr=jo.x+Oa),Ba?Gr=jo.y+Wa:Da&&(jr=jo.y+Wa),fn&&Uo&&Gr-jr<fn.height){const pn=fn.height-(Gr-jr);jr-=.5*pn,Gr+=.5*pn}if(fn&&ss&&Ur-hr<fn.width){const pn=fn.width-(Ur-hr);hr-=.5*pn,Ur+=.5*pn}if(Sn)if(ul){let pn=Ur-hr,Ro=Gr-jr;Uo?(Ro=pn/Sn,jr=Pi.y-.5*Ro,Gr=Pi.y+.5*Ro):ss&&(pn=Ro*Sn,hr=Pi.x-.5*pn,Ur=Pi.x+.5*pn)}else{const pn=ot(jo.x+Oa-Pi.x,jo.y+Wa-Pi.y);Fi===ra?(pn.x=Math.max(0,pn.x),pn.y=Math.min(0,pn.y)):Fi===oa?(pn.x=Math.max(0,pn.x),pn.y=Math.max(0,pn.y)):Fi===aa?(pn.x=Math.min(0,pn.x),pn.y=Math.max(0,pn.y)):Fi===na&&(pn.x=Math.min(0,pn.x),pn.y=Math.min(0,pn.y));const Ro=ws(pn),_a=ot(Sn,1),Ri=Mr(ro(_a),Ro);Fi===ra?(Ur=Pi.x+Ri.x,jr=Pi.y-Ri.y):Fi===oa?(Ur=Pi.x+Ri.x,Gr=Pi.y+Ri.y):Fi===aa?(hr=Pi.x-Ri.x,Gr=Pi.y+Ri.y):Fi===na&&(hr=Pi.x-Ri.x,jr=Pi.y-Ri.y)}return Pn(hr,jr,Ur-hr,Gr-jr)})(Z,We,{aspectRatio:ee,minSize:gi});return{boundsLimited:ef(Z,We,{...q,x:0,y:0},{aspectRatio:ee,minSize:gi,maxSize:Oi}),boundsIntent:Hi}};let Mn,Ar;const B=({translation:R,scalar:Te})=>{vt&&(Te=1,R=El(Be(R)));const We=Math.min(xt.width/lt.width,xt.height/lt.height),gi=Mr(Be(R),1/We);let Oi;if(Ar){const Hi=Bn(Be(Ar),R);Ar=R,Oi=Jo(Si(lt),Hi)}else Oi=Jo(Si(Mn),El(Be(gi))),Te!==void 0&&Tr(Oi,1/Te);wt(Vi,dt=Oi,dt),wt(Ji,lt=Oi,lt)},ce=Ei([Qr,Ji],([R,Te],We)=>{if(!Te)return;const[gi,Oi]=R,Hi=ir(Te);We([ol(Bo(rs(gi,Hi),si)),ol(Bo(Yr(Oi,Hi),si))])});A(t,ce,R=>i(174,zt=R));const vi=Ei([Sr,zn,Vr,co,Qr,_r],([R,Te,We,gi,Oi,Hi],ei)=>{if(!R)return;const ai=Oi[0],Ai=Oi[1];let Fi,un;Te?(Fi=((Sn,fn,Di)=>Ra(Di)?1-1/Math.min(Sn.height/fn.width,Sn.width/fn.height):1-1/Math.min(Sn.width/fn.width,Sn.height/fn.height))(R,Ai,Hi),un=Math.min(ai.width/We.width,ai.height/We.height)):(Fi=-1,un=1),ei([Fi,un].map(Sn=>si(Sn)))});A(t,vi,R=>i(27,le=R));const Ue=Ei([Sr,Ji,Qr,_r],([R,Te,We,gi],Oi)=>{if(!R||!Te)return Oi(0);let Hi;const ei=We[0],ai=We[1],Ai=Te.width,Fi=Te.height,un=ir(Te),Sn=Ra(gi)?Un(R.height,R.width):R,fn=Yr(Sn,un);if(Ai<=fn.width||Fi<=fn.height){const Di=fn.width-ei.width,Pi=fn.height-ei.height;Hi=Di===0||Pi===0?1:1-Math.min((Ai-ei.width)/Di,(Fi-ei.height)/Pi)}else{const Di=ai.width-fn.width,Pi=ai.height-fn.height,zr=Yr({width:Di,height:Pi},un);Hi=-Math.min((Ai-fn.width)/zr.width,(Fi-fn.height)/zr.height)}Oi(Hi)});A(t,Ue,R=>i(28,Xe=R));const Pt=R=>{const Te=ir(Mn);let We,gi,Oi;const Hi=Ra(Dt)?Un(oe.height,oe.width):oe,ei=Yr(Hi,Te);if(R>=0){const Fi=ei.width-Jt[0].width,un=ei.height-Jt[0].height;We=ei.width-Fi*R,gi=ei.height-un*R,Oi=rs({width:We,height:gi},Te)}else{const Fi=Jt[1].width-ei.width,un=Jt[1].height-ei.height;We=ei.width+Fi*-R,gi=ei.height+un*-R,Oi=Yr({width:We,height:gi},Te)}We=Oi.width,gi=Oi.height;const ai=Mn.x+.5*Mn.width-.5*We,Ai=Mn.y+.5*Mn.height-.5*gi;wt(Ji,lt={x:ai,y:Ai,width:We,height:gi},lt)};let ge;const yi=R=>{const Te=Tr(Si(ge),1/R);wt(Vi,dt=Te,dt),wt(Ji,lt=Te,lt)};let Gi;const dn=()=>{Hn.set({})};let wi;const Ni=pi(0,{precision:1e-4});A(t,Ni,R=>i(29,Ve=R));const Lr=pi();A(t,Lr,R=>i(30,At=R));const ca=Ei([pr,Ir,Vn],([R,Te,We],gi)=>{if(!n)return;const Oi=Cs(We),Hi=[...Oi].map(ei=>ei[0]).sort((ei,ai)=>Rn(ei[0])&&!Rn(ai[0])?1:-1).find(ei=>{if(Rn(ei)&&Te){const[ai,Ai]=ei,Fi=Te.width===ai&&Te.height===Ai,un=R===qo(ai,Ai);return Fi&&un}return ei===R});if(!Hi)return gi(void 0);gi(Oi.map(ei=>ei[0]).findIndex(ei=>Rn(ei)?os(ei,Hi):ei===Hi))});A(t,ca,R=>i(155,ye=R));const da=(R,Te)=>{if(!n||R===-1||R===void 0)return;const We=Cs(Te)[R][0];return We?Rn(We)?qo(We[0],We[1]):We:void 0},wa=Ei([dr,_i,gn],([R,Te,We],gi)=>{const{rows:Oi,cols:Hi,opacity:ei}=Ci(bn,We);if(!Te||ei<=0)return gi([]);const{x:ai,y:Ai,width:Fi,height:un}=Te,Sn=Fi/Hi,fn=un/Oi,Di=[];for(let Pi=1;Pi<=Oi-1;Pi++){const zr=Ai+fn*Pi;Di.push({id:"image-selection-guide-row-"+Pi,points:[ot(ai,zr),ot(ai+Fi,zr)],opacity:ei,strokeWidth:1,strokeColor:R})}for(let Pi=1;Pi<=Hi-1;Pi++){const zr=ai+Sn*Pi;Di.push({id:"image-selection-guide-col-"+Pi,points:[ot(zr,Ai),ot(zr,Ai+un)],opacity:ei,strokeWidth:1,strokeColor:R})}gi(Di)});A(t,wa,R=>i(141,ut=R));const Ho="crop-"+ea();let Nr,Mo=Ho+"-"+(Zt?Bi:"zoom"),Po=Mo,za;const Hr=pi(N?20:0);return A(t,Hr,R=>i(138,tt=R)),t.$$set=R=>{"isActive"in R&&Ye(i(0,$i=R.isActive)),"stores"in R&&i(97,bi=R.stores),"cropImageSelectionCornerStyle"in R&&i(1,Mi=R.cropImageSelectionCornerStyle),"cropWillRenderImageSelectionGuides"in R&&i(98,Ci=R.cropWillRenderImageSelectionGuides),"cropAutoCenterImageSelectionTimeout"in R&&i(99,X=R.cropAutoCenterImageSelectionTimeout),"cropEnableZoomMatchImageAspectRatio"in R&&i(100,Gt=R.cropEnableZoomMatchImageAspectRatio),"cropEnableRotateMatchImageAspectRatio"in R&&i(101,H=R.cropEnableRotateMatchImageAspectRatio),"cropEnableRotationInput"in R&&i(102,Zt=R.cropEnableRotationInput),"cropEnableZoom"in R&&i(2,ae=R.cropEnableZoom),"cropEnableZoomInput"in R&&i(103,jt=R.cropEnableZoomInput),"cropEnableZoomAutoHide"in R&&i(104,$e=R.cropEnableZoomAutoHide),"cropEnableImageSelection"in R&&i(105,Xt=R.cropEnableImageSelection),"cropEnableInfoIndicator"in R&&i(106,Le=R.cropEnableInfoIndicator),"cropEnableZoomTowardsWheelPosition"in R&&i(107,qe=R.cropEnableZoomTowardsWheelPosition),"cropEnableLimitWheelInputToCropSelection"in R&&i(108,Ne=R.cropEnableLimitWheelInputToCropSelection),"cropEnableCenterImageSelection"in R&&i(109,pt=R.cropEnableCenterImageSelection),"cropEnableButtonRotateLeft"in R&&i(110,Ht=R.cropEnableButtonRotateLeft),"cropEnableButtonRotateRight"in R&&i(111,ie=R.cropEnableButtonRotateRight),"cropEnableButtonFlipHorizontal"in R&&i(112,Fe=R.cropEnableButtonFlipHorizontal),"cropEnableButtonFlipVertical"in R&&i(113,Wt=R.cropEnableButtonFlipVertical),"cropSelectPresetOptions"in R&&i(114,K=R.cropSelectPresetOptions),"cropEnableSelectPreset"in R&&i(115,Yt=R.cropEnableSelectPreset),"cropEnableFilterMatchAspectRatio"in R&&i(116,Ut=R.cropEnableFilterMatchAspectRatio),"cropSelectPresetFilter"in R&&i(95,ne=R.cropSelectPresetFilter),"cropEnableButtonToggleCropLimit"in R&&i(117,De=R.cropEnableButtonToggleCropLimit),"cropWillRenderTools"in R&&i(118,re=R.cropWillRenderTools),"cropActiveTransformTool"in R&&i(119,Bi=R.cropActiveTransformTool),"cropMinimizeToolbar"in R&&i(120,ti=R.cropMinimizeToolbar),"cropInteractionFocus"in R&&i(121,Ce=R.cropInteractionFocus),"cropRotationRange"in R&&i(3,xe=R.cropRotationRange),"cropMaskOpacity"in R&&i(122,Ke=R.cropMaskOpacity),"locale"in R&&i(4,Pe=R.locale)},t.$$.update=()=>{4096&t.$$.dirty[0]|268435456&t.$$.dirty[3]&&Ti.set(Ce==="selection"&&k),2097152&t.$$.dirty[3]&&i(129,n=K&&Array.isArray(K)&&K.length),2097152&t.$$.dirty[3]|32&t.$$.dirty[4]&&Vn.set(n?K:[]),4096&t.$$.dirty[0]|32768&t.$$.dirty[4]&&k&&la.set(1,{hard:!N}),4096&t.$$.dirty[0]&&cn.set(!k),4096&t.$$.dirty[0]&&en.set(!k),4096&t.$$.dirty[0]&&k&&so.set(!0),65536&t.$$.dirty[4]&&i(124,h=it.layoutMode==="overlay"),4194304&t.$$.dirty[3]|1&t.$$.dirty[4]&&i(128,I=Yt&&!h),83886080&t.$$.dirty[4]&&i(137,l=q&&xt&&eu(q,xt)),67117056&t.$$.dirty[4]&&i(135,c=!(!xt||!l)),67119104&t.$$.dirty[4]&&i(133,d=c&&Qo(xt,l,R=>si(R,5))),16400&t.$$.dirty[0]|52297732&t.$$.dirty[3]|1879114288&t.$$.dirty[4]|31&t.$$.dirty[5]&&i(11,r=Oe&&re([Ht&&["Button","rotate-left",{label:Pe.cropLabelButtonRotateLeft,labelClass:"PinturaToolbarContentWide",icon:Pe.cropIconButtonRotateLeft,onclick:()=>{Nn(-Math.PI/2),$n.write()}}],ie&&["Button","rotate-right",{label:Pe.cropLabelButtonRotateRight,labelClass:"PinturaToolbarContentWide",icon:Pe.cropIconButtonRotateRight,onclick:()=>{Nn(Math.PI/2),$n.write()}}],Fe&&["Button","flip-horizontal",{label:Pe.cropLabelButtonFlipHorizontal,labelClass:"PinturaToolbarContentWide",icon:Pe.cropIconButtonFlipHorizontal,onclick:()=>{Ra(Dt)?wt(To,ze=!ze,ze):wt(Co,Re=!Re,Re),$n.write()}}],Wt&&["Button","flip-vertical",{label:Pe.cropLabelButtonFlipVertical,labelClass:"PinturaToolbarContentWide",icon:Pe.cropIconButtonFlipVertical,onclick:()=>{Ra(Dt)?wt(Co,Re=!Re,Re):wt(To,ze=!ze,ze),$n.write()}}],I&&n&&[ne===!1?"Dropdown":iS,"select-preset",{icon:nr(Pe.cropIconSelectPreset,Pe,da(ye,Ot)),label:nr(Pe.cropLabelSelectPreset,Pe,da(ye,Ot)),labelClass:"PinturaToolbarContentWide",options:Ot,filter:ne,onfilterchange:ao,selectedIndex:ye,onchange:({value:R})=>{Rn(R)?(wt(pr,ee=qo(R[0],R[1]),ee),wt(Ir,fi=ey(R),fi)):wt(pr,ee=R,ee),d&&dn(),$n.write()},optionMapper:R=>{let Te=!1;const We=Rn(R.value)?R.value[0]/R.value[1]:R.value;if(We){const gi=Il(oe,Dt,We);Te=gi.width<Kt.width||gi.height<Kt.height}return R.icon=((gi,Oi={})=>{const{width:Hi=24,height:ei=24,bounds:ai=16,radius:Ai=3}=Oi;let Fi,un,Sn,fn,Di=Rn(gi)?qo(gi[0],gi[1]):gi,Pi=!!Di;return Di=Pi?Di:1,Sn=Di>1?ai:Di*ai,fn=Sn/Di,Fi=Math.round(.5*(Hi-Sn)),un=Math.round(.5*(ei-fn)),`<rect fill="${Pi?"currentColor":"none"}" stroke="${Pi?"none":"currentColor"}" stroke-width="${Hi/16}" stroke-dasharray="${[Hi/12,Hi/6].join(" ")}" x="${Fi}" y="${un}" width="${Sn}" height="${fn}" rx="${Ai}"/>`})(R.value,{bounds:14}),{...R,disabled:Te}}}],De&&["Dropdown","select-crop-limit",{icon:nr(Pe.cropIconCropBoundary,Pe,te),label:Pe.cropLabelCropBoundary,labelClass:"PinturaToolbarContentWide",onchange:({value:R})=>{wt(zn,te=R,te),$n.write()},options:[[!0,Pe.cropLabelCropBoundaryEdge,{icon:nr(Pe.cropIconCropBoundary,Pe,!0)}],[!1,Pe.cropLabelCropBoundaryNone,{icon:nr(Pe.cropIconCropBoundary,Pe,!1)}]]}]].filter(Boolean),it,()=>fe.set({})).filter(Boolean)),6144&t.$$.dirty[0]|134217728&t.$$.dirty[3]|65537&t.$$.dirty[4]&&wt(vr,ke=k&&ti!=="never"&&(ti==="always"||it.verticalSpace==="short"||h)?r.map(([R,Te,We])=>Array.isArray(We)?[R,Te,We]:[R,Te,{...We,hideLabel:!0}]):[],ke),536870912&t.$$.dirty[4]&&i(23,o=te?0:-1),150994944&t.$$.dirty[4]&&i(130,a=q&&ot(-(nt.x-q.x),-(nt.y-q.y))),524352&t.$$.dirty[4]&&i(131,s=G&&a&&ot(Oc(G.x+.5*G.width+a.x),Oc(G.y+.5*G.height+a.y))),33554432&t.$$.dirty[4]&&i(134,u=Z!=null),16785408&t.$$.dirty[4]&&i(136,p=q&&l&&(l.height===q.height||l.width===q.width)),12587008&t.$$.dirty[4]&&i(132,g=!p&&J<1&&kt<1),3840&t.$$.dirty[4]&&i(9,m=c&&!u&&(!d||g)),8192&t.$$.dirty[0]|8192&t.$$.dirty[3]|1&t.$$.dirty[4]&&i(22,f=Le&&!!lt&&!h),524352&t.$$.dirty[4]&&i(8,S=G&&a&&{x:G.x+a.x,y:G.y+a.y,width:G.width,height:G.height}),256&t.$$.dirty[0]|4096&t.$$.dirty[3]|1&t.$$.dirty[4]&&i(21,b=Xt&&!!S&&!h),65600&t.$$.dirty[3]|2097280&t.$$.dirty[4]&&i(10,w=pt&&!!s&&!X&&!vt),512&t.$$.dirty[0]|1073741888&t.$$.dirty[3]|1048576&t.$$.dirty[4]&&m&&X&&!$t&&(clearTimeout(wi),i(123,wi=setTimeout(dn,X))),1073741824&t.$$.dirty[3]|1048576&t.$$.dirty[4]&&$t&&clearTimeout(wi),1536&t.$$.dirty[0]|32768&t.$$.dirty[4]&&Ni.set(w&&m?1:0,{hard:N===!1}),32896&t.$$.dirty[4]&&Lr.set(s,{hard:N===!1}),4096&t.$$.dirty[0]|262144&t.$$.dirty[4]&&(k&&!at?(wt(lo,gt.crop={maskOpacity:Ke,maskMarkupOpacity:Ke},gt),lo.set(gt)):(delete gt.crop,lo.set(gt))),131072&t.$$.dirty[4]&&ut&&cr.update(R=>{const Te=R.filter(We=>!/^image\-selection\-guide/.test(We.id));return k?[...Te,...ut]:Te}),65536&t.$$.dirty[4]&&i(127,C=it.verticalSpace!=="short"),134217728&t.$$.dirty[3]|9&t.$$.dirty[4]&&i(20,M=ti==="never"&&!h||C&&ti!=="always"),4&t.$$.dirty[0]|1024&t.$$.dirty[3]&&i(126,D=ae&&jt),2048&t.$$.dirty[3]|12&t.$$.dirty[4]&&i(125,T=$e?C&&D:D),512&t.$$.dirty[3]|2&t.$$.dirty[4]&&i(19,F=Zt||T),2&t.$$.dirty[4]&&(T||i(5,Po=Mo)),32&t.$$.dirty[0]&&i(18,W={name:Ho,selected:Po}),16&t.$$.dirty[0]|512&t.$$.dirty[3]|2&t.$$.dirty[4]&&i(7,O=[Zt&&{id:Ho+"-rotation",label:Pe.cropLabelTabRotation},T&&{id:Ho+"-zoom",label:Pe.cropLabelTabZoom}].filter(Boolean)),128&t.$$.dirty[0]&&i(17,y=O.map(R=>R.id)),64&t.$$.dirty[0]|1&t.$$.dirty[4]&&Nr&&!Nr.children.length&&h&&Nr.dispatchEvent(new CustomEvent("measure",{detail:Nr.rect})),4096&t.$$.dirty[0]|32768&t.$$.dirty[4]&&N&&Hr.set(k?0:20),16384&t.$$.dirty[4]&&i(16,V=tt?`transform: translateY(${tt}px)`:void 0)},[$i,Mi,ae,xe,Pe,Po,Nr,O,S,m,w,r,k,lt,Dt,za,V,y,W,F,M,b,f,o,Tt,di,bt,le,Xe,Ve,At,je,Me,fe,Ti,Yi,En,Vn,So,Wi,On,Vo,Kr,ko,No,br,vr,lo,Co,To,_r,Jr,Ir,ur,wr,Wn,_i,Vi,lr,Ji,Vr,co,Qr,pr,zn,Sr,uo,Kn,()=>{bn="select",wt(Wi,$t=!0,$t),wt(wr,Z=Si(xt),Z),Er=vt?to:eo},({detail:R})=>{const{boundsLimited:Te,boundsIntent:We}=Er(R.direction,R.translation);wt(On,mt=!0,mt),wt(Wn,_=We,_),wt(ur,xt=Te,xt)},({detail:R})=>{const{boundsLimited:Te}=Er(R.direction,R.translation);wt(On,mt=!1,mt),wt(Wi,$t=!1,$t),wt(Wn,_=void 0,_),ws(R.translation)&&(wt(ur,xt=Te,xt),$n.write()),wt(wr,Z=void 0,Z),bn=void 0},()=>{bn="rotate",wt(Wi,$t=!0,$t),wt(lr,se=Si(lt),se)},R=>{wt(On,mt=!0,mt),wt(_r,Dt=R,Dt)},R=>{wt(On,mt=!1,mt),wt(Wi,$t=!1,$t),wt(_r,Dt=R,Dt),$n.write(),wt(lr,se=void 0,se)},()=>{bn="pan",Ar=void 0,wt(Wi,$t=!0,$t),Mn=Si(lt)},({detail:R})=>{wt(On,mt=!0,mt),B(R)},({detail:R})=>{wt(On,mt=!1,mt),wt(Wi,$t=!1,$t),(ws(R.translation)>0||R.scalar!==0)&&(B(R),$n.write()),wt(Vi,dt=void 0,dt),Mn=void 0},({detail:{translation:R}})=>{vt&&(R=El(Be(R))),Ar=R,wt(Wi,$t=!1,$t)},ce,vi,Ue,()=>{bn="zoom",wt(Wi,$t=!0,$t),Mn=Si(lt)},R=>{wt(On,mt=!1,mt),Pt(R)},R=>{Pt(R),$n.write(),wt(On,mt=!1,mt),wt(Wi,$t=!1,$t),Mn=void 0},()=>{bn="zoom",Mn||(ge=Si(lt),wt(Wi,$t=!0,$t))},({detail:R})=>{ge&&(wt(On,mt=!0,mt),yi(R))},({detail:R})=>{ge&&(wt(On,mt=!1,mt),wt(Wi,$t=!1,$t),yi(R),wt(Vi,dt=void 0,dt),ge=void 0,$n.write())},R=>{const Te=sh(R,Tt,nt);if(Ne&&!du(xt,Te))return;bn="zoom",wt(Wi,$t=!0,$t),wt(On,mt=!0,mt),R.preventDefault(),R.stopPropagation();const We=Au(R,{fixScrollDirection:U}),gi=1+We/100,Oi=Si(lt),Hi=Math.min(lt.width/Kt.width,lt.height/Kt.height)===1;if(Gt&&te){const Ai=xr(lt,oe,Dt);if(An()&&Ai&&We>0&&d){wt(Wi,$t=!1,$t),wt(On,mt=!1,mt);const Fi=Ra(Dt)?Or({height:oe.width,width:oe.height}):Or(oe);return Qo(Oi,Fi)||(clearTimeout(Gi),Qo($n.state.crop,Fi))?void 0:(wt(Ji,lt=Fi,lt),void $n.write())}}let ei=ki(lt);if(qe&&Ce!=="selection"&&We<0&&!Hi){const Ai=Bn(Be(Te),xt),Fi=Math.min(xt.width/lt.width,xt.height/lt.height),un=Tr(Si(xt),1.1);ei=du(un,Te)?Dn(Si(lt),Mr(Ai,1/Fi)):ei}let ai=Tr(Si(lt),gi,ei);if(cu(zt[1],ai)||(ai=gm(ki(ai),zt[1])),cu(ai,zt[0])||(ai=gm(ki(ai),zt[0])),Qo(Oi,ai,si))return wt(Wi,$t=!1,$t),void wt(On,mt=!1,mt);wt(Ji,lt=Bo(ai,Ai=>si(Ai,5)),lt),wt(Wi,$t=!1,$t),wt(On,mt=!1,mt),clearTimeout(Gi),Gi=setTimeout(()=>{$n.write()},500)},dn,Ni,Lr,ca,wa,Ho,Hr,ne,"crop",bi,Ci,X,Gt,H,Zt,jt,$e,Xt,Le,qe,Ne,pt,Ht,ie,Fe,Wt,K,Yt,Ut,De,re,Bi,ti,Ce,Ke,wi,h,T,D,C,I,n,a,s,g,d,u,c,p,l,tt,N,it,ut,at,G,$t,vt,kt,J,q,Z,xt,nt,oe,te,Kt,ye,Ot,ze,Re,Oe,function(R){Wr.call(this,t,R)},({detail:R})=>i(5,Po=R),function(R){zi[R?"unshift":"push"](()=>{Nr=R,i(6,Nr)})},R=>Qh(R),function(R){za=R,i(15,za)},function(R){Wr.call(this,t,R)}]}var gS={util:["crop",class extends ci{constructor(t){super(),li(this,t,$S,pS,oi,{name:96,isActive:0,stores:97,cropImageSelectionCornerStyle:1,cropWillRenderImageSelectionGuides:98,cropAutoCenterImageSelectionTimeout:99,cropEnableZoomMatchImageAspectRatio:100,cropEnableRotateMatchImageAspectRatio:101,cropEnableRotationInput:102,cropEnableZoom:2,cropEnableZoomInput:103,cropEnableZoomAutoHide:104,cropEnableImageSelection:105,cropEnableInfoIndicator:106,cropEnableZoomTowardsWheelPosition:107,cropEnableLimitWheelInputToCropSelection:108,cropEnableCenterImageSelection:109,cropEnableButtonRotateLeft:110,cropEnableButtonRotateRight:111,cropEnableButtonFlipHorizontal:112,cropEnableButtonFlipVertical:113,cropSelectPresetOptions:114,cropEnableSelectPreset:115,cropEnableFilterMatchAspectRatio:116,cropSelectPresetFilter:95,cropEnableButtonToggleCropLimit:117,cropWillRenderTools:118,cropActiveTransformTool:119,cropMinimizeToolbar:120,cropInteractionFocus:121,cropRotationRange:3,cropMaskOpacity:122,locale:4},null,[-1,-1,-1,-1,-1,-1,-1,-1])}get name(){return this.$$.ctx[96]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get stores(){return this.$$.ctx[97]}set stores(t){this.$$set({stores:t}),E()}get cropImageSelectionCornerStyle(){return this.$$.ctx[1]}set cropImageSelectionCornerStyle(t){this.$$set({cropImageSelectionCornerStyle:t}),E()}get cropWillRenderImageSelectionGuides(){return this.$$.ctx[98]}set cropWillRenderImageSelectionGuides(t){this.$$set({cropWillRenderImageSelectionGuides:t}),E()}get cropAutoCenterImageSelectionTimeout(){return this.$$.ctx[99]}set cropAutoCenterImageSelectionTimeout(t){this.$$set({cropAutoCenterImageSelectionTimeout:t}),E()}get cropEnableZoomMatchImageAspectRatio(){return this.$$.ctx[100]}set cropEnableZoomMatchImageAspectRatio(t){this.$$set({cropEnableZoomMatchImageAspectRatio:t}),E()}get cropEnableRotateMatchImageAspectRatio(){return this.$$.ctx[101]}set cropEnableRotateMatchImageAspectRatio(t){this.$$set({cropEnableRotateMatchImageAspectRatio:t}),E()}get cropEnableRotationInput(){return this.$$.ctx[102]}set cropEnableRotationInput(t){this.$$set({cropEnableRotationInput:t}),E()}get cropEnableZoom(){return this.$$.ctx[2]}set cropEnableZoom(t){this.$$set({cropEnableZoom:t}),E()}get cropEnableZoomInput(){return this.$$.ctx[103]}set cropEnableZoomInput(t){this.$$set({cropEnableZoomInput:t}),E()}get cropEnableZoomAutoHide(){return this.$$.ctx[104]}set cropEnableZoomAutoHide(t){this.$$set({cropEnableZoomAutoHide:t}),E()}get cropEnableImageSelection(){return this.$$.ctx[105]}set cropEnableImageSelection(t){this.$$set({cropEnableImageSelection:t}),E()}get cropEnableInfoIndicator(){return this.$$.ctx[106]}set cropEnableInfoIndicator(t){this.$$set({cropEnableInfoIndicator:t}),E()}get cropEnableZoomTowardsWheelPosition(){return this.$$.ctx[107]}set cropEnableZoomTowardsWheelPosition(t){this.$$set({cropEnableZoomTowardsWheelPosition:t}),E()}get cropEnableLimitWheelInputToCropSelection(){return this.$$.ctx[108]}set cropEnableLimitWheelInputToCropSelection(t){this.$$set({cropEnableLimitWheelInputToCropSelection:t}),E()}get cropEnableCenterImageSelection(){return this.$$.ctx[109]}set cropEnableCenterImageSelection(t){this.$$set({cropEnableCenterImageSelection:t}),E()}get cropEnableButtonRotateLeft(){return this.$$.ctx[110]}set cropEnableButtonRotateLeft(t){this.$$set({cropEnableButtonRotateLeft:t}),E()}get cropEnableButtonRotateRight(){return this.$$.ctx[111]}set cropEnableButtonRotateRight(t){this.$$set({cropEnableButtonRotateRight:t}),E()}get cropEnableButtonFlipHorizontal(){return this.$$.ctx[112]}set cropEnableButtonFlipHorizontal(t){this.$$set({cropEnableButtonFlipHorizontal:t}),E()}get cropEnableButtonFlipVertical(){return this.$$.ctx[113]}set cropEnableButtonFlipVertical(t){this.$$set({cropEnableButtonFlipVertical:t}),E()}get cropSelectPresetOptions(){return this.$$.ctx[114]}set cropSelectPresetOptions(t){this.$$set({cropSelectPresetOptions:t}),E()}get cropEnableSelectPreset(){return this.$$.ctx[115]}set cropEnableSelectPreset(t){this.$$set({cropEnableSelectPreset:t}),E()}get cropEnableFilterMatchAspectRatio(){return this.$$.ctx[116]}set cropEnableFilterMatchAspectRatio(t){this.$$set({cropEnableFilterMatchAspectRatio:t}),E()}get cropSelectPresetFilter(){return this.$$.ctx[95]}set cropSelectPresetFilter(t){this.$$set({cropSelectPresetFilter:t}),E()}get cropEnableButtonToggleCropLimit(){return this.$$.ctx[117]}set cropEnableButtonToggleCropLimit(t){this.$$set({cropEnableButtonToggleCropLimit:t}),E()}get cropWillRenderTools(){return this.$$.ctx[118]}set cropWillRenderTools(t){this.$$set({cropWillRenderTools:t}),E()}get cropActiveTransformTool(){return this.$$.ctx[119]}set cropActiveTransformTool(t){this.$$set({cropActiveTransformTool:t}),E()}get cropMinimizeToolbar(){return this.$$.ctx[120]}set cropMinimizeToolbar(t){this.$$set({cropMinimizeToolbar:t}),E()}get cropInteractionFocus(){return this.$$.ctx[121]}set cropInteractionFocus(t){this.$$set({cropInteractionFocus:t}),E()}get cropRotationRange(){return this.$$.ctx[3]}set cropRotationRange(t){this.$$set({cropRotationRange:t}),E()}get cropMaskOpacity(){return this.$$.ctx[122]}set cropMaskOpacity(t){this.$$set({cropMaskOpacity:t}),E()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),E()}}]};function fS(t){let e,i,n,r,o,a,s,l=t[77],c=(on(t[77].label)?t[77].label(t[2]):t[77].label)+"";function d(...h){return t[51](t[77],...h)}const u=()=>t[52](i,l),p=()=>t[52](null,l);return{c(){e=ht("div"),i=ht("div"),n=pe(),r=ht("span"),o=mn(c),v(i,"class",q2),v(e,"slot","option"),v(e,"class","PinturaFilterOption")},m(h,g){et(h,e,g),Ct(e,i),u(),Ct(e,n),Ct(e,r),Ct(r,o),a||(s=[Mt(i,"measure",d),Xi(yr.call(null,i))],a=!0)},p(h,g){l!==(t=h)[77]&&(p(),l=t[77],u()),4&g[0]|32768&g[2]&&c!==(c=(on(t[77].label)?t[77].label(t[2]):t[77].label)+"")&&In(o,c)},d(h){h&&Q(e),p(),a=!1,Ui(s)}}}function yS(t){let e,i;return e=new as({props:{locale:t[2],layout:"row",options:t[3],selectedIndex:t[12],onchange:t[32],$$slots:{option:[fS,({option:n})=>({77:n}),({option:n})=>[0,0,n?32768:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4&r[0]&&(o.locale=n[2]),8&r[0]&&(o.options=n[3]),4096&r[0]&&(o.selectedIndex=n[12]),1028&r[0]|98304&r[2]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function xS(t){let e,i,n,r,o,a,s,l;function c(h){t[54](h)}function d(h){t[55](h)}function u(h){t[56](h)}let p={elasticity:t[13]*t[19],onscroll:t[53],$$slots:{default:[yS]},$$scope:{ctx:t}};return t[4]!==void 0&&(p.maskFeatherStartOpacity=t[4]),t[5]!==void 0&&(p.maskFeatherEndOpacity=t[5]),t[6]!==void 0&&(p.maskFeatherSize=t[6]),i=new va({props:p}),zi.push(()=>mo(i,"maskFeatherStartOpacity",c)),zi.push(()=>mo(i,"maskFeatherEndOpacity",d)),zi.push(()=>mo(i,"maskFeatherSize",u)),i.$on("measure",t[57]),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"slot","footer"),v(e,"style",t[11])},m(h,g){et(h,e,g),Rt(i,e,null),a=!0,s||(l=[Mt(e,"transitionend",t[30]),Mt(e,"measure",t[58]),Xi(yr.call(null,e,{observePosition:!0}))],s=!0)},p(h,g){const m={};8192&g[0]&&(m.elasticity=h[13]*h[19]),128&g[0]&&(m.onscroll=h[53]),5132&g[0]|65536&g[2]&&(m.$$scope={dirty:g,ctx:h}),!n&&16&g[0]&&(n=!0,m.maskFeatherStartOpacity=h[4],vo(()=>n=!1)),!r&&32&g[0]&&(r=!0,m.maskFeatherEndOpacity=h[5],vo(()=>r=!1)),!o&&64&g[0]&&(o=!0,m.maskFeatherSize=h[6],vo(()=>o=!1)),i.$set(m),(!a||2048&g[0])&&v(e,"style",h[11])},i(h){a||(P(i.$$.fragment,h),a=!0)},o(h){z(i.$$.fragment,h),a=!1},d(h){h&&Q(e),It(i),s=!1,Ui(l)}}}function bS(t){let e,i;return e=new dl({props:{$$slots:{footer:[xS]},$$scope:{ctx:t}}}),e.$on("measure",t[59]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16380&r[0]|65536&r[2]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}let q2="PinturaFilterPreview";function vS(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,I,M,D=ni,T=()=>(D(),D=Br(y,bt=>i(43,d=bt)),y),F=ni,W=()=>(F(),F=Br(O,bt=>i(49,S=bt)),O);t.$$.on_destroy.push(()=>D()),t.$$.on_destroy.push(()=>F());let{isActive:O}=e;W();let{isActiveFraction:y}=e;T();let{stores:V}=e,{locale:tt}=e,{filterFunctions:k}=e,{filterOptions:N}=e;const it=sn("elasticityMultiplier");A(t,it,bt=>i(13,M=bt));const{history:ut,interfaceImages:at,stageRectBase:gt,utilRect:G,animation:$t,scrollElasticity:vt,imageSize:lt,imagePreview:kt,imageCropRect:J,imageRotation:q,imageFlipX:Z,imageFlipY:xt,imageBackgroundColor:nt,imageGamma:mt,imageColorMatrix:zt,allowPan:oe,allowZoom:Dt,allowZoomControls:te,allowPlayPause:Kt}=V;A(t,at,bt=>i(60,u=bt)),A(t,gt,bt=>i(48,w=bt)),A(t,G,bt=>i(47,b=bt)),A(t,$t,bt=>i(50,C=bt)),A(t,lt,bt=>i(62,h=bt)),A(t,kt,bt=>i(42,c=bt)),A(t,nt,bt=>i(61,p=bt)),A(t,mt,bt=>i(44,g=bt)),A(t,zt,bt=>i(40,s=bt));const U=ue({});A(t,U,bt=>i(46,f=bt));const Tt=(bt,le)=>wt(U,f[bt.value]=le,f),dt=Ei(U,bt=>{if(!bt[void 0])return;const le=bt[void 0];return I&&zc(I,le)?I:no(le)});A(t,dt,bt=>i(63,I=bt));const Jt=Ei([O,dt,J,lt,q,Z,xt],([bt,le,Xe,Ve,At,Ge,Ye],$i)=>{if(!bt||!le||!Ve)return m;const bi=Or(Ve),Mi=ki(bi),Ci=Wh(Ve,Xe,At),X=ki(Ci),Gt=Bn(Be(Mi),X),H=El(Be(Gt)),Zt=Math.max(le.width/Xe.width,le.height/Xe.height);$i({origin:H,translation:Gt,rotation:{x:Ye?Math.PI:0,y:Ge?Math.PI:0,z:At},scale:Zt})});A(t,Jt,bt=>i(45,m=bt));const se=pi(C?20:0);let ee;A(t,se,bt=>i(39,a=bt));const be={};let ve,_,ke,fi,ye,Ot,ze={x:0,y:0};const Re=ue([]);A(t,Re,bt=>i(41,l=bt));const Oe=bt=>{const le={...bt,data:c,size:h,offset:{...bt.offset},mask:{...bt.mask},backgroundColor:p};return le.opacity=d,le.offset.y+=a,le.mask.y+=a,le.id="filter",le},di=()=>u.filter(bt=>bt.id!=="filter");return _o(()=>{at.set([])}),t.$$set=bt=>{"isActive"in bt&&W(i(0,O=bt.isActive)),"isActiveFraction"in bt&&T(i(1,y=bt.isActiveFraction)),"stores"in bt&&i(34,V=bt.stores),"locale"in bt&&i(2,tt=bt.locale),"filterFunctions"in bt&&i(35,k=bt.filterFunctions),"filterOptions"in bt&&i(3,N=bt.filterOptions)},t.$$.update=()=>{if(262144&t.$$.dirty[1]&&oe.set(S),262144&t.$$.dirty[1]&&Dt.set(S),262144&t.$$.dirty[1]&&te.set(S),262144&t.$$.dirty[1]&&S&&Kt.set(!1),8&t.$$.dirty[0]&&i(38,n=Cs(N)),640&t.$$.dirty[1]&&i(12,r=((bt,le)=>{if(!bt||!bt.filter||!le)return 0;const Xe=bt.filter;return le.findIndex(([Ve])=>{if(!k[Ve])return!1;const At=k[Ve]();return os(At,Xe)})})(s,n)),786432&t.$$.dirty[1]&&C&&se.set(S?0:20),512&t.$$.dirty[0]|458752&t.$$.dirty[1]&&S&&b&&w&&Ot&&i(37,ye={x:w.x-b.x,y:w.y-b.y+Ot.y}),496&t.$$.dirty[0]|58096&t.$$.dirty[1]&&m&&ye&&ze&&fi&&ee){const bt=ye.x+fi.x+ze.x,le=ye.y,Xe=fi.x+ye.x,Ve=Xe+fi.width;Re.set(n.map(([At],Ge)=>{const Ye=f[At],$i=ze.x+Ye.x,bi=$i+Ye.width;if(bi<0||$i>fi.width)return!1;const Mi=bt+Ye.x,Ci=le+Ye.y,X=(H=>({origin:Be(H.origin),translation:Be(H.translation),rotation:{...H.rotation},scale:H.scale}))(m);X.offset=ot(.5*Ye.width+Mi,.5*Ye.height+Ci),X.maskOpacity=1,X.mask=Pn(Mi+0,Ci,Ye.width+0,Ye.height),X.maskFeather=[1,0,1,0,1,Ve,1,Ve],$i<ke&&ve<1&&(X.maskFeather[0]=ve,X.maskFeather[1]=Xe,X.maskFeather[2]=1,X.maskFeather[3]=Xe+ke),bi>fi.width-ke&&_<1&&(X.maskFeather[4]=_,X.maskFeather[5]=Ve-ke,X.maskFeather[6]=1,X.maskFeather[7]=Ve),X.maskCornerRadius=ee[At];let Gt=s&&Object.keys(s).filter(H=>H!="filter").map(H=>s[H])||[];return on(k[At])&&Gt.push(k[At]()),X.colorMatrix=Gt.length?Dh(Gt):void 0,X.gamma=g,X}).filter(Boolean))}if(7424&t.$$.dirty[1])if(d>0&&l){const bt=[...di(),...l.map(Oe)];at.set(bt)}else at.set(di());256&t.$$.dirty[1]&&i(11,o=a?`transform: translateY(${a}px)`:void 0)},[O,y,tt,N,ve,_,ke,ze,fi,Ot,be,o,r,M,it,at,gt,G,$t,vt,lt,kt,nt,mt,zt,U,Tt,dt,Jt,se,bt=>{bt.target.className===q2&&i(36,ee=Object.keys(be).reduce((le,Xe)=>{const Ve=be[Xe],At=getComputedStyle(Ve),Ge=["top-left","top-right","bottom-left","bottom-right"].map(Ye=>At.getPropertyValue(`border-${Ye}-radius`)).map(w2).map(Ye=>1.25*Ye);return le[Xe]=Ge,le},{}))},Re,({value:bt})=>{wt(zt,s={...s,filter:on(k[bt])?k[bt]():void 0},s),ut.write()},"filter",V,k,ee,ye,n,a,s,l,c,d,g,m,f,b,w,S,C,(bt,le)=>Tt(bt,le.detail),function(bt,le){zi[bt?"unshift":"push"](()=>{be[le.value]=bt,i(10,be)})},bt=>i(7,ze=bt),function(bt){ve=bt,i(4,ve)},function(bt){_=bt,i(5,_)},function(bt){ke=bt,i(6,ke)},bt=>i(8,fi=bt.detail),bt=>i(9,Ot=bt.detail),function(bt){Wr.call(this,t,bt)}]}var wS={util:["filter",class extends ci{constructor(t){super(),li(this,t,vS,bS,oi,{name:33,isActive:0,isActiveFraction:1,stores:34,locale:2,filterFunctions:35,filterOptions:3},null,[-1,-1,-1])}get name(){return this.$$.ctx[33]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),E()}get stores(){return this.$$.ctx[34]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[2]}set locale(t){this.$$set({locale:t}),E()}get filterFunctions(){return this.$$.ctx[35]}set filterFunctions(t){this.$$set({filterFunctions:t}),E()}get filterOptions(){return this.$$.ctx[3]}set filterOptions(t){this.$$set({filterOptions:t}),E()}}]};function pf(t){let e,i,n,r;e=new va({props:{elasticity:t[6]*t[9],class:"PinturaControlListScroller",$$slots:{default:[kS]},$$scope:{ctx:t}}});const o=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[4]},t[5]];let a={$$slots:{default:[CS,({panel:s})=>({42:s}),({panel:s})=>[0,s?2048:0]]},$$scope:{ctx:t}};for(let s=0;s<o.length;s+=1)a=Cn(a,o[s]);return n=new Eu({props:a}),{c(){Et(e.$$.fragment),i=pe(),Et(n.$$.fragment)},m(s,l){Rt(e,s,l),et(s,i,l),Rt(n,s,l),r=!0},p(s,l){const c={};64&l[0]&&(c.elasticity=s[6]*s[9]),38&l[0]|8192&l[1]&&(c.$$scope={dirty:l,ctx:s}),e.$set(c);const d=48&l[0]?fr(o,[o[0],o[1],16&l[0]&&{panels:s[4]},32&l[0]&&Rr(s[5])]):{};128&l[0]|10240&l[1]&&(d.$$scope={dirty:l,ctx:s}),n.$set(d)},i(s){r||(P(e.$$.fragment,s),P(n.$$.fragment,s),r=!0)},o(s){z(e.$$.fragment,s),z(n.$$.fragment,s),r=!1},d(s){It(e,s),s&&Q(i),It(n,s)}}}function SS(t){let e,i,n=t[43].label+"";return{c(){e=ht("span"),i=mn(n)},m(r,o){et(r,e,o),Ct(e,i)},p(r,o){4096&o[1]&&n!==(n=r[43].label+"")&&In(i,n)},d(r){r&&Q(e)}}}function kS(t){let e,i;const n=[{class:"PinturaControlList"},{tabs:t[1]},t[5]];let r={$$slots:{default:[SS,({tab:o})=>({43:o}),({tab:o})=>[0,o?4096:0]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new Iu({props:r}),e.$on("select",t[24]),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=34&a[0]?fr(n,[n[0],2&a[0]&&{tabs:o[1]},32&a[0]&&Rr(o[5])]):{};12288&a[1]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function CS(t){let e,i;const n=[t[7][t[42]]];let r={};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new t0({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=128&a[0]|2048&a[1]?fr(n,[Rr(o[7][o[42]])]):{};e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function TS(t){let e,i,n=t[5]&&pf(t);return{c(){e=ht("div"),n&&n.c(),v(e,"slot","footer"),v(e,"style",t[3])},m(r,o){et(r,e,o),n&&n.m(e,null),i=!0},p(r,o){r[5]?n?(n.p(r,o),32&o[0]&&P(n,1)):(n=pf(r),n.c(),P(n,1),n.m(e,null)):n&&(Ie(),z(n,1,1,()=>{n=null}),Ee()),(!i||8&o[0])&&v(e,"style",r[3])},i(r){i||(P(n),i=!0)},o(r){z(n),i=!1},d(r){r&&Q(e),n&&n.d()}}}function MS(t){let e,i;return e=new dl({props:{$$slots:{footer:[TS]},$$scope:{ctx:t}}}),e.$on("measure",t[25]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};254&r[0]|8192&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function PS(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g=ni,m=()=>(g(),g=Br(b,J=>i(21,c=J)),b);t.$$.on_destroy.push(()=>g());let{stores:f}=e,{isActive:b}=e;m();let{locale:w={}}=e,{finetuneControlConfiguration:S}=e,{finetuneOptions:C}=e,{finetuneNudgePrecision:I}=e;const{history:M,animation:D,scrollElasticity:T,rangeInputElasticity:F,imageColorMatrix:W,imageConvolutionMatrix:O,imageGamma:y,imageVignette:V,imageNoise:tt,allowPan:k,allowZoom:N,allowZoomControls:it,allowPlayPause:ut}=f;A(t,D,J=>i(22,d=J));const at={imageColorMatrix:W,imageConvolutionMatrix:O,imageGamma:y,imageVignette:V,imageNoise:tt},gt=sn("elasticityMultiplier");A(t,gt,J=>i(6,p=J));const G="finetune-"+ea(),$t=ue({});A(t,$t,J=>i(23,u=J));const vt=ue({});A(t,vt,J=>i(7,h=J));let lt=[];const kt=pi(d?20:0);return A(t,kt,J=>i(20,l=J)),t.$$set=J=>{"stores"in J&&i(15,f=J.stores),"isActive"in J&&m(i(0,b=J.isActive)),"locale"in J&&i(16,w=J.locale),"finetuneControlConfiguration"in J&&i(17,S=J.finetuneControlConfiguration),"finetuneOptions"in J&&i(18,C=J.finetuneOptions),"finetuneNudgePrecision"in J&&i(19,I=J.finetuneNudgePrecision)},t.$$.update=()=>{var J;2097152&t.$$.dirty[0]&&k.set(c),2097152&t.$$.dirty[0]&&N.set(c),2097152&t.$$.dirty[0]&&it.set(c),2097152&t.$$.dirty[0]&&c&&ut.set(!0),327680&t.$$.dirty[0]&&i(1,n=C?C.map(([q,Z])=>({id:q,label:on(Z)?Z(w):Z})):[]),2&t.$$.dirty[0]&&i(2,r=n.length?n[0].id:void 0),4&t.$$.dirty[0]&&i(5,o=r&&{name:G,selected:r}),2&t.$$.dirty[0]&&i(4,a=n.map(q=>q.id)),131072&t.$$.dirty[0]&&S&&(J=S,lt&&lt.forEach(q=>q()),lt=a.map(q=>{const{getStore:Z,getValue:xt=Ki}=J[q];return Z(at).subscribe(nt=>{const mt=nt!=null?xt(nt):nt;wt($t,u={...u,[q]:mt},u)})})),8519680&t.$$.dirty[0]&&S&&u&&wt(vt,h=Object.keys(u).reduce((q,Z)=>{const{base:xt,min:nt,max:mt,getLabel:zt,getStore:oe,setValue:Dt=(U,Tt)=>U.set(Tt)}=S[Z],te=oe(at),Kt=u[Z]!=null?u[Z]:xt;return q[Z]={base:xt,min:nt,max:mt,value:Kt,valueLabel:zt?zt(Kt,nt,mt,mt-nt):Math.round(100*Kt),oninputmove:U=>{Dt(te,U)},oninputend:U=>{Dt(te,U),M.write()},elasticity:p*F,labelReset:w.labelReset,nudgeMultiplier:I},q},{}),h),6291456&t.$$.dirty[0]&&d&&kt.set(c?0:20),1048576&t.$$.dirty[0]&&i(3,s=l?`transform: translateY(${l}px)`:void 0)},[b,n,r,s,a,o,p,h,D,T,gt,$t,vt,kt,"finetune",f,w,S,C,I,l,c,d,u,({detail:J})=>i(2,r=J),function(J){Wr.call(this,t,J)}]}var RS={util:["finetune",class extends ci{constructor(t){super(),li(this,t,PS,MS,oi,{name:14,stores:15,isActive:0,locale:16,finetuneControlConfiguration:17,finetuneOptions:18,finetuneNudgePrecision:19},null,[-1,-1])}get name(){return this.$$.ctx[14]}get stores(){return this.$$.ctx[15]}set stores(t){this.$$set({stores:t}),E()}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get locale(){return this.$$.ctx[16]}set locale(t){this.$$set({locale:t}),E()}get finetuneControlConfiguration(){return this.$$.ctx[17]}set finetuneControlConfiguration(t){this.$$set({finetuneControlConfiguration:t}),E()}get finetuneOptions(){return this.$$.ctx[18]}set finetuneOptions(t){this.$$set({finetuneOptions:t}),E()}get finetuneNudgePrecision(){return this.$$.ctx[19]}set finetuneNudgePrecision(t){this.$$set({finetuneNudgePrecision:t}),E()}}]},vu=(t,e)=>{const i=e.length;return t<0?t%i+i:t>=i?t%i:t};function hf(t,e,i){const n=t.slice();return n[46]=e[i].key,n[47]=e[i].index,n[48]=e[i].translate,n[49]=e[i].scale,n[50]=e[i].selected,n[12]=e[i].rotate,n[51]=e[i].dir,n[52]=e[i].center,n[53]=e[i].type,n[2]=e[i].visible,n}function mf(t){let e,i;return{c(){e=ht("div"),v(e,"class","PinturaShapeManipulator"),v(e,"data-control","point"),v(e,"style",i=`pointer-events:none;transform: translate3d(${t[52].x}px, ${t[52].y}px, 0) scale(${t[5]}, ${t[5]}); opacity: ${t[4]}`)},m(n,r){et(n,e,r)},p(n,r){56&r[0]&&i!==(i=`pointer-events:none;transform: translate3d(${n[52].x}px, ${n[52].y}px, 0) scale(${n[5]}, ${n[5]}); opacity: ${n[4]}`)&&v(e,"style",i)},d(n){n&&Q(e)}}}function $f(t,e){let i,n,r,o,a,s,l,c,d,u;function p(...g){return e[18](e[47],...g)}let h=e[53]==="edge"&&e[2]&&mf(e);return{key:t,first:null,c(){i=ht("div"),l=pe(),h&&h.c(),c=Tn(),v(i,"role","button"),v(i,"aria-label",n=`Drag ${e[53]} ${e[46]}`),v(i,"tabindex",r=e[53]==="edge"?-1:0),v(i,"class","PinturaShapeManipulator"),v(i,"data-control",o=e[53]),v(i,"data-selected",a=e[50]),v(i,"style",s=`cursor:${e[51]?e[51]+"-resize":"move"};opacity:${e[4]};--tx:${e[48].x};--ty:${e[48].y};--r:${e[53]==="edge"?e[12]:0}rad;--sx:${e[53]==="point"?e[5]:e[49].x};--sy:${e[53]==="point"?e[5]:e[49].y};`),this.first=i},m(g,m){et(g,i,m),et(g,l,m),h&&h.m(g,m),et(g,c,m),d||(u=[Mt(i,"nudge",p),Xi(Ds.call(null,i,{preventDefault:!0})),Mt(i,"interactionstart",function(){Zi(e[9]("start",e[47]))&&e[9]("start",e[47]).apply(this,arguments)}),Mt(i,"interactionupdate",function(){Zi(e[9]("move",e[47]))&&e[9]("move",e[47]).apply(this,arguments)}),Mt(i,"interactionend",function(){Zi(e[9]("end",e[47]))&&e[9]("end",e[47]).apply(this,arguments)}),Xi(Fs.call(null,i,{observeKeys:!0}))],d=!0)},p(g,m){e=g,8&m[0]&&n!==(n=`Drag ${e[53]} ${e[46]}`)&&v(i,"aria-label",n),8&m[0]&&r!==(r=e[53]==="edge"?-1:0)&&v(i,"tabindex",r),8&m[0]&&o!==(o=e[53])&&v(i,"data-control",o),8&m[0]&&a!==(a=e[50])&&v(i,"data-selected",a),56&m[0]&&s!==(s=`cursor:${e[51]?e[51]+"-resize":"move"};opacity:${e[4]};--tx:${e[48].x};--ty:${e[48].y};--r:${e[53]==="edge"?e[12]:0}rad;--sx:${e[53]==="point"?e[5]:e[49].x};--sy:${e[53]==="point"?e[5]:e[49].y};`)&&v(i,"style",s),e[53]==="edge"&&e[2]?h?h.p(e,m):(h=mf(e),h.c(),h.m(c.parentNode,c)):h&&(h.d(1),h=null)},d(g){g&&Q(i),g&&Q(l),h&&h.d(g),g&&Q(c),d=!1,Ui(u)}}}function gf(t){let e,i,n,r;return{c(){e=ht("div"),v(e,"role","button"),v(e,"aria-label","Drag rotator"),v(e,"tabindex","0"),v(e,"class","PinturaShapeManipulator"),v(e,"data-control","rotate"),v(e,"style",i=`transform: translate3d(${t[0].x}px, ${t[0].y}px, 0) scale(${t[5]}, ${t[5]}); opacity: ${t[4]}`)},m(o,a){et(o,e,a),n||(r=[Mt(e,"nudge",t[11]),Xi(Ds.call(null,e,{preventDefault:!0})),Mt(e,"interactionstart",t[12]("start")),Mt(e,"interactionupdate",t[12]("move")),Mt(e,"interactionend",t[12]("end")),Xi(Fs.call(null,e,{observeKeys:!0}))],n=!0)},p(o,a){49&a[0]&&i!==(i=`transform: translate3d(${o[0].x}px, ${o[0].y}px, 0) scale(${o[5]}, ${o[5]}); opacity: ${o[4]}`)&&v(e,"style",i)},d(o){o&&Q(e),n=!1,Ui(r)}}}function IS(t){let e,i,n=[],r=new Map,o=t[3];const a=l=>l[46];for(let l=0;l<o.length;l+=1){let c=hf(t,o,l),d=a(c);r.set(d,n[l]=$f(d,c))}let s=t[1]&&gf(t);return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=pe(),s&&s.c(),i=Tn()},m(l,c){for(let d=0;d<n.length;d+=1)n[d].m(l,c);et(l,e,c),s&&s.m(l,c),et(l,i,c)},p(l,c){1592&c[0]&&(o=l[3],n=La(n,c,a,1,l,o,r,e.parentNode,qy,$f,e,hf)),l[1]?s?s.p(l,c):(s=gf(l),s.c(),s.m(i.parentNode,i)):s&&(s.d(1),s=null)},i:ni,o:ni,d(l){for(let c=0;c<n.length;c+=1)n[c].d(l);l&&Q(e),s&&s.d(l),l&&Q(i)}}}function ES(t,e,i){let n,r,o,a;const s=ba(),l=.5*Ko,c=Wo-l,d=Wo+l,u=-Wo,p=u-l,h=u+l,g=lp-l,m=-lp+l,f=l,b=-l,w=Wo-Ko,S=w-l,C=w+l,I=lp-Ko,M=I-l,D=I+l,T=u-Ko,F=T+l,W=T-l,O=u+Ko,y=O+l,V=O-l;let{visible:tt=!1}=e,{points:k=[]}=e,{rotatorPoint:N}=e,{selectedPoint:it}=e,{enableDragEdges:ut=!0}=e,{enableDragPoints:at=!0}=e,{enableRotatePoints:gt=!0}=e;const G=sn("isAnimated");A(t,G,J=>i(17,r=J));const $t=pi(.5,{precision:1e-4,stiffness:.3,damping:.7});A(t,$t,J=>i(5,a=J));const vt=pi(0,{precision:.001,stiffness:.3,damping:.7});A(t,vt,J=>i(4,o=J));const lt=J=>{let q="";return(J<=d&&J>=c||J>=p&&J<=h)&&(q="ns"),(J<=m||J>=g||J>=b&&J<=f)&&(q="ew"),(J>=M&&J<=D||J<=y&&J>=V)&&(q="nesw"),(J>=S&&J<=C||J<=F&&J>=W)&&(q="nwse"),q},kt=(J,q)=>{s("resizestart",{indexes:J,translation:rn(),isNudge:!0}),s("resizemove",{indexes:J,translation:q,isNudge:!0}),s("resizeend",{indexes:J,translation:rn(),isNudge:!0})};return t.$$set=J=>{"visible"in J&&i(2,tt=J.visible),"points"in J&&i(13,k=J.points),"rotatorPoint"in J&&i(0,N=J.rotatorPoint),"selectedPoint"in J&&i(14,it=J.selectedPoint),"enableDragEdges"in J&&i(15,ut=J.enableDragEdges),"enableDragPoints"in J&&i(16,at=J.enableDragPoints),"enableRotatePoints"in J&&i(1,gt=J.enableRotatePoints)},t.$$.update=()=>{131076&t.$$.dirty[0]&&$t.set(tt?1:.5,{hard:r===!1}),131076&t.$$.dirty[0]&&vt.set(tt?1:0,{hard:r===!1}),8192&t.$$.dirty[0]&&i(3,n=((J,q)=>{let Z=0;const xt=Do(J),nt=[],mt=J.length;for(;Z<mt;Z++){const zt=vu(Z-1,J),oe=vu(Z+1,J),Dt=J[zt],te=J[Z],Kt=J[oe],U=Math.atan2(Kt.y-te.y,Kt.x-te.x);if(at){const dt=ro(ot(Dt.x-te.x,Dt.y-te.y)),Jt=ro(ot(Kt.x-te.x,Kt.y-te.y)),se=ot(dt.x+Jt.x,dt.y+Jt.y),ee=ut?at&&lt(Math.atan2(se.y,se.x)):void 0;nt.push({index:[Z],key:"point-"+Z,type:"point",selected:it===Z,scale:{x:1,y:1},translate:{x:te.x,y:te.y},angle:void 0,rotate:gt,center:te,dir:ee})}if(!ut||Array.isArray(ut)&&!ut.some(([dt,Jt])=>Z===dt&&oe===Jt))continue;const Tt=ot(te.x+.5*(Kt.x-te.x),te.y+.5*(Kt.y-te.y));nt.push({index:[Z,oe],key:"edge-"+Z,type:"edge",scale:{x:ho(te,Kt),y:1},translate:{x:te.x,y:te.y},angle:U,rotate:U,center:Tt,visible:Array.isArray(ut),dir:lt(Math.atan2(xt.y-Tt.y,xt.x-Tt.x))})}return nt})(k))},[N,gt,tt,n,o,a,G,$t,vt,(J,q)=>({detail:Z})=>{const xt=Z&&Z.translation?Z.translation:ot(0,0);s("resize"+J,{...Z,indexes:q,translation:xt})},kt,({detail:J})=>{s("rotatestart",{translation:rn(),isNudge:!0}),s("rotatemove",{translation:J,isNudge:!0}),s("rotateend",{translation:rn(),isNudge:!0})},J=>({detail:q})=>{const Z=q&&q.translation?q.translation:ot(0,0);s("rotate"+J,{...q,translation:Z})},k,it,ut,at,r,(J,{detail:q})=>kt(J,q)]}class AS extends ci{constructor(e){super(),li(this,e,ES,IS,oi,{visible:2,points:13,rotatorPoint:0,selectedPoint:14,enableDragEdges:15,enableDragPoints:16,enableRotatePoints:1},null,[-1,-1])}}var hh=(t,e)=>{const i=Qh(t);return Bn(i,e)},Kd=t=>document.createTextNode(t),K2=t=>(Ea()&&t.endsWith("<div><br></div>")?t.replace(/<div><br><\/div>$/,"<br><br>"):t).replace(/<div><br><\/div>/g,"<br>").replace(/<\/div>/g,"").replace(/<div>/g,"<br>");function ff(t){let e,i;return{c(){e=ht("pre"),v(e,"class","PinturaContentEditable"),v(e,"style",i=t[7]+";position:absolute;z-index:-1;pointer-events:none;")},m(n,r){et(n,e,r),e.innerHTML=t[0]},p(n,r){1&r[0]&&(e.innerHTML=n[0]),128&r[0]&&i!==(i=n[7]+";position:absolute;z-index:-1;pointer-events:none;")&&v(e,"style",i)},d(n){n&&Q(e)}}}function LS(t){let e,i,n,r,o,a,s=t[8]&&ff(t);return{c(){s&&s.c(),e=pe(),i=ht("pre"),v(i,"class","PinturaContentEditable"),v(i,"data-wrap-content",n=t[4]||t[5]?"wrap":"nowrap"),v(i,"contenteditable",""),v(i,"spellcheck",t[1]),v(i,"autocorrect",t[2]),v(i,"autocapitalize",t[3]),v(i,"style",r=t[8]?t[15](t[7]):t[7])},m(l,c){s&&s.m(l,c),et(l,e,c),et(l,i,c),t[26](i),o||(a=[Mt(i,"input",t[13]),Mt(i,"compositionend",t[12]),Mt(i,"paste",t[14]),Mt(i,"keydown",t[10]),Mt(i,"keyup",t[11]),Mt(i,"blur",t[9])],o=!0)},p(l,c){l[8]?s?s.p(l,c):(s=ff(l),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),48&c[0]&&n!==(n=l[4]||l[5]?"wrap":"nowrap")&&v(i,"data-wrap-content",n),2&c[0]&&v(i,"spellcheck",l[1]),4&c[0]&&v(i,"autocorrect",l[2]),8&c[0]&&v(i,"autocapitalize",l[3]),384&c[0]&&r!==(r=l[8]?l[15](l[7]):l[7])&&v(i,"style",r)},i:ni,o:ni,d(l){s&&s.d(l),l&&Q(e),l&&Q(i),t[26](null),o=!1,Ui(a)}}}function zS(t,e,i){let n,r,{spellcheck:o="false"}=e,{autocorrect:a="off"}=e,{autocapitalize:s="off"}=e,{wrapLines:l=!0}=e,{allowNewline:c=!0}=e,{textFormat:d="text"}=e,{formatInput:u=Ki}=e,{formatPaste:p=Ki}=e,{style:h}=e,{innerHTML:g}=e,{oninput:m=me}=e,{enableTextStyleShortcuts:f=!1}=e;const b=()=>{if(!S)return;const k=document.createRange();k.selectNodeContents(S);const N=W();N.removeAllRanges(),N.addRange(k)},w=ba();let S;document.execCommand("defaultParagraphSeparator",!1,"br");const C=k=>k.replace(/<\/?(?:i|b|em|u|s|strike|strong|font)>/,"").replace(/style=".*?"/g,"").replace(/\n/gim,"<br>"),I=()=>{i(0,g=S.innerHTML);const k=K2(g);w("input",k),m(k),requestAnimationFrame(()=>S&&S.scrollTo(0,0))},M=()=>{O(S);const k=d==="html"?S.innerHTML:C(S.innerHTML);i(6,S.innerHTML=u(k),S),y(S),I()},D={b:"bold",i:"italic",u:"underline",s:"strikethrough"},T=k=>{const N=xn("span");return N.dataset.bookmark=k,N},F=(k,N,it)=>{const ut=T(it);if(k.nodeType===Node.TEXT_NODE){const at=k.textContent;if(it==="start"){const gt=Kd(at.substr(0,N)),G=Kd(at.substr(N));k.replaceWith(gt,ut,G)}else{const gt=Kd(at.substr(0,N)),G=Kd(at.substr(N));k.replaceWith(gt,ut,G)}}else k.nodeType===Node.ELEMENT_NODE&&k.insertBefore(ut,k.childNodes[N])},W=()=>{const k=S.getRootNode();return"getSelection"in k?k.getSelection():document.getSelection()},O=k=>{const N=W();if(!N.getRangeAt||!N.rangeCount)return;const it=N.getRangeAt(0),{startOffset:ut,endOffset:at,startContainer:gt,endContainer:G}=it;if(k.contains(it.startContainer)&&k.contains(it.endContainer))if(gt.nodeType===Node.TEXT_NODE&&gt===G){const $t=gt.textContent,vt=$t.substr(0,ut),lt=T("start"),kt=at-ut>0?$t.substr(ut,at):"",J=T("end"),q=$t.substr(at);gt.replaceWith(vt,lt,kt,J,q)}else F(gt,ut,"start"),F(G,at+(gt===G?1:0),"end")},y=k=>{const N=V(k,"start"),it=V(k,"end");if(!N||!it)return;const ut=document.createRange();ut.setStart(N,0),ut.setEnd(it,0);const at=W();at.removeAllRanges(),at.addRange(ut),N.remove(),it.remove()},V=(k,N)=>{const it=k.children;for(let ut=0;ut<it.length;ut++){const at=it[ut];if(at.dataset.bookmark===N)return at;if(at.children.length){const gt=V(at,N);if(gt)return gt}}};let tt;return t.$$set=k=>{"spellcheck"in k&&i(1,o=k.spellcheck),"autocorrect"in k&&i(2,a=k.autocorrect),"autocapitalize"in k&&i(3,s=k.autocapitalize),"wrapLines"in k&&i(4,l=k.wrapLines),"allowNewline"in k&&i(5,c=k.allowNewline),"textFormat"in k&&i(16,d=k.textFormat),"formatInput"in k&&i(17,u=k.formatInput),"formatPaste"in k&&i(18,p=k.formatPaste),"style"in k&&i(19,h=k.style),"innerHTML"in k&&i(0,g=k.innerHTML),"oninput"in k&&i(20,m=k.oninput),"enableTextStyleShortcuts"in k&&i(21,f=k.enableTextStyleShortcuts)},t.$$.update=()=>{var k;if(64&t.$$.dirty[0]&&i(25,n=!!S),33554433&t.$$.dirty[0]&&n&&g&&(k=g)!==S.innerHTML&&(i(6,S.innerHTML=k,S),S===document.activeElement&&b()),524336&t.$$.dirty[0])if(!l&&c){const N=h.includes(":right")?"text-indent:-100px!important":h.includes(":center")?"":"min-width:calc(100% + 100px)!important";i(7,tt=h+";overflow:visible;"+N)}else i(7,tt=h);524288&t.$$.dirty[0]&&i(8,r=h.includes("text-stroke"))},[g,o,a,s,l,c,S,tt,r,()=>{w("blur")},k=>{if(/escape/i.test(k.code))return k.stopPropagation(),void w("cancel");const N=k.ctrlKey||k.metaKey;if(d==="html"&&N&&/b|i|u|s/.test(k.key))return f&&(it=>{const ut=D[it];ut&&document.execCommand(ut)})(k.key),void k.preventDefault();/enter/i.test(k.code)&&(k.stopPropagation(),k.isComposing||(N?w("confirm"):(c||k.preventDefault(),document.execCommand("insertLineBreak"),k.preventDefault())))},()=>{},k=>{k.data!==""&&M()},k=>{const{inputType:N}=k;N!=="insertCompositionText"&&N!=="deleteCompositionText"&&M()},k=>{k.preventDefault();const N=k.clipboardData.getData("text/plain"),it=d==="html"?N:C(N),ut=p(it);if(!ut.length)return;const at=W().getRangeAt(0);at.deleteContents(),at.insertNode(document.createTextNode(ut)),I()},k=>k.replace("-webkit-text-stroke","--text-stroke").replace("text-shadow","--text-shadow"),d,u,p,h,m,f,()=>M(),()=>S&&S.focus(),b,n,function(k){zi[k?"unshift":"push"](()=>{S=k,i(6,S)})}]}class FS extends ci{constructor(e){super(),li(this,e,zS,LS,oi,{spellcheck:1,autocorrect:2,autocapitalize:3,wrapLines:4,allowNewline:5,textFormat:16,formatInput:17,formatPaste:18,style:19,innerHTML:0,oninput:20,enableTextStyleShortcuts:21,confirm:22,focus:23,select:24},null,[-1,-1])}get spellcheck(){return this.$$.ctx[1]}set spellcheck(e){this.$$set({spellcheck:e}),E()}get autocorrect(){return this.$$.ctx[2]}set autocorrect(e){this.$$set({autocorrect:e}),E()}get autocapitalize(){return this.$$.ctx[3]}set autocapitalize(e){this.$$set({autocapitalize:e}),E()}get wrapLines(){return this.$$.ctx[4]}set wrapLines(e){this.$$set({wrapLines:e}),E()}get allowNewline(){return this.$$.ctx[5]}set allowNewline(e){this.$$set({allowNewline:e}),E()}get textFormat(){return this.$$.ctx[16]}set textFormat(e){this.$$set({textFormat:e}),E()}get formatInput(){return this.$$.ctx[17]}set formatInput(e){this.$$set({formatInput:e}),E()}get formatPaste(){return this.$$.ctx[18]}set formatPaste(e){this.$$set({formatPaste:e}),E()}get style(){return this.$$.ctx[19]}set style(e){this.$$set({style:e}),E()}get innerHTML(){return this.$$.ctx[0]}set innerHTML(e){this.$$set({innerHTML:e}),E()}get oninput(){return this.$$.ctx[20]}set oninput(e){this.$$set({oninput:e}),E()}get enableTextStyleShortcuts(){return this.$$.ctx[21]}set enableTextStyleShortcuts(e){this.$$set({enableTextStyleShortcuts:e}),E()}get confirm(){return this.$$.ctx[22]}get focus(){return this.$$.ctx[23]}get select(){return this.$$.ctx[24]}}const yf=["i","b","u","strike"].map(t=>({tag:t,tagOpen:new RegExp(`<${t}>`,"g"),tagClose:new RegExp(`</${t}>`,"g"),placeholderOpen:new RegExp(`___${t}O___`,"g"),placeholderClose:new RegExp(`___${t}C___`,"g")}));var DS=t=>t=((e,i=yf)=>(i.forEach(({tag:n,placeholderOpen:r,placeholderClose:o})=>{e=e.replace(r,`<${n}>`).replace(o,`</${n}>`)}),e))(t=(t=((e,i=yf)=>(i.forEach(({tag:n,tagOpen:r,tagClose:o})=>{e=e.replace(r,`___${n}O___`).replace(o,`___${n}C___`)}),e))(t)).replace(/ {2,}/g," ").replace(/\u00a0/g,"&nbsp;").split(`
`).join("<br>")),Jd=(t,e)=>_e(t)?parseFloat(t)/100*e:t,vc=(t,e)=>({x:Fr(t.x,e.width),y:Fr(t.y,e.height)});function xf(t,e,i){const n=t.slice();return n[284]=e[i],n[286]=i,n}function bf(t,e){let i,n,r,o,a,s,l,c,d,u,p,h=e[284].name+"";function g(){return e[183](e[286])}return r=new Jh({props:{color:e[284].color}}),{key:t,first:null,c(){i=ht("li"),n=ht("button"),Et(r.$$.fragment),o=pe(),a=ht("span"),s=mn(h),c=pe(),v(n,"class","PinturaShapeListItem"),v(n,"type","button"),v(n,"aria-label",l="Select shape "+e[284].name),this.first=i},m(m,f){et(m,i,f),Ct(i,n),Rt(r,n,null),Ct(n,o),Ct(n,a),Ct(a,s),Ct(i,c),d=!0,u||(p=Mt(n,"click",g),u=!0)},p(m,f){e=m;const b={};2097152&f[0]&&(b.color=e[284].color),r.$set(b),(!d||2097152&f[0])&&h!==(h=e[284].name+"")&&In(s,h),(!d||2097152&f[0]&&l!==(l="Select shape "+e[284].name))&&v(n,"aria-label",l)},i(m){d||(P(r.$$.fragment,m),d=!0)},o(m){z(r.$$.fragment,m),d=!1},d(m){m&&Q(i),It(r),u=!1,p()}}}function vf(t){let e,i;return e=new AS({props:{visible:!0,points:t[12],rotatorPoint:t[27],selectedPoint:t[16],enableDragEdges:t[17],enableDragPoints:t[29],enableRotatePoints:t[14]}}),e.$on("resizestart",t[38]),e.$on("resizemove",t[39]),e.$on("resizeend",t[40]),e.$on("rotatestart",t[41]),e.$on("rotatemove",t[42]),e.$on("rotateend",t[43]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4096&r[0]&&(o.points=n[12]),134217728&r[0]&&(o.rotatorPoint=n[27]),65536&r[0]&&(o.selectedPoint=n[16]),131072&r[0]&&(o.enableDragEdges=n[17]),536870912&r[0]&&(o.enableDragPoints=n[29]),16384&r[0]&&(o.enableRotatePoints=n[14]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function wf(t){let e,i,n,r;const o=[OS,BS],a=[];function s(l,c){return l[4]==="modal"?0:l[4]==="inline"?1:-1}return~(e=s(t))&&(i=a[e]=o[e](t)),{c(){i&&i.c(),n=Tn()},m(l,c){~e&&a[e].m(l,c),et(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?~e&&a[e].p(l,c):(i&&(Ie(),z(a[d],1,1,()=>{a[d]=null}),Ee()),~e?(i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),P(i,1),i.m(n.parentNode,n)):i=null)},i(l){r||(P(i),r=!0)},o(l){z(i),r=!1},d(l){~e&&a[e].d(l),l&&Q(n)}}}function BS(t){let e,i,n,r,o,a={formatInput:t[45],wrapLines:!!t[13].width,textFormat:t[13].format,enableTextStyleShortcuts:t[5],allowNewline:t[28],style:t[26]};return i=new FS({props:a}),t[186](i),i.$on("input",t[46]),i.$on("keyup",t[49]),i.$on("cancel",t[51]),i.$on("confirm",t[50]),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaInlineInput"),v(e,"style",t[25])},m(s,l){et(s,e,l),Rt(i,e,null),n=!0,r||(o=Mt(e,"focusout",t[187]),r=!0)},p(s,l){const c={};8192&l[0]&&(c.wrapLines=!!s[13].width),8192&l[0]&&(c.textFormat=s[13].format),32&l[0]&&(c.enableTextStyleShortcuts=s[5]),268435456&l[0]&&(c.allowNewline=s[28]),67108864&l[0]&&(c.style=s[26]),i.$set(c),(!n||33554432&l[0])&&v(e,"style",s[25])},i(s){n||(P(i.$$.fragment,s),n=!0)},o(s){z(i.$$.fragment,s),n=!1},d(s){s&&Q(e),t[186](null),It(i),r=!1,o()}}}function OS(t){let e,i;return e=new z2({props:{panelOffset:t[2],onconfirm:t[50],oncancel:t[51],buttonCancel:{icon:t[6].shapeIconInputCancel,label:t[6].shapeLabelInputCancel},buttonConfirm:{icon:t[6].shapeIconInputConfirm,label:t[6].shapeLabelInputConfirm,hideLabel:!0},$$slots:{default:[WS]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4&r[0]&&(o.panelOffset=n[2]),64&r[0]&&(o.buttonCancel={icon:n[6].shapeIconInputCancel,label:n[6].shapeLabelInputCancel}),64&r[0]&&(o.buttonConfirm={icon:n[6].shapeIconInputConfirm,label:n[6].shapeLabelInputConfirm,hideLabel:!0}),83886336&r[0]|256&r[9]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function WS(t){let e,i,n;return{c(){e=ht("textarea"),v(e,"spellcheck","false"),v(e,"autocorrect","off"),v(e,"autocapitalize","off"),v(e,"style",t[26])},m(r,o){et(r,e,o),t[184](e),qm(e,t[24]),i||(n=[Mt(e,"keydown",t[48]),Mt(e,"keypress",t[47]),Mt(e,"keyup",t[49]),Mt(e,"input",t[46]),Mt(e,"input",t[185])],i=!0)},p(r,o){67108864&o[0]&&v(e,"style",r[26]),16777216&o[0]&&qm(e,r[24])},d(r){r&&Q(e),t[184](null),i=!1,Ui(n)}}}function Sf(t){let e,i,n,r,o;return i=new oo({props:{items:t[22],key:t[10]}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaShapeControls"),v(e,"style",t[23])},m(a,s){et(a,e,s),Rt(i,e,null),n=!0,r||(o=[Mt(e,"measure",t[188]),Xi(yr.call(null,e))],r=!0)},p(a,s){const l={};4194304&s[0]&&(l.items=a[22]),1024&s[0]&&(l.key=a[10]),i.$set(l),(!n||8388608&s[0])&&v(e,"style",a[23])},i(a){n||(P(i.$$.fragment,a),n=!0)},o(a){z(i.$$.fragment,a),n=!1},d(a){a&&Q(e),It(i),r=!1,Ui(o)}}}function _S(t){let e,i,n,r,o,a,s,l,c,d,u=[],p=new Map,h=t[21];const g=w=>w[284].id;for(let w=0;w<h.length;w+=1){let S=xf(t,h,w),C=g(S);p.set(C,u[w]=bf(C,S))}let m=t[15]&&vf(t),f=t[11]&&wf(t),b=t[18]>0&&Sf(t);return{c(){e=ht("div"),i=ht("nav"),n=ht("ul");for(let w=0;w<u.length;w+=1)u[w].c();r=pe(),m&&m.c(),o=pe(),f&&f.c(),a=pe(),b&&b.c(),v(i,"class","PinturaShapeList"),v(i,"data-visible",t[19]),v(e,"class","PinturaShapeEditor"),v(e,"tabindex","0")},m(w,S){et(w,e,S),Ct(e,i),Ct(i,n);for(let C=0;C<u.length;C+=1)u[C].m(n,null);Ct(e,r),m&&m.m(e,null),Ct(e,o),f&&f.m(e,null),Ct(e,a),b&&b.m(e,null),t[189](e),l=!0,c||(d=[Mt(i,"focusin",t[54]),Mt(i,"focusout",t[55]),Mt(e,"keydown",function(){Zi(t[0]?me:t[44])&&(t[0]?me:t[44]).apply(this,arguments)}),Mt(e,"nudge",function(){Zi(t[0]?me:t[53])&&(t[0]?me:t[53]).apply(this,arguments)}),Mt(e,"measure",t[182]),Mt(e,"pointermove",function(){Zi(t[0]?me:t[56])&&(t[0]?me:t[56]).apply(this,arguments)}),Mt(e,"pointerleave",function(){Zi(t[0]?me:t[57])&&(t[0]?me:t[57]).apply(this,arguments)}),Mt(e,"interactionstart",function(){Zi(t[0]?me:t[32])&&(t[0]?me:t[32]).apply(this,arguments)}),Mt(e,"interactionupdate",function(){Zi(t[0]?me:t[34])&&(t[0]?me:t[34]).apply(this,arguments)}),Mt(e,"interactioncancel",function(){Zi(t[0]?me:t[33])&&(t[0]?me:t[33]).apply(this,arguments)}),Mt(e,"interactionrelease",function(){Zi(t[0]?me:t[35])&&(t[0]?me:t[35]).apply(this,arguments)}),Mt(e,"interactionend",function(){Zi(t[0]?me:t[36])&&(t[0]?me:t[36]).apply(this,arguments)}),Xi(yr.call(null,e)),Xi(Ds.call(null,e)),Xi(s=Fs.call(null,e,{drag:!0,inertia:!0,multiTouch:!1,observeKeys:!0,shouldStartInteraction:kf,getEventPosition:t[190]}))],c=!0)},p(w,S){t=w,2097282&S[0]&&(h=t[21],Ie(),u=La(u,S,g,1,t,h,p,n,Ls,bf,null,xf),Ee()),(!l||524288&S[0])&&v(i,"data-visible",t[19]),t[15]?m?(m.p(t,S),32768&S[0]&&P(m,1)):(m=vf(t),m.c(),P(m,1),m.m(e,o)):m&&(Ie(),z(m,1,1,()=>{m=null}),Ee()),t[11]?f?(f.p(t,S),2048&S[0]&&P(f,1)):(f=wf(t),f.c(),P(f,1),f.m(e,a)):f&&(Ie(),z(f,1,1,()=>{f=null}),Ee()),t[18]>0?b?(b.p(t,S),262144&S[0]&&P(b,1)):(b=Sf(t),b.c(),P(b,1),b.m(e,null)):b&&(Ie(),z(b,1,1,()=>{b=null}),Ee()),s&&Zi(s.update)&&8&S[0]&&s.update.call(null,{drag:!0,inertia:!0,multiTouch:!1,observeKeys:!0,shouldStartInteraction:kf,getEventPosition:t[190]})},i(w){if(!l){for(let S=0;S<h.length;S+=1)P(u[S]);P(m),P(f),P(b),l=!0}},o(w){for(let S=0;S<u.length;S+=1)z(u[S]);z(m),z(f),z(b),l=!1},d(w){w&&Q(e);for(let S=0;S<u.length;S+=1)u[S].d();m&&m.d(),f&&f.d(),b&&b.d(),t[189](null),c=!1,Ui(d)}}}const kf=(t,e)=>t.target===e;function VS(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,I,M,D,T,F,W,O,y,V,tt,k,N,it,ut,at,gt,G,$t,vt,lt,kt,J,q,Z,xt,nt,mt,zt,oe,Dt,te,Kt,U,Tt,dt,Jt,se,ee,be,ve=ni,_=()=>(ve(),ve=Br(Ot,x=>i(178,dt=x)),Ot);t.$$.on_destroy.push(()=>ve());let{uid:ke=ea()}=e,{ui:fi}=e,{disabled:ye=!1}=e,{shapes:Ot}=e;_();let{selection:ze}=e,{offset:Re}=e,{contextRotation:Oe=0}=e,{contextFlipX:di=!1}=e,{contextFlipY:bt=!1}=e,{contextZoom:le=1}=e,{active:Xe=!1}=e,{opacity:Ve=1}=e,{parentRect:At}=e,{rootRect:Ge}=e,{utilRect:Ye}=e,{hoverColor:$i}=e,{caretColor:bi}=e,{gridColor:Mi}=e,{snapColor:Ci}=e,{textInputMode:X="inline"}=e,{oninteractionstart:Gt=me}=e,{oninteractionupdate:H=me}=e,{oninteractionrelease:Zt=me}=e,{oninteractionend:ae=me}=e,{oninteractioncancel:jt=me}=e,{onaddshape:$e=me}=e,{onupdateshape:Xt=me}=e,{onselectshape:Le=me}=e,{onblurshape:qe=me}=e,{onremoveshape:Ne=me}=e,{ontapshape:pt=me}=e,{onhovershape:Ht=me}=e,{onhovercanvas:ie=me}=e,{ontapcanvas:Fe=me}=e,{onleavecanvas:Wt=me}=e,{beforeSelectShape:K=()=>!0}=e,{beforeDeselectShape:Yt=()=>!0}=e,{beforeRemoveShape:Ut=()=>!0}=e,{beforeUpdateShape:ne=(x,j,L)=>j}=e,{willRenderShapeControls:De=Ki}=e,{willRenderShapeTextControls:re=Ki}=e,{willStartInteraction:Bi=(x,j)=>!0}=e,{mapEditorPointToImagePoint:ti}=e,{mapImagePointToEditorPoint:Ce}=e,{eraseRadius:xe}=e,{selectRadius:Ke}=e,{enableButtonFlipVertical:Pe=!1}=e,{enableTapToAddText:je=!0}=e,{enableTextStyleControls:Me=!0}=e,{locale:fe}=e,{snapThreshold:Ti=0}=e,{snapPointer:Yi=!0}=e,{enableSnapToContext:En=!0}=e,{gridSize:bn=0}=e;const Vn=x=>{if(Ti===0)return[];let j;return En&&(j={...At,x:0,y:0}),[...dt.filter(L=>L!==x).filter(L=>!fo(L)).filter(L=>(rt=>rt.disableAcceptSnap!==!0)(L)).map(L=>Zn({...L},At)),j].filter(Boolean)},An=(x,j,L,rt)=>x===0?{snapTargets:[]}:{snapThreshold:x,gridSize:j,gridRect:L,snapTargets:Vn(rt)},qr=sn("isAnimated");A(t,qr,x=>i(179,se=x));const ao=x=>x.set(fa(x)),Ln=x=>fa(x).find(fo),xr=(x,j)=>{if(!Ln(j))return Zp(x),So(x,j)},vn=x=>{Ln(x)&&x.update(j=>j.filter(L=>!fo(L)))},Nn=x=>{const j=Ln(x);if(j)return Bm(j),ao(x),j},$n=(x,j,L=(rt,ct)=>({...rt,...ct}))=>{Ln(j)&&j.update(rt=>rt.map(ct=>fo(ct)?L(ct,x):ct))},So=(x,j=Ot)=>(j.update(L=>[...L,x]),x),Wi=(x,j,L)=>{const rt=ne({...x},j,{...L});return ga(x,rt,L),x},gn=(x,j)=>{const L=ho(x,j),rt=Dd(x,j),ct=Math.PI/8,Lt=ct*Math.round(rt/ct)-Oe%ct;j.x=x.x+L*Math.cos(Lt),j.y=x.y+L*Math.sin(Lt)},On=sn("keysPressed");A(t,On,x=>i(180,ee=x));const Vo=(x,j,L)=>x===0||j&&L?x:j||L?-x:x,Kr=x=>{if(x.x===null&&x.y===null)return $o();x.x&&i(139,ko=ti({x:x.x,y:0}).x),x.y&&i(140,dr=ti({x:0,y:x.y}).y)},$o=()=>{i(139,ko=null),i(140,dr=null)};let ko=null,dr=null;const cn=(x,j)=>{const L=Ce(x);return ti(Dn(L,j))},en=(x,j,L)=>{const rt=(L-j)/x+1;return Array.from({length:rt},(ct,Lt)=>j+Lt*x)},so=x=>{let j=[],L=[],rt=x.points;if(x.x1!==void 0&&(rt=[{x:x.x1,y:x.y1},{x:x.x2,y:x.y2}]),rt){const ct=rt.map(Ce),Lt=er(ct),Nt=ct[0],Vt=ct[ct.length-1];j=[Lt.x,Lt.x+.5*Lt.width,Lt.x+Lt.width,Nt.x,Vt.x],L=[Lt.y,Lt.y+.5*Lt.height,Lt.y+Lt.height,Nt.y,Vt.y]}else if(x.text||x.width!==void 0||x.rx!==void 0){let ct;if(x.text&&x.height===void 0){const qt=Fo(x.text,x);ct=Pn(x.x,x.y,qt.width,qt.height)}else ct=x.width!==void 0?ys(x):ys({x:x.x-x.rx,y:x.y-x.ry,width:2*x.rx,height:2*x.ry});const Lt=Oo(ct).map(Ce),Nt=Math.abs(x.rotation)>0?mr(ct,x.rotation).map(Ce):Lt,Vt=er(Nt),Bt=ki(Vt),Ft=.5*Vt.width,_t=.5*Vt.height;j=[Bt.x-Ft,Bt.x,Bt.x+Ft],L=[Bt.y-_t,Bt.y,Bt.y+_t]}else if(x.x!==void 0){const ct=Ce(x);j=[ct.x],L=[ct.y]}return{x:j,y:L}},No=(x,j,L)=>{let rt,ct,Lt,Nt=Number.Infinity,Vt=null,Bt=null;for(let Ft=0;Ft<x.length;Ft++){ct=x[Ft];for(let _t=0;_t<j.length;_t++)Lt=j[_t],rt=Math.abs(ct-Lt),rt<L&&(Bt===null||rt<Nt)&&(Nt=rt,Vt=ct,Bt=Lt)}return{origin:Vt,target:Bt}},br=(x,j,L,rt,ct)=>{const Lt={x:null,y:null},Nt={x:null,y:null},Vt=j.map(so);if(rt>0){const Bt=Ce({x:0,y:0}),Ft=Ce({x:rt,y:rt}),_t=Ce({x:ct.width,y:ct.height}),qt=Ft.x-Bt.x,ri=en(qt,Bt.x,_t.x),de=en(qt,Bt.y,_t.y);Vt.push({x:ri,y:de})}return Vt.forEach(Bt=>{const{snapTranslation:Ft,snapLine:_t}=((qt,ri,de)=>{const he={x:null,y:null},we={x:null,y:null},Se=No(qt.x,ri.x,de);Se.target!==null&&(he.x=Se.target,we.x=Se.target-Se.origin);const Ze=No(qt.y,ri.y,de);return Ze.target!==null&&(he.y=Ze.target,we.y=Ze.target-Ze.origin),{snapTranslation:we,snapLine:he}})(x,Bt,L);Ft.x!==null&&(Nt.x===null||Math.abs(Ft.x)<Math.abs(Nt.x))&&(Nt.x=Ft.x||0,Lt.x=_t.x),Ft.y!==null&&(Nt.y===null||Math.abs(Ft.y)<Math.abs(Nt.y))&&(Nt.y=Ft.y||0,Lt.y=_t.y)}),{snapTranslation:Nt,snapLines:Lt}},vr=(x,j)=>(j.x!==null&&(x.x+=j.x),j.y!==null&&(x.y+=j.y),x),lo=(x,j,L,rt)=>{const{snapThreshold:ct=0,gridSize:Lt=0,gridRect:Nt,snapTargets:Vt=[]}=rt||{};let Bt=null;if(tr(x)){if(ct){const qt=Zn({...x},At),ri=cn(Qa(j),L),de=cn(ts(j),L),he=so({...qt,x1:ri.x,y1:ri.y,x2:de.x,y2:de.y}),{snapTranslation:we,snapLines:Se}=br(he,Vt,ct,Lt,Nt);vr(L,we),Kr(Se)}const Ft=cn(Qa(j),L),_t=cn(ts(j),L);Bt={x1:Ft.x,y1:Ft.y,x2:_t.x,y2:_t.y}}else if(x.points){if(gp(Pt)&&Vi(Pt,{selectedPoint:void 0}),ct){const Ft=Zn({...x},At),_t=so({...Ft,points:j.points.map(de=>cn(de,L))}),{snapTranslation:qt,snapLines:ri}=br(_t,Vt,ct,Lt,Nt);vr(L,qt),Kr(ri)}Bt={points:j.points.map(Ft=>cn(Ft,L))}}else if(xo(x)||Xn(x)||Yn(x)){if(ct){const Ft=Zn({...x},At),_t=cn(j,L),qt=so({...Ft,..._t}),{snapTranslation:ri,snapLines:de}=br(qt,Vt,ct,Lt,Nt);vr(L,ri),Kr(de)}Bt=cn(j,L)}Bt&&(Wi(x,Bt,At),Wn())},la={0:1,1:0,2:3,3:2},Co={0:3,1:2,2:1,3:0};let To;const _r=(x,j)=>{const L=x.points.filter((rt,ct)=>ct!==j);Vi(x,{points:L,selectedPoint:void 0})},Jr=()=>{if(dt.length)return dt.find(fo)},Ir=()=>{if(dt.length)return dt.findIndex(fo)},ur=()=>{const x=Jr();if(x)return Bm(x),Wn(),x},wr=()=>{if(!Jr())return;const x=[...dt];x.splice(Ir(),1),Ot.set(x)},Wn=()=>{Ot.set(dt)},_i=(x,j=[],L=!0)=>{j.filter(Boolean).forEach(rt=>delete x[rt]),L&&Wn()},Vi=(x,j,L=!0)=>{x=Object.assign(x,j),L&&Wn()},lr=(x,j,L,rt=!0)=>{x[j]=L,rt&&Wn()},Ji=(x,j=!0)=>{dt.forEach(L=>Vi(L,x,!1)),j&&Wn()},Vr=()=>[...dt].reverse().find(xs),co=()=>!!Vr(),Qr=x=>{if(!Ut(x))return!1;Ot.set(dt.filter(j=>j!==x)),Ne(x)},pr=()=>{const x=Vr();if(!x)return;const j=dt.filter(ct=>Om(ct)&&ha(ct)),L=j.findIndex(ct=>ct===x);if(Qr(x)===!1)return;if(zn=x,j.length-1<=0)return Sr();const rt=L-1<0?j.length-1:L-1;cr(j[rt])};let zn;const Sr=(x={})=>{const{storePrevious:j=!0}=x;Object.keys(Uo).forEach(rt=>Uo[rt]={});const L=uo();j&&(zn=L),Ji({isSelected:!1,isEditing:!1,_prerender:!1}),L&&qe(L)},uo=()=>dt.find(xs),cr=(x,j=!0)=>{if(fo(x))return;const L=uo()||zn,rt=xs(x);zn=void 0,K(L,x)&&(Sr(),(ct=>{ct.isSelected=!0})(x),!rt&&Le(x),j&&Wn())},Kn=x=>{Di&&Di.confirm&&x.isEditing&&Di.confirm();const j={isSelected:!1,isEditing:!1,_prerender:!1};x.selectedPoint>-1&&(j.selectedPoint=void 0),Vi(x,j),qe(x)},Hn=x=>{Vi(x,{isSelected:!0,isEditing:!0,_prerender:X==="inline"})},Er=x=>{Vi(x,{isSelected:!0,isEditing:!1,_prerender:!1})},to=x=>{if(!x.length)return[];const j=x.filter(Ut);return Ot.set(dt.filter(L=>!j.includes(L))),j},eo=x=>{const j=Fo(x.text,x);return Pn(x.x,x.y,x.width?Math.min(x.width,j.width):j.width,x.height?Math.min(x.height,j.height):j.height)},Mn=x=>{if(el(x))return ys(x);if(Yn(x))return cp(x);const j=eo(x);return j.width=Math.max(10,x.width||j.width),j},Ar=(x,j,L=0,rt=()=>!0)=>[...x].reverse().filter(rt).map(ct=>({shape:ct,priority:1})).filter(ct=>{const{shape:Lt}=ct,Nt=Zn(jn(Lt),At),Vt=L+.5*(Nt.strokeWidth||0);if(xo(Nt))return dp(j,Vt,Nt,Lt.rotation);if(Xn(Nt)){const Bt=Mn(Nt),Ft=dp(j,Vt,Bt,Lt.rotation);let _t=!1;if(Ft&&!xs(Lt)){const qt=eo(Nt);Lt.textAlign!=="right"||Lt.flipX||(qt.x=Bt.x+Bt.width-qt.width),Lt.textAlign==="center"&&(qt.x=Bt.x+.5*Bt.width-.5*qt.width),_t=dp(j,Vt,qt,Lt.rotation,ki(Bt)),_t||(ct.priority=-1)}return Ft}return Yn(Nt)?((Bt,Ft,_t,qt,ri,de)=>{const he=uu(ot(_t.x,_t.y),_t.rx,_t.ry,qt,ri,de,12);return Gp(Bt,Ft,he)})(j,Vt,Nt,Lt.rotation,Lt.flipX,Lt.flipY):tr(Nt)?pu(j,Math.max(16,Vt),Qa(Nt),ts(Nt)):_n(Nt)&&Nt.pathClose?Gp(j,Vt,Nt.points):!!_n(Nt)&&(Nt.points.length===1?yo(j,Nt.points[0])<Vt*Vt:dy(j,Math.max(16,Vt),Nt.points))}).sort((ct,Lt)=>ct.priority<Lt.priority?1:ct.priority>Lt.priority?-1:0).map(ct=>ct.shape),B=(x,j,L,rt=0)=>{const ct=Math.abs(rt),Lt=Es(j,L),Nt=vh(Lt,ct),Vt=(({start:Bt,end:Ft},_t)=>{if(_t===0)return[ot(Bt.x,Bt.y),ot(Bt.x,Bt.y),ot(Ft.x,Ft.y),ot(Ft.x,Ft.y)];const qt=Math.atan2(Ft.y-Bt.y,Ft.x-Bt.x),ri=Math.sin(qt)*_t,de=Math.cos(qt)*_t;return[ot(ri+Bt.x,-de+Bt.y),ot(-ri+Bt.x,de+Bt.y),ot(-ri+Ft.x,de+Ft.y),ot(ri+Ft.x,-de+Ft.y)]})(Nt,ct);return x.filter(Bt=>{const Ft=Zn(jn(Bt),At);if(tr(Ft)||_n(Ft)){const _t=Ft.points?[...Ft.points]:[Qa(Ft),ts(Ft)];return!!sy(Nt,_t)}return((_t,qt)=>!!_t.find(ri=>Up(ri,qt))||!!qt.find(ri=>Up(ri,_t)))(Vt,((_t,qt=12)=>{if(xo(_t))return mr(_t,_t.rotation,ki(_t));if(Xn(_t)){const ri=Mn(_t);return mr(ri,_t.rotation,ki(ri))}return Yn(_t)?uu(ot(_t.x,_t.y),_t.rx,_t.ry,_t.rotation,_t.flipX,_t.flipY,qt):[]})(Ft))})};let ce,vi,Ue,Pt,ge,yi,Gi=!1,dn=!1,wi=!1;const Ni=()=>{clearTimeout(vi),vi=void 0,i(142,wi=!1),$o()};let Lr=null;const ca=x=>{const j=hi(x.rotation)&&x.rotation!==0;if(xo(x)){if(x.width<1&&x.height<1)return;const L=ki(x),rt=Oo(x);return(x.flipX||x.flipY)&&Al(rt,x.flipX,x.flipY,L.x,L.y),j?rl(rt,x.rotation,L.x,L.y):rt}if(Yn(x)){if(x.rx<1&&x.ry<1)return;const L=x,rt=Oo(cp(x));return(x.flipX||x.flipY)&&Al(rt,x.flipX,x.flipY,L.x,L.y),j?rl(rt,x.rotation,L.x,L.y):rt}if(tr(x))return[Qa(x),ts(x)];if(_n(x)){if(x.bitmap&&!x.pathClose){const L=er(x.points);return L.x-=.5*x.strokeWidth,L.y-=.5*x.strokeWidth,L.width+=x.strokeWidth,L.height+=x.strokeWidth,ca({...x,...L})}return[...x.points]}if(Xn(x)){if(x.width<5&&x.height<5)return;const L=Mn(x);L.width=Math.max(10,L.width);const rt=ki(L),ct=Oo(L);return(x.flipX||x.flipY)&&Al(ct,x.flipX,x.flipY,rt.x,rt.y),j?rl(ct,x.rotation,rt.x,rt.y):ct}return[]},da=x=>{const j=ca(x);let L,rt;return x.flipY?(L=Do([j[0],j[1]]),rt=ro(ot(j[1].x-j[2].x,j[1].y-j[2].y))):(L=Do([j[2],j[3]]),rt=ro(ot(j[2].x-j[1].x,j[2].y-j[1].y))),Mr(rt,20/le),{origin:L,dir:rt}},wa=x=>j=>j.id===x,Ho=x=>{const j=wa(x);return L=>L.filter((rt=>ct=>!rt(ct))(j))},Nr=x=>{const j=wa(x),L=Ho(x);return()=>fi.update(rt=>rt.some(j)?L(rt):rt)},Mo=x=>{const j=Ho(x);return(...L)=>{fi.update(rt=>[...j(rt),...L.filter(Boolean)])}},Po=Nr("markup-hover"),za=Mo("markup-hover");let Hr;const R="markup-manipulator-segment-"+ke,Te=(x,j)=>{const L=x[j],rt=j-1<0?x[x.length-1]:x[j-1],ct=j+1<x.length?x[j+1]:x[0],Lt=Bn(Be(rt),L);ro(Lt);const Nt=Dn(Mr(Lt,10),L),Vt=Bn(Be(ct),L);return ro(Vt),[Nt,L,Dn(Mr(Vt,10),L)]},We=Nr(R),gi=Mo(R),Oi=()=>{i(143,Hr=void 0),Po()},Hi=(x,j)=>{if(Ti<=0)return x;if(j)return $o(),x;const L=ti(x),rt=Vn(),{snapTranslation:ct,snapLines:Lt}=br(so(L),rt,Ti,bn,n);return Kr(Lt),vr(x,ct),x},ei=pi(0);A(t,ei,x=>i(181,be=x));const ai="markup-grid-line-"+ke,Ai=Nr(ai),Fi=Mo(ai),un="markup-snap-line",Sn=Nr(un),fn=Mo(un);let Di;const Pi=x=>{i(8,Di.innerHTML=DS(x),Di)},zr=x=>{const j=x.value===void 0?x.innerHTML:x.value,L=r.format==="text"?K2(j).split(/<br>|<br\/>/g).join(`
`).replace(/&nbsp;/g,"Â ").replace(/&amp;/g,"&"):j;return $u(r)&&r.disableNewline!==!1?(rt=>{const ct=rt.split(/[\n\r]/g);return ct.length>1?ct.map(Lt=>Lt.trim()).filter(Lt=>Lt.length).join(" "):ct[0]})(L):L},jo=()=>{const x=zr(Di),j=Cl(r,x),L=j===!0?x:j;let rt=k.x,ct=k.y;if(!r.height){const Lt=mr({...it},r.rotation),Nt=Fo(L,l),Vt=mr({x:rt,y:ct,...Nt},r.rotation),[Bt,,Ft]=Lt,[_t,,qt]=Vt;let ri=Bt,de=_t;r.flipX&&(ri=Ft,de=qt);const he=Bn(Be(ri),de);rt+=he.x,ct+=he.y}Vi(r,{x:_e(tt.x)?Fr(rt,At.width):rt,y:_e(tt.y)?Fr(ct,At.height):ct,text:L})},Sa=()=>{a&&ur(),Di&&Di.confirm&&Di.confirm(),jo(),Er(r),Xt(r)},Fa=()=>{a?wr():(Vi(r,{text:tt.text,x:tt.x,y:tt.y}),Er(r))},Da=(x,j,{flipX:L,flipY:rt,rotation:ct},Lt="top left")=>{let Nt,Vt;const[Bt,Ft,_t,qt]=mr(x,ct),[ri,de,he,we]=mr(j,ct);return Lt==="top center"?(Nt=Do(rt?[qt,_t]:[Bt,Ft]),Vt=Do(rt?[we,he]:[ri,de])):Lt==="top right"&&!L||Lt==="top left"&&L?(Nt=rt?_t:Ft,Vt=rt?he:de):(Nt=rt?qt:Bt,Vt=rt?we:ri),Bn(Be(Nt),Vt)},Ba=(x,j,L)=>ot(_e(x.x)?Fr(j.x+L.x,At.width):j.x+L.x,_e(x.y)?Fr(j.y+L.y,At.height):j.y+L.y),Uo={},ss=()=>_r(r,r.selectedPoint),ul=()=>Hn(r),Oa=()=>{const x=is(Fo(r.text,l),Bt=>Math.ceil(Bt)),j=Ae(r,"height"),L=!j&&Ae(r,"width"),rt=r.id;let ct=Uo[rt];ct||(Uo[rt]={},ct=Uo[rt]);const Lt=Bt=>{const{width:Ft,..._t}=l,qt=Fo(r.text,_t),ri=Da(Pn(l.x,l.y,Bt.width,Bt.height),Pn(l.x,l.y,qt.width,qt.height),l,"top "+r.textAlign),de=l.disableNewline!==!1;_i(r,["width","height",de&&"textAlign"]),Vi(r,{...Ba(r,l,ri)})},Nt=Bt=>{const Ft=Un(ct.width||l.width||x.width,x.height),_t=ct.textAlign||"left",qt=Da(Pn(l.x,l.y,Bt.width,Bt.height),Pn(l.x,l.y,Ft.width,Ft.height),l,"top "+_t);_i(r,["height"]),Vi(r,{...Ba(r,l,qt),width:_e(r.width)?Fr(Ft.width,At.width):Ft.width,textAlign:_t})},Vt=Bt=>{const Ft=Un(ct.width||x.width,ct.height||x.height),_t=ct.textAlign||"left",qt=Da(Pn(l.x,l.y,Bt.width,Bt.height),Pn(l.x,l.y,Ft.width,Ft.height),l,"top "+_t);Vi(r,{...Ba(r,l,qt),width:_e(r.width)?Fr(Ft.width,At.width):Ft.width,height:_e(r.width)?Fr(Ft.height,At.height):Ft.height,textAlign:_t})};if(j){ct.textAlign=r.textAlign,ct.width=l.width,ct.height=l.height;const Bt=Un(l.width,l.height);qs(r,"auto-height")?Nt(Bt):qs(r,"auto-width")&&Lt(Bt)}else if(L){ct.textAlign=r.textAlign,ct.width=l.width;const Bt=Un(l.width,x.height);qs(r,"auto-width")?Lt(Bt):qs(r,"fixed-size")&&Vt(Bt)}else{ct.textAlign=r.textAlign;const Bt=Un(Math.ceil(x.width),Math.ceil(x.height));qs(r,"fixed-size")?Vt(Bt):qs(r,"auto-height")&&Nt(Bt)}},Wa=x=>{x.stopPropagation();const j=r.flipX||!1;lr(r,"flipX",!j),Xt(r)},jr=x=>{x.stopPropagation();const j=r.flipY||!1;lr(r,"flipY",!j),Xt(r)},Ur=x=>{lr(r,"opacity",x)},Gr=x=>{Ur(x),Xt(r)},hr=x=>{x.stopPropagation(),x.target.blur(),pr()},pn=x=>{x.stopPropagation(),dt.findIndex(j=>j===r)!==dt.length-1&&(Ot.set(dt.filter(j=>j!==r).concat([r])),Xt(r))},Ro=x=>{x.stopPropagation(),_a()},_a=()=>{const x=jn(r);x.id=ea();const j=ot(50,-50);if(Ae(x,"points")){const L=Ll(x,["points"],At);L.points.forEach(rt=>{rt.x+=j.x,rt.y+=j.y}),ga(x,L,At)}else if(tr(x)){const L=Ll(x,["x1","y1","x2","y2"],At);L.x1+=j.x,L.y1+=j.y,L.x2+=j.x,L.y2+=j.y,ga(x,L,At)}else{const L=Ll(x,["x","y"],At);L.x+=50,L.y-=50,ga(x,L,At)}Ot.set([...dt,x]),$e(x),cr(x)},Ri=pi(0,{stiffness:.2,damping:.7});A(t,Ri,x=>i(18,Jt=x));let Bs;const ls=(x,j)=>{const{disableTextLayout:L=[]}=j;return"height"in j?L.includes("auto-height")?x.shapeIconButtonTextLayoutAutoWidth:x.shapeIconButtonTextLayoutAutoHeight:"width"in j?L.includes("auto-width")?x.shapeIconButtonTextLayoutFixedSize:x.shapeIconButtonTextLayoutAutoWidth:L.includes("fixed-size")?x.shapeIconButtonTextLayoutAutoHeight:x.shapeIconButtonTextLayoutFixedSize},jl=(x,j)=>{const{disableTextLayout:L=[]}=j;return"height"in j?L.includes("auto-height")?x.shapeTitleButtonTextLayoutAutoWidth:x.shapeTitleButtonTextLayoutAutoHeight:"width"in j?L.includes("auto-width")?x.shapeTitleButtonTextLayoutFixedSize:x.shapeTitleButtonTextLayoutAutoWidth:L.includes("fixed-size")?x.shapeTitleButtonTextLayoutAutoHeight:x.shapeTitleButtonTextLayoutFixedSize};let ka=!1,cs=rn(),Zr;const Os=x=>{Ht(x),i(143,Hr=x)};let Va;return _o(()=>{Sn(),Ai(),We(),Po()}),t.$$set=x=>{"uid"in x&&i(58,ke=x.uid),"ui"in x&&i(59,fi=x.ui),"disabled"in x&&i(0,ye=x.disabled),"shapes"in x&&_(i(1,Ot=x.shapes)),"selection"in x&&i(60,ze=x.selection),"offset"in x&&i(2,Re=x.offset),"contextRotation"in x&&i(61,Oe=x.contextRotation),"contextFlipX"in x&&i(62,di=x.contextFlipX),"contextFlipY"in x&&i(63,bt=x.contextFlipY),"contextZoom"in x&&i(64,le=x.contextZoom),"active"in x&&i(65,Xe=x.active),"opacity"in x&&i(66,Ve=x.opacity),"parentRect"in x&&i(67,At=x.parentRect),"rootRect"in x&&i(3,Ge=x.rootRect),"utilRect"in x&&i(68,Ye=x.utilRect),"hoverColor"in x&&i(69,$i=x.hoverColor),"caretColor"in x&&i(70,bi=x.caretColor),"gridColor"in x&&i(71,Mi=x.gridColor),"snapColor"in x&&i(72,Ci=x.snapColor),"textInputMode"in x&&i(4,X=x.textInputMode),"oninteractionstart"in x&&i(73,Gt=x.oninteractionstart),"oninteractionupdate"in x&&i(74,H=x.oninteractionupdate),"oninteractionrelease"in x&&i(75,Zt=x.oninteractionrelease),"oninteractionend"in x&&i(76,ae=x.oninteractionend),"oninteractioncancel"in x&&i(77,jt=x.oninteractioncancel),"onaddshape"in x&&i(78,$e=x.onaddshape),"onupdateshape"in x&&i(79,Xt=x.onupdateshape),"onselectshape"in x&&i(80,Le=x.onselectshape),"onblurshape"in x&&i(81,qe=x.onblurshape),"onremoveshape"in x&&i(82,Ne=x.onremoveshape),"ontapshape"in x&&i(83,pt=x.ontapshape),"onhovershape"in x&&i(84,Ht=x.onhovershape),"onhovercanvas"in x&&i(85,ie=x.onhovercanvas),"ontapcanvas"in x&&i(86,Fe=x.ontapcanvas),"onleavecanvas"in x&&i(87,Wt=x.onleavecanvas),"beforeSelectShape"in x&&i(88,K=x.beforeSelectShape),"beforeDeselectShape"in x&&i(89,Yt=x.beforeDeselectShape),"beforeRemoveShape"in x&&i(90,Ut=x.beforeRemoveShape),"beforeUpdateShape"in x&&i(91,ne=x.beforeUpdateShape),"willRenderShapeControls"in x&&i(92,De=x.willRenderShapeControls),"willRenderShapeTextControls"in x&&i(93,re=x.willRenderShapeTextControls),"willStartInteraction"in x&&i(94,Bi=x.willStartInteraction),"mapEditorPointToImagePoint"in x&&i(95,ti=x.mapEditorPointToImagePoint),"mapImagePointToEditorPoint"in x&&i(96,Ce=x.mapImagePointToEditorPoint),"eraseRadius"in x&&i(97,xe=x.eraseRadius),"selectRadius"in x&&i(98,Ke=x.selectRadius),"enableButtonFlipVertical"in x&&i(99,Pe=x.enableButtonFlipVertical),"enableTapToAddText"in x&&i(100,je=x.enableTapToAddText),"enableTextStyleControls"in x&&i(5,Me=x.enableTextStyleControls),"locale"in x&&i(6,fe=x.locale),"snapThreshold"in x&&i(101,Ti=x.snapThreshold),"snapPointer"in x&&i(102,Yi=x.snapPointer),"enableSnapToContext"in x&&i(103,En=x.enableSnapToContext),"gridSize"in x&&i(104,bn=x.gridSize)},t.$$.update=()=>{var x,j;32&t.$$.dirty[2]|2048&t.$$.dirty[3]&&i(169,n=bn>0?{x:0,y:0,...At}:void 0),1&t.$$.dirty[0]|8388608&t.$$.dirty[5]&&i(147,r=!ye&&dt&&(Jr()||Vr())),8388608&t.$$.dirty[4]&&i(176,o=!!r),8388608&t.$$.dirty[4]&&i(163,a=r&&fo(r)),8388608&t.$$.dirty[4]|256&t.$$.dirty[5]&&i(10,s=r&&!a?r.id:void 0),8&t.$$.dirty[0]|32&t.$$.dirty[2]|8388608&t.$$.dirty[4]&&i(13,l=Ge&&r&&Zn(jn(r),At)),8388608&t.$$.dirty[4]|256&t.$$.dirty[5]&&i(145,c=!(!r||!a)),8192&t.$$.dirty[0]|16&t.$$.dirty[2]|8388608&t.$$.dirty[4]&&i(175,d=r&&Ve&&ca(l)||[]),8388608&t.$$.dirty[4]&&i(177,u=r&&Yp(x=r)&&wc(x)&&x.disableResize!==!0&&(el(x)||nu(x)||Yn(x)||tr(x)||_n(x)&&Ae(x,"pathClose"))&&!Ja(r)),8388608&t.$$.dirty[4]&&i(14,p=r&&(L=>Yp(L)&&L.disableRotate!==!0&&(el(L)||Ae(L,"text")||Yn(L)))(r)&&!Ja(r)),8388608&t.$$.dirty[4]|4194304&t.$$.dirty[5]&&i(17,h=u&&Ae(r,"text")&&!r.height?[[1,2],[3,0]]:(!r||!tr(r)&&!_n(r))&&u),131072&t.$$.dirty[0]|8388608&t.$$.dirty[4]|4194304&t.$$.dirty[5]&&i(29,g=!!r&&!Array.isArray(h)&&u),8388608&t.$$.dirty[4]|1048576&t.$$.dirty[5]&&i(15,m=r&&d.length>1),8&t.$$.dirty[3]|1048576&t.$$.dirty[5]&&i(173,f=d.map(Ce)),4&t.$$.dirty[0]|262144&t.$$.dirty[5]&&i(12,b=f.map(L=>ot(L.x-Re.x,L.y-Re.y))),8388608&t.$$.dirty[4]&&i(16,w=r&&r.points&&hi(r.selectedPoint)?r.selectedPoint:-1),65536&t.$$.dirty[0]&&i(155,S=w>=0),69632&t.$$.dirty[0]|1&t.$$.dirty[5]&&i(160,C=S?b[w]:void 0),8388608&t.$$.dirty[4]|2097152&t.$$.dirty[5]&&i(28,I=o&&(nu(r)?!Ae(r,"disableNewline")||!r.disableNewline:r.disableNewline===!1)),8&t.$$.dirty[3]|524288&t.$$.dirty[4]&&(Hr&&Ce&&!xs(Hr)&&ha(Hr)?(L=>{const rt=ca(Zn(jn(L),At));if(!rt)return;const ct=rt.map(Ce),Lt=!!L.pathClose||!(!L.bitmap&&(_n(L)||tr(L))),Nt=L.selectionStyle==="hook",Vt=Nt?ct.map((Ft,_t,qt)=>({id:"markup-hover",points:Te(qt,_t),strokeColor:[0,0,0,.1],strokeWidth:2})):[{id:"markup-hover",points:ct.map(Ft=>ot(Ft.x+1,Ft.y+1)),strokeColor:[0,0,0,.1],strokeWidth:2,pathClose:Lt}],Bt=Nt?ct.map((Ft,_t,qt)=>({id:"markup-hover",points:Te(qt,_t),strokeColor:$i,strokeWidth:2})):[{id:"markup-hover",points:ct,strokeColor:$i,strokeWidth:2,pathClose:Lt}];za(...Vt,...Bt)})(Hr):Po()),61440&t.$$.dirty[0]|16&t.$$.dirty[2]&&i(174,M=m&&p&&Ve&&b&&(L=>{const rt=da(L),ct=Ce({x:rt.origin.x+rt.dir.x,y:rt.origin.y+rt.dir.y});return{origin:Ce(rt.origin),position:ct}})(l)),4&t.$$.dirty[0]|524288&t.$$.dirty[5]&&i(27,D=M&&ot(M.position.x-Re.x,M.position.y-Re.y)),33554432&t.$$.dirty[5]&&i(168,O=!!(ee||[]).find(L=>[91,93,17].includes(L))),512&t.$$.dirty[3]|8192&t.$$.dirty[5]&&i(170,T=!(O||!Yi)),16&t.$$.dirty[2]|9437184&t.$$.dirty[4]|295168&t.$$.dirty[5]&&r&&f&&Ve>0&&(r===Hr&&Oi(),((L,rt,ct)=>{if(!ha(rt))return;const Lt=_n(rt),Nt=Lt&&Ae(rt,"pathClose"),Vt=Nt&&(an=>an.strokeWidth&&((kr,Xr)=>{const io=kr.strokeColor;return!!io&&(io.length===3||io[3]>0)})(an))(rt),Bt=fo(rt),Ft=Ja(rt),_t=rt.selectionStyle==="hook",qt=rt.disableShowPoints!==!0,{selectionOpacity:ri=1}=rt;if(Bt&&Lt&&!Nt)return;const de=[],he=[...f],we=he[he.length-1],Se=he[0],Ze=(Ft?.05:.1)*L*ri,ii=Ze>0,xi=(Ft?.5:1)*L*ri,ui=xi>0,Ii=[0,0,0],ln=[1,1,1],ji=Ft?1:1.5;ee.includes(16)&&we&&ct&&gn(we,ct);const Li=(he.length&&Nt&&Bt&&ct?yo(Se,ct):1/0)<=256,yn=(he.length&&Nt&&Bt&&ct?yo(we,ct):1/0)<=256;!Li&&ct&&he.push(ct);const Qi=he.length>1,Gn=!!rt.pathClose||!(!rt.bitmap&&(_n(rt)||tr(rt)))||he.length>2&&Li;Qi&&ii&&(_t?de.push(...he.map((an,kr,Xr)=>({id:R,points:Te(Xr,kr),strokeColor:Ii,opacity:Ze}))):de.push({id:R,points:he.map(an=>ot(an.x+1,an.y+1)),pathClose:Gn,strokeColor:Ii,strokeWidth:2,opacity:Ze})),Nt&&ii&&qt&&de.push(...he.map(an=>({id:R,...an,rx:2*ji,ry:2*ji,backgroundColor:Ii,opacity:Ze}))),M&&ii&&de.push({id:R,points:[ot(M.origin.x+1,M.origin.y+1),ot(M.position.x+1,M.position.y+1)],strokeColor:Ii,strokeWidth:2,opacity:Ze}),Qi&&ui&&(_t?de.push(...he.map((an,kr,Xr)=>({id:R,points:Te(Xr,kr),strokeColor:ln,strokeWidth:ji,opacity:xi}))):de.push({id:R,points:he,pathClose:Gn,strokeColor:ln,strokeWidth:ji,backgroundColor:Bt&&Nt&&rt.backgroundColor&&rt.backgroundColor[3]>0?rt.backgroundColor:[0,0,0,0],opacity:xi})),Nt&&qt&&de.push(...he.map(an=>({id:R,...an,rx:3*ji,ry:3*ji,backgroundColor:[.5,.5,.5],strokeWidth:ji,strokeColor:ln}))),Nt&&Bt&&qt&&f.length>=3&&de.push({...Se,id:R,rx:ji*(Li?5:4),ry:ji*(Li?5:4),backgroundColor:Li?$i:[.5,.5,.5],strokeWidth:ji,strokeColor:ln}),Nt&&Bt&&Vt&&qt&&!Li&&d.length>=2&&de.push({...we,id:R,rx:ji*(yn?5:4),ry:ji*(yn?5:4),backgroundColor:yn?$i:[.5,.5,.5],strokeWidth:ji,strokeColor:ln}),M&&ui&&!_t&&de.push({id:R,points:[{x:M.origin.x,y:M.origin.y},{x:M.position.x,y:M.position.y}],strokeColor:ln,strokeWidth:ji,opacity:xi}),gi(...de)})(Ve,r,a&&_n(r)?Hi({...Zr},!T):void 0)),8388608&t.$$.dirty[4]&&(r||(Oi(),We())),524288&t.$$.dirty[4]&&i(171,F=!!Hr),131072&t.$$.dirty[4]&&i(172,W=!!Pt),1048576&t.$$.dirty[4]|229376&t.$$.dirty[5]&&(!Zr||W||F||Hi({...Zr},!T)),512&t.$$.dirty[2]|2056&t.$$.dirty[3]|67125248&t.$$.dirty[5]&&bn>0&&n&&Ce&&((L,rt,ct,Lt)=>{const Nt=Ce({x:0,y:0}),Vt=Ce({x:L,y:L}),Bt=Ce({x:rt.width,y:rt.height}),Ft=Vt.x-Nt.x;if(ei.set(Ft>6?1:0),Lt<=0)return Ai();const _t=en(Ft,Nt.x,Bt.x).map(ri=>({id:ai,opacity:Lt,points:[{x:ri,y:Nt.y},{x:ri,y:Bt.y}],strokeWidth:1,strokeColor:ct})),qt=en(Ft,Nt.y,Bt.y).map(ri=>({id:ai,opacity:Lt,points:[{x:Nt.x,y:ri},{x:Bt.x,y:ri}],strokeWidth:1,strokeColor:ct}));Fi(...qt,..._t)})(bn,n,Mi,be),1024&t.$$.dirty[2]|8&t.$$.dirty[3]|98304&t.$$.dirty[4]|8192&t.$$.dirty[5]&&Ce&&(O?Sn():((L,rt,ct)=>{if(L===null&&rt===null)return Sn();let Lt,Nt;L!==null&&(Lt={id:un,strokeColor:ct,strokeWidth:1.5,points:[Ce({x:L,y:0}),Ce({x:L,y:At.height})]}),rt!==null&&(Nt={id:un,strokeColor:ct,strokeWidth:1.5,points:[Ce({x:0,y:rt}),Ce({x:At.width,y:rt})]}),fn(Lt,Nt)})(ko,dr,Ci)),8&t.$$.dirty[2]&&(L=>{if(!L)return Ji({_prerender:!1});const rt=dt.find(ct=>ct.isEditing);rt&&Vi(rt,{_prerender:X==="inline"})})(Xe),33554432&t.$$.dirty[5]&&ee&&ee.length&&(()=>{const[L]=ee;L!==8&&L!==46||co()&&(r.isEditing||(_n(r)&&hi(r.selectedPoint)?setTimeout(()=>_r(r,r.selectedPoint),0):setTimeout(()=>pr(),0)))})(),272&t.$$.dirty[0]&&Di&&X==="inline"&&Di.focus(),8388608&t.$$.dirty[4]&&i(167,y=r&&Xn(r)),8388608&t.$$.dirty[4]|4096&t.$$.dirty[5]&&i(11,V=y&&Cl(r)!==!1&&Ja(r)),2048&t.$$.dirty[0]&&i(162,tt=V?{...r}:void 0),32&t.$$.dirty[2]|128&t.$$.dirty[5]&&i(164,k=tt&&Zn({...tt},At)),512&t.$$.dirty[5]&&i(166,N=k&&Fo(k.text,k)),2560&t.$$.dirty[5]&&(it=k&&Pn(k.x,k.y,N.width,N.height)),2048&t.$$.dirty[0]|8388608&t.$$.dirty[4]&&i(24,ut=V?r.text:""),2056&t.$$.dirty[0]|32&t.$$.dirty[2]|8388608&t.$$.dirty[4]&&i(165,at=Ge&&r&&V&&Zn({...jn(r),width:hi(r.width)?Math.floor(r.width):void 0,height:hi(r.height)?Math.floor(r.height):void 0},At)),2064&t.$$.dirty[0]|1024&t.$$.dirty[5]&&i(26,gt=V&&((L,rt)=>{const{textAlign:ct="left",fontFamily:Lt="sans-serif",fontWeight:Nt="normal",fontStyle:Vt="normal",letterSpacing:Bt="normal",textShadowX:Ft=0,textShadowY:_t=0,textShadowBlur:qt=0,textShadowColor:ri,textOutlineWidth:de=0,textOutlineColor:he}=L,we="!important",Se=`caret-color:${$t};text-align:${ct}${we};font-family:${Lt}${we};font-weight:${Nt}${we};font-style:${Vt}${we};letter-spacing:${hi(Bt)?Bt+"px":"normal"}${we}`;if(rt==="modal")return Se;const Ze=de?`;-webkit-text-stroke:${2*de}px ${$r(he)} ${we}`:"",ii=qt||Ft||_t?`;text-shadow:${Ft}px ${_t}px ${qt}px ${$r(ri)} ${we}`:"";let xi=L.fontSize,ui=1,Ii="";xi>1e3&&ya()&&(ui=xi/1e3,Ii=`transform-origin:0 0;transform:scale(${ui})`,xi=1e3);let ln=L.lineHeight/ui;const ji=$r(L.color),Li=.5*Math.max(0,xi-ln);return`--font-scalar:${ui};--bottom-inset:${Li}px;padding:${Li}px 0 0${we};color:${ji}${we};font-size:${xi}px${we};line-height:${ln}px${we};${Se};${Ii}${Ze}${ii}`})(at,X)),2052&t.$$.dirty[0]|1073741824&t.$$.dirty[1]|4&t.$$.dirty[2]|1024&t.$$.dirty[5]&&i(25,G=V&&((L,rt,ct,Lt)=>{let Nt,Vt;L.width&&L.height?(Nt=ki(L),Vt=Aa(L)):(Vt=Fo(r.text,l),Vt.width=l.width||Vt.width,Nt=ot(L.x+.5*Vt.width,L.y+.5*Vt.height));const Bt=Math.max(0,L.fontSize-L.lineHeight)+L.lineHeight,Ft=Ce(Nt);let _t=Ft.x-rt.x-.5*Vt.width,qt=Ft.y-rt.y-.5*Vt.height,ri=L.flipX,de=L.flipY,he=L.rotation;di&&bt?(ri=!ri,de=!de):di?(ri=!ri,he=-he):bt&&(de=!de,he=-he),he+=Lt;const we=ct*(ri?-1:1),Se=ct*(de?-1:1);return`--line-height:${Bt}px;width:${Vt.width}px;height:${Vt.height}px;transform:translate(${_t}px,${qt}px) rotate(${he}rad) scale(${we}, ${Se})`})(at,Re,le,Oe)),256&t.$$.dirty[2]&&($t=bi?$r(bi):"auto"),2320&t.$$.dirty[0]&&V&&Di&&X==="inline"&&Pi(ut),144703488&t.$$.dirty[4]&&i(151,vt=r&&!c?r:vt),134217728&t.$$.dirty[4]&&i(153,lt=vt&&Ib(vt)),134217728&t.$$.dirty[4]&&i(148,kt=vt&&qs(vt)),134217728&t.$$.dirty[4]&&i(150,J=vt&&(L=>L.disableDuplicate!==!0&&wc(L))(vt)),134217728&t.$$.dirty[4]&&i(149,q=vt&&Om(vt)),134217728&t.$$.dirty[4]&&i(152,Z=vt&&(L=>L.disableReorder!==!0)(vt)),134217728&t.$$.dirty[4]&&i(146,xt=vt&&Cl(vt)!==!1),134217728&t.$$.dirty[4]&&i(154,nt=vt&&Ae(vt,"backgroundImage")&&Xp(vt,"opacity")),8388608&t.$$.dirty[4]&&i(157,mt=r&&r.format==="html"),10485760&t.$$.dirty[4]|4&t.$$.dirty[5]&&i(161,zt=r&&(!c||mt)),262144&t.$$.dirty[4]|16777280&t.$$.dirty[5]&&Ri.set(zt&&!wi?1:0,{hard:se===!1}),4096&t.$$.dirty[0]|80&t.$$.dirty[5]&&i(159,oe=zt&&b.length?(j=er(b),bo(ot(j.x+.5*j.width,j.y),Oc)):oe),512&t.$$.dirty[0]|64&t.$$.dirty[2]|48&t.$$.dirty[5]&&i(158,Dt=(C||oe)&&Bs&&Ye&&((L,rt,ct,Lt)=>{const Nt=L.x,Vt=L.y,Bt=Nt+L.width;let Ft=Math.max(rt.x-.5*ct.width,Nt),_t=Math.max(rt.y-ct.height+Lt,Vt);return Ft+ct.width>Bt&&(Ft=Bt-ct.width),ot(Ft,_t)})(Ye,C||oe,Bs,-16)),262144&t.$$.dirty[0]|8&t.$$.dirty[5]&&i(23,te=Dt&&`transform: translate(${Dt.x}px, ${Dt.y}px);opacity:${Jt}`),2048&t.$$.dirty[0]&&i(156,Kt=V?"text":"shape"),1088&t.$$.dirty[0]|1073741824&t.$$.dirty[2]|65&t.$$.dirty[3]|2143289344&t.$$.dirty[4]|8388615&t.$$.dirty[5]&&i(22,U=Kt==="text"&&re&&mt?_c(()=>re([["div","text-styles",{class:"PinturaShapeControlsGroup"},[...[["bold",{label:"B",style:"font-weight:900;",title:"Bold",shortcut:["CMD","B"]}],["italic",{label:"I",style:"font-family:Times New Roman;font-style:italic;",title:"Italic",shortcut:["CMD","I"]}],["underline",{label:"U",style:"text-decoration:underline;",title:"Underline",shortcut:["CMD","U"]}],["strikeThrough",{label:"S",style:"text-decoration:line-through;",title:"Strikethrough",shortcut:["CMD","S"]}]].map(([L,rt])=>["Button","style-"+L,{onclick:()=>document.execCommand(L),...rt,style:"font-size:1.25em;text-underline-offset:1px;text-decoration-thickness:1.5px;font-weight:400;"+rt.style}])]],["div","text-reset",{class:"PinturaShapeControlsGroup"},[["Button","style-reset",{onclick:()=>document.execCommand("removeFormat"),style:"font-weight:400;",label:'<span style="font-size:1.25em;font-style:italic;font-family:Times New Roman;text-decoration:underline;">T</span><span style="position:relative;top:.175rem;">&times;</span>',title:"Remove styles"}]]]],s)):Kt==="shape"&&De&&s?_c(()=>De(S?[["div","epsilon",{class:"PinturaShapeControlsGroup"},[["Button","remove-point",{onclick:ss,label:fe.shapeTitleButtonRemove,icon:fe.shapeIconButtonRemove,shortcut:["Backspace"],hideLabel:!0}]]]]:[nt&&["div","alpha",{class:"PinturaShapeControlsGroup"},[["ToggleSlider","adjust-opacity",{onrelease:Gr,onchange:Ur,step:.01,value:Ae(r,"opacity")?r.opacity:1,label:(L,rt,ct)=>Math.round(L/ct*100)+"%",min:0,max:1,direction:"x"}]]],["div","beta",{class:"PinturaShapeControlsGroup"},[lt&&["Button","flip-horizontal",{onclick:Wa,label:fe.shapeTitleButtonFlipHorizontal,icon:fe.shapeIconButtonFlipHorizontal,hideLabel:!0}],lt&&Pe&&["Button","flip-vertical",{onclick:jr,label:fe.shapeTitleButtonFlipVertical,icon:fe.shapeIconButtonFlipVertical,hideLabel:!0}],Z&&["Button","to-front",{onclick:pn,label:fe.shapeTitleButtonMoveToFront,icon:fe.shapeIconButtonMoveToFront,hideLabel:!0,disabled:dt[dt.length-1]===vt}],J&&["Button","duplicate",{onclick:Ro,label:fe.shapeTitleButtonDuplicate,icon:fe.shapeIconButtonDuplicate,shortcut:["CMD","D"],hideLabel:!0}],q&&["Button","remove",{onclick:hr,label:fe.shapeTitleButtonRemove,icon:fe.shapeIconButtonRemove,shortcut:["Backspace"],hideLabel:!0}]].filter(Boolean)],xt&&kt&&["div","gamma",{class:"PinturaShapeControlsGroup"},[["Button","text-layout",{onclick:Oa,label:nr(jl,fe,r),icon:nr(ls,fe,r),hideLabel:!0}]]],xt&&["div","delta",{class:"PinturaShapeControlsGroup"},[["Button","edit-text",{label:fe.shapeLabelInputText,onclick:ul}]]]].filter(Boolean),s)):[]),64&t.$$.dirty[0]|8388608&t.$$.dirty[5]&&i(21,Tt=dt.filter(ha).filter(L=>L.id).filter(L=>!fo(L)).map(L=>({id:L.id,color:Xn(L)?L.color:tr(L)?L.strokeColor:L.backgroundColor,name:L.name||fe["shapeLabelTool"+Qy(zb(L))]})))},[ye,Ot,Re,Ge,X,Me,fe,cr,Di,Bs,s,V,b,l,p,m,w,h,Jt,ka,Va,Tt,U,te,ut,G,gt,D,I,g,qr,On,x=>{const{origin:j}=x.detail;i(141,Pt=void 0),ge=void 0,yi=void 0,Gi=!1,Ue=void 0,dn=!1,$o(),clearTimeout(vi),vi=setTimeout(()=>i(142,wi=!0),250);const L=Jr();if(!L||_n(L)&&Ae(L,"pathClose")||ur(),ce=ti(Be(j)),L&&_n(L)&&Ae(L,"pathClose"))return Gt(x);const rt=Ar(dt,ce,Ke,Lt=>ha(Lt)),ct=rt.length&&rt.shift();if(r&&Ja(r)&&(Sa(),je&&(dn=!0)),!ct&&r&&Ja(r)&&Kn(r),!!Bi(j)){if(ct&&xs(ct))return Gi=!0,i(141,Pt=ct),ge=jn(Pt),void(yi=Zn(jn(Pt),At));Ue=ct||void 0,!Gt(x)&&ct&&(cr(ct),i(141,Pt=ct),ge=jn(Pt),yi=Zn(jn(Pt),At))}},x=>{Ni(),jt(x)},x=>{const{translation:j,ctrlKey:L,metaKey:rt,shiftKey:ct,position:Lt}=x.detail;if(Pt){if(!wc(Pt)||Ja(Pt))return;if(ct){let Nt=Math.abs(j.x),Vt=Math.abs(j.y);Lr==="x"&&(Vt-=64),Lr==="y"&&(Nt-=64),Nt>Vt?(j.y=0,Lr="x"):Vt>Nt&&(j.x=0,Lr="y")}else Lr=null;return lo(Pt,yi,j,{...An(L||rt?0:Ti,bn,n,Pt)})}H(x)},x=>{if(Ni(),Pt){if(Ja(Pt)&&Fa(),x.detail.isTap&&_n(Pt)&&Ty(Pt)){const{position:j}=x.detail,L=ti(Be(j));return void((rt,ct)=>{const Lt=rt.points,Nt=[];for(let _t=0;_t<Lt.length-1;_t++)Nt.push([Lt[_t],Lt[_t+1]]);Nt.push([Lt[Lt.length-1],Lt[0]]);const Vt=Nt.findIndex(([_t,qt])=>pu(ct,6,_t,qt));let Bt;const Ft=[];for(let _t=0;_t<Nt.length;_t++)Ft.push(Nt[_t][0]),_t===Vt&&(Bt=_t+1,Ft.push(ct));Vi(rt,{points:Ft,selectedPoint:Bt})})(Pt,L)}x.detail.isTap&&Gi&&Xn(Pt)&&Cl(Pt)!==!1&&Hn(Pt)}else Zt(x)},x=>{const j=Ue&&x.detail.isTap;if(x.detail.isTap&&setTimeout(()=>{Fe({target:Pt||Ue,position:ce},0)}),Pt)return pt(Pt),L=Pt,rt=ge,JSON.stringify(L)!==JSON.stringify(rt)&&Xt(Pt),void i(141,Pt=void 0);var L,rt;const ct=uo(),Lt=!ct||Yt(ct,Ue||void 0);Lt&&Sr({storePrevious:!1}),ae(x),Lt&&j&&cr(Ue)},ei,x=>{i(142,wi=!0),i(141,Pt=r),yi=l},x=>{if(!Pt)return void i(142,wi=!1);const{translation:j,indexes:L,shiftKey:rt,ctrlKey:ct,metaKey:Lt,isNudge:Nt}=x.detail;((Vt,Bt,Ft,_t,qt)=>{const{shiftKey:ri,snapThreshold:de=0,gridSize:he=0,gridRect:we,snapTargets:Se=[]}=qt||{},Ze=de?(ii,xi,ui)=>{const{snapTranslation:Ii,snapLines:ln}=br(so(ii),Se,de,he,we);vr(xi,Ii),Kr(ln);const ji=cn(ui(),xi);ii.x=ji.x,ii.y=ji.y}:me;if(tr(Vt)||_n(Vt)&&Ae(Vt,"pathClose")){const[ii]=Ft,xi=ri?gn:(Li,yn)=>yn;let ui,Ii,ln;if(tr(Vt))ii===0?(ui=()=>Qa(Bt),Ii=Li=>xi(ts(Bt),Li),ln=(Li,yn)=>{Li.x1=yn.x,Li.y1=yn.y}):ii===1&&(ui=()=>ts(Bt),Ii=Li=>xi(Qa(Bt),Li),ln=(Li,yn)=>{Li.x2=yn.x,Li.y2=yn.y});else{const Li=Bt.points;ui=()=>({...Li[ii]}),Ii=yn=>{const Qi=Li[vu(ii-1,Li)],Gn=Li[vu(ii+1,Li)];xi(Qi,yn),xi(Gn,yn)},ln=(yn,Qi)=>yn.points=yn.points.map((Gn,an)=>ii===an?Qi:Gn)}const ji=cn(ui(),_t);Ze(ji,_t,ui),Ii(ji),ln(Vt,ji)}else if(el(Vt)||Yn(Vt)||nu(Vt)){let ii,xi,ui=!1;if(Yn(Vt))ii=cp(Bt);else if(el(Vt))ii=ys(Bt);else{ui=!0,ii=ys(Bt);const Qi=Fo(Bt.text,Bt);ii.height=Qi.height}Vt.aspectRatio?xi=Vt.aspectRatio:qt.shiftKey&&!ui&&(xi=ii.width/ii.height);const Ii=ys(ii),ln=ki(Ii),ji=Vt.rotation,Li=Oo(Ii),yn=mr(Ii,ji);if(Ft.length===1){let Qi=Ft[0];Vt.flipX&&(Qi=la[Qi]),Vt.flipY&&(Qi=Co[Qi]);const[Gn,an,kr,Xr]=Li,io=Ce(yn[Qi]),Na=Dn({...io},_t),Ha=ti(Na);Ze(Ha,_t,()=>ti(io));const ds=ot(Ha.x-yn[Qi].x,Ha.y-yn[Qi].y),ja=Dr(Be(ds),-ji),ua=ot(Li[Qi].x+ja.x,Li[Qi].y+ja.y);let Go;Qi===0&&(Go=kr),Qi===1&&(Go=Xr),Qi===2&&(Go=Gn),Qi===3&&(Go=an);const Io=er([Go,ua]);if(xi){const{width:ps,height:Ws}=Yr(Io,xi),[Ul,Ta,Za,Fn]=al(Io);Io.width=ps,Io.height=Ws,ua.y<Go.y&&(Io.y=Za-Ws),ua.x<Go.x&&(Io.x=Ta-ps)}const Ua=mr(Io,ji,ln),Ca=Do(Ua),us=Dr(Ua[0],-ji,Ca),go=Dr(Ua[2],-ji,Ca),Ga=er([us,go]);Wi(Vt,Yn(Vt)?hm(Ga):Ga,At)}else{Ft=Ft.map(Fn=>(Vt.flipX&&(Fn=la[Fn]),Vt.flipY&&(Fn=Co[Fn]),Fn));const[Qi,Gn]=Ft.map(Fn=>yn[Fn]),an={x:Qi.x+.5*(Gn.x-Qi.x),y:Qi.y+.5*(Gn.y-Qi.y)},[kr,Xr]=Ft.map(Fn=>Li[Fn]),[io,Na]=Ft.map(Fn=>{const Eo=Fn+2;return Eo<4?Li[Eo]:Li[Eo-4]}),Ha={x:io.x+.5*(Na.x-io.x),y:io.y+.5*(Na.y-io.y)},ds=Ce(an),ja=Dn({...ds},_t),ua=ti(ja);Ze(ua,_t,()=>ti(ds));const Go=ot(ua.x-an.x,ua.y-an.y),Io=Dr(Be(Go),-ji),Ua=Bn(Be(kr),Xr),Ca=bo(Ua,Fn=>1-Math.abs(Math.sign(Fn))),us=ot(Io.x*Ca.x,Io.y*Ca.y);Dn(kr,us),Dn(Xr,us);const go=er(Li);if(xi){let Fn=go.width,Eo=go.height;Ca.y===0?Eo=Fn/xi:Fn=Eo*xi,go.width=Fn,go.height=Eo,Ca.y===0?go.y=Ha.y-.5*Eo:go.x=Ha.x-.5*Fn}const Ga=mr(go,ji,ln),ps=Do(Ga),Ws=Dr(Ga[0],-ji,ps),Ul=Dr(Ga[2],-ji,ps),Ta=er([Ws,Ul]);let Za;Yn(Vt)?Za=hm(Ta):el(Vt)?Za=Ta:ui&&(Za={x:Ta.x,y:Ta.y,width:Ta.width}),Wi(Vt,Za,At)}}Wn()})(Pt,yi,L,j,{shiftKey:!Nt&&rt,...An(ct||Lt?0:Ti,bn,n,Pt)}),gp(Pt)&&yo(j)>16&&Vi(Pt,{selectedPoint:void 0})},x=>{if(!Pt)return void i(142,wi=!1);cr(Pt);const{isTap:j,translation:L,indexes:rt}=x.detail;j&&(gp(Pt)&&Vi(Pt,{selectedPoint:Pt.selectedPoint===rt[0]?void 0:rt[0]}),pt(Pt)),i(141,Pt=void 0),i(142,wi=!1),Xt(r)},x=>{To=da(l).origin,i(142,wi=!0),i(141,Pt=r),yi=l},x=>{if(!Pt)return void i(142,wi=!1);const{translation:j,shiftKey:L}=x.detail;((rt,ct,Lt,Nt)=>{const Vt=Mn(Zn(jn(rt),At)),Bt=ki(Vt),Ft=cn(To,Lt);let _t=Dd(Ft,Bt)+Math.PI/2;if(Nt.shiftKey){const qt=Math.PI/16;_t=qt*Math.round(_t/qt)-Oe%qt}Wi(rt,{rotation:_t},At),Wn()})(Pt,0,j,{shiftKey:L})},()=>{Pt?(cr(Pt),i(141,Pt=void 0),i(142,wi=!1),Xt(r)):i(142,wi=!1)},x=>{const{key:j}=x,L=/escape/i.test(j);if(co())return L?(x.preventDefault(),x.stopPropagation(),Kn(r)):void(J&&j==="d"&&(x.metaKey||x.ctrlKey)&&(x.preventDefault(),x.stopPropagation(),_a()))},x=>{const j=Cl(r,x);return j===!0?x:j},jo,x=>{const{target:j,key:L}=x,rt=j.value||j.innerText,ct=j.selectionStart||0,Lt=j.selectionEnd||rt.length,Nt=rt.substring(0,ct)+L+rt.substring(Lt);if(Cl(r,Nt)!==Nt)return x.preventDefault()},x=>$u(r)&&/enter/i.test(x.code)&&r.disableNewline!==!1?x.preventDefault():/arrow/i.test(x.code)?x.stopPropagation():/escape/i.test(x.key)?Fa():void 0,x=>{const{key:j,ctrlKey:L,altKey:rt}=x;if(/enter/i.test(j)&&(L||rt))return Sa()},Sa,Fa,Ri,x=>{const j=Vr();j&&(Ja(j)||wc(j)&&(i(141,Pt=j),yi=Zn(jn(Pt),At),lo(Pt,yi,x.detail)))},x=>{i(19,ka=!0)},({relatedTarget:x})=>{x&&x.classList.contains("shape-selector__button")||i(19,ka=!1)},x=>{if(x.pointerType==="touch"||x.target.className!=="PinturaShapeEditor")return void Wt();(wi||vi)&&Os(void 0);const j=hh(x,Ge);i(144,Zr=Be(j));const L=bo(ti(j),ct=>Math.round(ct));if(bs(L,cs)||(cs=Be(L),ie(wi,j,L),wi||vi)||c)return;const[rt]=Ar(dt,L,0,ha);rt&&fo(rt)||Os(rt)},x=>{x.pointerType!=="touch"&&Wt()},ke,fi,ze,Oe,di,bt,le,Xe,Ve,At,Ye,$i,bi,Mi,Ci,Gt,H,Zt,ae,jt,$e,Xt,Le,qe,Ne,pt,Ht,ie,Fe,Wt,K,Yt,Ut,ne,De,re,Bi,ti,Ce,xe,Ke,Pe,je,Ti,Yi,En,bn,ao,Ln,xr,vn,Nn,$n,So,(x,j={})=>{let L,rt,ct,Lt=Yn(x),Nt=Xn(x),Vt=j.position==="relative";const Bt=Vn(),Ft=de=>{if(!Ti)return de;const he=ti(de),{snapTranslation:we,snapLines:Se}=br(so(he),Bt,Ti,bn,n);return vr(de,we),Kr(Se),de},_t=!!uo(),qt=j.isSelection?ze:Ot,ri=j.inputMode==="step";if(_n(x)){if(ri){let de=!1;const he=(we,Se)=>{const Ze=Ln(qt),ii=we&&ot(Jd(we.x,At.width),Jd(we.y,At.height)),xi=ii&&Ce(ii);ee.includes(16)&&xi&&gn(xi,Se);const ui=ti(Se),Ii=Ze.points.length?Ze.points[0]:ui,ln=ot(Jd(Ii.x,At.width),Jd(Ii.y,At.height)),ji=Ce(ln),Li=yo(ji,Se);if(!de&&Ze.points.length===1&&Li<36)return vn(qt);if(Ze.points.length>2&&Li<=256){Ze.pathClose=!0,ha(Ze)&&cr(Ze);const Gn=Nn(qt);return void $e(Gn)}const yn=Ze.strokeWidth&&Ze.strokeColor&&(Ze.strokeColor[3]===void 0||Ze.strokeColor[3]>0),Qi=yo(xi,Se);if(yn&&Ze.points.length>1&&Qi<256){Ze.pathClose=!1,Ze.backgroundColor=[0,0,0,0],ha(Ze)&&cr(Ze);const Gn=Nn(qt);$e(Gn)}else if(!(Ze.points.length>0&&Qi<100))return Vt?vc(ui,At):ui};return{start:we=>{const Se=Ln(qt),{origin:Ze}=we.detail;if(rt=4,L=Ft(Be(Ze)),ct=Be(L),Se){const ii=Se.points[Se.points.length-1],xi=he(ii,L);return xi&&(Se.points=[...Se.points,xi]),void $n({points:Se.points},qt)}de=!0},update:we=>{if(!de)return;const Se=Ln(qt);if(!Se)return;const Ze=Se.points[0],ii=he(Ze,ot(L.x+we.detail.translation.x,L.y+we.detail.translation.y));ii&&(Se.points[1]=ii,$n({points:Se.points},qt))},release:we=>we.detail.preventInertia(),cancel:()=>{vn(qt)},end:we=>{if(!de)return;const Se=ti(L),Ze=Vt?vc(Se,At):Se,{isTap:ii}=we.detail;if(ii&&Ar(dt,Se,0,ha).length)return vn(qt);xr({...x,points:[Ze]},qt)}}}return{start:de=>{const{origin:he}=de.detail;rt=4,L=Be(he),ct=Be(L);const we=ti(L),Se=Vt?vc(we,At):we;xr({...x,points:[Se]},qt)},update:de=>{const he=Ln(qt),{translation:we}=de.detail,Se=ot(L.x+we.x,L.y+we.y),Ze=ho(ct,Se);if(si(Ze,5)<=rt)return;const ii=Dd(Se,ct),xi=rt-Ze;ct.x+=xi*Math.cos(ii),ct.y+=xi*Math.sin(ii);const ui=ti(ct),Ii=Vt?vc(ui,At):ui;$n({points:he.points.concat(Ii)},qt)},release:de=>de.detail.preventInertia(),cancel:()=>{vn(qt)},end:de=>{const he=Ln(qt);if(de.detail.isTap){let Se=!1;if(he.bitmap?(Ue&&(Se=!0),_t&&(Se=!0)):Se=!0,Se)return vn(qt)}const we=Nn(qt);$e(we)}}}return Lt||Nt||xo(x)?{start:de=>{const{origin:he}=de.detail;L=Ft(Be(he));const we=ti(L),Se=Vt?vc(we,At):we,Ze=-1*Vo(Oe,di,bt),ii={...x,rotation:Ze,...Se};ii.flipX=di,ii.flipY=bt,delete ii.position,ii.opacity=0,(Lt?["rx","ry"]:["width","height"]).forEach(xi=>{ii[xi]=Vt?"0%":0}),xr(ii,qt)},update:de=>{const he=Ln(qt);he.opacity=1;let{aspectRatio:we}=he,{translation:Se,shiftKey:Ze,ctrlKey:ii}=de.detail;!we&&Ze&&(we=1);const xi=Ft(ot(L.x+Se.x,L.y+Se.y)),ui=ti(L),Ii=ti(xi);if(we){const kr=er([ui,Ii]),Xr=Yr(kr,we),io=Ii.x<ui.x?-1:1,Na=Ii.y<ui.y?-1:1;Ii.x=ui.x+Xr.width*io,Ii.y=ui.y+Xr.height*Na}const ln={x:ui.x+.5*(Ii.x-ui.x),y:ui.y+.5*(Ii.y-ui.y)},ji=Vo(Oe,di,bt);Dr(ui,ji,ln),Dr(Ii,ji,ln);const Li=Math.min(ui.x,Ii.x),yn=Math.min(ui.y,Ii.y);let Qi=Math.max(ui.x,Ii.x)-Li,Gn=Math.max(ui.y,Ii.y)-yn,an={};Lt?(ii?(an.x=ui.x,an.y=ui.y):(an.x=Li+.5*Qi,an.y=yn+.5*Gn),an.rx=.5*Qi,an.ry=.5*Gn):(ii?(an.x=ui.x-.5*Qi,an.y=ui.y-.5*Gn):(an.x=Li,an.y=yn),an.width=Qi,an.height=Gn),$n(an,qt,(kr,Xr)=>Wi(kr,Xr,At))},release:de=>{de.detail.preventInertia()},cancel:()=>{vn(qt)},end:de=>{const he=Ln(qt);if(de.detail.isTap){if(Xn(he)&&je&&dn||!Xn(he)||!je||Ue)return vn(qt);delete he.width,delete he.height,he.disableNewline!==!1&&delete he.textAlign;const we=Zn({...he},At),Se=Fo(he.text,we),Ze=ti({x:L.x,y:L.y-.5*Se.height}),ii=ti({x:L.x+Se.width,y:L.y+.5*Se.height}),xi={x:Ze.x+.5*(ii.x-Ze.x),y:Ze.y+.5*(ii.y-Ze.y)},ui=Vo(Oe,di,bt);Dr(Ze,ui,xi),Dr(ii,ui,xi);let Ii=Math.min(Ze.x,ii.x),ln=Math.min(Ze.y,ii.y);Ii<0&&(Ii=0),ln<0&&(ln=0),Ii+Se.width>At.width&&(Ii=At.width-Se.width),ln+Se.height>At.height&&(ln=At.height-Se.height),he.x=_e(he.x)?Fr(Ii,At.width):Ii,he.y=_e(he.y)?Fr(ln,At.height):ln}if(he.opacity=1,Xn(he))$e(he);else{const we=Nn(qt);$e(we)}ha(he)&&cr(he),Xn(he)&&Hn(he)}}:tr(x)?{start:de=>{const{origin:he}=de.detail,we=ti(Ft(he)),Se=bo(we,Oc);L=Be(he),xr({...x,x1:Vt?Fr(Se.x,At.width):Se.x,y1:Vt?Fr(Se.y,At.height):Se.y,x2:Vt?Fr(Se.x,At.width):Se.x,y2:Vt?Fr(Se.y,At.height):Se.y,opacity:0},qt)},update:de=>{const{translation:he}=de.detail,we=Ft(Dn(Be(L),he));if(ee.includes(16)){const Ze=ho(L,we),ii=Dd(L,we),xi=Math.PI/4,ui=xi*Math.round(ii/xi);we.x=L.x+Ze*Math.cos(ui),we.y=L.y+Ze*Math.sin(ui)}const Se=ti(we);$n({x2:Vt?Fr(Se.x,At.width):Se.x,y2:Vt?Fr(Se.y,At.height):Se.y,opacity:1},qt)},release:de=>de.detail.preventInertia(),cancel:()=>{vn(qt)},end:de=>{const he=Ln(qt);if(de.detail.isTap)return vn(qt);he.opacity=1;const we=Nn(qt);$e(we),ha(he)&&cr(we)}}:void 0},()=>{let x,j;const L=xe*xe,rt=(ct,Lt,Nt=!1)=>{const Vt=yo(ct,Lt);if(!Nt&&Vt<2)return!1;const Bt=dt.filter(_t=>!_t.disableErase);let Ft;return Ft=Vt<L?Ar(dt,ti(Lt),xe):B(Bt,ti(ct),ti(Lt),xe),to(Ft).forEach(Ne),!0};return{start:ct=>{x=ot(Math.round(ct.detail.origin.x),Math.round(ct.detail.origin.y)),rt(x,x,!0),j=x},update:ct=>{const{translation:Lt}=ct.detail,Nt=ot(Math.round(x.x+Lt.x),Math.round(x.y+Lt.y));rt(j,Nt)&&(j=Be(Nt))},release:ct=>ct.detail.preventInertia(),cancel:()=>{vn(collection)},end:()=>{}}},Jr,Ir,x=>{if(!Jr())return Zp(x),So(x)},ur,wr,(x={})=>({id:ea(),...x}),Wn,_i,Vi,lr,(x,j,L=!0)=>{dt.forEach(rt=>lr(rt,x,j,!1)),L&&Wn()},Ji,Vr,co,Qr,pr,Sr,Kn,Hn,Er,to,eo,Mn,Ar,B,ko,dr,Pt,wi,Hr,Zr,c,xt,r,kt,q,J,vt,Z,lt,nt,S,Kt,mt,Dt,oe,C,zt,tt,a,k,at,N,y,O,n,T,F,W,f,M,d,o,u,dt,se,ee,be,function(x){Wr.call(this,t,x)},x=>cr(Ot[x]),function(x){zi[x?"unshift":"push"](()=>{Di=x,i(8,Di)})},function(){ut=this.value,i(24,ut),i(11,V),i(147,r),i(167,y),i(0,ye),i(178,dt)},function(x){zi[x?"unshift":"push"](()=>{Di=x,i(8,Di)})},()=>{Va&&Va.focus()},x=>i(9,Bs=x.detail),function(x){zi[x?"unshift":"push"](()=>{Va=x,i(20,Va)})},x=>hh(x,Ge)]}class NS extends ci{constructor(e){super(),li(this,e,VS,_S,oi,{uid:58,ui:59,disabled:0,shapes:1,selection:60,offset:2,contextRotation:61,contextFlipX:62,contextFlipY:63,contextZoom:64,active:65,opacity:66,parentRect:67,rootRect:3,utilRect:68,hoverColor:69,caretColor:70,gridColor:71,snapColor:72,textInputMode:4,oninteractionstart:73,oninteractionupdate:74,oninteractionrelease:75,oninteractionend:76,oninteractioncancel:77,onaddshape:78,onupdateshape:79,onselectshape:80,onblurshape:81,onremoveshape:82,ontapshape:83,onhovershape:84,onhovercanvas:85,ontapcanvas:86,onleavecanvas:87,beforeSelectShape:88,beforeDeselectShape:89,beforeRemoveShape:90,beforeUpdateShape:91,willRenderShapeControls:92,willRenderShapeTextControls:93,willStartInteraction:94,mapEditorPointToImagePoint:95,mapImagePointToEditorPoint:96,eraseRadius:97,selectRadius:98,enableButtonFlipVertical:99,enableTapToAddText:100,enableTextStyleControls:5,locale:6,snapThreshold:101,snapPointer:102,enableSnapToContext:103,gridSize:104,syncShapeCollection:105,getShapeDraft:106,addShapeDraft:107,discardShapeDraft:108,confirmShapeDraft:109,updateShapeDraft:110,addShape:111,createShape:112,eraseShape:113,getMarkupItemDraft:114,getMarkupItemDraftIndex:115,addMarkupItemDraft:116,confirmMarkupItemDraft:117,discardMarkupItemDraft:118,createMarkupItem:119,syncShapes:120,removeMarkupShapeProps:121,updateMarkupShape:122,updateMarkupShapeProperty:123,updateMarkupItemsShapeProperty:124,updateMarkupShapeItems:125,getActiveMarkupItem:126,hasActiveMarkupItem:127,removeShape:128,removeActiveMarkupItem:129,blurShapes:130,selectShape:7,deselectMarkupItem:131,editMarkupItem:132,finishEditMarkupItem:133,removeMarkupItems:134,getTextShapeRect:135,getMarkupShapeRect:136,getShapesNearPosition:137,getShapesBetweenPoints:138},null,[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1])}get syncShapeCollection(){return this.$$.ctx[105]}get getShapeDraft(){return this.$$.ctx[106]}get addShapeDraft(){return this.$$.ctx[107]}get discardShapeDraft(){return this.$$.ctx[108]}get confirmShapeDraft(){return this.$$.ctx[109]}get updateShapeDraft(){return this.$$.ctx[110]}get addShape(){return this.$$.ctx[111]}get createShape(){return this.$$.ctx[112]}get eraseShape(){return this.$$.ctx[113]}get getMarkupItemDraft(){return this.$$.ctx[114]}get getMarkupItemDraftIndex(){return this.$$.ctx[115]}get addMarkupItemDraft(){return this.$$.ctx[116]}get confirmMarkupItemDraft(){return this.$$.ctx[117]}get discardMarkupItemDraft(){return this.$$.ctx[118]}get createMarkupItem(){return this.$$.ctx[119]}get syncShapes(){return this.$$.ctx[120]}get removeMarkupShapeProps(){return this.$$.ctx[121]}get updateMarkupShape(){return this.$$.ctx[122]}get updateMarkupShapeProperty(){return this.$$.ctx[123]}get updateMarkupItemsShapeProperty(){return this.$$.ctx[124]}get updateMarkupShapeItems(){return this.$$.ctx[125]}get getActiveMarkupItem(){return this.$$.ctx[126]}get hasActiveMarkupItem(){return this.$$.ctx[127]}get removeShape(){return this.$$.ctx[128]}get removeActiveMarkupItem(){return this.$$.ctx[129]}get blurShapes(){return this.$$.ctx[130]}get selectShape(){return this.$$.ctx[7]}get deselectMarkupItem(){return this.$$.ctx[131]}get editMarkupItem(){return this.$$.ctx[132]}get finishEditMarkupItem(){return this.$$.ctx[133]}get removeMarkupItems(){return this.$$.ctx[134]}get getTextShapeRect(){return this.$$.ctx[135]}get getMarkupShapeRect(){return this.$$.ctx[136]}get getShapesNearPosition(){return this.$$.ctx[137]}get getShapesBetweenPoints(){return this.$$.ctx[138]}}function HS(t){let e,i,n;return i=new oo({props:{items:t[2]}}),{c(){e=ht("ul"),Et(i.$$.fragment),v(e,"class","PinturaShapeStyleList")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};4&o&&(a.items=r[2]),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function jS(t){let e,i;return e=new va({props:{class:"PinturaShapeStyles",elasticity:t[0],$$slots:{default:[US]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1&r&&(o.elasticity=n[0]),131076&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function US(t){let e,i,n;return i=new oo({props:{items:t[2]}}),{c(){e=ht("ul"),Et(i.$$.fragment),v(e,"class","PinturaShapeStyleList")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};4&o&&(a.items=r[2]),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function GS(t){let e,i,n,r;const o=[jS,HS],a=[];function s(l,c){return l[1]?0:1}return i=s(t),n=a[i]=o[i](t),{c(){e=ht("div"),n.c(),v(e,"style",t[3])},m(l,c){et(l,e,c),a[i].m(e,null),r=!0},p(l,[c]){let d=i;i=s(l),i===d?a[i].p(l,c):(Ie(),z(a[d],1,1,()=>{a[d]=null}),Ee(),n=a[i],n?n.p(l,c):(n=a[i]=o[i](l),n.c()),P(n,1),n.m(e,null)),(!r||8&c)&&v(e,"style",l[3])},i(l){r||(P(n),r=!0)},o(l){z(n),r=!1},d(l){l&&Q(e),a[i].d()}}}function ZS(t,e,i){let n,r,o,a,s,l,{isActive:c=!1}=e,{controls:d=[]}=e,{locale:u}=e,{scrollElasticity:p}=e,{scrollEnable:h=!0}=e,{hideTitles:g=!1}=e,{willRenderControls:m=Ki}=e;const f=sn("redrawTrigger");A(t,f,C=>i(14,a=C));const b=sn("env");A(t,b,C=>i(13,o=C));const w=sn("isAnimated");A(t,w,C=>i(16,l=C));const S=pi(0,{stiffness:.25,damping:.9});return A(t,S,C=>i(15,s=C)),t.$$set=C=>{"isActive"in C&&i(8,c=C.isActive),"controls"in C&&i(9,d=C.controls),"locale"in C&&i(10,u=C.locale),"scrollElasticity"in C&&i(0,p=C.scrollElasticity),"scrollEnable"in C&&i(1,h=C.scrollEnable),"hideTitles"in C&&i(11,g=C.hideTitles),"willRenderControls"in C&&i(12,m=C.willRenderControls)},t.$$.update=()=>{65792&t.$$.dirty&&S.set(c?1:0,{hard:l===!1}),33024&t.$$.dirty&&i(3,n=`opacity:${s};${c?"":"pointer-events:none;"}${s<=0?"visibility:hidden":""}`),32256&t.$$.dirty&&i(2,r=a&&m(d.map(C=>["ShapeStyle",C.id,{title:C.componentProps.title,locale:u,hideTitle:g,items:[[C.component,C.id,C.componentProps]]}]),o,()=>f.set({})))},[p,h,r,n,f,b,w,S,c,d,u,g,m,o,a,s,l]}class XS extends ci{constructor(e){super(),li(this,e,ZS,GS,oi,{isActive:8,controls:9,locale:10,scrollElasticity:0,scrollEnable:1,hideTitles:11,willRenderControls:12})}}function Cf(t,e,i){const n=t.slice();return n[15]=e[i].key,n[6]=e[i].controls,n[16]=e[i].isActive,n}function Tf(t,e){let i,n,r;return n=new XS({props:{isActive:e[16],controls:e[6],locale:e[1],scrollElasticity:e[2],scrollEnable:e[3],hideTitles:e[4],willRenderControls:e[5]}}),{key:t,first:null,c(){i=Tn(),Et(n.$$.fragment),this.first=i},m(o,a){et(o,i,a),Rt(n,o,a),r=!0},p(o,a){e=o;const s={};128&a&&(s.isActive=e[16]),128&a&&(s.controls=e[6]),2&a&&(s.locale=e[1]),4&a&&(s.scrollElasticity=e[2]),8&a&&(s.scrollEnable=e[3]),16&a&&(s.hideTitles=e[4]),32&a&&(s.willRenderControls=e[5]),n.$set(s)},i(o){r||(P(n.$$.fragment,o),r=!0)},o(o){z(n.$$.fragment,o),r=!1},d(o){o&&Q(i),It(n,o)}}}function YS(t){let e,i,n,r=[],o=new Map,a=t[7];const s=l=>l[15];for(let l=0;l<a.length;l+=1){let c=Cf(t,a,l),d=s(c);o.set(d,r[l]=Tf(d,c))}return{c(){e=ht("div");for(let l=0;l<r.length;l+=1)r[l].c();v(e,"class",i=mi(["PinturaShapeStyleEditor",!t[3]&&"PinturaShapeStyleEditorOverflow",t[0]]))},m(l,c){et(l,e,c);for(let d=0;d<r.length;d+=1)r[d].m(e,null);n=!0},p(l,[c]){190&c&&(a=l[7],Ie(),r=La(r,c,s,1,l,a,o,e,Ls,Tf,null,Cf),Ee()),(!n||9&c&&i!==(i=mi(["PinturaShapeStyleEditor",!l[3]&&"PinturaShapeStyleEditorOverflow",l[0]])))&&v(e,"class",i)},i(l){if(!n){for(let c=0;c<a.length;c+=1)P(r[c]);n=!0}},o(l){for(let c=0;c<r.length;c+=1)z(r[c]);n=!1},d(l){l&&Q(e);for(let c=0;c<r.length;c+=1)r[c].d()}}}function qS(t,e,i){let n,r,o,{class:a}=e,{controls:s={}}=e,{shape:l}=e,{onchange:c}=e,{locale:d}=e,{scrollElasticity:u}=e,{scrollEnable:p=!0}=e,{hideTitles:h=!1}=e,{willRenderControls:g}=e;const m=[];return t.$$set=f=>{"class"in f&&i(0,a=f.class),"controls"in f&&i(6,s=f.controls),"shape"in f&&i(8,l=f.shape),"onchange"in f&&i(9,c=f.onchange),"locale"in f&&i(1,d=f.locale),"scrollElasticity"in f&&i(2,u=f.scrollElasticity),"scrollEnable"in f&&i(3,p=f.scrollEnable),"hideTitles"in f&&i(4,h=f.hideTitles),"willRenderControls"in f&&i(5,g=f.willRenderControls)},t.$$.update=()=>{64&t.$$.dirty&&i(11,n=Object.keys(s).filter(f=>s[f])),2304&t.$$.dirty&&i(10,r=l&&Object.keys(l).length&&n&&Xp(l)?(f=>n.filter(b=>b.split("_").every(w=>Ae(f,w)&&Xp(f,w))).map(b=>{const w=(f.settings&&f.settings[b]||{}).control||b,S=b.split("_"),C=S.length>1?S.map(T=>f[T]):f[b];if(on(s[w])){const{title:T,component:F}=s[w](C,W=>{c({[b]:W})},{selectedShapeId:f.id});return{id:w,component:oo,componentProps:{title:T,items:F}}}let[I,M]=s[w];if(_e(I)&&s[I]){const T={...M};[I,M]=s[I],M={...M,...T}}const D=on(M.options)?M.options(f):M.options;return I==="RadioGroup"&&(M.selectedIndex=-1),{id:w,component:I,componentProps:{...M,options:D,locale:d,value:C,optionLabelClass:"PinturaButtonLabel",onchange:T=>{const F=sl(T)&&!Rn(T)?T.value:T;M.onchange&&M.onchange(F,f);const W=S.length>1?S.reduce((O,y,V)=>({...O,[y]:Array.isArray(F)?F[V]:F}),{}):{[b]:F};c(W)}}}}).filter(Boolean))(l):[]),1280&t.$$.dirty&&i(7,o=((f,b)=>{let w=m.find(S=>S.key===f);return w||(w={key:f,controls:b},m.push(w)),m.forEach(S=>S.isActive=!1),w.controls=b,w.isActive=!0,m})(l&&Object.keys(l).length?Object.keys(l).join("_"):"none",r||[]))},[a,d,u,p,h,g,s,o,l,c,r,n]}class Du extends ci{constructor(e){super(),li(this,e,qS,YS,oi,{class:0,controls:6,shape:8,onchange:9,locale:1,scrollElasticity:2,scrollEnable:3,hideTitles:4,willRenderControls:5})}}var J2=t=>/<svg /.test(t);function KS(t){let e,i;return e=new oo({props:{items:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r&&(o.items=n[10]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function JS(t){let e,i,n,r;const o=[t6,QS],a=[];function s(l,c){return l[8]?0:1}return e=s(t),i=a[e]=o[e](t),{c(){i.c(),n=Tn()},m(l,c){a[e].m(l,c),et(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?a[e].p(l,c):(Ie(),z(a[d],1,1,()=>{a[d]=null}),Ee(),i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),P(i,1),i.m(n.parentNode,n))},i(l){r||(P(i),r=!0)},o(l){z(i),r=!1},d(l){a[e].d(l),l&&Q(n)}}}function QS(t){let e,i,n,r,o=t[10]&&Mf(t);return n=new va({props:{scrollAutoCancel:t[9],elasticity:t[0],$$slots:{default:[e6]},$$scope:{ctx:t}}}),{c(){e=ht("div"),o&&o.c(),i=pe(),Et(n.$$.fragment),v(e,"class","PinturaShapePresetsFlat")},m(a,s){et(a,e,s),o&&o.m(e,null),Ct(e,i),Rt(n,e,null),r=!0},p(a,s){a[10]?o?(o.p(a,s),1024&s&&P(o,1)):(o=Mf(a),o.c(),P(o,1),o.m(e,i)):o&&(Ie(),z(o,1,1,()=>{o=null}),Ee());const l={};512&s&&(l.scrollAutoCancel=a[9]),1&s&&(l.elasticity=a[0]),536871070&s&&(l.$$scope={dirty:s,ctx:a}),n.$set(l)},i(a){r||(P(o),P(n.$$.fragment,a),r=!0)},o(a){z(o),z(n.$$.fragment,a),r=!1},d(a){a&&Q(e),o&&o.d(),It(n)}}}function t6(t){let e,i,n,r,o;i=new va({props:{elasticity:t[0],class:"PinturaShapePresetsGroups",$$slots:{default:[r6]},$$scope:{ctx:t}}});const a=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[11]},t[12]];let s={$$slots:{default:[a6,({panel:l,panelIsActive:c})=>({26:l,27:c}),({panel:l,panelIsActive:c})=>(l?67108864:0)|(c?134217728:0)]},$$scope:{ctx:t}};for(let l=0;l<a.length;l+=1)s=Cn(s,a[l]);return r=new Eu({props:s}),{c(){e=ht("div"),Et(i.$$.fragment),n=pe(),Et(r.$$.fragment),v(e,"class","PinturaShapePresetsGrouped")},m(l,c){et(l,e,c),Rt(i,e,null),Ct(e,n),Rt(r,e,null),o=!0},p(l,c){const d={};1&c&&(d.elasticity=l[0]),536876128&c&&(d.$$scope={dirty:c,ctx:l}),i.$set(d);const u=6144&c?fr(a,[a[0],a[1],2048&c&&{panels:l[11]},4096&c&&Rr(l[12])]):{};738206239&c&&(u.$$scope={dirty:c,ctx:l}),r.$set(u)},i(l){o||(P(i.$$.fragment,l),P(r.$$.fragment,l),o=!0)},o(l){z(i.$$.fragment,l),z(r.$$.fragment,l),o=!1},d(l){l&&Q(e),It(i),It(r)}}}function Mf(t){let e,i;return e=new oo({props:{items:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r&&(o.items=n[10]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function e6(t){let e,i;return e=new Yh({props:{items:t[7],onclickitem:t[1],ongrabitem:t[2],ondragitem:t[3],ondropitem:t[4]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};128&r&&(o.items=n[7]),2&r&&(o.onclickitem=n[1]),4&r&&(o.ongrabitem=n[2]),8&r&&(o.ondragitem=n[3]),16&r&&(o.ondropitem=n[4]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Pf(t){let e,i;return e=new oo({props:{items:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r&&(o.items=n[10]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Rf(t){let e,i;return e=new wo({props:{$$slots:{default:[i6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};805306368&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function i6(t){let e,i=t[28].icon+"";return{c(){e=gr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){268435456&r&&i!==(i=n[28].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function If(t){let e,i,n=t[28].label+"";return{c(){e=ht("span"),i=mn(n)},m(r,o){et(r,e,o),Ct(e,i)},p(r,o){268435456&o&&n!==(n=r[28].label+"")&&In(i,n)},d(r){r&&Q(e)}}}function n6(t){let e,i,n,r=t[28].icon&&Rf(t),o=!t[28].hideLabel&&If(t);return{c(){r&&r.c(),e=pe(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[28].icon?r?(r.p(a,s),268435456&s&&P(r,1)):(r=Rf(a),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(Ie(),z(r,1,1,()=>{r=null}),Ee()),a[28].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=If(a),o.c(),o.m(i.parentNode,i))},i(a){n||(P(r),n=!0)},o(a){z(r),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function r6(t){let e,i,n,r=t[10]&&Pf(t);const o=[{class:"PinturaControlList"},{tabs:t[5]},t[12],{layout:"compact"}];let a={$$slots:{default:[n6,({tab:s})=>({28:s}),({tab:s})=>s?268435456:0]},$$scope:{ctx:t}};for(let s=0;s<o.length;s+=1)a=Cn(a,o[s]);return i=new Iu({props:a}),i.$on("select",t[18]),{c(){r&&r.c(),e=pe(),Et(i.$$.fragment)},m(s,l){r&&r.m(s,l),et(s,e,l),Rt(i,s,l),n=!0},p(s,l){s[10]?r?(r.p(s,l),1024&l&&P(r,1)):(r=Pf(s),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(Ie(),z(r,1,1,()=>{r=null}),Ee());const c=4128&l?fr(o,[o[0],32&l&&{tabs:s[5]},4096&l&&Rr(s[12]),o[3]]):{};805306368&l&&(c.$$scope={dirty:l,ctx:s}),i.$set(c)},i(s){n||(P(r),P(i.$$.fragment,s),n=!0)},o(s){z(r),z(i.$$.fragment,s),n=!1},d(s){r&&r.d(s),s&&Q(e),It(i,s)}}}function o6(t){let e,i;return e=new Yh({props:{items:t[13][t[26]].items,disabled:t[13][t[26]].disabled,onclickitem:t[1],ongrabitem:t[2],ondragitem:t[3],ondropitem:t[4]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};67117056&r&&(o.items=n[13][n[26]].items),67117056&r&&(o.disabled=n[13][n[26]].disabled),2&r&&(o.onclickitem=n[1]),4&r&&(o.ongrabitem=n[2]),8&r&&(o.ondragitem=n[3]),16&r&&(o.ondropitem=n[4]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function a6(t){let e,i;return e=new va({props:{scroll:t[27]?{scrollOffset:0,animate:!1}:void 0,scrollAutoCancel:t[9],elasticity:t[0],$$slots:{default:[o6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};134217728&r&&(o.scroll=n[27]?{scrollOffset:0,animate:!1}:void 0),512&r&&(o.scrollAutoCancel=n[9]),1&r&&(o.elasticity=n[0]),603987998&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function s6(t){let e,i,n,r;const o=[JS,KS],a=[];function s(l,c){return l[9]?0:l[10]?1:-1}return~(i=s(t))&&(n=a[i]=o[i](t)),{c(){e=ht("div"),n&&n.c(),v(e,"class","PinturaShapePresetsPalette")},m(l,c){et(l,e,c),~i&&a[i].m(e,null),r=!0},p(l,[c]){let d=i;i=s(l),i===d?~i&&a[i].p(l,c):(n&&(Ie(),z(a[d],1,1,()=>{a[d]=null}),Ee()),~i?(n=a[i],n?n.p(l,c):(n=a[i]=o[i](l),n.c()),P(n,1),n.m(e,null)):n=null)},i(l){r||(P(n),r=!0)},o(l){z(n),r=!1},d(l){l&&Q(e),~i&&a[i].d()}}}function l6(t,e,i){let n,r,o,a,s,l,c,d,u,{locale:p}=e,{presets:h}=e,{scrollElasticity:g}=e,{enableSelectImage:m=!0}=e,{willRenderPresetToolbar:f=Ki}=e,{onaddpreset:b=me}=e,{ongrabpreset:w}=e,{ondragpreset:S}=e,{ondroppreset:C}=e;const I="presets-"+ea(),M=(W,O="")=>J2(W)?W:mu(W)?xy(W,O):`<img src="${W}" alt="${O}"/>`,D=W=>ty(Sh(W)),T=["src","alt","thumb","shape","id","mount","disabled"],F=W=>W.map(O=>(y=>Rn(y)&&_e(y[0])&&Rn(y[1]))(O)?{...O[2],id:`${I}-${O[0].toLowerCase()}`,label:O[0],items:F(O[1])}:(y=>{let V,tt,k,N,it,ut,at,gt=y;return _e(y)?mu(y)?(V=y,it=y,N=M(V,it)):(V=y,it=D(V),N=M(V,it)):(V=y.src,it=y.alt||(_e(V)?D(V):_e(y.thumb)?D(y.thumb):void 0),N=M(y.thumb||V,it),tt=y.shape,ut=y.mount,at=y.disabled,k=Object.keys(y).reduce((G,$t)=>(T.includes($t)||(G[$t]=y[$t]),G),{})),{id:gt,src:V,thumb:N,shape:tt,shapeProps:k,alt:it,title:it,mount:ut,disabled:at}})(O));return t.$$set=W=>{"locale"in W&&i(14,p=W.locale),"presets"in W&&i(15,h=W.presets),"scrollElasticity"in W&&i(0,g=W.scrollElasticity),"enableSelectImage"in W&&i(16,m=W.enableSelectImage),"willRenderPresetToolbar"in W&&i(17,f=W.willRenderPresetToolbar),"onaddpreset"in W&&i(1,b=W.onaddpreset),"ongrabpreset"in W&&i(2,w=W.ongrabpreset),"ondragpreset"in W&&i(3,S=W.ondragpreset),"ondroppreset"in W&&i(4,C=W.ondroppreset)},t.$$.update=()=>{32768&t.$$.dirty&&i(7,n=F(h)),128&t.$$.dirty&&i(9,r=n.length),640&t.$$.dirty&&i(8,o=r&&n.some(W=>!!W.items)),384&t.$$.dirty&&i(5,a=o&&n),384&t.$$.dirty&&i(13,s=o&&n.reduce((W,O)=>(W[O.id]=O,W),{})),96&t.$$.dirty&&i(6,l=l||a&&(a.find(W=>!W.disabled)||{}).id),64&t.$$.dirty&&i(12,c={name:I,selected:l}),32&t.$$.dirty&&i(11,d=a&&a.map(W=>W.id)),212994&t.$$.dirty&&i(10,u=p&&f([m&&["Button","browse",{label:p.shapeLabelButtonSelectSticker,icon:p.shapeIconButtonSelectSticker,onclick:()=>{D2().then(W=>{W&&b(W)})}}]]))},[g,b,w,S,C,a,l,n,o,r,u,d,c,s,p,h,m,f,({detail:W})=>i(6,l=W)]}class Q2 extends ci{constructor(e){super(),li(this,e,l6,s6,oi,{locale:14,presets:15,scrollElasticity:0,enableSelectImage:16,willRenderPresetToolbar:17,onaddpreset:1,ongrabpreset:2,ondragpreset:3,ondroppreset:4})}}function c6(t){let e,i,n,r;return e=new oo({props:{items:t[29]}}),n=new Du({props:{locale:t[4],shape:t[48]||t[49],onchange:t[85],controls:t[9],scrollEnable:!1,hideTitles:!0,willRenderControls:t[160]}}),{c(){Et(e.$$.fragment),i=pe(),Et(n.$$.fragment)},m(o,a){Rt(e,o,a),et(o,i,a),Rt(n,o,a),r=!0},p(o,a){const s={};536870912&a[0]&&(s.items=o[29]),e.$set(s);const l={};16&a[0]&&(l.locale=o[4]),393216&a[1]&&(l.shape=o[48]||o[49]),512&a[0]&&(l.controls=o[9]),n.$set(l)},i(o){r||(P(e.$$.fragment,o),P(n.$$.fragment,o),r=!0)},o(o){z(e.$$.fragment,o),z(n.$$.fragment,o),r=!1},d(o){It(e,o),o&&Q(i),It(n,o)}}}function d6(t){let e,i,n;return i=new Y2({props:{$$slots:{default:[c6]},$$scope:{ctx:t}}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"slot","header")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};536871440&o[0]|393216&o[1]|524288&o[6]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function Ef(t){let e,i;const n=[{locale:t[4]},{ui:t[69]},{shapes:t[5]},{selection:t[58]},{uid:t[19]},{parentRect:t[36]},{rootRect:t[55]},{utilRect:t[38]},{offset:t[50]},{disabled:t[37]},{contextRotation:t[22]},{contextFlipX:t[23]},{contextFlipY:t[24]},{contextZoom:t[35]?t[35].scale:void 0},{active:t[34]},{opacity:t[56]},{hoverColor:t[57]},{caretColor:t[57]},{snapColor:t[57]},{gridColor:[1,1,1,.125]},{eraseRadius:t[46]},{selectRadius:t[6]},{enableButtonFlipVertical:t[10]},{mapEditorPointToImagePoint:t[20]},{mapImagePointToEditorPoint:t[21]},{enableTapToAddText:t[13]},{textInputMode:t[8]},{snapThreshold:t[15]},{snapPointer:!t[47]},{enableSnapToContext:t[16]},{gridSize:t[14]},{willStartInteraction:t[95]},{oninteractionstart:t[79]},{oninteractionupdate:t[80]},{oninteractionrelease:t[81]},{oninteractionend:t[83]},{oninteractioncancel:t[82]},{onleavecanvas:t[87]},{onhovercanvas:t[86]},{onhovershape:t[89]},{ontapcanvas:t[88]},{onaddshape:t[152]},{onselectshape:t[153]},{onblurshape:t[154]},{ontapshape:t[155]},{onupdateshape:t[156]},{onremoveshape:t[157]},t[41]];let r={};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new NS({props:r}),t[158](e),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=1106896240&a[0]|252282104&a[1]|255721600&a[2]|12&a[3]?fr(n,[16&a[0]&&{locale:o[4]},128&a[2]&&{ui:o[69]},32&a[0]&&{shapes:o[5]},134217728&a[1]&&{selection:o[58]},524288&a[0]&&{uid:o[19]},32&a[1]&&{parentRect:o[36]},16777216&a[1]&&{rootRect:o[55]},128&a[1]&&{utilRect:o[38]},524288&a[1]&&{offset:o[50]},64&a[1]&&{disabled:o[37]},4194304&a[0]&&{contextRotation:o[22]},8388608&a[0]&&{contextFlipX:o[23]},16777216&a[0]&&{contextFlipY:o[24]},16&a[1]&&{contextZoom:o[35]?o[35].scale:void 0},8&a[1]&&{active:o[34]},33554432&a[1]&&{opacity:o[56]},67108864&a[1]&&{hoverColor:o[57]},67108864&a[1]&&{caretColor:o[57]},67108864&a[1]&&{snapColor:o[57]},n[19],32768&a[1]&&{eraseRadius:o[46]},64&a[0]&&{selectRadius:o[6]},1024&a[0]&&{enableButtonFlipVertical:o[10]},1048576&a[0]&&{mapEditorPointToImagePoint:o[20]},2097152&a[0]&&{mapImagePointToEditorPoint:o[21]},8192&a[0]&&{enableTapToAddText:o[13]},256&a[0]&&{textInputMode:o[8]},32768&a[0]&&{snapThreshold:o[15]},65536&a[1]&&{snapPointer:!o[47]},65536&a[0]&&{enableSnapToContext:o[16]},16384&a[0]&&{gridSize:o[14]},4&a[3]&&{willStartInteraction:o[95]},131072&a[2]&&{oninteractionstart:o[79]},262144&a[2]&&{oninteractionupdate:o[80]},524288&a[2]&&{oninteractionrelease:o[81]},2097152&a[2]&&{oninteractionend:o[83]},1048576&a[2]&&{oninteractioncancel:o[82]},33554432&a[2]&&{onleavecanvas:o[87]},16777216&a[2]&&{onhovercanvas:o[86]},134217728&a[2]&&{onhovershape:o[89]},67108864&a[2]&&{ontapcanvas:o[88]},1073741824&a[0]|8&a[3]&&{onaddshape:o[152]},1073741824&a[0]&&{onselectshape:o[153]},1073741824&a[0]&&{onblurshape:o[154]},1073741824&a[0]&&{ontapshape:o[155]},1073741824&a[0]|8&a[3]&&{onupdateshape:o[156]},1073741824&a[0]|8&a[3]&&{onremoveshape:o[157]},1024&a[1]&&Rr(o[41])]):{};e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){t[158](null),It(e,o)}}}function u6(t){let e,i,n,r,o,a=t[51]&&Ef(t);return{c(){e=ht("div"),a&&a.c(),v(e,"slot","main"),v(e,"style",i="cursor:"+t[45])},m(s,l){et(s,e,l),a&&a.m(e,null),t[159](e),n=!0,r||(o=[Mt(e,"keydown",t[84]),Xi(y2.call(null,e)),Mt(e,"dropfiles",function(){Zi(t[12]?t[94]:me)&&(t[12]?t[94]:me).apply(this,arguments)}),Xi(yr.call(null,e)),Mt(e,"measure",t[148])],r=!0)},p(s,l){(t=s)[51]?a?(a.p(t,l),1048576&l[1]&&P(a,1)):(a=Ef(t),a.c(),P(a,1),a.m(e,null)):a&&(Ie(),z(a,1,1,()=>{a=null}),Ee()),(!n||16384&l[1]&&i!==(i="cursor:"+t[45]))&&v(e,"style",i)},i(s){n||(P(a),n=!0)},o(s){z(a),n=!1},d(s){s&&Q(e),a&&a.d(),t[159](null),r=!1,Ui(o)}}}function p6(t){let e,i;return e=new Q2({props:{locale:t[4],presets:t[18],enableSelectImage:t[11],willRenderPresetToolbar:t[42],onaddpreset:t[93],ongrabpreset:t[90],ondragpreset:t[91],ondroppreset:t[92],scrollElasticity:t[43]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),262144&r[0]&&(o.presets=n[18]),2048&r[0]&&(o.enableSelectImage=n[11]),2048&r[1]&&(o.willRenderPresetToolbar=n[42]),4096&r[1]&&(o.scrollElasticity=n[43]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function h6(t){let e,i,n,r=t[7]==="stack"&&Af(t),o=(t[53]&&t[33]||t[7]==="row")&&Lf(t);return{c(){r&&r.c(),e=pe(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[7]==="stack"?r?(r.p(a,s),128&s[0]&&P(r,1)):(r=Af(a),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(Ie(),z(r,1,1,()=>{r=null}),Ee()),a[53]&&a[33]||a[7]==="row"?o?(o.p(a,s),128&s[0]|4194308&s[1]&&P(o,1)):(o=Lf(a),o.c(),P(o,1),o.m(i.parentNode,i)):o&&(Ie(),z(o,1,1,()=>{o=null}),Ee())},i(a){n||(P(r),P(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function Af(t){let e,i,n,r;const o=[$6,m6],a=[];function s(l,c){return l[44]?0:1}return i=s(t),n=a[i]=o[i](t),{c(){e=ht("div"),n.c(),v(e,"class","PinturaControlPanels")},m(l,c){et(l,e,c),a[i].m(e,null),r=!0},p(l,c){let d=i;i=s(l),i===d?a[i].p(l,c):(Ie(),z(a[d],1,1,()=>{a[d]=null}),Ee(),n=a[i],n?n.p(l,c):(n=a[i]=o[i](l),n.c()),P(n,1),n.m(e,null))},i(l){r||(P(n),r=!0)},o(l){z(n),r=!1},d(l){l&&Q(e),a[i].d()}}}function m6(t){let e,i,n;return i=new Du({props:{locale:t[4],shape:t[48]||t[49],onchange:t[85],controls:t[9],scrollElasticity:t[43],willRenderControls:t[17]}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaControlPanel")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};16&o[0]&&(a.locale=r[4]),393216&o[1]&&(a.shape=r[48]||r[49]),512&o[0]&&(a.controls=r[9]),4096&o[1]&&(a.scrollElasticity=r[43]),131072&o[0]&&(a.willRenderControls=r[17]),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function $6(t){let e,i,n;return i=new Q2({props:{locale:t[4],presets:t[18],enableSelectImage:t[11],willRenderPresetToolbar:t[42],onaddpreset:t[93],ongrabpreset:t[90],ondragpreset:t[91],ondroppreset:t[92],scrollElasticity:t[43]}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaControlPanel")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};16&o[0]&&(a.locale=r[4]),262144&o[0]&&(a.presets=r[18]),2048&o[0]&&(a.enableSelectImage=r[11]),2048&o[1]&&(a.willRenderPresetToolbar=r[42]),4096&o[1]&&(a.scrollElasticity=r[43]),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function Lf(t){let e,i;return e=new va({props:{class:"PinturaControlListScroller",elasticity:t[43],$$slots:{default:[y6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4096&r[1]&&(o.elasticity=n[43]),131729&r[0]|393221&r[1]|524288&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function zf(t){let e,i;return e=new as({props:{locale:t[4],class:"PinturaControlList",optionClass:"PinturaControlListOption",layout:"row",options:t[31],selectedIndex:t[31].findIndex(t[149]),onchange:t[78],$$slots:{option:[f6,({option:n})=>({204:n}),({option:n})=>[0,0,0,0,0,0,n?262144:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),1&r[1]&&(o.options=n[31]),1&r[0]|1&r[1]&&(o.selectedIndex=n[31].findIndex(n[149])),16&r[0]|786432&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Ff(t){let e,i;return e=new wo({props:{$$slots:{default:[g6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]|786432&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function g6(t){let e,i=(on(t[204].icon)?t[204].icon(t[4]):t[204].icon)+"";return{c(){e=gr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){16&r[0]|262144&r[6]&&i!==(i=(on(n[204].icon)?n[204].icon(n[4]):n[204].icon)+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function Df(t){let e,i,n=(on(t[204].label)?t[204].label(t[4]):t[204].label)+"";return{c(){e=ht("span"),i=mn(n)},m(r,o){et(r,e,o),Ct(e,i)},p(r,o){16&o[0]|262144&o[6]&&n!==(n=(on(r[204].label)?r[204].label(r[4]):r[204].label)+"")&&In(i,n)},d(r){r&&Q(e)}}}function f6(t){let e,i,n,r=t[204].icon&&Ff(t),o=!t[204].hideLabel&&Df(t);return{c(){e=ht("div"),r&&r.c(),i=pe(),o&&o.c(),v(e,"slot","option")},m(a,s){et(a,e,s),r&&r.m(e,null),Ct(e,i),o&&o.m(e,null),n=!0},p(a,s){a[204].icon?r?(r.p(a,s),262144&s[6]&&P(r,1)):(r=Ff(a),r.c(),P(r,1),r.m(e,i)):r&&(Ie(),z(r,1,1,()=>{r=null}),Ee()),a[204].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=Df(a),o.c(),o.m(e,null))},i(a){n||(P(r),n=!0)},o(a){z(r),n=!1},d(a){a&&Q(e),r&&r.d(),o&&o.d()}}}function Bf(t){let e,i;return e=new Du({props:{locale:t[4],shape:t[48]||t[49],onchange:t[85],controls:t[9],scrollEnable:!1,hideTitles:!0,willRenderControls:t[150]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),393216&r[1]&&(o.shape=n[48]||n[49]),512&r[0]&&(o.controls=n[9]),131072&r[0]&&(o.willRenderControls=n[150]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function y6(t){let e,i,n,r=t[33]&&zf(t),o=t[7]==="row"&&Bf(t);return{c(){r&&r.c(),e=pe(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[33]?r?(r.p(a,s),4&s[1]&&P(r,1)):(r=zf(a),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(Ie(),z(r,1,1,()=>{r=null}),Ee()),a[7]==="row"?o?(o.p(a,s),128&s[0]&&P(o,1)):(o=Bf(a),o.c(),P(o,1),o.m(i.parentNode,i)):o&&(Ie(),z(o,1,1,()=>{o=null}),Ee())},i(a){n||(P(r),P(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function Of(t){let e,i;return e=new va({props:{class:"PinturaControlListScroller",elasticity:t[43],$$slots:{default:[v6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4096&r[1]&&(o.elasticity=n[43]),67108880&r[0]|8388608&r[1]|524288&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Wf(t){let e,i;return e=new wo({props:{$$slots:{default:[x6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]|786432&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function x6(t){let e,i=(on(t[204].icon)?t[204].icon(t[4]):t[204].icon)+"";return{c(){e=gr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){16&r[0]|262144&r[6]&&i!==(i=(on(n[204].icon)?n[204].icon(n[4]):n[204].icon)+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function b6(t){let e,i,n,r,o,a=(on(t[204].label)?t[204].label(t[4]):t[204].label)+"",s=t[204].icon&&Wf(t);return{c(){e=ht("div"),s&&s.c(),i=pe(),n=ht("span"),r=mn(a),v(e,"slot","option")},m(l,c){et(l,e,c),s&&s.m(e,null),Ct(e,i),Ct(e,n),Ct(n,r),o=!0},p(l,c){l[204].icon?s?(s.p(l,c),262144&c[6]&&P(s,1)):(s=Wf(l),s.c(),P(s,1),s.m(e,i)):s&&(Ie(),z(s,1,1,()=>{s=null}),Ee()),(!o||16&c[0]|262144&c[6])&&a!==(a=(on(l[204].label)?l[204].label(l[4]):l[204].label)+"")&&In(r,a)},i(l){o||(P(s),o=!0)},o(l){z(s),o=!1},d(l){l&&Q(e),s&&s.d()}}}function v6(t){let e,i;return e=new as({props:{locale:t[4],class:"PinturaControlList",optionClass:"PinturaControlListOption",layout:"row",options:t[54],selectedIndex:t[54].findIndex(t[151]),onchange:t[77],$$slots:{option:[b6,({option:n})=>({204:n}),({option:n})=>[0,0,0,0,0,0,n?262144:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),8388608&r[1]&&(o.options=n[54]),67108864&r[0]|8388608&r[1]&&(o.selectedIndex=n[54].findIndex(n[151])),16&r[0]|786432&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function w6(t){let e,i,n,r,o;const a=[h6,p6],s=[];function l(d,u){return d[52]?0:d[44]?1:-1}~(i=l(t))&&(n=s[i]=a[i](t));let c=t[32]&&Of(t);return{c(){e=ht("div"),n&&n.c(),r=pe(),c&&c.c(),v(e,"slot","footer"),v(e,"style",t[39])},m(d,u){et(d,e,u),~i&&s[i].m(e,null),Ct(e,r),c&&c.m(e,null),o=!0},p(d,u){let p=i;i=l(d),i===p?~i&&s[i].p(d,u):(n&&(Ie(),z(s[p],1,1,()=>{s[p]=null}),Ee()),~i?(n=s[i],n?n.p(d,u):(n=s[i]=a[i](d),n.c()),P(n,1),n.m(e,r)):n=null),d[32]?c?(c.p(d,u),2&u[1]&&P(c,1)):(c=Of(d),c.c(),P(c,1),c.m(e,null)):c&&(Ie(),z(c,1,1,()=>{c=null}),Ee()),(!o||256&u[1])&&v(e,"style",d[39])},i(d){o||(P(n),P(c),o=!0)},o(d){z(n),z(c),o=!1},d(d){d&&Q(e),~i&&s[i].d(),c&&c.d()}}}function S6(t){let e,i;return e=new dl({props:{hasHeader:t[40],$$slots:{footer:[w6],main:[u6],header:[d6]},$$scope:{ctx:t}}}),e.$on("measure",t[161]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};512&r[1]&&(o.hasHeader=n[40]),2113929201&r[0]|134217215&r[1]|524288&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function k6(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,I,M,D,T,F,W,O,y,V,tt,k,N,it,ut,at,gt,G,$t,vt,lt,kt,J,q,Z,xt,nt,mt,zt,oe,Dt,te,Kt,U,Tt,dt,Jt,se,ee,be,ve,_,ke,fi,ye,Ot,ze,Re,Oe=ni,di=()=>(Oe(),Oe=Br(bi,B=>i(34,Z=B)),bi),bt=ni,le=()=>(bt(),bt=Br(H,B=>i(141,zt=B)),H),Xe=ni,Ve=()=>(Xe(),Xe=Br(bn,B=>i(36,dt=B)),bn),At=ni,Ge=()=>(At(),At=Br(Ci,B=>i(147,fi=B)),Ci),Ye=ni,$i=()=>(Ye(),Ye=Br(Mi,B=>i(56,ze=B)),Mi);t.$$.on_destroy.push(()=>Oe()),t.$$.on_destroy.push(()=>bt()),t.$$.on_destroy.push(()=>Xe()),t.$$.on_destroy.push(()=>At()),t.$$.on_destroy.push(()=>Ye());let{isActive:bi}=e;di();let{isActiveFraction:Mi}=e;$i();let{isVisible:Ci}=e;Ge();let{stores:X}=e,{locale:Gt={}}=e,{shapes:H}=e;le();let{toolbar:Zt=[]}=e,{toolShapes:ae={}}=e,{toolActive:jt}=e,{toolSelectRadius:$e}=e,{toolRetainStyles:Xt=!1}=e,{toolbarLayout:Le="stack"}=e,{textInputMode:qe}=e,{shapeControls:Ne={}}=e,{enableButtonFlipVertical:pt=!1}=e,{enablePresetSelectImage:Ht=!0}=e,{enablePresetDropImage:ie=!0}=e,{enableSelectToolToAddShape:Fe=!1}=e,{enableAutoSelectMoveTool:Wt=["line","arrow","path","rectangle","ellipse","text"]}=e,{enableTapToAddText:K=!1}=e,{enableMoveTool:Yt=!1}=e,{enableViewTool:Ut=!1}=e,{enableToolShareStyles:ne=!0}=e,{gridSize:De=0}=e,{snapThreshold:re=0}=e,{enableSnapToContext:Bi=!0}=e,{willRenderHeaderTools:ti=Ki}=e,{willRenderPresetToolbar:Ce}=e,{willRenderShapeStyleControls:xe}=e,{willStartInteraction:Ke}=e,{shapePresets:Pe=[]}=e,{utilKey:je}=e,{mapScreenPointToImagePoint:Me}=e,{mapImagePointToScreenPoint:fe}=e,{imageRotation:Ti=0}=e,{imageFlipX:Yi=!1}=e,{imageFlipY:En=!1}=e,{parentRect:bn}=e;Ve();let{hooks:Vn={}}=e;const An=sn("selection");A(t,An,B=>i(146,ve=B));const qr=sn("isAnimated");A(t,qr,B=>i(138,xt=B));const ao=sn("elasticityMultiplier");A(t,ao,B=>i(142,oe=B));const Ln=sn("ui");A(t,Ln,B=>i(171,_=B));const xr=sn("keysPressed");let vn;A(t,xr,B=>i(145,be=B));const{env:Nn,history:$n,rootRect:So,rootColorSecondary:Wi,enablePanInput:gn,enablePanInputStatus:On,enableZoomInput:Vo,stageRect:Kr,utilRectPadded:$o,scrollElasticity:ko,imageOverlayMarkup:dr,imagePreviewModifiers:cn,imageCropRect:en,shapePreprocessor:so,stageScalar:No,imageSelectionRect:br,imageTransformsInterpolated:vr,imageSelectionPan:lo,imageSize:la,allowPan:Co,allowZoom:To,allowZoomControls:_r,allowPlayPause:Jr}=X;A(t,Nn,B=>i(139,nt=B)),A(t,So,B=>i(55,Ot=B)),A(t,Wi,B=>i(57,Re=B)),A(t,On,B=>i(37,se=B)),A(t,Kr,B=>i(143,Dt=B)),A(t,$o,B=>i(38,ke=B)),A(t,cn,B=>i(172,ye=B)),A(t,en,B=>i(170,Jt=B)),A(t,No,B=>i(168,U=B)),A(t,br,B=>i(169,Tt=B)),A(t,vr,B=>i(35,te=B)),A(t,lo,B=>i(167,Kt=B)),A(t,la,B=>i(144,ee=B));let Ir=0,ur={};const wr=B=>{const[ce,vi]=vn[B];let Ue,Pt,ge=vi.position==="relative";const yi=ge?"0%":0,Gi=ge?"0%":0;xo(ce)||Xn(ce)?(Pt=ge?"20%":.2*dt.width,Ue=jn(ce),Ue.x=yi,Ue.y=Gi,ga(Ue,{width:Pt,height:Pt},dt)):Yn(ce)?(Pt=ge?"10%":.1*dt.width,Ue=jn(ce),Ue.x=yi,Ue.y=Gi,ga(Ue,{rx:Pt,ry:Pt},dt)):tr(ce)&&(Pt=ge?"10%":.1*dt.width,Ue=jn(ce),Ue.x1=yi,Ue.y1=Gi,Ue.x2=yi,Ue.y2=Gi),Ue&&Promise.resolve().then(()=>{Kn(uo(Ue,void 0,Pt))})},Wn=B=>Me(hh(B,Ot));let _i,Vi={},lr,Ji;const Vr=B=>{if(!(_n(B)&&Ae(B,"pathClose")))return;const ce=[...B.strokeColor];ce[3]=1,_i.updateMarkupShape(B,{pathClose:!1,strokeColor:ce},!1),_i.removeMarkupShapeProps(B,["backgroundColor"],!1),_i.confirmMarkupItemDraft(),_i.selectShape(B),gt("addshape",B),$n.write()};let co;const Qr=(B,ce)=>{if(hi(B))return B;if(B.endsWith("%"))return parseFloat(B)/100*ce.width};let pr,zn,Sr;const uo=(B,ce,vi)=>{let Ue=!1;ce||(Ue=!0,ce=at?Me(ki(Dt)):ki(Jt)),ce.x-=dt.x||0,ce.y-=dt.y||0,(Yi||En)&&(B.flipX=Yi,B.flipY=En);const Pt=_i.getShapesNearPosition(zt,ce);if(Ue&&Pt.length){const ge=.1*Math.min(Jt.width,Jt.height);ce.x+=Math.round(-ge+Math.random()*ge*2),ce.y+=Math.round(-ge+Math.random()*ge*2)}if(Ti!==0&&(B.rotation=Yi&&En?-Ti:Yi||En?Ti:-Ti),Ae(B,"width")&&Ae(B,"height")){const{width:ge,height:yi}=Ll(B,["width","height"],dt);ga(B,{x:ce.x-.5*ge,y:ce.y-.5*yi},dt)}else if(Yn(B))ga(B,{x:ce.x,y:ce.y},dt);else if(tr(B)){const{x1:ge,y1:yi,x2:Gi,y2:dn}=Ll(B,["x1","y1","x2","y2"],dt),wi=ho(ot(ge,yi),ot(Gi,dn)),Ni=_e(vi)?gu(vi,dt.width):wi;ga(B,{x1:ce.x-Ni,y1:ce.y+Ni,x2:ce.x+Ni,y2:ce.y-Ni},dt)}else if(_n(B)){const{points:ge}=Ll(B,["points"],dt),yi=Do(ge);ga(B,{points:ge.map(Gi=>({x:Gi.x+ce.x-yi.x,y:Gi.y+ce.y-yi.y}))},dt)}return B},cr=(B,ce)=>{const vi=uo(Dm(B,Jt),ce);return B.shape&&(Ae(B.shape,"x")&&(vi.x=B.shape.x),Ae(B.shape,"y")&&(vi.y=B.shape.y)),Kn(vi)},Kn=B=>{const{beforeAddShape:ce=()=>!0}=Vn;if(ce(B))return _i.addShape(B),_i.selectShape(B),gt("addshape",B),$n.write(),B};let Hn=!1;const Er=()=>{$n.write()};let to;const eo=sn("redrawTrigger");A(t,eo,B=>i(140,mt=B));const Mn=[],Ar=pi(xt?20:0);return A(t,Ar,B=>i(137,q=B)),t.$$set=B=>{"isActive"in B&&di(i(1,bi=B.isActive)),"isActiveFraction"in B&&$i(i(2,Mi=B.isActiveFraction)),"isVisible"in B&&Ge(i(3,Ci=B.isVisible)),"stores"in B&&i(100,X=B.stores),"locale"in B&&i(4,Gt=B.locale),"shapes"in B&&le(i(5,H=B.shapes)),"toolbar"in B&&i(101,Zt=B.toolbar),"toolShapes"in B&&i(102,ae=B.toolShapes),"toolActive"in B&&i(0,jt=B.toolActive),"toolSelectRadius"in B&&i(6,$e=B.toolSelectRadius),"toolRetainStyles"in B&&i(103,Xt=B.toolRetainStyles),"toolbarLayout"in B&&i(7,Le=B.toolbarLayout),"textInputMode"in B&&i(8,qe=B.textInputMode),"shapeControls"in B&&i(9,Ne=B.shapeControls),"enableButtonFlipVertical"in B&&i(10,pt=B.enableButtonFlipVertical),"enablePresetSelectImage"in B&&i(11,Ht=B.enablePresetSelectImage),"enablePresetDropImage"in B&&i(12,ie=B.enablePresetDropImage),"enableSelectToolToAddShape"in B&&i(104,Fe=B.enableSelectToolToAddShape),"enableAutoSelectMoveTool"in B&&i(105,Wt=B.enableAutoSelectMoveTool),"enableTapToAddText"in B&&i(13,K=B.enableTapToAddText),"enableMoveTool"in B&&i(106,Yt=B.enableMoveTool),"enableViewTool"in B&&i(107,Ut=B.enableViewTool),"enableToolShareStyles"in B&&i(108,ne=B.enableToolShareStyles),"gridSize"in B&&i(14,De=B.gridSize),"snapThreshold"in B&&i(15,re=B.snapThreshold),"enableSnapToContext"in B&&i(16,Bi=B.enableSnapToContext),"willRenderHeaderTools"in B&&i(109,ti=B.willRenderHeaderTools),"willRenderPresetToolbar"in B&&i(110,Ce=B.willRenderPresetToolbar),"willRenderShapeStyleControls"in B&&i(17,xe=B.willRenderShapeStyleControls),"willStartInteraction"in B&&i(111,Ke=B.willStartInteraction),"shapePresets"in B&&i(18,Pe=B.shapePresets),"utilKey"in B&&i(19,je=B.utilKey),"mapScreenPointToImagePoint"in B&&i(20,Me=B.mapScreenPointToImagePoint),"mapImagePointToScreenPoint"in B&&i(21,fe=B.mapImagePointToScreenPoint),"imageRotation"in B&&i(22,Ti=B.imageRotation),"imageFlipX"in B&&i(23,Yi=B.imageFlipX),"imageFlipY"in B&&i(24,En=B.imageFlipY),"parentRect"in B&&Ve(i(25,bn=B.parentRect)),"hooks"in B&&i(112,Vn=B.hooks)},t.$$.update=()=>{var B,ce,vi,Ue;if(2097152&t.$$.dirty[4]&&i(122,n=be.includes(18)),1049088&t.$$.dirty[3]&&(vn&&ae===vn||i(113,vn=ae)),8&t.$$.dirty[1]&&Co.set(Z),8&t.$$.dirty[1]&&To.set(Z),8&t.$$.dirty[1]&&_r.set(Z),256&t.$$.dirty[3]&&i(32,r=Array.isArray(Zt)&&Zt.length>1&&Array.isArray(Zt[0][1])),2&t.$$.dirty[1]|256&t.$$.dirty[3]&&i(54,o=r?Zt.map((Pt,ge)=>[ge,Pt[0]]):[]),67108864&t.$$.dirty[0]|2&t.$$.dirty[1]|256&t.$$.dirty[3]&&i(136,a=r?Zt[Ir][1]:Zt),262144&t.$$.dirty[0]|155648&t.$$.dirty[3]|4096&t.$$.dirty[4]&&i(31,s=((Pt,{willRenderPresetToolbar:ge,shapePresets:yi,enableViewTool:Gi,enableMoveTool:dn})=>{let wi=yi.length!==0||ge?Pt:Pt.filter(Ni=>Ni[0]!=="preset");return r&&(wi=[["move",Ni=>Ni.shapeLabelToolMove,{icon:Ni=>Ni.shapeIconToolMove}],["view",Ni=>Ni.shapeLabelToolView,{icon:Ni=>Ni.shapeIconToolView}],...wi]),wi=dn?wi:wi.filter(Ni=>Ni[0]!=="move"),Gi?wi:wi.filter(Ni=>Ni[0]!=="view")})(a,{willRenderPresetToolbar:Ce,shapePresets:Pe,enableMoveTool:Yt,enableViewTool:Ut})),1&t.$$.dirty[1]&&i(134,d=!!s.length),1&t.$$.dirty[0]|1&t.$$.dirty[1]|1024&t.$$.dirty[4]&&d&&jt===void 0&&i(0,jt=s[0][0]),67108865&t.$$.dirty[0]|2&t.$$.dirty[1]|2097152&t.$$.dirty[3]|4096&t.$$.dirty[4]&&r&&i(114,ur={...ur,[Ir]:a.map(([Pt])=>Pt).includes(jt)?jt:ur[Ir]||a[0][0]}),512&t.$$.dirty[0]&&i(133,l=!!Object.keys(Ne).length),1&t.$$.dirty[1]&&i(33,c=s.length>1),6&t.$$.dirty[1]&&i(53,u=c||r),1&t.$$.dirty[0]&&i(135,p=jt!==void 0),3584&t.$$.dirty[4]&&i(52,h=(!p||d)&&l),268435456&t.$$.dirty[0]&&i(30,gt=to&&(B=to,(Pt,ge)=>{B.dispatchEvent(fs(Pt,ge))})),1073741825&t.$$.dirty[0]|8&t.$$.dirty[1]&&Z&&gt&&gt("selectcontrol",jt),8&t.$$.dirty[1]&&(Z?wt(cn,ye[je]={maskMarkupOpacity:.85},ye):delete ye[je]),1&t.$$.dirty[0]|1048576&t.$$.dirty[3]&&i(132,g=jt&&vn[jt]?vn[jt][1]:void 0),256&t.$$.dirty[4]&&i(123,m=g&&g.isSelection?"selection":"shapes"),1610612736&t.$$.dirty[3]&&(Pt=>{if(!_i)return;const ge=_i.getShapeDraft(An);ge&&(Pt&&(lr=ge.drawMode),_i.updateShapeDraft({drawMode:Pt?"subtract":lr},An))})(m==="selection"&&n),134217729&t.$$.dirty[0]&&jt&&_i){const Pt=_i.getMarkupItemDraft();Pt&&Vr(Pt)}if(1&t.$$.dirty[0]&&jt&&_i&&jt!=="move"&&_i.blurShapes(),8&t.$$.dirty[1]|8388608&t.$$.dirty[4]&&i(51,f=fi&&Z),128&t.$$.dirty[1]|524288&t.$$.dirty[4]&&i(50,b=ke&&ot(Dt.x-ke.x,Dt.y-ke.y)),512&t.$$.dirty[0]&&i(131,w=Object.keys(Ne)),8&t.$$.dirty[1]|131072&t.$$.dirty[4]&&i(119,S=Z&&zt.filter(xs)[0]),8&t.$$.dirty[1]|131072&t.$$.dirty[4]&&i(128,C=Z&&zt.find(Pt=>$p(Pt))),8&t.$$.dirty[1]|131072&t.$$.dirty[4]&&i(49,I=Z&&zt.find(Pt=>fo(Pt))),1&t.$$.dirty[0]|8&t.$$.dirty[1]|1048576&t.$$.dirty[3]&&i(125,M=Z&&vn[jt]?My(jn({...vn[jt][0],..._[je]?_[je][jt]:{}})):{}),1048576&t.$$.dirty[3]&&vn&&i(115,Vi={}),1&t.$$.dirty[0]|4227072&t.$$.dirty[3]|130&t.$$.dirty[4]&&i(124,D=M&&Object.keys(M).reduce((Pt,ge)=>{const yi=ge==="disableStyle",Gi=ge==="settings",dn=!!w.find(Lr=>Lr.split("_").includes(ge));if(!yi&&!Gi&&!dn||M[ge]===void 0||M.disableStyle===!0||M.disableStyle&&M.disableStyle.includes(ge))return Pt;if(ge==="strokeWidth"&&Object.keys(Vi).includes("strokeWidth")&&Vi[ge]===void 0&&Ae(M,"points"))return Pt[ge]=M[ge],Pt;const{share:wi=!0}=M.settings&&M.settings[ge]||{},Ni=ne&&wi?Vi:Vi[jt]||{};return Pt[ge]=Ae(Ni,ge)?Ni[ge]:M[ge],Pt},{})),524289&t.$$.dirty[0]|1024&t.$$.dirty[3]|1&t.$$.dirty[4]&&(Xt?((Pt,ge,yi)=>{const Gi=_[Pt],dn=Gi?Gi[ge]:{};Ln.set({..._,[Pt]:{...Gi,[ge]:{...dn,...yi}}})})(je,jt,D):(ce=je,Ln.set({[ce]:{}}))),8&t.$$.dirty[1]|67108864&t.$$.dirty[3]|4194305&t.$$.dirty[4]&&i(48,T=ve&&Z?S||D:void 0),1&t.$$.dirty[0]|2&t.$$.dirty[4]&&i(47,F=Ae(M,"eraseRadius")||Ae(M,"points")&&!Ae(M,"pathClose")||jt==="move"||jt==="view"),32&t.$$.dirty[1]|2&t.$$.dirty[4]&&i(46,W=M&&M.eraseRadius!==void 0?Qr(M.eraseRadius,dt):void 0),8&t.$$.dirty[1]|2097152&t.$$.dirty[4]&&i(129,O=Z&&be.includes(32)),1&t.$$.dirty[0]|8&t.$$.dirty[1]&&i(130,y=Z&&jt==="view"),96&t.$$.dirty[4]&&i(127,V=y||O),24&t.$$.dirty[4]&&i(126,tt=!!V&&(!!C||Wc(document.activeElement))),8&t.$$.dirty[1]|12&t.$$.dirty[4]&&gn.set(!Z||V&&!tt),8&t.$$.dirty[1]|4&t.$$.dirty[4]&&Vo.set(!Z||!tt),32&t.$$.dirty[1]|3&t.$$.dirty[4]&&i(120,k=M.cursorStyle?(({cursorStyle:Pt,cursorSize:ge},yi,Gi)=>{let dn;const wi=yi[ge];if(wi===void 0?dn=Qr(ge,Gi):hi(wi)?dn=wi:_e(wi)&&(dn=Bb(ge,yi[ge],Gi),ge==="strokeWidth"&&(dn*=.5)),!(dn<=0||dn===void 0))return{size:dn,style:Pt}})(M,{...M,...D},dt):void 0),33554432&t.$$.dirty[3]|1048576&t.$$.dirty[4]&&i(121,N=Sr&&(Ue=ee,(vi=Sr).x>=0&&vi.y>=0&&vi.x<=Ue.width&&vi.y<=Ue.height)),524288&t.$$.dirty[0]|80&t.$$.dirty[1]|2038431744&t.$$.dirty[3])if(N&&!pr&&k&&!se){const Pt=k.size*te.scale,ge={id:"cursor-"+je,x:zn.x,y:zn.y,strokeWidth:.5,strokeColor:[0,0,0]};k.style==="ellipse"&&(ge.rx=Pt,ge.ry=Pt);const yi={strokeWidth:2.5,strokeColor:[1,1,1],opacity:.75},Gi=[{...ge,...yi},ge];if(m==="selection"&&n){const dn=Pt,wi=zn.x+dn,Ni=zn.y+dn+4,Lr={id:"cursor-"+je,strokeWidth:.75,strokeColor:[0,0,0],points:[{x:wi,y:Ni},{x:wi+4,y:Ni}]};Gi.push({...Lr,...yi,strokeWidth:2,points:[{x:wi-.5,y:Ni},{x:wi+4.5,y:Ni}]},Lr)}(dn=>{dr.update(wi=>[...wi.filter(Ni=>Ni.id!=="cursor-"+je),...dn])})(Gi)}else dr.update(Pt=>Pt.filter(ge=>ge.id!=="cursor-"+je));1&t.$$.dirty[0]|64&t.$$.dirty[1]|478150656&t.$$.dirty[3]&&i(45,it=N?((Pt,ge,yi,Gi,dn,wi)=>{if(Gi)return dn?"grabbing":"grab";if(Pt&&!ge)return"none";if(!ge)return wi==="move"?"default":"crosshair";let Ni=ge||yi;return xs(Ni)?$p(Ni)?qe==="modal"?"default":"text":wc(Ni)?"move":"default":"default"})(k,pr,S,se,!1,jt):"default"),264193&t.$$.dirty[0]|131072&t.$$.dirty[3]&&i(44,ut=jt==="preset"&&(Pe.length>0||Ht||Ce)),32&t.$$.dirty[1]&&(at=!Ae(dt,"x")&&!Ae(dt,"y")),262144&t.$$.dirty[4]&&i(43,G=oe*ko),131072&t.$$.dirty[3]|98304&t.$$.dirty[4]&&i(42,$t=mt&&Ce?Pt=>_c(()=>Ce(Pt,cr,{...nt},()=>eo.set({}))):Ki),524288&t.$$.dirty[3]&&i(41,vt=Object.keys(Vn).reduce((Pt,ge)=>(ge==="beforeAddShape"||Vn[ge]===void 0||(Pt[ge]=Vn[ge]),Pt),{})),8&t.$$.dirty[1]&&(Pt=>{zt&&H.update(ge=>ge.map(yi=>(yi._prerender=!!Pt&&$p(yi),yi)))})(Z),65536&t.$$.dirty[3]|98304&t.$$.dirty[4]&&i(29,lt=mt&&ti([],nt,()=>eo.set({}))),536871424&t.$$.dirty[0]&&i(40,kt=!!lt.length||!!Object.keys(Ne).some(Pt=>Mn.includes(Pt))),8&t.$$.dirty[1]|16384&t.$$.dirty[4]&&xt&&Ar.set(Z?0:20),8192&t.$$.dirty[4]&&i(39,J=q?`transform: translateY(${q}px)`:void 0)},Jr.set(!1),[jt,bi,Mi,Ci,Gt,H,$e,Le,qe,Ne,pt,Ht,ie,K,De,re,Bi,xe,Pe,je,Me,fe,Ti,Yi,En,bn,Ir,_i,to,lt,gt,s,r,c,Z,te,dt,se,ke,J,kt,vt,$t,G,ut,it,W,F,T,I,b,f,h,u,o,Ot,ze,Re,An,qr,ao,Ln,xr,Nn,So,Wi,On,Kr,$o,dr,cn,en,No,br,vr,lo,la,({index:B},ce)=>{i(26,Ir=B),i(0,jt=ur[B])},({value:B},ce)=>{i(0,jt=B),(Fe||/enter/i.test(ce.key))&&wr(B)},B=>{if(jt==="eraser")Ji=_i.eraseShape();else if(jt&&vn[jt]){const[ce,vi={}]=vn[jt],{drawMode:Ue}=T;m==="selection"&&Ue==="new"&&An.set([]);let Pt={};m==="selection"&&(gt("selectiondown",[...ve]),n&&(lr=ce.drawMode,Pt.drawMode="subtract")),Ji=_i.createShape({...ce,...D,...Pt},vi)}else Ji=void 0;return!!Ji&&(Ji.start(B),!0)},B=>!!Ji&&(Ji.update(B),!0),B=>!!Ji&&(Ji.release(B),!0),B=>!!Ji&&(Ji.cancel(B),Ji=void 0,!0),B=>{if(!Ji)return!1;if(Ji.end(B),Ji=void 0,m==="selection"){if(B.detail.isTap){const[Ue]=vn[jt];Ue.bitmap||An.set([])}gt("selectionup",[...ve])}const ce=_i.getMarkupItemDraft(),vi=Yt&&(Wt===!0||Array.isArray(Wt)&&Wt.includes(jt));return ce&&!ce.isEditing||!vi||i(0,jt="move"),!0},B=>{const{key:ce}=B,vi=_i.getMarkupItemDraft();/escape/i.test(ce)&&vi&&(B.preventDefault(),B.stopPropagation(),_i.discardMarkupItemDraft(),Ji=void 0),/enter/i.test(ce)&&vi&&(B.preventDefault(),B.stopPropagation(),Vr(vi),Ji=void 0)},function(B){Object.keys(B).forEach(ce=>{const{retain:vi=!0,share:Ue=!0}=M.settings&&M.settings[ce]||{};vi&&(ne&&Ue?i(115,Vi[ce]=B[ce],Vi):(Vi[jt]||i(115,Vi[jt]={},Vi),i(115,Vi[jt][ce]=B[ce],Vi)))}),gt("selectstyle",B),S&&(_i.updateMarkupShape(S,B),clearTimeout(co),co=setTimeout(()=>{Er()},200))},(B,ce,vi)=>{i(117,zn=ce),i(118,Sr=vi)},()=>{i(118,Sr=void 0),i(117,zn=void 0)},B=>{gt("markuptap",B)},B=>i(116,pr=B),()=>{Hn=!1},(B,ce)=>{if(Hn)return;const{beforeAddShape:vi=()=>!0}=Vn,Ue=Wn(ce),Pt=_i.getMarkupItemDraft(),ge=du(Jt,{x:Ue.x+(dt.x||0),y:Ue.y+(dt.y||0)});if(Pt&&!ge&&_i.discardMarkupItemDraft(),ge){if(!Pt){const yi=Dm(B,Jt),Gi=uo(yi,Ue);return vi(Gi)?(Zp(Gi),void _i.addShape(Gi)):(Hn=!0,void ce.preventDefault())}xo(Pt)&&(Ue.x-=.5*Pt.width,Ue.y-=.5*Pt.height),B.shape&&(Ae(B.shape,"x")&&(Ue.x=B.shape.x),Ae(B.shape,"y")&&(Ue.y=B.shape.y)),_i.updateMarkupShape(Pt,Ue)}},(B,ce)=>{if(Hn)return;const vi=Wn(ce);if(!du(Jt,{x:vi.x+(dt.x||0),y:vi.y+(dt.y||0)}))return void _i.discardMarkupItemDraft();const Ue=_i.confirmMarkupItemDraft();_i.selectShape(Ue),gt("addshape",Ue),$n.write()},B=>cr(B),B=>{return ce=B.detail.resources,vi=Wn(B.detail.event),ce.forEach(Ue=>cr(Ue,vi));var ce,vi},B=>{if(!Ke)return!0;const ce=rectClone(Tt);return rectScale(ce,1/U),rectTranslate(ce,Kt),rectScale(ce,te.scale),Ke(B,{...ce,x:ce.x+Dt.x,y:ce.y+Dt.y})},Er,eo,Mn,Ar,X,Zt,ae,Xt,Fe,Wt,Yt,Ut,ne,ti,Ce,Ke,Vn,vn,ur,Vi,pr,zn,Sr,S,k,N,n,m,D,M,tt,V,C,O,y,w,g,l,d,p,a,q,xt,nt,mt,zt,oe,Dt,ee,be,ve,fi,function(B){Wr.call(this,t,B)},B=>B[0]===jt,(B,ce,vi)=>{const Ue=B.filter(([,Pt])=>!Mn.includes(Pt));return xe?xe(Ue,ce,vi):Ue},B=>B[0]===Ir,B=>{Promise.resolve().then(()=>{gt("addshape",B),Er()})},B=>{gt("selectshape",B)},B=>{Promise.resolve().then(()=>{gt("blurshape",B)})},B=>{gt("tapshape",B)},B=>{gt("updateshape",B),Er()},B=>{gt("removeshape",B),Er()},function(B){zi[B?"unshift":"push"](()=>{_i=B,i(27,_i)})},function(B){zi[B?"unshift":"push"](()=>{to=B,i(28,to)})},B=>B.filter(([,ce])=>Mn.includes(ce)),function(B){Wr.call(this,t,B)}]}class Bu extends ci{constructor(e){super(),li(this,e,k6,S6,oi,{isActive:1,isActiveFraction:2,isVisible:3,stores:100,locale:4,shapes:5,toolbar:101,toolShapes:102,toolActive:0,toolSelectRadius:6,toolRetainStyles:103,toolbarLayout:7,textInputMode:8,shapeControls:9,enableButtonFlipVertical:10,enablePresetSelectImage:11,enablePresetDropImage:12,enableSelectToolToAddShape:104,enableAutoSelectMoveTool:105,enableTapToAddText:13,enableMoveTool:106,enableViewTool:107,enableToolShareStyles:108,gridSize:14,snapThreshold:15,enableSnapToContext:16,willRenderHeaderTools:109,willRenderPresetToolbar:110,willRenderShapeStyleControls:17,willStartInteraction:111,shapePresets:18,utilKey:19,mapScreenPointToImagePoint:20,mapImagePointToScreenPoint:21,imageRotation:22,imageFlipX:23,imageFlipY:24,parentRect:25,hooks:112},null,[-1,-1,-1,-1,-1,-1,-1])}get isActive(){return this.$$.ctx[1]}set isActive(e){this.$$set({isActive:e}),E()}get isActiveFraction(){return this.$$.ctx[2]}set isActiveFraction(e){this.$$set({isActiveFraction:e}),E()}get isVisible(){return this.$$.ctx[3]}set isVisible(e){this.$$set({isVisible:e}),E()}get stores(){return this.$$.ctx[100]}set stores(e){this.$$set({stores:e}),E()}get locale(){return this.$$.ctx[4]}set locale(e){this.$$set({locale:e}),E()}get shapes(){return this.$$.ctx[5]}set shapes(e){this.$$set({shapes:e}),E()}get toolbar(){return this.$$.ctx[101]}set toolbar(e){this.$$set({toolbar:e}),E()}get toolShapes(){return this.$$.ctx[102]}set toolShapes(e){this.$$set({toolShapes:e}),E()}get toolActive(){return this.$$.ctx[0]}set toolActive(e){this.$$set({toolActive:e}),E()}get toolSelectRadius(){return this.$$.ctx[6]}set toolSelectRadius(e){this.$$set({toolSelectRadius:e}),E()}get toolRetainStyles(){return this.$$.ctx[103]}set toolRetainStyles(e){this.$$set({toolRetainStyles:e}),E()}get toolbarLayout(){return this.$$.ctx[7]}set toolbarLayout(e){this.$$set({toolbarLayout:e}),E()}get textInputMode(){return this.$$.ctx[8]}set textInputMode(e){this.$$set({textInputMode:e}),E()}get shapeControls(){return this.$$.ctx[9]}set shapeControls(e){this.$$set({shapeControls:e}),E()}get enableButtonFlipVertical(){return this.$$.ctx[10]}set enableButtonFlipVertical(e){this.$$set({enableButtonFlipVertical:e}),E()}get enablePresetSelectImage(){return this.$$.ctx[11]}set enablePresetSelectImage(e){this.$$set({enablePresetSelectImage:e}),E()}get enablePresetDropImage(){return this.$$.ctx[12]}set enablePresetDropImage(e){this.$$set({enablePresetDropImage:e}),E()}get enableSelectToolToAddShape(){return this.$$.ctx[104]}set enableSelectToolToAddShape(e){this.$$set({enableSelectToolToAddShape:e}),E()}get enableAutoSelectMoveTool(){return this.$$.ctx[105]}set enableAutoSelectMoveTool(e){this.$$set({enableAutoSelectMoveTool:e}),E()}get enableTapToAddText(){return this.$$.ctx[13]}set enableTapToAddText(e){this.$$set({enableTapToAddText:e}),E()}get enableMoveTool(){return this.$$.ctx[106]}set enableMoveTool(e){this.$$set({enableMoveTool:e}),E()}get enableViewTool(){return this.$$.ctx[107]}set enableViewTool(e){this.$$set({enableViewTool:e}),E()}get enableToolShareStyles(){return this.$$.ctx[108]}set enableToolShareStyles(e){this.$$set({enableToolShareStyles:e}),E()}get gridSize(){return this.$$.ctx[14]}set gridSize(e){this.$$set({gridSize:e}),E()}get snapThreshold(){return this.$$.ctx[15]}set snapThreshold(e){this.$$set({snapThreshold:e}),E()}get enableSnapToContext(){return this.$$.ctx[16]}set enableSnapToContext(e){this.$$set({enableSnapToContext:e}),E()}get willRenderHeaderTools(){return this.$$.ctx[109]}set willRenderHeaderTools(e){this.$$set({willRenderHeaderTools:e}),E()}get willRenderPresetToolbar(){return this.$$.ctx[110]}set willRenderPresetToolbar(e){this.$$set({willRenderPresetToolbar:e}),E()}get willRenderShapeStyleControls(){return this.$$.ctx[17]}set willRenderShapeStyleControls(e){this.$$set({willRenderShapeStyleControls:e}),E()}get willStartInteraction(){return this.$$.ctx[111]}set willStartInteraction(e){this.$$set({willStartInteraction:e}),E()}get shapePresets(){return this.$$.ctx[18]}set shapePresets(e){this.$$set({shapePresets:e}),E()}get utilKey(){return this.$$.ctx[19]}set utilKey(e){this.$$set({utilKey:e}),E()}get mapScreenPointToImagePoint(){return this.$$.ctx[20]}set mapScreenPointToImagePoint(e){this.$$set({mapScreenPointToImagePoint:e}),E()}get mapImagePointToScreenPoint(){return this.$$.ctx[21]}set mapImagePointToScreenPoint(e){this.$$set({mapImagePointToScreenPoint:e}),E()}get imageRotation(){return this.$$.ctx[22]}set imageRotation(e){this.$$set({imageRotation:e}),E()}get imageFlipX(){return this.$$.ctx[23]}set imageFlipX(e){this.$$set({imageFlipX:e}),E()}get imageFlipY(){return this.$$.ctx[24]}set imageFlipY(e){this.$$set({imageFlipY:e}),E()}get parentRect(){return this.$$.ctx[25]}set parentRect(e){this.$$set({parentRect:e}),E()}get hooks(){return this.$$.ctx[112]}set hooks(e){this.$$set({hooks:e}),E()}}var n0=(t,e,i,n,r,o,a,s,l)=>{const c=Be(t),d=.5*i.width,u=.5*i.height,p=.5*e.width,h=.5*e.height,g=r.x+n.x,m=r.y+n.y;s&&(c.x=i.width-c.x),l&&(c.y=i.height-c.y);const f=Math.cos(o),b=Math.sin(o);c.x-=d,c.y-=u;const w=c.x*f-c.y*b,S=c.x*b+c.y*f;c.x=d+w,c.y=u+S,c.x*=a,c.y*=a,c.x+=p,c.y+=h,c.x+=g,c.y+=m,c.x-=d*a,c.y-=u*a;const C=(r.x-g)*a,I=(r.y-m)*a,M=C*f-I*b,D=C*b+I*f;return c.x+=M,c.y+=D,c},r0=(t,e,i,n,r,o,a,s,l)=>{const c=Be(t),d=Dl(i),u=Dl(e),p=ot(r.x+n.x,r.y+n.y),h=Math.cos(o),g=Math.sin(o);c.x-=u.x,c.y-=u.y;const m=(r.x-p.x)*a,f=(r.y-p.y)*a,b=m*h-f*g,w=m*g+f*h;c.x-=b,c.y-=w,c.x-=p.x,c.y-=p.y,c.x/=a,c.y/=a;const S=c.x*h+c.y*g,C=c.x*g-c.y*h;return c.x=S,c.y=-C,c.x+=d.x,c.y+=d.y,s&&(c.x=i.width-c.x),l&&(c.y=i.height-c.y),c},Vl=t=>typeof t=="boolean";function C6(t){let e,i,n;function r(a){t[59](a)}let o={utilKey:t[1],stores:t[5],locale:t[6],isActive:t[2],isActiveFraction:t[3],isVisible:t[4],mapScreenPointToImagePoint:t[45],mapImagePointToScreenPoint:t[44],imageRotation:t[46],imageFlipX:t[43],imageFlipY:t[42],shapes:t[48],toolbar:t[21]||t[7],toolShapes:t[22]||t[8],toolRetainStyles:t[9],enableSelectToolToAddShape:t[31],enableTapToAddText:t[32],enableViewTool:t[30],enableMoveTool:t[34],enableAutoSelectMoveTool:t[33],snapThreshold:t[16],gridSize:hi(t[18])?t[18]:t[15],enableSnapToContext:Vl(t[19])?t[19]:t[17],enableToolShareStyles:t[13],shapeControls:t[23]||t[10],shapePresets:t[27],enableButtonFlipVertical:t[24],parentRect:t[49],enablePresetDropImage:t[26],enablePresetSelectImage:t[25],toolSelectRadius:t[11],textInputMode:t[12],willStartInteraction:t[14],willRenderPresetToolbar:t[28]||t[20],willRenderShapeStyleControls:t[29],hooks:{willRenderShapeControls:t[35],willRenderShapeTextControls:t[36],beforeAddShape:t[37],beforeRemoveShape:t[38],beforeDeselectShape:t[39],beforeSelectShape:t[40],beforeUpdateShape:t[41]}};return t[0]!==void 0&&(o.toolActive=t[0]),e=new Bu({props:o}),zi.push(()=>mo(e,"toolActive",r)),e.$on("measure",t[60]),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};32&s[0]&&(l.stores=a[5]),64&s[0]&&(l.locale=a[6]),4&s[0]&&(l.isActive=a[2]),8&s[0]&&(l.isActiveFraction=a[3]),16&s[0]&&(l.isVisible=a[4]),16384&s[1]&&(l.mapScreenPointToImagePoint=a[45]),8192&s[1]&&(l.mapImagePointToScreenPoint=a[44]),32768&s[1]&&(l.imageRotation=a[46]),4096&s[1]&&(l.imageFlipX=a[43]),2048&s[1]&&(l.imageFlipY=a[42]),2097280&s[0]&&(l.toolbar=a[21]||a[7]),4194560&s[0]&&(l.toolShapes=a[22]||a[8]),512&s[0]&&(l.toolRetainStyles=a[9]),1&s[1]&&(l.enableSelectToolToAddShape=a[31]),2&s[1]&&(l.enableTapToAddText=a[32]),1073741824&s[0]&&(l.enableViewTool=a[30]),8&s[1]&&(l.enableMoveTool=a[34]),4&s[1]&&(l.enableAutoSelectMoveTool=a[33]),65536&s[0]&&(l.snapThreshold=a[16]),294912&s[0]&&(l.gridSize=hi(a[18])?a[18]:a[15]),655360&s[0]&&(l.enableSnapToContext=Vl(a[19])?a[19]:a[17]),8192&s[0]&&(l.enableToolShareStyles=a[13]),8389632&s[0]&&(l.shapeControls=a[23]||a[10]),134217728&s[0]&&(l.shapePresets=a[27]),16777216&s[0]&&(l.enableButtonFlipVertical=a[24]),67108864&s[0]&&(l.enablePresetDropImage=a[26]),33554432&s[0]&&(l.enablePresetSelectImage=a[25]),2048&s[0]&&(l.toolSelectRadius=a[11]),4096&s[0]&&(l.textInputMode=a[12]),16384&s[0]&&(l.willStartInteraction=a[14]),269484032&s[0]&&(l.willRenderPresetToolbar=a[28]||a[20]),536870912&s[0]&&(l.willRenderShapeStyleControls=a[29]),2032&s[1]&&(l.hooks={willRenderShapeControls:a[35],willRenderShapeTextControls:a[36],beforeAddShape:a[37],beforeRemoveShape:a[38],beforeDeselectShape:a[39],beforeSelectShape:a[40],beforeUpdateShape:a[41]}),!i&&1&s[0]&&(i=!0,l.toolActive=a[0],vo(()=>i=!1)),e.$set(l)},i(a){n||(P(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function T6(t,e,i){let n,r,o,a,s,l,c,d,u,{isActive:p}=e,{isActiveFraction:h}=e,{isVisible:g}=e,{stores:m}=e,{locale:f={}}=e,{markupEditorToolbar:b}=e,{markupEditorToolStyles:w}=e,{markupEditorToolRetainStyles:S}=e,{markupEditorShapeStyleControls:C}=e,{markupEditorToolSelectRadius:I}=e,{markupEditorTextInputMode:M}=e,{markupEditorToolShareStyles:D}=e,{markupEditorWillStartInteraction:T}=e,{markupEditorGridSize:F=0}=e,{markupEditorSnapThreshold:W=0}=e,{markupEditorSnapToContext:O=!1}=e,{annotateGridSize:y}=e,{annotateSnapToContext:V}=e,{willRenderShapePresetToolbar:tt}=e,{annotateTools:k}=e,{annotateToolShapes:N}=e,{annotateShapeControls:it}=e,{annotateActiveTool:ut}=e,{annotateEnableButtonFlipVertical:at=!1}=e,{annotateEnableSelectImagePreset:gt=!1}=e,{annotateEnableDropImagePreset:G=!0}=e,{annotatePresets:$t=[]}=e,{annotateWillRenderShapePresetToolbar:vt}=e,{annotateWillRenderShapeStyleControls:lt}=e,{enableViewTool:kt}=e,{enableSelectToolToAddShape:J}=e,{enableTapToAddText:q}=e,{enableAutoSelectMoveTool:Z}=e,{enableMoveTool:xt}=e,{willRenderShapeControls:nt}=e,{willRenderShapeTextControls:mt}=e,{beforeAddShape:zt}=e,{beforeRemoveShape:oe}=e,{beforeDeselectShape:Dt}=e,{beforeSelectShape:te}=e,{beforeUpdateShape:Kt}=e;const{rootRect:U,imageAnnotation:Tt,imageSize:dt,imageRotation:Jt,imageFlipX:se,imageFlipY:ee,imageTransforms:be,imageTransformsInterpolated:ve}=m;return A(t,U,_=>i(58,d=_)),A(t,dt,_=>i(57,c=_)),A(t,Jt,_=>i(46,u=_)),A(t,se,_=>i(43,a=_)),A(t,ee,_=>i(42,o=_)),A(t,be,_=>i(56,l=_)),A(t,ve,_=>i(55,s=_)),t.$$set=_=>{"isActive"in _&&i(2,p=_.isActive),"isActiveFraction"in _&&i(3,h=_.isActiveFraction),"isVisible"in _&&i(4,g=_.isVisible),"stores"in _&&i(5,m=_.stores),"locale"in _&&i(6,f=_.locale),"markupEditorToolbar"in _&&i(7,b=_.markupEditorToolbar),"markupEditorToolStyles"in _&&i(8,w=_.markupEditorToolStyles),"markupEditorToolRetainStyles"in _&&i(9,S=_.markupEditorToolRetainStyles),"markupEditorShapeStyleControls"in _&&i(10,C=_.markupEditorShapeStyleControls),"markupEditorToolSelectRadius"in _&&i(11,I=_.markupEditorToolSelectRadius),"markupEditorTextInputMode"in _&&i(12,M=_.markupEditorTextInputMode),"markupEditorToolShareStyles"in _&&i(13,D=_.markupEditorToolShareStyles),"markupEditorWillStartInteraction"in _&&i(14,T=_.markupEditorWillStartInteraction),"markupEditorGridSize"in _&&i(15,F=_.markupEditorGridSize),"markupEditorSnapThreshold"in _&&i(16,W=_.markupEditorSnapThreshold),"markupEditorSnapToContext"in _&&i(17,O=_.markupEditorSnapToContext),"annotateGridSize"in _&&i(18,y=_.annotateGridSize),"annotateSnapToContext"in _&&i(19,V=_.annotateSnapToContext),"willRenderShapePresetToolbar"in _&&i(20,tt=_.willRenderShapePresetToolbar),"annotateTools"in _&&i(21,k=_.annotateTools),"annotateToolShapes"in _&&i(22,N=_.annotateToolShapes),"annotateShapeControls"in _&&i(23,it=_.annotateShapeControls),"annotateActiveTool"in _&&i(0,ut=_.annotateActiveTool),"annotateEnableButtonFlipVertical"in _&&i(24,at=_.annotateEnableButtonFlipVertical),"annotateEnableSelectImagePreset"in _&&i(25,gt=_.annotateEnableSelectImagePreset),"annotateEnableDropImagePreset"in _&&i(26,G=_.annotateEnableDropImagePreset),"annotatePresets"in _&&i(27,$t=_.annotatePresets),"annotateWillRenderShapePresetToolbar"in _&&i(28,vt=_.annotateWillRenderShapePresetToolbar),"annotateWillRenderShapeStyleControls"in _&&i(29,lt=_.annotateWillRenderShapeStyleControls),"enableViewTool"in _&&i(30,kt=_.enableViewTool),"enableSelectToolToAddShape"in _&&i(31,J=_.enableSelectToolToAddShape),"enableTapToAddText"in _&&i(32,q=_.enableTapToAddText),"enableAutoSelectMoveTool"in _&&i(33,Z=_.enableAutoSelectMoveTool),"enableMoveTool"in _&&i(34,xt=_.enableMoveTool),"willRenderShapeControls"in _&&i(35,nt=_.willRenderShapeControls),"willRenderShapeTextControls"in _&&i(36,mt=_.willRenderShapeTextControls),"beforeAddShape"in _&&i(37,zt=_.beforeAddShape),"beforeRemoveShape"in _&&i(38,oe=_.beforeRemoveShape),"beforeDeselectShape"in _&&i(39,Dt=_.beforeDeselectShape),"beforeSelectShape"in _&&i(40,te=_.beforeSelectShape),"beforeUpdateShape"in _&&i(41,Kt=_.beforeUpdateShape)},t.$$.update=()=>{251664384&t.$$.dirty[1]&&i(45,n=_=>r0(_,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o)),251664384&t.$$.dirty[1]&&i(44,r=_=>n0(_,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o))},[ut,"annotate",p,h,g,m,f,b,w,S,C,I,M,D,T,F,W,O,y,V,tt,k,N,it,at,gt,G,$t,vt,lt,kt,J,q,Z,xt,nt,mt,zt,oe,Dt,te,Kt,o,a,r,n,u,U,Tt,dt,Jt,se,ee,be,ve,s,l,c,d,function(_){ut=_,i(0,ut)},function(_){Wr.call(this,t,_)}]}var M6={util:["annotate",class extends ci{constructor(t){super(),li(this,t,T6,C6,oi,{name:1,isActive:2,isActiveFraction:3,isVisible:4,stores:5,locale:6,markupEditorToolbar:7,markupEditorToolStyles:8,markupEditorToolRetainStyles:9,markupEditorShapeStyleControls:10,markupEditorToolSelectRadius:11,markupEditorTextInputMode:12,markupEditorToolShareStyles:13,markupEditorWillStartInteraction:14,markupEditorGridSize:15,markupEditorSnapThreshold:16,markupEditorSnapToContext:17,annotateGridSize:18,annotateSnapToContext:19,willRenderShapePresetToolbar:20,annotateTools:21,annotateToolShapes:22,annotateShapeControls:23,annotateActiveTool:0,annotateEnableButtonFlipVertical:24,annotateEnableSelectImagePreset:25,annotateEnableDropImagePreset:26,annotatePresets:27,annotateWillRenderShapePresetToolbar:28,annotateWillRenderShapeStyleControls:29,enableViewTool:30,enableSelectToolToAddShape:31,enableTapToAddText:32,enableAutoSelectMoveTool:33,enableMoveTool:34,willRenderShapeControls:35,willRenderShapeTextControls:36,beforeAddShape:37,beforeRemoveShape:38,beforeDeselectShape:39,beforeSelectShape:40,beforeUpdateShape:41},null,[-1,-1])}get name(){return this.$$.ctx[1]}get isActive(){return this.$$.ctx[2]}set isActive(t){this.$$set({isActive:t}),E()}get isActiveFraction(){return this.$$.ctx[3]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),E()}get isVisible(){return this.$$.ctx[4]}set isVisible(t){this.$$set({isVisible:t}),E()}get stores(){return this.$$.ctx[5]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[6]}set locale(t){this.$$set({locale:t}),E()}get markupEditorToolbar(){return this.$$.ctx[7]}set markupEditorToolbar(t){this.$$set({markupEditorToolbar:t}),E()}get markupEditorToolStyles(){return this.$$.ctx[8]}set markupEditorToolStyles(t){this.$$set({markupEditorToolStyles:t}),E()}get markupEditorToolRetainStyles(){return this.$$.ctx[9]}set markupEditorToolRetainStyles(t){this.$$set({markupEditorToolRetainStyles:t}),E()}get markupEditorShapeStyleControls(){return this.$$.ctx[10]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),E()}get markupEditorToolSelectRadius(){return this.$$.ctx[11]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),E()}get markupEditorTextInputMode(){return this.$$.ctx[12]}set markupEditorTextInputMode(t){this.$$set({markupEditorTextInputMode:t}),E()}get markupEditorToolShareStyles(){return this.$$.ctx[13]}set markupEditorToolShareStyles(t){this.$$set({markupEditorToolShareStyles:t}),E()}get markupEditorWillStartInteraction(){return this.$$.ctx[14]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),E()}get markupEditorGridSize(){return this.$$.ctx[15]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),E()}get markupEditorSnapThreshold(){return this.$$.ctx[16]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),E()}get markupEditorSnapToContext(){return this.$$.ctx[17]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),E()}get annotateGridSize(){return this.$$.ctx[18]}set annotateGridSize(t){this.$$set({annotateGridSize:t}),E()}get annotateSnapToContext(){return this.$$.ctx[19]}set annotateSnapToContext(t){this.$$set({annotateSnapToContext:t}),E()}get willRenderShapePresetToolbar(){return this.$$.ctx[20]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),E()}get annotateTools(){return this.$$.ctx[21]}set annotateTools(t){this.$$set({annotateTools:t}),E()}get annotateToolShapes(){return this.$$.ctx[22]}set annotateToolShapes(t){this.$$set({annotateToolShapes:t}),E()}get annotateShapeControls(){return this.$$.ctx[23]}set annotateShapeControls(t){this.$$set({annotateShapeControls:t}),E()}get annotateActiveTool(){return this.$$.ctx[0]}set annotateActiveTool(t){this.$$set({annotateActiveTool:t}),E()}get annotateEnableButtonFlipVertical(){return this.$$.ctx[24]}set annotateEnableButtonFlipVertical(t){this.$$set({annotateEnableButtonFlipVertical:t}),E()}get annotateEnableSelectImagePreset(){return this.$$.ctx[25]}set annotateEnableSelectImagePreset(t){this.$$set({annotateEnableSelectImagePreset:t}),E()}get annotateEnableDropImagePreset(){return this.$$.ctx[26]}set annotateEnableDropImagePreset(t){this.$$set({annotateEnableDropImagePreset:t}),E()}get annotatePresets(){return this.$$.ctx[27]}set annotatePresets(t){this.$$set({annotatePresets:t}),E()}get annotateWillRenderShapePresetToolbar(){return this.$$.ctx[28]}set annotateWillRenderShapePresetToolbar(t){this.$$set({annotateWillRenderShapePresetToolbar:t}),E()}get annotateWillRenderShapeStyleControls(){return this.$$.ctx[29]}set annotateWillRenderShapeStyleControls(t){this.$$set({annotateWillRenderShapeStyleControls:t}),E()}get enableViewTool(){return this.$$.ctx[30]}set enableViewTool(t){this.$$set({enableViewTool:t}),E()}get enableSelectToolToAddShape(){return this.$$.ctx[31]}set enableSelectToolToAddShape(t){this.$$set({enableSelectToolToAddShape:t}),E()}get enableTapToAddText(){return this.$$.ctx[32]}set enableTapToAddText(t){this.$$set({enableTapToAddText:t}),E()}get enableAutoSelectMoveTool(){return this.$$.ctx[33]}set enableAutoSelectMoveTool(t){this.$$set({enableAutoSelectMoveTool:t}),E()}get enableMoveTool(){return this.$$.ctx[34]}set enableMoveTool(t){this.$$set({enableMoveTool:t}),E()}get willRenderShapeControls(){return this.$$.ctx[35]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),E()}get willRenderShapeTextControls(){return this.$$.ctx[36]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),E()}get beforeAddShape(){return this.$$.ctx[37]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),E()}get beforeRemoveShape(){return this.$$.ctx[38]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),E()}get beforeDeselectShape(){return this.$$.ctx[39]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),E()}get beforeSelectShape(){return this.$$.ctx[40]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),E()}get beforeUpdateShape(){return this.$$.ctx[41]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),E()}}]};function P6(t){let e,i,n;function r(a){t[51](a)}let o={utilKey:t[1],stores:t[5],locale:t[6],isActive:t[2],isActiveFraction:t[3],isVisible:t[4],mapScreenPointToImagePoint:t[43],mapImagePointToScreenPoint:t[42],shapes:t[45],toolbar:t[20]||t[7],toolShapes:t[21]||t[8],toolRetainStyles:t[9],shapeControls:t[22]||t[10],shapePresets:t[26],enableSelectToolToAddShape:t[29],enableTapToAddText:t[30],enableViewTool:t[31],enableMoveTool:t[32],enableAutoSelectMoveTool:t[33],snapThreshold:t[16],gridSize:hi(t[18])?t[18]:t[15],enableSnapToContext:Vl(t[19])?t[19]:t[17],enableToolShareStyles:t[13],enablePresetSelectImage:t[24],enablePresetDropImage:t[25],enableButtonFlipVertical:t[23],parentRect:t[44],toolSelectRadius:t[11],textInputMode:t[12],willStartInteraction:t[41],willRenderPresetToolbar:t[27]||t[14],willRenderShapeStyleControls:t[28],hooks:{willRenderShapeControls:t[34],willRenderShapeTextControls:t[35],beforeAddShape:t[36],beforeRemoveShape:t[37],beforeDeselectShape:t[38],beforeSelectShape:t[39],beforeUpdateShape:t[40]}};return t[0]!==void 0&&(o.toolActive=t[0]),e=new Bu({props:o}),zi.push(()=>mo(e,"toolActive",r)),e.$on("measure",t[52]),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};32&s[0]&&(l.stores=a[5]),64&s[0]&&(l.locale=a[6]),4&s[0]&&(l.isActive=a[2]),8&s[0]&&(l.isActiveFraction=a[3]),16&s[0]&&(l.isVisible=a[4]),4096&s[1]&&(l.mapScreenPointToImagePoint=a[43]),2048&s[1]&&(l.mapImagePointToScreenPoint=a[42]),1048704&s[0]&&(l.toolbar=a[20]||a[7]),2097408&s[0]&&(l.toolShapes=a[21]||a[8]),512&s[0]&&(l.toolRetainStyles=a[9]),4195328&s[0]&&(l.shapeControls=a[22]||a[10]),67108864&s[0]&&(l.shapePresets=a[26]),536870912&s[0]&&(l.enableSelectToolToAddShape=a[29]),1073741824&s[0]&&(l.enableTapToAddText=a[30]),1&s[1]&&(l.enableViewTool=a[31]),2&s[1]&&(l.enableMoveTool=a[32]),4&s[1]&&(l.enableAutoSelectMoveTool=a[33]),65536&s[0]&&(l.snapThreshold=a[16]),294912&s[0]&&(l.gridSize=hi(a[18])?a[18]:a[15]),655360&s[0]&&(l.enableSnapToContext=Vl(a[19])?a[19]:a[17]),8192&s[0]&&(l.enableToolShareStyles=a[13]),16777216&s[0]&&(l.enablePresetSelectImage=a[24]),33554432&s[0]&&(l.enablePresetDropImage=a[25]),8388608&s[0]&&(l.enableButtonFlipVertical=a[23]),2048&s[0]&&(l.toolSelectRadius=a[11]),4096&s[0]&&(l.textInputMode=a[12]),1024&s[1]&&(l.willStartInteraction=a[41]),134234112&s[0]&&(l.willRenderPresetToolbar=a[27]||a[14]),268435456&s[0]&&(l.willRenderShapeStyleControls=a[28]),1016&s[1]&&(l.hooks={willRenderShapeControls:a[34],willRenderShapeTextControls:a[35],beforeAddShape:a[36],beforeRemoveShape:a[37],beforeDeselectShape:a[38],beforeSelectShape:a[39],beforeUpdateShape:a[40]}),!i&&1&s[0]&&(i=!0,l.toolActive=a[0],vo(()=>i=!1)),e.$set(l)},i(a){n||(P(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function R6(t,e,i){let n,r,o,a,s,{isActive:l}=e,{isActiveFraction:c}=e,{isVisible:d}=e,{stores:u}=e,{locale:p={}}=e,{markupEditorToolbar:h}=e,{markupEditorToolStyles:g}=e,{markupEditorToolRetainStyles:m}=e,{markupEditorShapeStyleControls:f}=e,{markupEditorToolSelectRadius:b}=e,{markupEditorTextInputMode:w}=e,{markupEditorToolShareStyles:S}=e,{willRenderShapePresetToolbar:C}=e,{markupEditorGridSize:I}=e,{markupEditorSnapThreshold:M}=e,{markupEditorSnapToContext:D=!0}=e,{decorateGridSize:T}=e,{decorateSnapToContext:F}=e,{decorateTools:W}=e,{decorateToolShapes:O}=e,{decorateShapeControls:y}=e,{decorateActiveTool:V}=e,{decorateEnableButtonFlipVertical:tt=!1}=e,{decorateEnableSelectImagePreset:k=!1}=e,{decorateEnableDropImagePreset:N=!0}=e,{decoratePresets:it=[]}=e,{decorateWillRenderShapePresetToolbar:ut}=e,{decorateWillRenderShapeStyleControls:at}=e,{enableSelectToolToAddShape:gt}=e,{enableTapToAddText:G}=e,{enableViewTool:$t}=e,{enableMoveTool:vt}=e,{enableAutoSelectMoveTool:lt}=e,{willRenderShapeControls:kt}=e,{willRenderShapeTextControls:J}=e,{beforeAddShape:q}=e,{beforeRemoveShape:Z}=e,{beforeDeselectShape:xt}=e,{beforeSelectShape:nt}=e,{beforeUpdateShape:mt}=e,{markupEditorWillStartInteraction:zt}=e;const{imageCropRect:oe,imageDecoration:Dt,imageSelectionRectPresentation:te,imageTransformsInterpolated:Kt}=u;return A(t,te,U=>i(49,a=U)),A(t,Kt,U=>i(50,s=U)),t.$$set=U=>{"isActive"in U&&i(2,l=U.isActive),"isActiveFraction"in U&&i(3,c=U.isActiveFraction),"isVisible"in U&&i(4,d=U.isVisible),"stores"in U&&i(5,u=U.stores),"locale"in U&&i(6,p=U.locale),"markupEditorToolbar"in U&&i(7,h=U.markupEditorToolbar),"markupEditorToolStyles"in U&&i(8,g=U.markupEditorToolStyles),"markupEditorToolRetainStyles"in U&&i(9,m=U.markupEditorToolRetainStyles),"markupEditorShapeStyleControls"in U&&i(10,f=U.markupEditorShapeStyleControls),"markupEditorToolSelectRadius"in U&&i(11,b=U.markupEditorToolSelectRadius),"markupEditorTextInputMode"in U&&i(12,w=U.markupEditorTextInputMode),"markupEditorToolShareStyles"in U&&i(13,S=U.markupEditorToolShareStyles),"willRenderShapePresetToolbar"in U&&i(14,C=U.willRenderShapePresetToolbar),"markupEditorGridSize"in U&&i(15,I=U.markupEditorGridSize),"markupEditorSnapThreshold"in U&&i(16,M=U.markupEditorSnapThreshold),"markupEditorSnapToContext"in U&&i(17,D=U.markupEditorSnapToContext),"decorateGridSize"in U&&i(18,T=U.decorateGridSize),"decorateSnapToContext"in U&&i(19,F=U.decorateSnapToContext),"decorateTools"in U&&i(20,W=U.decorateTools),"decorateToolShapes"in U&&i(21,O=U.decorateToolShapes),"decorateShapeControls"in U&&i(22,y=U.decorateShapeControls),"decorateActiveTool"in U&&i(0,V=U.decorateActiveTool),"decorateEnableButtonFlipVertical"in U&&i(23,tt=U.decorateEnableButtonFlipVertical),"decorateEnableSelectImagePreset"in U&&i(24,k=U.decorateEnableSelectImagePreset),"decorateEnableDropImagePreset"in U&&i(25,N=U.decorateEnableDropImagePreset),"decoratePresets"in U&&i(26,it=U.decoratePresets),"decorateWillRenderShapePresetToolbar"in U&&i(27,ut=U.decorateWillRenderShapePresetToolbar),"decorateWillRenderShapeStyleControls"in U&&i(28,at=U.decorateWillRenderShapeStyleControls),"enableSelectToolToAddShape"in U&&i(29,gt=U.enableSelectToolToAddShape),"enableTapToAddText"in U&&i(30,G=U.enableTapToAddText),"enableViewTool"in U&&i(31,$t=U.enableViewTool),"enableMoveTool"in U&&i(32,vt=U.enableMoveTool),"enableAutoSelectMoveTool"in U&&i(33,lt=U.enableAutoSelectMoveTool),"willRenderShapeControls"in U&&i(34,kt=U.willRenderShapeControls),"willRenderShapeTextControls"in U&&i(35,J=U.willRenderShapeTextControls),"beforeAddShape"in U&&i(36,q=U.beforeAddShape),"beforeRemoveShape"in U&&i(37,Z=U.beforeRemoveShape),"beforeDeselectShape"in U&&i(38,xt=U.beforeDeselectShape),"beforeSelectShape"in U&&i(39,nt=U.beforeSelectShape),"beforeUpdateShape"in U&&i(40,mt=U.beforeUpdateShape),"markupEditorWillStartInteraction"in U&&i(41,zt=U.markupEditorWillStartInteraction)},t.$$.update=()=>{524288&t.$$.dirty[1]&&i(48,n=s?s.scale:1),393216&t.$$.dirty[1]&&i(43,r=U=>{const Tt=Be(U);return Tt.x-=a.x,Tt.y-=a.y,Tt.x/=n,Tt.y/=n,Tt}),393216&t.$$.dirty[1]&&i(42,o=U=>{const Tt=Be(U);return Tt.x*=n,Tt.y*=n,Tt.x+=a.x,Tt.y+=a.y,Tt})},[V,"decorate",l,c,d,u,p,h,g,m,f,b,w,S,C,I,M,D,T,F,W,O,y,tt,k,N,it,ut,at,gt,G,$t,vt,lt,kt,J,q,Z,xt,nt,mt,zt,o,r,oe,Dt,te,Kt,n,a,s,function(U){V=U,i(0,V)},function(U){Wr.call(this,t,U)}]}var I6={util:["decorate",class extends ci{constructor(t){super(),li(this,t,R6,P6,oi,{name:1,isActive:2,isActiveFraction:3,isVisible:4,stores:5,locale:6,markupEditorToolbar:7,markupEditorToolStyles:8,markupEditorToolRetainStyles:9,markupEditorShapeStyleControls:10,markupEditorToolSelectRadius:11,markupEditorTextInputMode:12,markupEditorToolShareStyles:13,willRenderShapePresetToolbar:14,markupEditorGridSize:15,markupEditorSnapThreshold:16,markupEditorSnapToContext:17,decorateGridSize:18,decorateSnapToContext:19,decorateTools:20,decorateToolShapes:21,decorateShapeControls:22,decorateActiveTool:0,decorateEnableButtonFlipVertical:23,decorateEnableSelectImagePreset:24,decorateEnableDropImagePreset:25,decoratePresets:26,decorateWillRenderShapePresetToolbar:27,decorateWillRenderShapeStyleControls:28,enableSelectToolToAddShape:29,enableTapToAddText:30,enableViewTool:31,enableMoveTool:32,enableAutoSelectMoveTool:33,willRenderShapeControls:34,willRenderShapeTextControls:35,beforeAddShape:36,beforeRemoveShape:37,beforeDeselectShape:38,beforeSelectShape:39,beforeUpdateShape:40,markupEditorWillStartInteraction:41},null,[-1,-1])}get name(){return this.$$.ctx[1]}get isActive(){return this.$$.ctx[2]}set isActive(t){this.$$set({isActive:t}),E()}get isActiveFraction(){return this.$$.ctx[3]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),E()}get isVisible(){return this.$$.ctx[4]}set isVisible(t){this.$$set({isVisible:t}),E()}get stores(){return this.$$.ctx[5]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[6]}set locale(t){this.$$set({locale:t}),E()}get markupEditorToolbar(){return this.$$.ctx[7]}set markupEditorToolbar(t){this.$$set({markupEditorToolbar:t}),E()}get markupEditorToolStyles(){return this.$$.ctx[8]}set markupEditorToolStyles(t){this.$$set({markupEditorToolStyles:t}),E()}get markupEditorToolRetainStyles(){return this.$$.ctx[9]}set markupEditorToolRetainStyles(t){this.$$set({markupEditorToolRetainStyles:t}),E()}get markupEditorShapeStyleControls(){return this.$$.ctx[10]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),E()}get markupEditorToolSelectRadius(){return this.$$.ctx[11]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),E()}get markupEditorTextInputMode(){return this.$$.ctx[12]}set markupEditorTextInputMode(t){this.$$set({markupEditorTextInputMode:t}),E()}get markupEditorToolShareStyles(){return this.$$.ctx[13]}set markupEditorToolShareStyles(t){this.$$set({markupEditorToolShareStyles:t}),E()}get willRenderShapePresetToolbar(){return this.$$.ctx[14]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),E()}get markupEditorGridSize(){return this.$$.ctx[15]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),E()}get markupEditorSnapThreshold(){return this.$$.ctx[16]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),E()}get markupEditorSnapToContext(){return this.$$.ctx[17]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),E()}get decorateGridSize(){return this.$$.ctx[18]}set decorateGridSize(t){this.$$set({decorateGridSize:t}),E()}get decorateSnapToContext(){return this.$$.ctx[19]}set decorateSnapToContext(t){this.$$set({decorateSnapToContext:t}),E()}get decorateTools(){return this.$$.ctx[20]}set decorateTools(t){this.$$set({decorateTools:t}),E()}get decorateToolShapes(){return this.$$.ctx[21]}set decorateToolShapes(t){this.$$set({decorateToolShapes:t}),E()}get decorateShapeControls(){return this.$$.ctx[22]}set decorateShapeControls(t){this.$$set({decorateShapeControls:t}),E()}get decorateActiveTool(){return this.$$.ctx[0]}set decorateActiveTool(t){this.$$set({decorateActiveTool:t}),E()}get decorateEnableButtonFlipVertical(){return this.$$.ctx[23]}set decorateEnableButtonFlipVertical(t){this.$$set({decorateEnableButtonFlipVertical:t}),E()}get decorateEnableSelectImagePreset(){return this.$$.ctx[24]}set decorateEnableSelectImagePreset(t){this.$$set({decorateEnableSelectImagePreset:t}),E()}get decorateEnableDropImagePreset(){return this.$$.ctx[25]}set decorateEnableDropImagePreset(t){this.$$set({decorateEnableDropImagePreset:t}),E()}get decoratePresets(){return this.$$.ctx[26]}set decoratePresets(t){this.$$set({decoratePresets:t}),E()}get decorateWillRenderShapePresetToolbar(){return this.$$.ctx[27]}set decorateWillRenderShapePresetToolbar(t){this.$$set({decorateWillRenderShapePresetToolbar:t}),E()}get decorateWillRenderShapeStyleControls(){return this.$$.ctx[28]}set decorateWillRenderShapeStyleControls(t){this.$$set({decorateWillRenderShapeStyleControls:t}),E()}get enableSelectToolToAddShape(){return this.$$.ctx[29]}set enableSelectToolToAddShape(t){this.$$set({enableSelectToolToAddShape:t}),E()}get enableTapToAddText(){return this.$$.ctx[30]}set enableTapToAddText(t){this.$$set({enableTapToAddText:t}),E()}get enableViewTool(){return this.$$.ctx[31]}set enableViewTool(t){this.$$set({enableViewTool:t}),E()}get enableMoveTool(){return this.$$.ctx[32]}set enableMoveTool(t){this.$$set({enableMoveTool:t}),E()}get enableAutoSelectMoveTool(){return this.$$.ctx[33]}set enableAutoSelectMoveTool(t){this.$$set({enableAutoSelectMoveTool:t}),E()}get willRenderShapeControls(){return this.$$.ctx[34]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),E()}get willRenderShapeTextControls(){return this.$$.ctx[35]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),E()}get beforeAddShape(){return this.$$.ctx[36]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),E()}get beforeRemoveShape(){return this.$$.ctx[37]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),E()}get beforeDeselectShape(){return this.$$.ctx[38]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),E()}get beforeSelectShape(){return this.$$.ctx[39]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),E()}get beforeUpdateShape(){return this.$$.ctx[40]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),E()}get markupEditorWillStartInteraction(){return this.$$.ctx[41]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),E()}}]};function E6(t){let e,i;return e=new Bu({props:{stores:t[3],locale:t[4],isActive:t[0],isActiveFraction:t[1],isVisible:t[2],mapScreenPointToImagePoint:t[25],mapImagePointToScreenPoint:t[24],utilKey:"sticker",shapePresets:t[5],shapes:t[6]?t[34]:t[35],toolActive:"preset",imageFlipX:!!t[6]&&t[23],imageFlipY:!!t[6]&&t[22],imageRotation:t[6]?t[30]:0,parentRect:t[6]?t[36]:t[32],snapThreshold:t[28],gridSize:t[27],enableSnapToContext:t[26],enablePresetDropImage:t[7],enablePresetSelectImage:t[29],enableButtonFlipVertical:t[10]||t[8],toolSelectRadius:t[14],willStartInteraction:t[21],willRenderPresetToolbar:t[11]||t[9]||t[15],hooks:{willRenderShapeControls:t[12],willRenderShapeTextControls:t[13],beforeAddShape:t[16],beforeRemoveShape:t[17],beforeDeselectShape:t[18],beforeSelectShape:t[19],beforeUpdateShape:t[20]}}}),e.$on("measure",t[59]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8&r[0]&&(o.stores=n[3]),16&r[0]&&(o.locale=n[4]),1&r[0]&&(o.isActive=n[0]),2&r[0]&&(o.isActiveFraction=n[1]),4&r[0]&&(o.isVisible=n[2]),33554432&r[0]&&(o.mapScreenPointToImagePoint=n[25]),16777216&r[0]&&(o.mapImagePointToScreenPoint=n[24]),32&r[0]&&(o.shapePresets=n[5]),64&r[0]&&(o.shapes=n[6]?n[34]:n[35]),8388672&r[0]&&(o.imageFlipX=!!n[6]&&n[23]),4194368&r[0]&&(o.imageFlipY=!!n[6]&&n[22]),1073741888&r[0]&&(o.imageRotation=n[6]?n[30]:0),64&r[0]&&(o.parentRect=n[6]?n[36]:n[32]),268435456&r[0]&&(o.snapThreshold=n[28]),134217728&r[0]&&(o.gridSize=n[27]),67108864&r[0]&&(o.enableSnapToContext=n[26]),128&r[0]&&(o.enablePresetDropImage=n[7]),536870912&r[0]&&(o.enablePresetSelectImage=n[29]),1280&r[0]&&(o.enableButtonFlipVertical=n[10]||n[8]),16384&r[0]&&(o.toolSelectRadius=n[14]),2097152&r[0]&&(o.willStartInteraction=n[21]),35328&r[0]&&(o.willRenderPresetToolbar=n[11]||n[9]||n[15]),2043904&r[0]&&(o.hooks={willRenderShapeControls:n[12],willRenderShapeTextControls:n[13],beforeAddShape:n[16],beforeRemoveShape:n[17],beforeDeselectShape:n[18],beforeSelectShape:n[19],beforeUpdateShape:n[20]}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function A6(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,{isActive:w}=e,{isActiveFraction:S}=e,{isVisible:C}=e,{stores:I}=e,{locale:M={}}=e,{stickers:D=[]}=e,{stickerForceEnable:T=!1}=e,{stickerStickToImage:F=!1}=e,{stickerEnableSelectImagePreset:W=!0}=e,{stickerEnableDropImagePreset:O=!0}=e,{stickerEnableButtonFlipVertical:y=!1}=e,{stickerWillRenderShapePresetToolbar:V}=e,{stickerEnableSelectImage:tt=!0}=e,{stickersEnableButtonFlipVertical:k=!1}=e,{stickersWillRenderShapePresetToolbar:N}=e,{markupEditorGridSize:it=0}=e,{markupEditorSnapThreshold:ut=0}=e,{markupEditorSnapToContext:at=!1}=e,{annotateGridSize:gt}=e,{annotateSnapToContext:G}=e,{decorateGridSize:$t}=e,{decorateSnapToContext:vt}=e,{willRenderShapeControls:lt}=e,{willRenderShapeTextControls:kt}=e,{markupEditorToolSelectRadius:J}=e,{willRenderShapePresetToolbar:q}=e,{beforeAddShape:Z}=e,{beforeRemoveShape:xt}=e,{beforeDeselectShape:nt}=e,{beforeSelectShape:mt}=e,{beforeUpdateShape:zt}=e,{markupEditorWillStartInteraction:oe}=e;const{rootRect:Dt,imageCropRect:te,imageSelectionRectPresentation:Kt,imageAnnotation:U,imageDecoration:Tt,imageSize:dt,imageTransforms:Jt,imageTransformsInterpolated:se,imageRotation:ee,imageFlipX:be,imageFlipY:ve}=I;return A(t,Dt,_=>i(58,f=_)),A(t,Kt,_=>i(54,d=_)),A(t,dt,_=>i(57,m=_)),A(t,Jt,_=>i(56,g=_)),A(t,se,_=>i(55,h=_)),A(t,ee,_=>i(30,b=_)),A(t,be,_=>i(23,p=_)),A(t,ve,_=>i(22,u=_)),t.$$set=_=>{"isActive"in _&&i(0,w=_.isActive),"isActiveFraction"in _&&i(1,S=_.isActiveFraction),"isVisible"in _&&i(2,C=_.isVisible),"stores"in _&&i(3,I=_.stores),"locale"in _&&i(4,M=_.locale),"stickers"in _&&i(5,D=_.stickers),"stickerForceEnable"in _&&i(43,T=_.stickerForceEnable),"stickerStickToImage"in _&&i(6,F=_.stickerStickToImage),"stickerEnableSelectImagePreset"in _&&i(44,W=_.stickerEnableSelectImagePreset),"stickerEnableDropImagePreset"in _&&i(7,O=_.stickerEnableDropImagePreset),"stickerEnableButtonFlipVertical"in _&&i(8,y=_.stickerEnableButtonFlipVertical),"stickerWillRenderShapePresetToolbar"in _&&i(9,V=_.stickerWillRenderShapePresetToolbar),"stickerEnableSelectImage"in _&&i(45,tt=_.stickerEnableSelectImage),"stickersEnableButtonFlipVertical"in _&&i(10,k=_.stickersEnableButtonFlipVertical),"stickersWillRenderShapePresetToolbar"in _&&i(11,N=_.stickersWillRenderShapePresetToolbar),"markupEditorGridSize"in _&&i(46,it=_.markupEditorGridSize),"markupEditorSnapThreshold"in _&&i(47,ut=_.markupEditorSnapThreshold),"markupEditorSnapToContext"in _&&i(48,at=_.markupEditorSnapToContext),"annotateGridSize"in _&&i(49,gt=_.annotateGridSize),"annotateSnapToContext"in _&&i(50,G=_.annotateSnapToContext),"decorateGridSize"in _&&i(51,$t=_.decorateGridSize),"decorateSnapToContext"in _&&i(52,vt=_.decorateSnapToContext),"willRenderShapeControls"in _&&i(12,lt=_.willRenderShapeControls),"willRenderShapeTextControls"in _&&i(13,kt=_.willRenderShapeTextControls),"markupEditorToolSelectRadius"in _&&i(14,J=_.markupEditorToolSelectRadius),"willRenderShapePresetToolbar"in _&&i(15,q=_.willRenderShapePresetToolbar),"beforeAddShape"in _&&i(16,Z=_.beforeAddShape),"beforeRemoveShape"in _&&i(17,xt=_.beforeRemoveShape),"beforeDeselectShape"in _&&i(18,nt=_.beforeDeselectShape),"beforeSelectShape"in _&&i(19,mt=_.beforeSelectShape),"beforeUpdateShape"in _&&i(20,zt=_.beforeUpdateShape),"markupEditorWillStartInteraction"in _&&i(21,oe=_.markupEditorWillStartInteraction)},t.$$.update=()=>{16777216&t.$$.dirty[1]&&i(53,n=h?h.scale:1),24576&t.$$.dirty[1]&&i(29,r=W!==!1&&tt),65536&t.$$.dirty[1]&&i(28,o=ut),64&t.$$.dirty[0]|1343488&t.$$.dirty[1]&&i(27,a=F?hi(gt)?gt:it:hi($t)?$t:it),64&t.$$.dirty[0]|2752512&t.$$.dirty[1]&&i(26,s=F?Vl(G)?G:at:Vl(vt)?vt:at),12582976&t.$$.dirty[0]|264241152&t.$$.dirty[1]&&i(25,l=F?_=>r0(_,f,m,h.origin,h.translation,g.rotation.z,h.scale,p,u):_=>{const ke=Be(_);return ke.x-=d.x,ke.y-=d.y,ke.x/=n,ke.y/=n,ke}),12582976&t.$$.dirty[0]|264241152&t.$$.dirty[1]&&i(24,c=F?_=>n0(_,f,m,h.origin,h.translation,g.rotation.z,h.scale,p,u):_=>{const ke=Be(_);return ke.x*=n,ke.y*=n,ke.x+=d.x,ke.y+=d.y,ke})},[w,S,C,I,M,D,F,O,y,V,k,N,lt,kt,J,q,Z,xt,nt,mt,zt,oe,u,p,c,l,s,a,o,r,b,Dt,te,Kt,U,Tt,dt,Jt,se,ee,be,ve,"sticker",T,W,tt,it,ut,at,gt,G,$t,vt,n,d,h,g,m,f,function(_){Wr.call(this,t,_)}]}var L6={util:["sticker",class extends ci{constructor(t){super(),li(this,t,A6,E6,oi,{name:42,isActive:0,isActiveFraction:1,isVisible:2,stores:3,locale:4,stickers:5,stickerForceEnable:43,stickerStickToImage:6,stickerEnableSelectImagePreset:44,stickerEnableDropImagePreset:7,stickerEnableButtonFlipVertical:8,stickerWillRenderShapePresetToolbar:9,stickerEnableSelectImage:45,stickersEnableButtonFlipVertical:10,stickersWillRenderShapePresetToolbar:11,markupEditorGridSize:46,markupEditorSnapThreshold:47,markupEditorSnapToContext:48,annotateGridSize:49,annotateSnapToContext:50,decorateGridSize:51,decorateSnapToContext:52,willRenderShapeControls:12,willRenderShapeTextControls:13,markupEditorToolSelectRadius:14,willRenderShapePresetToolbar:15,beforeAddShape:16,beforeRemoveShape:17,beforeDeselectShape:18,beforeSelectShape:19,beforeUpdateShape:20,markupEditorWillStartInteraction:21},null,[-1,-1])}get name(){return this.$$.ctx[42]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),E()}get isVisible(){return this.$$.ctx[2]}set isVisible(t){this.$$set({isVisible:t}),E()}get stores(){return this.$$.ctx[3]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),E()}get stickers(){return this.$$.ctx[5]}set stickers(t){this.$$set({stickers:t}),E()}get stickerForceEnable(){return this.$$.ctx[43]}set stickerForceEnable(t){this.$$set({stickerForceEnable:t}),E()}get stickerStickToImage(){return this.$$.ctx[6]}set stickerStickToImage(t){this.$$set({stickerStickToImage:t}),E()}get stickerEnableSelectImagePreset(){return this.$$.ctx[44]}set stickerEnableSelectImagePreset(t){this.$$set({stickerEnableSelectImagePreset:t}),E()}get stickerEnableDropImagePreset(){return this.$$.ctx[7]}set stickerEnableDropImagePreset(t){this.$$set({stickerEnableDropImagePreset:t}),E()}get stickerEnableButtonFlipVertical(){return this.$$.ctx[8]}set stickerEnableButtonFlipVertical(t){this.$$set({stickerEnableButtonFlipVertical:t}),E()}get stickerWillRenderShapePresetToolbar(){return this.$$.ctx[9]}set stickerWillRenderShapePresetToolbar(t){this.$$set({stickerWillRenderShapePresetToolbar:t}),E()}get stickerEnableSelectImage(){return this.$$.ctx[45]}set stickerEnableSelectImage(t){this.$$set({stickerEnableSelectImage:t}),E()}get stickersEnableButtonFlipVertical(){return this.$$.ctx[10]}set stickersEnableButtonFlipVertical(t){this.$$set({stickersEnableButtonFlipVertical:t}),E()}get stickersWillRenderShapePresetToolbar(){return this.$$.ctx[11]}set stickersWillRenderShapePresetToolbar(t){this.$$set({stickersWillRenderShapePresetToolbar:t}),E()}get markupEditorGridSize(){return this.$$.ctx[46]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),E()}get markupEditorSnapThreshold(){return this.$$.ctx[47]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),E()}get markupEditorSnapToContext(){return this.$$.ctx[48]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),E()}get annotateGridSize(){return this.$$.ctx[49]}set annotateGridSize(t){this.$$set({annotateGridSize:t}),E()}get annotateSnapToContext(){return this.$$.ctx[50]}set annotateSnapToContext(t){this.$$set({annotateSnapToContext:t}),E()}get decorateGridSize(){return this.$$.ctx[51]}set decorateGridSize(t){this.$$set({decorateGridSize:t}),E()}get decorateSnapToContext(){return this.$$.ctx[52]}set decorateSnapToContext(t){this.$$set({decorateSnapToContext:t}),E()}get willRenderShapeControls(){return this.$$.ctx[12]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),E()}get willRenderShapeTextControls(){return this.$$.ctx[13]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),E()}get markupEditorToolSelectRadius(){return this.$$.ctx[14]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),E()}get willRenderShapePresetToolbar(){return this.$$.ctx[15]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),E()}get beforeAddShape(){return this.$$.ctx[16]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),E()}get beforeRemoveShape(){return this.$$.ctx[17]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),E()}get beforeDeselectShape(){return this.$$.ctx[18]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),E()}get beforeSelectShape(){return this.$$.ctx[19]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),E()}get beforeUpdateShape(){return this.$$.ctx[20]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),E()}get markupEditorWillStartInteraction(){return this.$$.ctx[21]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),E()}},({stickers:t,stickerEnableSelectImage:e,stickerEnableSelectImagePreset:i,stickerEnableDropImagePreset:n,stickerForceEnable:r})=>t&&t.length||e||i||n||r]};function z6(t){let e,i,n,r,o,a=(t[14](t[34].value)||"")+"",s=(on(t[34].label)?t[34].label(t[1]):t[34].label)+"";return{c(){e=ht("div"),i=new Pu(!1),n=pe(),r=ht("span"),o=mn(s),i.a=n,v(e,"slot","option")},m(l,c){et(l,e,c),i.m(a,e),Ct(e,n),Ct(e,r),Ct(r,o)},p(l,c){8&c[1]&&a!==(a=(l[14](l[34].value)||"")+"")&&i.p(a),2&c[0]|8&c[1]&&s!==(s=(on(l[34].label)?l[34].label(l[1]):l[34].label)+"")&&In(o,s)},d(l){l&&Q(e)}}}function F6(t){let e,i;return e=new as({props:{locale:t[1],class:"PinturaControlList",layout:"row",options:t[2],selectedIndex:t[6],onchange:t[12],$$slots:{option:[z6,({option:n})=>({34:n}),({option:n})=>[0,n?8:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};2&r[0]&&(o.locale=n[1]),4&r[0]&&(o.options=n[2]),64&r[0]&&(o.selectedIndex=n[6]),2&r[0]|24&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function D6(t){let e,i,n,r,o;return i=new Du({props:{locale:t[1],class:"PinturaControlPanels",shape:t[4],onchange:t[13],controls:t[3],scrollElasticity:t[7]}}),r=new va({props:{elasticity:t[10],$$slots:{default:[F6]},$$scope:{ctx:t}}}),{c(){e=ht("div"),Et(i.$$.fragment),n=pe(),Et(r.$$.fragment),v(e,"slot","footer"),v(e,"style",t[5])},m(a,s){et(a,e,s),Rt(i,e,null),Ct(e,n),Rt(r,e,null),o=!0},p(a,s){const l={};2&s[0]&&(l.locale=a[1]),16&s[0]&&(l.shape=a[4]),8&s[0]&&(l.controls=a[3]),128&s[0]&&(l.scrollElasticity=a[7]),i.$set(l);const c={};70&s[0]|16&s[1]&&(c.$$scope={dirty:s,ctx:a}),r.$set(c),(!o||32&s[0])&&v(e,"style",a[5])},i(a){o||(P(i.$$.fragment,a),P(r.$$.fragment,a),o=!0)},o(a){z(i.$$.fragment,a),z(r.$$.fragment,a),o=!1},d(a){a&&Q(e),It(i),It(r)}}}function B6(t){let e,i;return e=new dl({props:{$$slots:{footer:[D6]},$$scope:{ctx:t}}}),e.$on("measure",t[23]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};254&r[0]|16&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function O6(t,e,i){let n,r,o,a,s,l,c,d,u=ni,p=()=>(u(),u=Br(h,k=>i(20,s=k)),h);t.$$.on_destroy.push(()=>u());let{isActive:h}=e;p();let{stores:g}=e,{locale:m={}}=e,{frameStyles:f={}}=e,{frameOptions:b=[]}=e,{markupEditorShapeStyleControls:w}=e;const S=sn("elasticityMultiplier");A(t,S,k=>i(22,d=k));const{history:C,animation:I,scrollElasticity:M,imageFrame:D,allowPan:T,allowZoom:F,allowZoomControls:W,allowPlayPause:O}=g;A(t,I,k=>i(21,l=k)),A(t,D,k=>i(4,c=k));let y={},V;const tt=pi(l?20:0);return A(t,tt,k=>i(19,a=k)),t.$$set=k=>{"isActive"in k&&p(i(0,h=k.isActive)),"stores"in k&&i(17,g=k.stores),"locale"in k&&i(1,m=k.locale),"frameStyles"in k&&i(18,f=k.frameStyles),"frameOptions"in k&&i(2,b=k.frameOptions),"markupEditorShapeStyleControls"in k&&i(3,w=k.markupEditorShapeStyleControls)},t.$$.update=()=>{1048576&t.$$.dirty[0]&&T.set(s),1048576&t.$$.dirty[0]&&F.set(s),1048576&t.$$.dirty[0]&&W.set(s),1048576&t.$$.dirty[0]&&s&&O.set(!0),4194304&t.$$.dirty[0]&&i(7,n=d*M),20&t.$$.dirty[0]&&i(6,r=c?b.findIndex(([k])=>k===c.id):0),3145728&t.$$.dirty[0]&&l&&tt.set(s?0:20),524288&t.$$.dirty[0]&&i(5,o=a?`transform: translateY(${a}px)`:void 0)},[h,m,b,w,c,o,r,n,S,I,M,D,({value:k})=>{const N=f[k];if(!N||!N.shape)return D.set(void 0),void C.write();const{shape:it}=N,ut={id:k,...jn(it),...Object.keys(y).reduce((at,gt)=>(it[gt]&&(at[gt]=y[gt]),at),{})};D.set(ut),C.write()},function(k){Ae(k,"frameColor")&&(y.frameColor=k.frameColor),c&&(ga(c,k),D.set(c),clearTimeout(V),V=setTimeout(()=>{C.write()},200))},k=>{const N=f[k];var it;if(N&&N.thumb)return it=N.thumb,/div/i.test(it)||J2(it)?it:/rect|path|circle|line|<g>/i.test(it)?`<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" stroke-width="1" stroke="currentColor" fill="none" aria-hidden="true" focusable="false" stroke-linecap="round" stroke-linejoin="round">${it}</svg>`:`<img src="${it}" alt=""/>`},tt,"frame",g,f,a,s,l,d,function(k){Wr.call(this,t,k)}]}var W6={util:["frame",class extends ci{constructor(t){super(),li(this,t,O6,B6,oi,{name:16,isActive:0,stores:17,locale:1,frameStyles:18,frameOptions:2,markupEditorShapeStyleControls:3},null,[-1,-1])}get name(){return this.$$.ctx[16]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get stores(){return this.$$.ctx[17]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),E()}get frameStyles(){return this.$$.ctx[18]}set frameStyles(t){this.$$set({frameStyles:t}),E()}get frameOptions(){return this.$$.ctx[2]}set frameOptions(t){this.$$set({frameOptions:t}),E()}get markupEditorShapeStyleControls(){return this.$$.ctx[3]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),E()}},({src:t})=>t&&!cl(t)]};function _6(t){let e,i,n,r,o,a,s,l;return{c(){e=ht("div"),i=ht("input"),r=pe(),o=ht("label"),a=mn(t[1]),v(i,"id",t[0]),v(i,"type","number"),v(i,"min","1"),v(i,"inputmode","numeric"),v(i,"pattern","[0-9]*"),v(i,"data-state",t[3]),v(i,"autocomplete","off"),v(i,"placeholder",t[4]),i.value=n=t[5]===void 0?"":t[7](t[5]+""),v(o,"for",t[0]),v(o,"title",t[2]),v(o,"aria-label",t[2]),v(e,"class","PinturaInputDimension")},m(c,d){et(c,e,d),Ct(e,i),Ct(e,r),Ct(e,o),Ct(o,a),s||(l=Mt(i,"input",t[8]),s=!0)},p(c,[d]){1&d&&v(i,"id",c[0]),8&d&&v(i,"data-state",c[3]),16&d&&v(i,"placeholder",c[4]),160&d&&n!==(n=c[5]===void 0?"":c[7](c[5]+""))&&i.value!==n&&(i.value=n),2&d&&In(a,c[1]),1&d&&v(o,"for",c[0]),4&d&&v(o,"title",c[2]),4&d&&v(o,"aria-label",c[2])},i:ni,o:ni,d(c){c&&Q(e),s=!1,l()}}}function V6(t,e,i){let{id:n}=e,{label:r}=e,{title:o}=e,{state:a}=e,{placeholder:s}=e,{value:l}=e,{onchange:c}=e,{format:d=u=>u.replace(/\D/g,"")}=e;return t.$$set=u=>{"id"in u&&i(0,n=u.id),"label"in u&&i(1,r=u.label),"title"in u&&i(2,o=u.title),"state"in u&&i(3,a=u.state),"placeholder"in u&&i(4,s=u.placeholder),"value"in u&&i(5,l=u.value),"onchange"in u&&i(6,c=u.onchange),"format"in u&&i(7,d=u.format)},[n,r,o,a,s,l,c,d,u=>c(d(u.currentTarget.value))]}class _f extends ci{constructor(e){super(),li(this,e,V6,_6,oi,{id:0,label:1,title:2,state:3,placeholder:4,value:5,onchange:6,format:7})}}function N6(t){let e;return{c(){e=gr("g")},m(i,n){et(i,e,n),e.innerHTML=t[2]},p(i,n){4&n&&(e.innerHTML=i[2])},d(i){i&&Q(e)}}}function H6(t){let e,i,n,r,o,a,s,l;return o=new wo({props:{$$slots:{default:[N6]},$$scope:{ctx:t}}}),{c(){e=ht("div"),i=ht("input"),n=pe(),r=ht("label"),Et(o.$$.fragment),v(i,"id",t[0]),v(i,"class","implicit"),v(i,"type","checkbox"),i.checked=t[1],v(r,"for",t[0]),v(r,"title",t[3])},m(c,d){et(c,e,d),Ct(e,i),Ct(e,n),Ct(e,r),Rt(o,r,null),a=!0,s||(l=Mt(i,"change",t[5]),s=!0)},p(c,[d]){(!a||1&d)&&v(i,"id",c[0]),(!a||2&d)&&(i.checked=c[1]);const u={};68&d&&(u.$$scope={dirty:d,ctx:c}),o.$set(u),(!a||1&d)&&v(r,"for",c[0]),(!a||8&d)&&v(r,"title",c[3])},i(c){a||(P(o.$$.fragment,c),a=!0)},o(c){z(o.$$.fragment,c),a=!1},d(c){c&&Q(e),It(o),s=!1,l()}}}function j6(t,e,i){let{id:n}=e,{locked:r}=e,{icon:o}=e,{title:a}=e,{onchange:s}=e;return t.$$set=l=>{"id"in l&&i(0,n=l.id),"locked"in l&&i(1,r=l.locked),"icon"in l&&i(2,o=l.icon),"title"in l&&i(3,a=l.title),"onchange"in l&&i(4,s=l.onchange)},[n,r,o,a,s,l=>s(l.currentTarget.checked)]}class U6 extends ci{constructor(e){super(),li(this,e,j6,H6,oi,{id:0,locked:1,icon:2,title:3,onchange:4})}}function G6(t){let e;return{c(){e=mn("Save")},m(i,n){et(i,e,n)},d(i){i&&Q(e)}}}function Z6(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g=t[1].resizeLabelFormCaption+"";return l=new oo({props:{items:t[4]}}),d=new zs({props:{type:"submit",class:"implicit",$$slots:{default:[G6]},$$scope:{ctx:t}}}),{c(){e=ht("form"),i=ht("div"),n=ht("fieldset"),r=ht("legend"),o=mn(g),a=pe(),s=ht("div"),Et(l.$$.fragment),c=pe(),Et(d.$$.fragment),v(r,"class","implicit"),v(s,"class","PinturaFieldsetInner"),v(i,"class","PinturaFormInner"),v(e,"slot","footer"),v(e,"style",t[3])},m(m,f){et(m,e,f),Ct(e,i),Ct(i,n),Ct(n,r),Ct(r,o),Ct(n,a),Ct(n,s),Rt(l,s,null),t[65](s),Ct(i,c),Rt(d,i,null),u=!0,p||(h=[Mt(s,"focusin",t[15]),Mt(s,"focusout",t[16]),Mt(e,"submit",Gb(t[17]))],p=!0)},p(m,f){(!u||2&f[0])&&g!==(g=m[1].resizeLabelFormCaption+"")&&In(o,g);const b={};16&f[0]&&(b.items=m[4]),l.$set(b);const w={};16&f[3]&&(w.$$scope={dirty:f,ctx:m}),d.$set(w),(!u||8&f[0])&&v(e,"style",m[3])},i(m){u||(P(l.$$.fragment,m),P(d.$$.fragment,m),u=!0)},o(m){z(l.$$.fragment,m),z(d.$$.fragment,m),u=!1},d(m){m&&Q(e),It(l),t[65](null),It(d),p=!1,Ui(h)}}}function X6(t){let e,i;return e=new dl({props:{$$slots:{footer:[Z6]},$$scope:{ctx:t}}}),e.$on("measure",t[66]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};30&r[0]|16&r[3]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Y6(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,I,M,D,T,F,W,O,y,V,tt,k,N,it=ni,ut=()=>(it(),it=Br(gt,pt=>i(49,h=pt)),gt);t.$$.on_destroy.push(()=>it());const at=(pt,Ht=0,ie=9999)=>{if(_e(pt)&&!(pt=pt.replace(/\D/g,"")).length)return;const Fe=Math.round(pt);return Number.isNaN(Fe)?void 0:tn(Fe,Ht,ie)};let{isActive:gt}=e;ut();let{stores:G}=e,{locale:$t={}}=e,{resizeMinSize:vt=Un(1,1)}=e,{resizeMaxSize:lt=Un(9999,9999)}=e,{resizeAspectRatioLocked:kt=!1}=e,{resizeEnableButtonLockAspectRatio:J=!0}=e,{resizeSizePresetOptions:q}=e,{resizeWidthPresetOptions:Z}=e,{resizeHeightPresetOptions:xt}=e,{resizeWillRenderFooter:nt=Ki}=e;const mt=pi(0,{stiffness:.15,damping:.3});A(t,mt,pt=>i(54,w=pt));const{animation:zt,imageSize:oe,imageCropRect:Dt,imageCropRectAspectRatio:te,imageCropAspectRatio:Kt,imageOutputSize:U,imageSelectionZoom:Tt,imageSelectionPan:dt,history:Jt,env:se,allowPan:ee,allowZoom:be,allowZoomControls:ve,allowPlayPause:_}=G;A(t,zt,pt=>i(50,g=pt)),A(t,oe,pt=>i(73,tt=pt)),A(t,Dt,pt=>i(52,f=pt)),A(t,te,pt=>i(53,b=pt)),A(t,Kt,pt=>i(72,W=pt)),A(t,U,pt=>i(61,F=pt)),A(t,Tt,pt=>i(74,k=pt)),A(t,dt,pt=>i(75,N=pt)),A(t,se,pt=>i(51,m=pt));const ke=ea();let fi,ye,Ot,ze,Re,Oe,di=rn();const bt=(pt,Ht,ie,Fe,Wt)=>pt!=null&&ie!==Ht?pt>=Fe[Ht]&&pt<=Wt[Ht]?"valid":"invalid":"undetermined",le=(pt,Ht,ie)=>Math.round(pt!=null?pt/Ht:ie.height),Xe=()=>{kt&&ye&&Ot&&(ze==="width"?i(39,Ot=Math.round(ye/b)):ze==="height"?i(38,ye=Math.round(Ot*b)):(Re==="width"?i(39,Ot=Math.round(ye/b)):Re==="height"&&i(38,ye=Math.round(Ot*b)),Ve()))},Ve=pt=>{let Ht=at(ye),ie=at(Ot),Fe=Ht,Wt=ie,K=Fe&&Wt,Yt=pt||b;if(!Fe&&!Wt)return;Fe&&!Wt?Wt=Math.round(Fe/Yt):Wt&&!Fe&&(Fe=Math.round(Wt*Yt)),Yt=pt||K?qo(Fe,Wt):b;let Ut=Un(Fe,Wt);cu(lt,Ut)||(Ut=Yr(lt,Yt)),cu(Ut,vt)||(Ut=rs(vt,Yt)),i(38,ye=Ht!=null?Math.round(Ut.width):void 0),i(39,Ot=ie!=null?Math.round(Ut.height):void 0)},At=()=>{Ve();const{width:pt,height:Ht}=F||{};pt===ye&&Ht===Ot||(ye||Ot?(ye&&Ot&&wt(Kt,W=ye/Ot,W),wt(U,F=Un(ye,Ot),F)):(wt(Kt,W=tt.width/tt.height,W),wt(Kt,W=void 0,W),wt(U,F=void 0,F)),Jt.write())},Ge=U.subscribe(pt=>{if(!pt)return i(38,ye=void 0),void i(39,Ot=void 0);i(38,ye=pt.width),i(39,Ot=pt.height),Ve()}),Ye=Kt.subscribe(pt=>{(ye||Ot)&&pt&&(ye&&Ot&&qo(ye,Ot)!==pt?(i(39,Ot=ye/pt),Ve(pt)):Ve())}),$i=pt=>_e(pt[0])?(pt[1]=pt[1].map($i),pt):hi(pt)?[pt,""+pt]:pt,bi=pt=>{if(_e(pt[0]))return pt[1]=pt[1].map(bi),pt;let[Ht,ie]=pt;if(hi(Ht)&&hi(ie)){const[Fe,Wt]=[Ht,ie];ie=`${Fe} &times; ${Wt}`,Ht=[Fe,Wt]}return[Ht,ie]},Mi=ue();A(t,Mi,pt=>i(60,T=pt));const Ci=ue();A(t,Ci,pt=>i(64,V=pt));const X=ue();A(t,X,pt=>i(58,M=pt));const Gt=ue();A(t,Gt,pt=>i(63,y=pt));const H=ue();A(t,H,pt=>i(56,C=pt));const Zt=ue();A(t,Zt,pt=>i(62,O=pt));const ae=Ei([U,Ci],([pt,Ht],ie)=>{if(!Ht)return ie(-1);const Fe=Ht.findIndex(([Wt])=>{if(!Wt&&!pt)return!0;if(!Wt)return!1;const[K,Yt]=Wt;return pt.width===K&&pt.height===Yt});ie(Fe<0?0:Fe)});A(t,ae,pt=>i(59,D=pt));const jt=Ei([U,Gt],([pt,Ht],ie)=>{if(!Ht)return ie(-1);const Fe=Ht.findIndex(([Wt])=>!Wt&&!pt||!!Wt&&pt.width===Wt);ie(Fe<0?0:Fe)});A(t,jt,pt=>i(57,I=pt));const $e=Ei([U,Zt],([pt,Ht],ie)=>{if(!Ht)return ie(-1);const Fe=Ht.findIndex(([Wt])=>!Wt&&!pt||!!Wt&&pt.height===Wt);ie(Fe<0?0:Fe)});A(t,$e,pt=>i(55,S=pt));let Xt,Le;const qe=sn("redrawTrigger"),Ne=pi(g?20:0);return A(t,Ne,pt=>i(48,p=pt)),_o(()=>{Ge(),Ye()}),t.$$set=pt=>{"isActive"in pt&&ut(i(0,gt=pt.isActive)),"stores"in pt&&i(30,G=pt.stores),"locale"in pt&&i(1,$t=pt.locale),"resizeMinSize"in pt&&i(31,vt=pt.resizeMinSize),"resizeMaxSize"in pt&&i(32,lt=pt.resizeMaxSize),"resizeAspectRatioLocked"in pt&&i(28,kt=pt.resizeAspectRatioLocked),"resizeEnableButtonLockAspectRatio"in pt&&i(33,J=pt.resizeEnableButtonLockAspectRatio),"resizeSizePresetOptions"in pt&&i(34,q=pt.resizeSizePresetOptions),"resizeWidthPresetOptions"in pt&&i(35,Z=pt.resizeWidthPresetOptions),"resizeHeightPresetOptions"in pt&&i(36,xt=pt.resizeHeightPresetOptions),"resizeWillRenderFooter"in pt&&i(37,nt=pt.resizeWillRenderFooter)},t.$$.update=()=>{var pt;262144&t.$$.dirty[1]&&ee.set(!h),262144&t.$$.dirty[1]&&be.set(!h),262144&t.$$.dirty[1]&&ve.set(!h),262144&t.$$.dirty[1]&&h&&_.set(!0),536870920&t.$$.dirty[1]&&q&&(wt(Mi,T=q.map(bi),T),wt(Ci,V=Cs(T),V)),536870912&t.$$.dirty[1]&&i(47,a=!!T),268435456&t.$$.dirty[1]|4&t.$$.dirty[2]&&i(46,n=D>-1&&V[D][1]),134217744&t.$$.dirty[1]&&Z&&(wt(X,M=Z.map($i),M),wt(Gt,y=Cs(M),y)),134283264&t.$$.dirty[1]&&i(44,s=!a&&M),67108864&t.$$.dirty[1]|2&t.$$.dirty[2]&&i(45,r=I>-1&&y[I][1]),33554464&t.$$.dirty[1]&&xt&&(wt(H,C=xt.map($i),C),wt(Zt,O=Cs(C),O)),33619968&t.$$.dirty[1]&&i(43,l=!a&&C),16777216&t.$$.dirty[1]|1&t.$$.dirty[2]&&i(42,o=S>-1&&O[S][1]),77824&t.$$.dirty[1]&&i(41,c=!a&&!s&&!l),268435458&t.$$.dirty[0]|1072824263&t.$$.dirty[1]&&i(4,d=qe&&_c(()=>{return nt([a&&["Dropdown","size-presets",{label:n,options:T,onchange:Wt=>{return(K=Wt.value)&&!Xt&&(Xt={...f},Le=W),K?(wt(Kt,W=qo(K[0],K[1]),W),wt(U,F=ey(K),F)):(wt(Dt,f=Xt,f),wt(Kt,W=Le,W),wt(U,F=void 0,F),Xt=void 0,Le=void 0),void Jt.write();var K},selectedIndex:D}],s&&["Dropdown","width-presets",{label:r,options:M,onchange:Wt=>{i(38,ye=Wt.value),At()},selectedIndex:I}],s&&l&&["span","times",{class:"PinturaResizeLabel",innerHTML:"&times;"}],l&&["Dropdown","height-presets",{label:o,options:C,onchange:Wt=>{i(39,Ot=Wt.value),At()},selectedIndex:S}],c&&[_f,"width-input",{id:"width-"+ke,title:$t.resizeTitleInputWidth,label:$t.resizeLabelInputWidth,placeholder:(Ht=at(Ot),ie=b,Fe=f,Math.round(Ht!=null?Ht*ie:Fe.width)),value:ye,state:bt(at(ye),"width",ze,vt,lt),onchange:Wt=>{i(38,ye=Wt),Xe()}}],c&&J&&[U6,"aspect-ratio-lock",{id:"aspect-ratio-lock-"+ke,title:$t.resizeTitleButtonMaintainAspectRatio,icon:_e($t.resizeIconButtonMaintainAspectRatio)?$t.resizeIconButtonMaintainAspectRatio:$t.resizeIconButtonMaintainAspectRatio(kt,w),locked:kt,onchange:Wt=>{i(28,kt=Wt),Xe()}}],c&&[_f,"height-input",{id:"height-"+ke,title:$t.resizeTitleInputHeight,label:$t.resizeLabelInputHeight,placeholder:le(at(ye),b,f),value:Ot,state:bt(at(Ot),"height",ze,vt,lt),onchange:Wt=>{i(39,Ot=Wt),Xe()}}]].filter(Boolean),{...m},()=>qe.set({}));var Ht,ie,Fe}).filter(Boolean)),268435456&t.$$.dirty[0]&&mt.set(kt?1:0),512&t.$$.dirty[1]&&ze&&(Re=ze),262144&t.$$.dirty[1]&&h&&(di=N,Oe=k),1074003968&t.$$.dirty[1]&&(h?(pt=F,wt(dt,N=rn(),N),wt(Tt,k=pt&&f?pt.width/f.width||pt.height/f.height:1,k)):(wt(dt,N=di,N),wt(Tt,k=Oe,k))),786432&t.$$.dirty[1]&&g&&Ne.set(h?0:20),131072&t.$$.dirty[1]&&i(3,u=p?`transform: translateY(${p}px)`:void 0)},[gt,$t,fi,u,d,mt,zt,oe,Dt,te,Kt,U,Tt,dt,se,pt=>{const Ht=pt.target.id;/width/.test(Ht)?i(40,ze="width"):/height/.test(Ht)?i(40,ze="height"):/aspectRatio/i.test(Ht)?i(40,ze="lock"):i(40,ze=void 0)},pt=>{fi.contains(pt.relatedTarget)||At(),i(40,ze=void 0)},At,Mi,Ci,X,Gt,H,Zt,ae,jt,$e,Ne,kt,"resize",G,vt,lt,J,q,Z,xt,nt,ye,Ot,ze,c,o,l,s,r,n,a,p,h,g,m,f,b,w,S,C,I,M,D,T,F,O,y,V,function(pt){zi[pt?"unshift":"push"](()=>{fi=pt,i(2,fi)})},function(pt){Wr.call(this,t,pt)}]}var q6={util:["resize",class extends ci{constructor(t){super(),li(this,t,Y6,X6,oi,{name:29,isActive:0,stores:30,locale:1,resizeMinSize:31,resizeMaxSize:32,resizeAspectRatioLocked:28,resizeEnableButtonLockAspectRatio:33,resizeSizePresetOptions:34,resizeWidthPresetOptions:35,resizeHeightPresetOptions:36,resizeWillRenderFooter:37},null,[-1,-1,-1,-1])}get name(){return this.$$.ctx[29]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get stores(){return this.$$.ctx[30]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),E()}get resizeMinSize(){return this.$$.ctx[31]}set resizeMinSize(t){this.$$set({resizeMinSize:t}),E()}get resizeMaxSize(){return this.$$.ctx[32]}set resizeMaxSize(t){this.$$set({resizeMaxSize:t}),E()}get resizeAspectRatioLocked(){return this.$$.ctx[28]}set resizeAspectRatioLocked(t){this.$$set({resizeAspectRatioLocked:t}),E()}get resizeEnableButtonLockAspectRatio(){return this.$$.ctx[33]}set resizeEnableButtonLockAspectRatio(t){this.$$set({resizeEnableButtonLockAspectRatio:t}),E()}get resizeSizePresetOptions(){return this.$$.ctx[34]}set resizeSizePresetOptions(t){this.$$set({resizeSizePresetOptions:t}),E()}get resizeWidthPresetOptions(){return this.$$.ctx[35]}set resizeWidthPresetOptions(t){this.$$set({resizeWidthPresetOptions:t}),E()}get resizeHeightPresetOptions(){return this.$$.ctx[36]}set resizeHeightPresetOptions(t){this.$$set({resizeHeightPresetOptions:t}),E()}get resizeWillRenderFooter(){return this.$$.ctx[37]}set resizeWillRenderFooter(t){this.$$set({resizeWillRenderFooter:t}),E()}},({src:t})=>t&&!cl(t)]};function K6(t){let e,i;return e=new Bu({props:{stores:t[3],locale:t[4],isActive:t[0],isActiveFraction:t[1],isVisible:t[2],mapScreenPointToImagePoint:t[9],mapImagePointToScreenPoint:t[8],utilKey:"redact",imageRotation:t[10],imageFlipX:t[7],imageFlipY:t[6],shapes:t[11],toolbar:["rect"],toolShapes:{rectangle:[{x:0,y:0,width:0,height:0}]},toolActive:"rectangle",parentRect:t[13],enablePresetDropImage:!1,enablePresetSelectImage:!1,willStartInteraction:t[5],hooks:{willRenderShapeControls:t[24]}}}),e.$on("measure",t[25]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,[r]){const o={};8&r&&(o.stores=n[3]),16&r&&(o.locale=n[4]),1&r&&(o.isActive=n[0]),2&r&&(o.isActiveFraction=n[1]),4&r&&(o.isVisible=n[2]),512&r&&(o.mapScreenPointToImagePoint=n[9]),256&r&&(o.mapImagePointToScreenPoint=n[8]),1024&r&&(o.imageRotation=n[10]),128&r&&(o.imageFlipX=n[7]),64&r&&(o.imageFlipY=n[6]),32&r&&(o.willStartInteraction=n[5]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function J6(t,e,i){let n,r,o,a,s,l,c,d,u,{isActive:p}=e,{isActiveFraction:h}=e,{isVisible:g}=e,{stores:m}=e,{locale:f={}}=e,{markupEditorWillStartInteraction:b}=e;const{imageRedaction:w,rootRect:S,imageSize:C,imageRotation:I,imageFlipX:M,imageFlipY:D,imageTransforms:T,imageTransformsInterpolated:F}=m;return A(t,S,W=>i(23,d=W)),A(t,C,W=>i(22,c=W)),A(t,I,W=>i(10,u=W)),A(t,M,W=>i(7,a=W)),A(t,D,W=>i(6,o=W)),A(t,T,W=>i(21,l=W)),A(t,F,W=>i(20,s=W)),t.$$set=W=>{"isActive"in W&&i(0,p=W.isActive),"isActiveFraction"in W&&i(1,h=W.isActiveFraction),"isVisible"in W&&i(2,g=W.isVisible),"stores"in W&&i(3,m=W.stores),"locale"in W&&i(4,f=W.locale),"markupEditorWillStartInteraction"in W&&i(5,b=W.markupEditorWillStartInteraction)},t.$$.update=()=>{15728832&t.$$.dirty&&i(9,n=W=>r0(W,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o)),15728832&t.$$.dirty&&i(8,r=W=>n0(W,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o))},[p,h,g,m,f,b,o,a,r,n,u,w,S,C,I,M,D,T,F,"redact",s,l,c,d,W=>{const O=uh(W[0]);return S3("to-front",O),W},function(W){Wr.call(this,t,W)}]}var Q6={util:["redact",class extends ci{constructor(t){super(),li(this,t,J6,K6,oi,{name:19,isActive:0,isActiveFraction:1,isVisible:2,stores:3,locale:4,markupEditorWillStartInteraction:5})}get name(){return this.$$.ctx[19]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),E()}get isVisible(){return this.$$.ctx[2]}set isVisible(t){this.$$set({isVisible:t}),E()}get stores(){return this.$$.ctx[3]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),E()}get markupEditorWillStartInteraction(){return this.$$.ctx[5]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),E()}},({src:t})=>t&&!cl(t)]};function Vf(t){let e,i,n=(on(t[32].label)?t[32].label(t[1]):t[32].label)+"";return{c(){e=ht("span"),i=mn(n)},m(r,o){et(r,e,o),Ct(e,i)},p(r,o){2&o[0]|2&o[1]&&n!==(n=(on(r[32].label)?r[32].label(r[1]):r[32].label)+"")&&In(i,n)},d(r){r&&Q(e)}}}function t8(t){let e,i,n,r=(t[11](t[32].value)||"")+"",o=t[32].label&&Vf(t);return{c(){e=ht("div"),i=new Pu(!1),n=pe(),o&&o.c(),i.a=n,v(e,"slot","option")},m(a,s){et(a,e,s),i.m(r,e),Ct(e,n),o&&o.m(e,null)},p(a,s){2&s[1]&&r!==(r=(a[11](a[32].value)||"")+"")&&i.p(r),a[32].label?o?o.p(a,s):(o=Vf(a),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(a){a&&Q(e),o&&o.d()}}}function e8(t){let e,i;return e=new as({props:{locale:t[1],class:"PinturaControlList",layout:"row",options:t[2],selectedIndex:t[4],onchange:t[10],$$slots:{option:[t8,({option:n})=>({32:n}),({option:n})=>[0,n?2:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};2&r[0]&&(o.locale=n[1]),4&r[0]&&(o.options=n[2]),16&r[0]&&(o.selectedIndex=n[4]),2&r[0]|6&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function i8(t){let e,i,n;return i=new va({props:{elasticity:t[5],$$slots:{default:[e8]},$$scope:{ctx:t}}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"slot","footer"),v(e,"style",t[3])},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};32&o[0]&&(a.elasticity=r[5]),22&o[0]|4&o[1]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a),(!n||8&o[0])&&v(e,"style",r[3])},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function n8(t){let e,i;return e=new dl({props:{$$slots:{footer:[i8]},$$scope:{ctx:t}}}),e.$on("measure",t[22]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};62&r[0]|4&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function r8(t,e,i){let n,r,o,a,s,l,c,d,u,p,h=ni,g=()=>(h(),h=Br(m,k=>i(17,l=k)),m);t.$$.on_destroy.push(()=>h());let{isActive:m}=e;g();let{stores:f}=e,{locale:b={}}=e,{fillOptions:w=[]}=e;const S=k=>k.map(N=>(it=>Rn(it)&&_e(it[0])&&Rn(it[1]))(N)?[N[0],S(N[1]),N[2]]:(it=>[Array.isArray(it)&&it.length===3?[...it,1]:it,void 0,{disabled:!1}])(N)),C=sn("elasticityMultiplier");A(t,C,k=>i(21,p=k));const{history:I,animation:M,scrollElasticity:D,imageBackgroundColor:T,imageBackgroundImage:F,allowPan:W,allowZoom:O,allowZoomControls:y,allowPlayPause:V}=f;A(t,M,k=>i(18,c=k)),A(t,T,k=>i(20,u=k)),A(t,F,k=>i(19,d=k));const tt=pi(c?20:0);return A(t,tt,k=>i(16,s=k)),t.$$set=k=>{"isActive"in k&&g(i(0,m=k.isActive)),"stores"in k&&i(14,f=k.stores),"locale"in k&&i(1,b=k.locale),"fillOptions"in k&&i(15,w=k.fillOptions)},t.$$.update=()=>{32768&t.$$.dirty[0]&&i(2,n=S(w)),131072&t.$$.dirty[0]&&W.set(l),131072&t.$$.dirty[0]&&O.set(l),131072&t.$$.dirty[0]&&y.set(l),131072&t.$$.dirty[0]&&l&&V.set(!0),2097152&t.$$.dirty[0]&&i(5,r=p*D),1572868&t.$$.dirty[0]&&i(4,o=n.findIndex(([k])=>d?k===d:Array.isArray(k)?os(k,u):void 0)||0),393216&t.$$.dirty[0]&&c&&tt.set(l?0:20),65536&t.$$.dirty[0]&&i(3,a=s?`transform: translateY(${s}px)`:void 0)},[m,b,n,a,o,r,C,M,T,F,({value:k})=>{_e(k)&&(wt(T,u=void 0,u),wt(F,d=k,d)),Rn(k)&&(wt(T,u=k,u),wt(F,d=void 0,d)),I.write()},k=>{if(_e(k))return`<div class="PinturaFillTile"><img src="${k}" alt="" width="48" height="64"/></div>`;if(Rn(k)){const[N,it,ut,at]=k.map((gt,G)=>G<3?Math.round(255*gt):gt);return`<div class="PinturaFillTile" data-transparent="${at<1}"><div style="background-color:rgba(${N},${it},${ut},${at})"></div></div>`}return"<div></div>"},tt,"fill",f,w,s,l,c,d,u,p,function(k){Wr.call(this,t,k)}]}var o8={util:["fill",class extends ci{constructor(t){super(),li(this,t,r8,n8,oi,{name:13,isActive:0,stores:14,locale:1,fillOptions:15},null,[-1,-1])}get name(){return this.$$.ctx[13]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get stores(){return this.$$.ctx[14]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),E()}get fillOptions(){return this.$$.ctx[15]}set fillOptions(t){this.$$set({fillOptions:t}),E()}},({src:t,fillOptions:e})=>t&&!cl(t)&&e&&e.length]};const Nf='<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M18 6L6 18M6 6l12 12"></path></path></g>',Hp='<path fill="none" d="M9 15 L12 9 L15 15 M10 13.5 h3" stroke="currentColor" stroke-width=".125em"/>';var a8={labelReset:"Reset",labelDefault:"Default",labelAuto:"Auto",labelNone:"None",labelEdit:"Edit",labelClose:"Close",labelSupportError:t=>t.join(", ")+" not supported on this browser",labelColor:"Color",labelWidth:"Width",labelSize:"Size",labelOffset:"Offset",labelAmount:"Amount",labelInset:"Inset",labelRadius:"Radius",labelColorPalette:"Color palette",labelSizeExtraSmall:"Extra small",labelSizeSmall:"Small",labelSizeMediumSmall:"Medium small",labelSizeMedium:"Medium",labelSizeMediumLarge:"Medium large",labelSizeLarge:"Large",labelSizeExtraLarge:"Extra large",labelButtonCancel:"Cancel",labelButtonUndo:"Undo",labelButtonRedo:"Redo",labelButtonRevert:"Revert",labelButtonExport:"Done",labelZoomIn:"Zoom in",labelZoomOut:"Zoom out",labelZoomFit:"Fit to view",labelZoomActual:"Actual size",iconZoomIn:'<path stroke="currentColor" stroke-width=".125em" d="M8 12 h8 M12 8 v8" />',iconZoomOut:'<path stroke="currentColor" stroke-width=".125em" d="M9 12 h6" />',iconSupportError:'<g fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><g><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></g>',iconButtonClose:Nf,iconButtonRevert:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M7.388 18.538a8 8 0 10-2.992-9.03"/><path fill="currentColor" d="M2.794 11.696L2.37 6.714l5.088 3.18z"/><path d="M12 8v4M12 12l4 2"/></g>',iconButtonUndo:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M10 8h4c2.485 0 5 2 5 5s-2.515 5-5 5h-4"/><path fill="currentColor" d="M5 8l4-3v6z"/></g>',iconButtonRedo:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M14 8h-4c-2.485 0-5 2-5 5s2.515 5 5 5h4"/><path fill="currentColor" d="M19 8l-4-3v6z"/></g>',iconButtonExport:'<polyline points="20 6 9 17 4 12" fill="none" stroke="currentColor" stroke-width=".125em"></polyline>',statusLabelButtonClose:"Close",statusIconButtonClose:Nf,statusLabelLoadImage:t=>t&&t.task?t.error?t.error.code==="IMAGE_TOO_SMALL"?"Minimum image size is {minWidth} &times; {minHeight}":"Error loading image":t.task==="blob-to-bitmap"?"Preparing image&hellip;":"Loading image&hellip;":"Waiting for image",statusLabelProcessImage:t=>{if(t&&t.task)return t.task==="store"?t.error?"Error uploading image":"Uploading image&hellip;":t.error?"Error processing image":"Processing image&hellip;"}};const s8={shapeLabelButtonSelectSticker:"Select image",shapeIconButtonSelectSticker:'<g fill="none" stroke="currentColor" stroke-width="0.0625em"><path d="M8 21 L15 11 L19 15"/><path d="M15 2 v5 h5"/><path d="M8 2 h8 l4 4 v12 q0 4 -4 4 h-8 q-4 0 -4 -4 v-12 q0 -4 4 -4z"/></g><circle fill="currentColor" cx="10" cy="8" r="1.5"/>',shapeIconButtonFlipHorizontal:'<g stroke="currentColor" stroke-width=".125em"><path fill="none" d="M6 6.5h5v11H6z"/><path fill="currentColor" d="M15 6.5h3v11h-3z"/><path d="M11 4v16" fill="currentColor"/></g>',shapeIconButtonFlipVertical:'<g stroke="currentColor" stroke-width=".125em"><rect x="7" y="8" width="11" height="5" fill="none"/><rect x="7" y="17" width="11" height="2" fill="currentColor"/><line x1="5" y1="13" x2="20" y2="13"/></g>',shapeIconButtonRemove:'<g fill="none" fill-rule="evenodd"><path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M7.5 7h9z"/><path d="M7.916 9h8.168a1 1 0 01.99 1.14l-.972 6.862a2 2 0 01-1.473 1.653c-.877.23-1.753.345-2.629.345-.876 0-1.752-.115-2.628-.345a2 2 0 01-1.473-1.653l-.973-6.862A1 1 0 017.916 9z" fill="currentColor"/><rect fill="currentColor" x="10" y="5" width="4" height="3" rx="1"/></g>',shapeIconButtonDuplicate:'<g fill="none" fill-rule="evenodd"><path d="M15 13.994V16a2 2 0 01-2 2H8a2 2 0 01-2-2v-5a2 2 0 012-2h2.142" stroke="currentColor" stroke-width=".125em"/><path d="M15 9V8a1 1 0 00-2 0v1h-1a1 1 0 000 2h1v1a1 1 0 002 0v-1h1a1 1 0 000-2h-1zm-4-4h6a2 2 0 012 2v6a2 2 0 01-2 2h-6a2 2 0 01-2-2V7a2 2 0 012-2z" fill="currentColor"/></g>',shapeIconButtonMoveToFront:'<g fill="none" fill-rule="evenodd"><rect fill="currentColor" x="11" y="13" width="8" height="2" rx="1"/><rect fill="currentColor" x="9" y="17" width="10" height="2" rx="1"/><path d="M11.364 8H10a5 5 0 000 10M12 6.5L14.5 8 12 9.5z" stroke="currentColor" stroke-width=".125em" stroke-linecap="round"/></g>',shapeIconButtonTextLayoutAutoWidth:""+Hp,shapeIconButtonTextLayoutAutoHeight:'<g fill="currentColor"><circle cx="4" cy="12" r="1.5"/><circle cx="20" cy="12" r="1.5"/></g>'+Hp,shapeIconButtonTextLayoutFixedSize:'<g fill="currentColor"><circle cx="5" cy="6" r="1.5"/><circle cx="19" cy="6" r="1.5"/><circle cx="19" cy="19" r="1.5"/><circle cx="5" cy="19" r="1.5"/></g>'+Hp,shapeTitleButtonTextLayoutAutoWidth:"Auto width",shapeTitleButtonTextLayoutAutoHeight:"Auto height",shapeTitleButtonTextLayoutFixedSize:"Fixed size",shapeTitleButtonFlipHorizontal:"Flip Horizontal",shapeTitleButtonFlipVertical:"Flip Vertical",shapeTitleButtonRemove:"Remove",shapeTitleButtonDuplicate:"Duplicate",shapeTitleButtonMoveToFront:"Move to front",shapeLabelInputText:"Edit text",shapeIconInputCancel:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M18 6L6 18M6 6l12 12"/></g>',shapeIconInputConfirm:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><polyline points="20 6 9 17 4 12"/></g>',shapeLabelInputCancel:"Cancel",shapeLabelInputConfirm:"Confirm",shapeLabelStrokeNone:"No outline",shapeLabelFontStyleNormal:"Normal",shapeLabelFontStyleBold:"Bold",shapeLabelFontStyleItalic:"Italic",shapeLabelFontStyleItalicBold:"Bold Italic",shapeTitleBackgroundColor:"Fill color",shapeTitleCornerRadius:"Corner radius",shapeTitleFontFamily:"Font",shapeTitleFontSize:"Font size",shapeTitleFontStyle:"Font style",shapeTitleLineHeight:"Line height",shapeTitleLineStart:"Start",shapeTitleLineEnd:"End",shapeTitleStrokeWidth:"Line width",shapeTitleStrokeColor:"Line color",shapeTitleLineDecorationBar:"Bar",shapeTitleLineDecorationCircle:"Circle",shapeTitleLineDecorationSquare:"Square",shapeTitleLineDecorationArrow:"Arrow",shapeTitleLineDecorationCircleSolid:"Circle solid",shapeTitleLineDecorationSquareSolid:"Square solid",shapeTitleLineDecorationArrowSolid:"Arrow solid",shapeIconLineDecorationBar:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16"/><path d="M16,8 V16"/></g>',shapeIconLineDecorationCircle:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><circle fill="none" stroke-width=".125em" cx="16" cy="12" r="4"/></g>',shapeIconLineDecorationSquare:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><rect fill="none" stroke-width=".125em" x="12" y="8" width="8" height="8"/></g>',shapeIconLineDecorationArrow:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16 M13,7 l6,5 l-6,5" fill="none"/></g>',shapeIconLineDecorationCircleSolid:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><circle fill="currentColor" cx="16" cy="12" r="4"/></g>',shapeIconLineDecorationSquareSolid:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><rect fill="currentColor" x="12" y="8" width="8" height="8"/></g>',shapeIconLineDecorationArrowSolid:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16"/><path d="M13,7 l6,5 l-6,5z" fill="currentColor"/></g>',shapeTitleColorTransparent:"Transparent",shapeTitleColorWhite:"White",shapeTitleColorSilver:"Silver",shapeTitleColorGray:"Gray",shapeTitleColorBlack:"Black",shapeTitleColorNavy:"Navy",shapeTitleColorBlue:"Blue",shapeTitleColorAqua:"Aqua",shapeTitleColorTeal:"Teal",shapeTitleColorOlive:"Olive",shapeTitleColorGreen:"Green",shapeTitleColorYellow:"Yellow",shapeTitleColorOrange:"Orange",shapeTitleColorRed:"Red",shapeTitleColorMaroon:"Maroon",shapeTitleColorFuchsia:"Fuchsia",shapeTitleColorPurple:"Purple",shapeTitleTextOutline:"Text outline",shapeTitleTextOutlineWidth:"Width",shapeTitleTextShadow:"Text shadow",shapeTitleTextShadowBlur:"Blur",shapeTitleTextColor:"Font color",shapeTitleTextAlign:"Text align",shapeTitleTextAlignLeft:"Left align text",shapeTitleTextAlignCenter:"Center align text",shapeTitleTextAlignRight:"Right align text",shapeIconTextAlignLeft:'<g stroke-width=".125em" stroke="currentColor"><line x1="5" y1="8" x2="15" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="5" y1="16" x2="14" y2="16"/></g>',shapeIconTextAlignCenter:'<g stroke-width=".125em" stroke="currentColor"><line x1="7" y1="8" x2="17" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="8" y1="16" x2="16" y2="16"/></g>',shapeIconTextAlignRight:'<g stroke-width=".125em" stroke="currentColor"><line x1="9" y1="8" x2="19" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="11" y1="16" x2="19" y2="16"/></g>',shapeLabelToolMove:"Move",shapeLabelToolView:"View",shapeLabelToolSharpie:"Sharpie",shapeLabelToolEraser:"Eraser",shapeLabelToolPath:"Path",shapeLabelToolRectangle:"Rectangle",shapeLabelToolEllipse:"Ellipse",shapeLabelToolArrow:"Arrow",shapeLabelToolLine:"Line",shapeLabelToolText:"Text",shapeLabelToolPreset:"Stickers",shapeIconToolView:'<g stroke-width=".125em" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M10.98 9.703V2.567c0-1.19 1.19-1.785 1.784-1.785.595 0 1.784.595 1.784 1.785v3.568"/><path d="M14.548 9.703V4.35c0-1.19 1.19-1.784 1.784-1.784.595 0 1.784.594 1.784 1.784v2.973"/><path d="M18.116 10.244V7.271c0-1.19 1.19-1.784 1.784-1.784.595 0 1.785.595 1.785 1.784 0 1.19 0 8.92-1.19 12.488-1.19 3.569-10.704 4.758-13.678 0-2.973-4.757-2.973-4.757-4.163-6.541-1.189-1.784-1.153-2.974-.594-3.568.558-.595 1.784-1.19 2.973.594 1.277 1.916 2.07 2.907 2.379 2.974V5.487c0-1.19 1.19-1.784 1.784-1.784.595 0 1.784.595 1.784 1.784V8.46"/></g>',shapeIconToolMove:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M6 2 L6 19 L18 13 Z M13 18 L16 24" stroke="currentColor" stroke-width=".125em" fill="none" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolSharpie:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M2.025 5c5.616-2.732 8.833-3.857 9.65-3.374C12.903 2.351.518 12.666 2.026 14 3.534 15.334 16.536.566 17.73 2.566 18.924 4.566 3.98 17.187 4.831 18c.851.813 9.848-6 11.643-6 1.087 0-2.53 5.11-2.92 7-.086.41 3.323-1.498 4.773-1 .494.17.64 2.317 1.319 3 .439.443 1.332.776 2.679 1" stroke="currentColor" stroke-width=".125em" fill="none" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolEraser:'<g stroke-width=".125em" stroke="currentColor" stroke-linecap="round" fill="none"><g transform="translate(3, 15) rotate(-45)"><rect x="0" y="0" width="18" height="10" rx="3"/></g><line x1="11" y1="21" x2="18" y2="21"/><line x1="20" y1="21" x2="22" y2="21"/></g>',shapeIconToolPath:'<g stroke-width=".125em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none"><circle cx="21" cy="3" r="2"/><circle cx="9" cy="9" r="2"/><circle cx="3" cy="21" r="2"/><path d="M19 4 11 8 M8 11 4 19"/></g>',shapeIconToolRectangle:'<g stroke-width=".125em" stroke="currentColor" fill="none"><rect x="1" y="1" width="22" height="22" rx="4"/></g>',shapeIconToolEllipse:'<g stroke-width=".125em" stroke="currentColor" fill="none"><circle cx="12" cy="12" r="11"/></g>',shapeIconToolArrow:'<g stroke-width=".125em" stroke="currentColor" fill="none"><line x1="20" y1="3" x2="6" y2="21"/><path d="m10 6 L21.5 1 L20 13.5" fill="currentColor" stroke="none"/></g>',shapeIconToolLine:'<g stroke-width=".125em" stroke="currentColor" fill="none"><line x1="20" y1="3" x2="6" y2="21"/></g>',shapeIconToolText:'<g stroke="none" fill="currentColor" transform="translate(6,0)"><path d="M8.14 20.085c.459 0 .901-.034 1.329-.102a8.597 8.597 0 001.015-.21v1.984c-.281.135-.695.247-1.242.336a9.328 9.328 0 01-1.477.133c-3.312 0-4.968-1.745-4.968-5.235V6.804H.344v-1.25l2.453-1.078L3.89.819h1.5v3.97h4.97v2.015H5.39v10.078c0 1.031.245 1.823.735 2.375s1.161.828 2.015.828z"/>',shapeIconToolPreset:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z"></path><path d="M20 17c-3 3-5 5-8 5"></path></g>',shapeTitleSelectionMode:"Selection mode",shapeTitleBrushSize:"Brush size",shapeLabelSelectionModeNew:"New",shapeLabelSelectionModeAdd:"Add",shapeLabelSelectionModeSubtract:"Remove",shapeLabelToolSelectionBrush:"Brush",shapeLabelToolSelectionLassoo:"Lassoo",shapeLabelToolSelectionRectangle:"Rectangle marquee",shapeLabelToolSelectionEllipse:"Ellipse marquee",shapeIconSelectionModeNew:'<g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 17H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v1.5"/><rect width="12" height="12" x="9" y="9" fill="currentColor" fill-opacity=".25" rx="2"/></g>',shapeIconSelectionModeAdd:'<g fill="none" fill-rule="evenodd" stroke="currentColor"><path fill="currentColor" fill-opacity=".25" stroke-linecap="round" stroke-linejoin="round" d="M15 3a2 2 0 0 1 2 2v4h2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2v-2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10Z"/><path d="M13 15h4M15 13v4"/></g>',shapeIconSelectionModeSubtract:'<g fill="none" fill-rule="evenodd" stroke="currentColor"><path fill="currentColor" fill-opacity=".25" stroke-linecap="round" stroke-linejoin="round" d="M15 3a2 2 0 0 1 2 2v4h-6a2 2 0 0 0-1.995 1.85L9 11v6H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10Z"/><rect width="12" height="12" x="9" y="9" stroke-linecap="round" stroke-linejoin="round" rx="2"/><path d="M13 15h4"/></g>',shapeIconToolSelectionBrush:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M2.025 5c5.616-2.732 8.833-3.857 9.65-3.374C12.903 2.351.518 12.666 2.026 14 3.534 15.334 16.536.566 17.73 2.566 18.924 4.566 3.98 17.187 4.831 18c.851.813 9.848-6 11.643-6 1.087 0-2.53 5.11-2.92 7-.086.41 3.323-1.498 4.773-1 .494.17.64 2.317 1.319 3 .439.443 1.332.776 2.679 1" stroke="currentColor" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolSelectionLassoo:'<g fill="none" fill-rule="evenodd" stroke-width=".125em" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M11.428 17.702a18.46 18.46 0 0 0 4.085-1.595c5.851-3.112 9.019-8.599 7.074-12.256-1.945-3.657-8.265-4.1-14.116-.988C2.619 5.974-.55 11.46 1.396 15.118c.63 1.186 1.72 2.033 3.105 2.532"/><ellipse cx="8" cy="18.5" rx="3.5" ry="2.833" transform="rotate(-15 8 18.5)"/><path stroke-linecap="round" d="M5 18c3.347 1.048 5.514 1.881 6.5 2.5.859.54 1.517.994 1.5 2.364"/></g>',shapeIconToolSelectionRectangle:'<g stroke-width=".125em" stroke="currentColor"><path d="M9 1 h6 m4 0 h4v4 m0 4 v6 m0 4 v4h-4 m-4 0 h-6 m-4 0 h-4v-4 m0 -4 v-6 m0 -4 v-4h4" fill="none" /></g>',shapeIconToolSelectionEllipse:'<path stroke-width=".125em" stroke="currentColor" d="M1.21 9.853a11.054 11.054 0 0 0 0 4.294m1.643 3.965a11.054 11.054 0 0 0 3.035 3.035m3.965 1.644a11.054 11.054 0 0 0 4.294 0m3.965-1.644a11.054 11.054 0 0 0 3.035-3.035m1.644-3.965a11.054 11.054 0 0 0 0-4.294m-1.644-3.965a11.054 11.054 0 0 0-3.035-3.035m-3.965-1.644a11.054 11.054 0 0 0-4.294 0M5.888 2.853a11.054 11.054 0 0 0-3.035 3.035"/>'};var l8={cropLabel:"Crop",cropIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M23 17H9a2 2 0 0 1-2-2v-5m0-3V1 M1 7h14a2 2 0 0 1 2 2v7m0 4v3"/></g>',cropIconButtonRecenter:'<path stroke="currentColor" fill="none" stroke-width="2" stroke-linejoin="bevel" d="M1.5 7.5v-6h6M1.5 16.5v6h6M22.5 16.5v6h-6M22.5 7.5v-6h-6"/><circle cx="12" cy="12" r="3.5" fill="currentColor" stroke="none"/>',cropIconButtonRotateLeft:'<g stroke="none" fill="currentColor"><path fill="none" d="M-1-1h582v402H-1z"/><rect x="3" rx="1" height="12" width="12" y="9"/><path d="M15 5h-1a5 5 0 015 5 1 1 0 002 0 7 7 0 00-7-7h-1.374l.747-.747A1 1 0 0011.958.84L9.603 3.194a1 1 0 000 1.415l2.355 2.355a1 1 0 001.415-1.414l-.55-.55H15z"/></g>',cropIconButtonRotateRight:'<g stroke="none" fill="currentColor"><path fill="none" d="M-1-1h582v402H-1z"/><path d="M11.177 5H10a5 5 0 00-5 5 1 1 0 01-2 0 7 7 0 017-7h1.374l-.747-.747A1 1 0 0112.042.84l2.355 2.355a1 1 0 010 1.415l-2.355 2.354a1 1 0 01-1.415-1.414l.55-.55z"/><rect rx="1" height="12" width="12" y="9" x="9"/></g>',cropIconButtonFlipVertical:'<g stroke="none" fill="currentColor"><path d="M19.993 12.143H7a1 1 0 0 1-1-1V5.994a1 1 0 0 1 1.368-.93l12.993 5.15a1 1 0 0 1-.368 1.93z"/><path d="M19.993 14a1 1 0 0 1 .368 1.93L7.368 21.078A1 1 0 0 1 6 20.148V15a1 1 0 0 1 1-1h12.993z" opacity=".6"/></g>',cropIconButtonFlipHorizontal:'<g stroke="none" fill="currentColor"><path d="M11.93 7.007V20a1 1 0 0 1-1 1H5.78a1 1 0 0 1-.93-1.368l5.15-12.993a1 1 0 0 1 1.929.368z"/><path d="M14 7.007V20a1 1 0 0 0 1 1h5.149a1 1 0 0 0 .93-1.368l-5.15-12.993A1 1 0 0 0 14 7.007z" opacity=".6"/></g>',cropIconSelectPreset:(t,e)=>{const[i,n,r]=e?[e<1?1:.3,e===1?.85:.5,e>1?1:.3]:[.2,.3,.4];return`<g fill="currentColor">
            <rect opacity="${i}" x="2" y="4" width="10" height="18" rx="1"/>
            <rect opacity="${n}" x="4" y="8" width="14" height="14" rx="1"/>
            <rect opacity="${r}" x="6" y="12" width="17" height="10" rx="1"/>
        </g>`},cropIconCropBoundary:(t,e)=>{const[i,n,r,o]=e?[.3,1,0,0]:[0,0,.3,1];return`<g fill="currentColor">
            <rect opacity="${i}" x="2" y="3" width="20" height="20" rx="1"/>
            <rect opacity="${n}" x="7" y="8" width="10" height="10" rx="1"/>
            <rect opacity="${r}" x="4" y="8" width="14" height="14" rx="1"/>
            <rect opacity="${o}" x="12" y="4" width="10" height="10" rx="1"/>
        </g>`},cropLabelButtonRecenter:"Recenter",cropLabelButtonRotateLeft:"Rotate left",cropLabelButtonRotateRight:"Rotate right",cropLabelButtonFlipHorizontal:"Flip horizontal",cropLabelButtonFlipVertical:"Flip vertical",cropLabelSelectPreset:"Crop shape",cropLabelCropBoundary:"Crop boundary",cropLabelCropBoundaryEdge:"Edge of image",cropLabelCropBoundaryNone:"None",cropLabelTabRotation:"Rotation",cropLabelTabZoom:"Scale"},c8={fillLabel:"Fill",fillIcon:`
    <g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em">
        <g transform="rotate(60, 12, 12)">
            <rect x="4" y="4" width="14" height="16" rx="3"/>
        </g>
        <path d="M21 13 L21 21"></path>
        <path d="M4.5 12.5 L19 12.5"></path>
    </g>
    `},d8={frameLabel:"Frame",frameIcon:`<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em">
            <rect x="2" y="2" width="20" height="20" rx="4"/>
            <rect x="6" y="6" width="12" height="12" rx="1"/>
        </g>`,frameLabelMatSharp:"Mat",frameLabelMatRound:"Bevel",frameLabelLineSingle:"Line",frameLabelLineMultiple:"Zebra",frameLabelEdgeSeparate:"Inset",frameLabelEdgeOverlap:"Plus",frameLabelEdgeCross:"Lumber",frameLabelCornerHooks:"Hook",frameLabelPolaroid:"Polaroid"},u8={redactLabel:"Redact",redactIcon:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M 4 5 l 1 -1"/><path d="M 4 10 l 6 -6"/><path d="M 4 15 l 11 -11"/><path d="M 4 20 l 16 -16"/><path d="M 9 20 l 11 -11"/><path d="M 14 20 l 6 -6"/><path d="M 19 20 l 1 -1"/></g>'},mh=(t,e)=>{const i=Object.getOwnPropertyDescriptors(t);Object.keys(i).forEach(n=>{i[n].get?Object.defineProperty(e,n,{get:()=>t[n],set:r=>t[n]=r}):e[n]=t[n]})},tx=t=>{const e={},{sub:i,pub:n}=ns();Pr()&&document.doctype!==null||console.warn("Browser is in quirks mode, add <!DOCTYPE html> to page to fix render issues");const r=n2();mh(r,e);const o=((c,d)=>{const u={},p=new Vg({target:c,props:{stores:d,pluginComponents:Array.from(dh)}});let h=!1;const g=()=>{h||(Pr()&&window.removeEventListener("pagehide",g),p&&(h=!0,p.$destroy()))};Op||(Op=new Set(Xh(Vg).filter(f=>!y3.includes(f)))),Op.forEach(f=>{Object.defineProperty(u,f,{get:()=>p[f],set:x3.includes(f)?b=>{p[f]={...p[f],...b}}:b=>p[f]=b})}),Object.defineProperty(u,"previewImageData",{get:()=>p.imagePreviewCurrent}),B2.forEach(f=>{const b=su[f],w=b[0];Object.defineProperty(u,f,{get:()=>p.pluginInterface[w][f],set:S=>{const C=b.reduce((I,M)=>(I[M]={...p.pluginOptions[M],[f]:S},I),{});p.pluginOptions={...p.pluginOptions,...C}}})}),Object.defineProperty(u,"element",{get:()=>p.root,set:()=>{}});const m=p.history;return bu(u,{on:(f,b)=>{if(h)return()=>{};if(/undo|redo|revert|writehistory/.test(f))return m.on(f,b);const w=[p.sub(f,b),p.$on(f,S=>b(S instanceof CustomEvent&&!S.detail?void 0:S))].filter(Boolean);return()=>w.forEach(S=>S())},updateImagePreview:f=>{p.imagePreviewSrc=f},close:()=>!h&&p.pub("close"),destroy:g}),Object.defineProperty(u,"history",{get:()=>({undo:()=>m.undo(),redo:()=>m.redo(),revert:()=>m.revert(),get:()=>m.get(),getCollapsed:()=>m.get().splice(0,m.index+1),set:f=>m.set(f),write:f=>m.write(f),get length(){return m.length()},get index(){return m.index},set index(f){m.index=f}})}),Pr()&&window.addEventListener("pagehide",g),u})(t,r.stores);mh(o,e);const a=["loadImage","processImage","abortProcessImage","abortLoadImage"].map(c=>o.on(c,d=>{const u=r[c](d&&d.detail);u instanceof Promise&&u.catch(me)})),s=(c,d)=>{const u=i(c,d),p=r.on(c,d),h=o.on(c,d);return()=>{u(),p(),h()}};e.handleEvent=me;const l=O2.map(c=>s(c,d=>e.handleEvent(c,d)));return bu(e,{on:s,updateImage:c=>new Promise((d,u)=>{const p=e.history.get(),h=e.history.index,g=e.imageState;r.loadImage(c).then(m=>{e.history.set(p),e.history.index=h,e.imageState=g,d(m)}).catch(u)}),close:()=>{n("close")},destroy:()=>{[...a,...l].forEach(c=>c()),o.destroy(),r.destroy(),n("destroy")}}),setTimeout(()=>n("init",e),0),e};Pr();var p8=(t,e={})=>{const i=_e(t)?document.querySelector(t):t;if(!Bl(i))return;e.class=e.class?"pintura-editor "+e.class:"pintura-editor";const n=tx(i);return Object.assign(n,e)};const Hf=(t,e,i,n)=>{const r=ot(e.x-t.x,e.y-t.y),o=ro(r),a=5*i;let s;s=n?.5*a:Math.ceil(.5*(a-1));const l=Mr(Be(o),s);return{anchor:Be(t),offset:l,normal:o,solid:n,size:a,sizeHalf:s}},h8=(t,e,i)=>{const{strokeWidth:n,strokeColor:r,strokeJoin:o,strokeCap:a,...s}=t,{anchor:l,offset:c,normal:d,solid:u,size:p,sizeHalf:h}=e,g=l.x,m=l.y,f=Mr(Be(d),p),b=ot(g+f.x,m+f.y);if(Mr(f,.55),u){Dn(i,c);const w=Mr(Be(d),.5*h);return[{...s,points:[ot(g-w.x,m-w.y),ot(b.x-f.y,b.y+f.x),ot(b.x+f.y,b.y-f.x)],pathClose:!0,backgroundColor:r}]}{const w=Mr((I=>{const M=I.x;return I.x=-I.y,I.y=M,I})(Be(d)),.5),S=ot(g-w.x,m-w.y),C=ot(g+w.x,m+w.y);return[{...s,points:[ot(b.x+f.y,b.y-f.x),S,ot(g,m),C,ot(b.x-f.y,b.y+f.x)],pathClose:!1,strokeWidth:n,strokeColor:r,strokeJoin:o,strokeCap:a}]}},m8=(t,e,i)=>{const{strokeWidth:n,strokeColor:r,...o}=t,{anchor:a,solid:s,offset:l,normal:c,sizeHalf:d}=e;return Dn(i,l),s&&Dn(i,El(Be(c))),[{...o,x:a.x,y:a.y,rx:d,ry:d,backgroundColor:s?r:void 0,strokeWidth:s?void 0:n,strokeColor:s?void 0:r}]},$8=(t,e)=>{const{strokeWidth:i,strokeColor:n,strokeJoin:r,strokeCap:o,...a}=t,{anchor:s,offset:l}=e;return[{...a,points:[ot(s.x-l.y,s.y+l.x),ot(s.x+l.y,s.y-l.x)],strokeWidth:i,strokeColor:n,strokeJoin:r,strokeCap:o}]},g8=(t,e,i)=>{const{strokeWidth:n,strokeColor:r,...o}=t,{anchor:a,solid:s,offset:l,normal:c,sizeHalf:d}=e;return Dn(i,l),[{...o,x:a.x-d,y:a.y-d,width:2*d,height:2*d,rotation:(u=c,Math.atan2(u.y,u.x)),backgroundColor:s?r:void 0,strokeWidth:s?void 0:n,strokeColor:s?void 0:r}];var u},f8=(t={})=>e=>{if(!e.lineStart&&!e.lineEnd)return;const i=[],{x1:n,y1:r,x2:o,y2:a,lineStart:s,lineEnd:l,strokeWidth:c,strokeColor:d,strokeJoin:u,strokeCap:p,strokeDash:h,bitmap:g,aboveFrame:m,opacity:f}=e,b=ot(n,r),w=ot(o,a),S=[b,w],C={bitmap:g,aboveFrame:m,opacity:f,strokeColor:d,strokeWidth:c,strokeJoin:u,strokeCap:p};if(s){const[I,M]=s.split("-"),D=t[I];if(D){const T=Hf(b,w,c,!!M);i.push(...D(C,T,b))}}if(l){const[I,M]=l.split("-"),D=t[I];if(D){const T=Hf(w,b,c,!!M);i.push(...D(C,T,w))}}return[{...C,strokeDash:h,points:S},...i]},y8=()=>({arrow:h8,circle:m8,square:g8,bar:$8}),$h=(t,e)=>{const i=parseFloat(t)*e;return _e(t)?i+"%":i},ta=(t,e)=>_e(t)?gu(t,e):t,x8=t=>[{...t,frameStyle:"line",frameInset:0,frameOffset:0,frameSize:t.frameSize?$h(t.frameSize,2):"2.5%",frameRadius:t.frameRound?$h(t.frameSize,2):0}],b8=({width:t,height:e,frameImage:i,frameSize:n="15%",frameOutset:r=0,frameSlices:o={x1:.15,y1:.15,x2:.85,y2:.85}},{isPreview:a})=>{if(!i)return[];const s=Math.sqrt(t*e),l=ta(n,s),c=a?l:Math.round(l),d=c,u=ta(r,s),p=2*u,{x1:h,x2:g,y1:m,y2:f}=o,b={x0:0,y0:0,x1:c,y1:d,x2:t-c,y2:e-d,x3:t,y3:e,cw:c,ch:d,ew:t-c-c,eh:e-d-d},w=a?1:0,S=2*w,C=u>0,I={expandsCanvas:C,width:b.cw,height:b.ch,backgroundImage:i};return[{expandsCanvas:C,x:b.x1-w-u,y:b.y0-u,width:b.ew+S+p,height:b.ch,backgroundCorners:[{x:h,y:0},{x:g,y:0},{x:g,y:m},{x:h,y:m}],backgroundImage:i},{expandsCanvas:C,x:b.x1-w-u,y:b.y2+u,width:b.ew+S+p,height:b.ch,backgroundCorners:[{x:h,y:f},{x:g,y:f},{x:g,y:1},{x:h,y:1}],backgroundImage:i},{expandsCanvas:C,x:b.x0-u,y:b.y1-w-u,width:b.cw,height:b.eh+S+p,backgroundCorners:[{x:0,y:m},{x:h,y:m},{x:h,y:f},{x:0,y:f}],backgroundImage:i},{expandsCanvas:C,x:b.x2+u,y:b.y1-w-u,width:b.cw,height:b.eh+S+p,backgroundCorners:[{x:g,y:m},{x:1,y:m},{x:1,y:f},{x:g,y:f}],backgroundImage:i},{...I,x:b.x0-u,y:b.y0-u,backgroundCorners:[{x:0,y:0},{x:h,y:0},{x:h,y:m},{x:0,y:m}]},{...I,x:b.x2+u,y:b.y0-u,backgroundCorners:[{x:g,y:0},{x:1,y:0},{x:1,y:m},{x:g,y:m}]},{...I,x:b.x2+u,y:b.y2+u,backgroundCorners:[{x:g,y:f},{x:1,y:f},{x:1,y:1},{x:g,y:1}]},{...I,x:b.x0-u,y:b.y2+u,backgroundCorners:[{x:0,y:f},{x:h,y:f},{x:h,y:1},{x:0,y:1}]}]},v8=({x:t,y:e,width:i,height:n,frameInset:r="3.5%",frameSize:o=".25%",frameColor:a=[1,1,1],frameOffset:s="5%",frameAmount:l=1,frameRadius:c=0,expandsCanvas:d=!1},{isPreview:u})=>{const p=Math.sqrt(i*n);let h=ta(o,p);const g=ta(r,p),m=ta(s,p);let f=0;u||(h=Math.max(1,Math.round(h)),f=h%2==0?0:.5);const b=ta($h(c,l),p);return new Array(l).fill(void 0).map((w,S)=>{const C=m*S;let I=t+g+C,M=e+g+C,D=t+i-g-C,T=e+n-g-C;return u||(I=Math.round(I),M=Math.round(M),D=Math.round(D),T=Math.round(T)),{x:I+f,y:M+f,width:D-I,height:T-M,cornerRadius:b>0?b-C:0,strokeWidth:h,strokeColor:a,expandsCanvas:d}})},w8=({x:t,y:e,width:i,height:n,frameSize:r=".25%",frameOffset:o=0,frameInset:a="2.5%",frameColor:s=[1,1,1]},{isPreview:l})=>{const c=Math.sqrt(i*n);let d=ta(r,c),u=ta(a,c),p=ta(o,c),h=0;l||(d=Math.max(1,Math.round(d)),u=Math.round(u),p=Math.round(p),h=d%2==0?0:.5);const g=p-u,m=t+u+h,f=e+u+h,b=t+i-u-h,w=e+n-u-h;return[{points:[ot(m+g,f),ot(b-g,f)]},{points:[ot(b,f+g),ot(b,w-g)]},{points:[ot(b-g,w),ot(m+g,w)]},{points:[ot(m,w-g),ot(m,f+g)]}].map(S=>(S.strokeWidth=d,S.strokeColor=s,S))},S8=({x:t,y:e,width:i,height:n,frameSize:r=".25%",frameInset:o="2.5%",frameLength:a="2.5%",frameColor:s=[1,1,1]},{isPreview:l})=>{const c=Math.sqrt(i*n);let d=ta(r,c),u=ta(o,c),p=ta(a,c),h=0;l||(d=Math.max(1,Math.round(d)),u=Math.round(u),p=Math.round(p),h=d%2==0?0:.5);const g=t+u+h,m=e+u+h,f=t+i-u-h,b=e+n-u-h;return[{points:[ot(g,m+p),ot(g,m),ot(g+p,m)]},{points:[ot(f-p,m),ot(f,m),ot(f,m+p)]},{points:[ot(f,b-p),ot(f,b),ot(f-p,b)]},{points:[ot(g+p,b),ot(g,b),ot(g,b-p)]}].map(w=>(w.strokeWidth=d,w.strokeColor=s,w))},k8=({x:t,y:e,width:i,height:n,frameColor:r=[1,1,1]},{isPreview:o})=>{const a=Math.sqrt(i*n),s=.1*a;let l=.2*a,c=0;const d=.5*s;return o?c=1:l=Math.ceil(l),r.length=3,[{id:"border",x:t-d+c,y:e-d+c,width:i+s-2*c,height:n+l-2*c,frameStyle:"line",frameInset:0,frameOffset:0,frameSize:s,frameColor:r,expandsCanvas:!0},{id:"chin",x:t-d,y:n-c,width:i+s,height:l,backgroundColor:r,expandsCanvas:!0}].filter(Boolean)},C8=(t={})=>(e,i)=>{if(!Ae(e,"frameStyle"))return;const n=e.frameStyle,r=t[n];if(!r)return;const{frameStyle:o,...a}=e;return r(a,i)},T8=()=>({solid:x8,hook:S8,line:v8,edge:w8,polaroid:k8,nine:b8}),M8=t=>{const e=(i,n={isPreview:!0})=>{const r=t.map(o=>{const a=o(i,n);if(a)return a.map(s=>e(s,n))}).filter(Boolean).flat();return r.length?r.flat().map((o,a)=>(o.id=i.id+"_"+a,o)):i};return e};typeof window<"u"&&(t=>{if(!t)return;const[e,i,n,r]=[[108,111,99,97,116,105,111,110],[82,101,103,69,120,112],[116,101,115,116],[112,113,105,110,97,92,46,110,108]].map(o=>o.map(a=>String.fromCharCode(a)).join(""));t._u5rlc3k=new t[i](r)[n](t[e])})(window);const P8=$2,jf=g2,R8=()=>({read:Kx,apply:Xf}),I8=(t={})=>{const{blurAmount:e,dataSizeScalar:i,scrambleAmount:n,backgroundColor:r}=t;return(o,a)=>(async(s,l={})=>{if(!s)return;const{width:c,height:d}=s,{dataSize:u=96,dataSizeScalar:p=1,scrambleAmount:h=4,blurAmount:g=6,outputFormat:m="canvas",backgroundColor:f=[0,0,0]}=l,b=Math.round(u*p),w=Math.min(b/c,b/d),S=Math.floor(c*w),C=Math.floor(d*w),I=xn("canvas",{width:S,height:C}),M=I.getContext("2d",{willReadFrequently:!0});if(f.length=3,M.fillStyle=$r(f),M.fillRect(0,0,S,C),Fl(s)){const W=xn("canvas",{width:c,height:d});W.getContext("2d",{willReadFrequently:!0}).putImageData(s,0,0),M.drawImage(W,0,0,S,C),qn(W)}else M.drawImage(s,0,0,S,C);const D=M.getImageData(0,0,S,C),T=[];if(h>0&&T.push([_v,{amount:h}]),g>0)for(let W=0;W<g;W++)T.push([yy,{matrix:Vv}]);let F;if(T.length){const W=(V,tt)=>`(err, imageData) => {
(${V[tt][0].toString()})(Object.assign({ imageData: imageData }, filterInstructions[${tt}]), 
${V[tt+1]?W(V,tt+1):"done"})
}`,O=`function (options, done) {
const filterInstructions = options.filterInstructions;
const imageData = options.imageData;
(${W(T,0)})(null, imageData)
}`,y=await Hc(O,[{imageData:D,filterInstructions:T.map(V=>V[1])}],[D.data.buffer]);F=Ph(y)}else F=D;return m==="canvas"?(M.putImageData(F,0,0),I):F})(o,{blurAmount:e,scrambleAmount:n,backgroundColor:r,...a,dataSizeScalar:i||a.dataSizeScalar})},E8=X2,A8={markupEditorToolbar:lw(),markupEditorToolStyles:sw(),markupEditorShapeStyleControls:X2()},L8=gS,z8=wS,F8=RS,D8=M6,B8=I6,O8=L6,W8=W6,_8=Q6,V8=q6,N8=o8,H8=Z3,j8=O3,U8=nw,G8=a8,Z8=s8,X8=l8,Y8=c8,q8={filterLabel:"Filter",filterIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M18.347 9.907a6.5 6.5 0 1 0-1.872 3.306M3.26 11.574a6.5 6.5 0 1 0 2.815-1.417 M10.15 17.897A6.503 6.503 0 0 0 16.5 23a6.5 6.5 0 1 0-6.183-8.51"/></g>',filterLabelChrome:"Chrome",filterLabelFade:"Fade",filterLabelCold:"Cold",filterLabelWarm:"Warm",filterLabelPastel:"Pastel",filterLabelMonoDefault:"Mono",filterLabelMonoNoir:"Noir",filterLabelMonoWash:"Wash",filterLabelMonoStark:"Stark",filterLabelSepiaDefault:"Sepia",filterLabelSepiaBlues:"Blues",filterLabelSepiaRust:"Rust",filterLabelSepiaColor:"Color"},K8={finetuneLabel:"Finetune",finetuneIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M4 1v5.5m0 3.503V23M12 1v10.5m0 3.5v8M20 1v15.5m0 3.5v3M2 7h4M10 12h4M18 17h4"/></g>',finetuneLabelBrightness:"Brightness",finetuneLabelContrast:"Contrast",finetuneLabelSaturation:"Saturation",finetuneLabelExposure:"Exposure",finetuneLabelTemperature:"Temperature",finetuneLabelGamma:"Gamma",finetuneLabelClarity:"Clarity",finetuneLabelVignette:"Vignette"},J8={resizeLabel:"Resize",resizeIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><rect x="2" y="12" width="10" height="10" rx="2"/><path d="M4 11.5V4a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-5.5"/><path d="M14 10l3.365-3.365M14 6h4v4"/></g>',resizeLabelFormCaption:"Image output size",resizeLabelInputWidth:"w",resizeTitleInputWidth:"Width",resizeLabelInputHeight:"h",resizeTitleInputHeight:"Height",resizeTitleButtonMaintainAspectRatio:"Maintain aspectratio",resizeIconButtonMaintainAspectRatio:(t,e)=>`<defs><mask id="mask1" x="0" y="0" width="24" height="24" ><rect x="0" y="0" width="24" height="10" fill="#fff" stroke="none"/></mask></defs><g fill="none" fill-rule="evenodd"><g  mask="url(#mask1)"><path transform="translate(0 ${3*(e-1)})" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" d="M9.401 10.205v-.804a2.599 2.599 0 0 1 5.198 0V17"/></g><rect fill="currentColor" x="7" y="10" width="10" height="7" rx="1.5"/></g>`},Q8={decorateLabel:"Decorate",decorateIcon:'<g fill="none" fill-rule="evenodd"><path stroke="currentColor" stroke-width=".125em" stroke-linecap="round" stroke-linejoin="round" d="M12 18.5l-6.466 3.4 1.235-7.2-5.23-5.1 7.228-1.05L12 2l3.233 6.55 7.229 1.05-5.231 5.1 1.235 7.2z"/></g>'},tk={annotateLabel:"Annotate",annotateIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M17.086 2.914a2.828 2.828 0 1 1 4 4l-14.5 14.5-5.5 1.5 1.5-5.5 14.5-14.5z"/></g>'},ek={stickerLabel:"Sticker",stickerIcon:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z"/><path d="M20 17c-3 3-5 5-8 5"/></g>'},ik=d8,nk=u8,rk=p8,ok=(t=[])=>M8([C8(T8()),f8(y8()),...t]),ak=(t={})=>{let e,i;Array.isArray(t.imageReader)||(i=t.imageReader,delete t.imageReader),Array.isArray(t.imageWriter)?e=jf():(e=on(t.imageWriter)?t.imageWriter:jf(t.imageWriter),delete t.imageWriter);let n;return on(t.imageScrambler)||(n=t.imageScrambler,delete t.imageScrambler),{imageReader:P8(i),imageWriter:e,imageOrienter:R8(),imageScrambler:I8(n)}},sk=(t={})=>{b3(L8,z8,F8,D8,B8,O8,W8,_8,V8,N8);const e=ak(t),i={...G8,...Z8,...X8,...Y8,...q8,...K8,...ik,...nk,...J8,...Q8,...tk,...ek,...t.locale};delete t.locale;const n=typeof t.shapePreprocessor=="function"?t.shapePreprocessor:ok(t.shapePreprocessor);return delete t.shapePreprocessor,t.markupEditorShapeStyleControls&&Object.entries(t.markupEditorShapeStyleControls).every(([r,o])=>/Options$/.test(r)||!Array.isArray(o))&&(t.markupEditorShapeStyleControls=E8({...t.markupEditorShapeStyleControls})),Ky([{...e,shapePreprocessor:n,utils:["trim","crop","filter","finetune","retouch","annotate","decorate","sticker","fill","frame","redact","resize"],...H8,...j8,...U8,...A8,stickerStickToImage:!0,locale:i},t])},lk={mounted(){this.editor=rk(this.$refs.elementRef,Object.assign({},this.$attrs)),this.unsubs=W2(this.editor,this.$refs.elementRef)},beforeUpdate(){Object.assign(this.editor,Object.assign({},this.$attrs))},beforeUnmount(){this.editor&&(this.editor.destroy(),this.unsubs.forEach(t=>t()),this.unsubs=[],this.editor=void 0)},render(){return Wx("div",{className:"PinturaRootWrapper",ref:"elementRef"})}},ck=_x({__name:"MediaImageEditor",props:{media:{}},async setup(t){let e,i;const n=t,r=sk({enableButtonClose:!0});n.media.fetch();const o=([e,i]=Vx(()=>Bx(n.media)),e=await e,i(),e);function a(l){n.media.setMediaImage(l.detail.dest),n.media.setEditing(!1),n.media.setUniqueId()}function s(l){l||n.media.setEditing(!1)}return(l,c)=>(Nx(),Hx(Zx,{to:"#drawer-editor"},[dm(Xx,{width:500,"rail-width":500,touchless:"","model-value":!0,"disable-resize-watcher":!0,elevation:0,class:"ig-navigation-drawer-editor","onUpdate:modelValue":s},{default:jx(()=>[dm(np(lk),Ux(np(r),{src:np(o),"onPintura:process":c[0]||(c[0]=d=>a(d)),"onPintura:close":c[1]||(c[1]=d=>l.media.setEditing(!1)),onContextmenu:c[2]||(c[2]=Gx(()=>{},["stop"]))}),null,16,["src"])]),_:1})]))}}),Mk=Ox(ck,[["__scopeId","data-v-96e7af5e"]]);export{Mk as default};
